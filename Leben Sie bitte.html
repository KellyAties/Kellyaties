<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Leben Sie bitte</title>
<style title="Twine CSS">@keyframes appear{0%{opacity:0}to{opacity:1}}@keyframes fade-in-out{0%,to{opacity:0}50%{opacity:1}}@keyframes rumble{25%{top:-0.1em}75%{top:.1em}0%,to{top:0px}}@keyframes shudder{25%{left:.1em}75%{left:-0.1em}0%,to{left:0px}}@keyframes buoy{25%{top:.25em}75%{top:-0.25em}0%,to{top:0px}}@keyframes sway{25%{left:.25em}75%{left:-0.25em}0%,to{left:0px}}@keyframes pulse{0%{transform:scale(0, 0)}20%{transform:scale(1.2, 1.2)}40%{transform:scale(0.9, 0.9)}60%{transform:scale(1.05, 1.05)}80%{transform:scale(0.925, 0.925)}to{transform:scale(1, 1)}}@keyframes zoom-in{0%{transform:scale(0, 0)}to{transform:scale(1, 1)}}@keyframes shudder-in{0%,to{transform:translateX(0em)}5%,25%,45%{transform:translateX(-1em)}15%,35%,55%{transform:translateX(1em)}65%{transform:translateX(-0.6em)}75%{transform:translateX(0.6em)}85%{transform:translateX(-0.2em)}95%{transform:translateX(0.2em)}}@keyframes rumble-in{0%,to{transform:translateY(0em)}5%,25%,45%{transform:translateY(-1em)}15%,35%,55%{transform:translateY(1em)}65%{transform:translateY(-0.6em)}75%{transform:translateY(0.6em)}85%{transform:translateY(-0.2em)}95%{transform:translateY(0.2em)}}@keyframes fidget{0%,8.1%,82.1%,31.1%,38.1%,44.1%,40.1%,47.1%,74.1%,16.1%,27.1%,72.1%,24.1%,95.1%,6.1%,36.1%,20.1%,4.1%,91.1%,14.1%,87.1%,to{left:0px;top:0px}8%,82%,31%,38%,44%{left:-1px}40%,47%,74%,16%,27%{left:1px}72%,24%,95%,6%,36%{top:-1px}20%,4%,91%,14%,87%{top:1px}}@keyframes slide-right{0%{transform:translateX(-100vw)}}@keyframes slide-left{0%{transform:translateX(100vw)}}@keyframes slide-up{0%{transform:translateY(100vh)}}@keyframes slide-down{0%{transform:translateY(-100vh)}}@keyframes fade-right{0%{opacity:0;transform:translateX(-1em)}to{opacity:1}}@keyframes fade-left{0%{opacity:0;transform:translateX(1em)}to{opacity:1}}@keyframes fade-up{0%{opacity:0;transform:translateY(1em)}to{opacity:1}}@keyframes fade-down{0%{opacity:0;transform:translateY(-1em)}to{opacity:1}}@keyframes flicker{0%,29%,31%,63%,65%,77%,79%,86%,88%,91%,93%{opacity:0}30%{opacity:.2}64%{opacity:.4}78%{opacity:.6}87%{opacity:.8}92%,to{opacity:1}}@keyframes blur{0%{filter:blur(2rem);opacity:0}25%{opacity:1}to{filter:blur(0rem);opacity:1}}.dom-debug-mode tw-story,.dom-debug-mode tw-passage,.dom-debug-mode tw-sidebar,.dom-debug-mode tw-include,.dom-debug-mode tw-hook,.dom-debug-mode tw-expression,.dom-debug-mode tw-link,.dom-debug-mode tw-dialog,.dom-debug-mode tw-columns,.dom-debug-mode tw-column,.dom-debug-mode tw-align{outline:1px solid #f5a3da;min-height:32px;display:block !important}.dom-debug-mode tw-story::before,.dom-debug-mode tw-passage::before,.dom-debug-mode tw-sidebar::before,.dom-debug-mode tw-include::before,.dom-debug-mode tw-hook::before,.dom-debug-mode tw-expression::before,.dom-debug-mode tw-link::before,.dom-debug-mode tw-dialog::before,.dom-debug-mode tw-columns::before,.dom-debug-mode tw-column::before,.dom-debug-mode tw-align::before{position:absolute;top:0;left:0;height:16px;background-color:#f5a3da;color:#000;font-size:16px;font-weight:normal;font-style:normal;font-family:monospace;display:inline-block;line-height:100%;white-space:pre;z-index:999997}.dom-debug-mode tw-story:hover,.dom-debug-mode tw-passage:hover,.dom-debug-mode tw-sidebar:hover,.dom-debug-mode tw-include:hover,.dom-debug-mode tw-hook:hover,.dom-debug-mode tw-expression:hover,.dom-debug-mode tw-link:hover,.dom-debug-mode tw-dialog:hover,.dom-debug-mode tw-columns:hover,.dom-debug-mode tw-column:hover,.dom-debug-mode tw-align:hover{outline:1px solid #fc9}.dom-debug-mode tw-story:hover::before,.dom-debug-mode tw-passage:hover::before,.dom-debug-mode tw-sidebar:hover::before,.dom-debug-mode tw-include:hover::before,.dom-debug-mode tw-hook:hover::before,.dom-debug-mode tw-expression:hover::before,.dom-debug-mode tw-link:hover::before,.dom-debug-mode tw-dialog:hover::before,.dom-debug-mode tw-columns:hover::before,.dom-debug-mode tw-column:hover::before,.dom-debug-mode tw-align:hover::before{background-color:#fc9;transition:background-color 1s}.dom-debug-mode tw-passage,.dom-debug-mode tw-include,.dom-debug-mode tw-hook,.dom-debug-mode tw-expression,.dom-debug-mode tw-link,.dom-debug-mode tw-dialog,.dom-debug-mode tw-columns,.dom-debug-mode tw-column,.dom-debug-mode tw-align{padding:1em;margin:0}.dom-debug-mode tw-story::before{content:'<tw-story tags="' attr(tags) '">'}.dom-debug-mode tw-passage::before{top:-16px;content:'<tw-passage tags="' attr(tags) '">'}.dom-debug-mode tw-sidebar::before{top:-16px;content:"<tw-sidebar>"}.dom-debug-mode tw-hook::before{content:'<tw-hook name="' attr(name) '">'}.dom-debug-mode tw-expression::before{content:'<tw-expression name="' attr(name) '">'}.dom-debug-mode tw-link::before{content:'<tw-link name="' attr(name) '">'}.dom-debug-mode tw-dialog::before{content:"<tw-dialog>"}.dom-debug-mode tw-columns::before{content:"<tw-columns>"}.dom-debug-mode tw-column::before{content:"<tw-column>"}.dom-debug-mode tw-align::before{content:"<tw-align>"}.dom-debug-mode tw-include::before{content:'<tw-include type="' attr(type) '" name="' attr(name) '">'}tw-open-button[goto]{display:none}.debug-mode tw-open-button[replay],.debug-mode tw-open-button[goto]{display:inline}.debug-mode tw-expression{display:inline-block !important}.debug-mode tw-expression[type=variable]::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"$" attr(name)}.debug-mode tw-expression[type=tempVariable]::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"_" attr(name)}.debug-mode tw-expression[return=boolean]{background-color:rgba(179,179,179,.2)}.debug-mode tw-expression[return=array]{background-color:rgba(255,102,102,.2)}.debug-mode tw-expression[return=dataset]{background-color:rgba(255,128,0,.2)}.debug-mode tw-expression[return=number]{background-color:rgba(255,179,102,.2)}.debug-mode tw-expression[return=datamap]{background-color:rgba(255,255,102,.2)}.debug-mode tw-expression[return=changer]{background-color:rgba(179,255,102,.2)}.debug-mode tw-expression[return=lambda]{background-color:rgba(102,255,102,.2)}.debug-mode tw-expression[return=hookname]{background-color:rgba(102,255,204,.2)}.debug-mode tw-expression[return=string]{background-color:rgba(102,255,255,.2)}.debug-mode tw-expression[return=datatype]{background-color:rgba(102,153,255,.2)}.debug-mode tw-expression[return=gradient],.debug-mode tw-expression[return=colour]{background-color:rgba(204,102,255,.2)}.debug-mode tw-expression[return=instant],.debug-mode tw-expression[return=macro]{background-color:rgba(240,117,199,.2)}.debug-mode tw-expression[return=command]{background-color:rgba(153,153,255,.2)}.debug-mode tw-expression.false{background-color:rgba(255,0,0,.2) !important}.debug-mode tw-expression[type=macro]::before{content:"(" attr(name) ":)";padding:0 .5rem;font-size:1rem;vertical-align:middle;line-height:normal;background-color:inherit;border:1px solid rgba(255,255,255,.5)}.debug-mode tw-expression[title]:not([title=""]){cursor:help}.debug-mode tw-hook{background-color:rgba(0,85,255,.1) !important}.debug-mode tw-hook::before{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"["}.debug-mode tw-hook::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"]"}.debug-mode tw-hook[name]::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"]<" attr(name) "|"}.debug-mode tw-pseudo-hook{background-color:rgba(255,170,0,.1) !important}.debug-mode tw-collapsed::before{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"{"}.debug-mode tw-collapsed::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"}"}.debug-mode tw-verbatim::before,.debug-mode tw-verbatim::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"`"}.debug-mode tw-align[style*="text-align: center"]{background:linear-gradient(to right, hsla(14, 100%, 87%, 0) 0%, hsla(14, 100%, 87%, 0.25) 50%, hsla(14, 100%, 87%, 0) 100%)}.debug-mode tw-align[style*="text-align: left"]{background:linear-gradient(to right, hsla(14, 100%, 87%, 0.25) 0%, hsla(14, 100%, 87%, 0) 100%)}.debug-mode tw-align[style*="text-align: right"]{background:linear-gradient(to right, hsla(14, 100%, 87%, 0) 0%, hsla(14, 100%, 87%, 0.25) 100%)}.debug-mode tw-column{background-color:rgba(189,228,255,.2)}.debug-mode tw-enchantment{animation:enchantment .5s infinite;border:1px solid}.debug-mode tw-link::after,.debug-mode tw-broken-link::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:attr(passage-name)}.debug-mode tw-include{background-color:rgba(204,128,51,.1)}.debug-mode tw-include::before{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:attr(type) ' "' attr(name) '"'}.debug-dialogs tw-backdrop:not(.eval-replay):not(.harlowe-crash){pointer-events:none;opacity:.1}tw-eval-replay tw-eval-code,tw-eval-replay tw-eval-explanation{max-height:20vh;overflow:auto;margin:10px auto}tw-eval-replay tw-eval-code{display:block;font-family:monospace;padding-bottom:1ex;border-bottom:2px solid gray}tw-eval-replay tw-eval-explanation{display:block;text-align:center}tw-eval-replay tw-eval-explanation>code{white-space:pre-wrap}tw-eval-replay tw-eval-explanation>code.from-block{width:40%;display:inline-block;text-align:left;max-height:4em;overflow-wrap:anywhere;overflow-y:scroll}tw-eval-replay tw-eval-explanation>code.from-block~.to-desc{width:calc(40% - 2em);margin-left:2em;display:inline-block}tw-eval-replay tw-eval-explanation>code.from-block+span::after{content:"..."}tw-eval-replay tw-eval-explanation>code.from-inline{text-align:right}tw-eval-replay tw-eval-explanation>:nth-child(2){white-space:pre}tw-eval-replay tw-eval-explanation>.to-desc{text-align:left}tw-eval-replay tw-eval-explanation>table{width:100%;margin-top:1em}tw-eval-replay tw-eval-explanation>table td{white-space:pre-wrap !important;word-wrap:anywhere}tw-eval-replay tw-eval-reason{text-align:center;font-size:80%;font-style:italic;display:block}tw-eval-replay tw-eval-it{text-align:center;font-size:80%;display:block}tw-eval-replay tw-dialog-links{display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around}@keyframes enchantment{0%,to{border-color:#ffb366}50%{border-color:#6fc}}tw-debugger{position:fixed;box-sizing:border-box;bottom:0;right:0;z-index:999999;min-width:14em;min-height:1em;padding:0em .5em .5em 1em;font-size:1.25em;font-family:sans-serif;color:#262626;background-color:#fff;border-left:solid #262626 2px;border-top:solid #262626 2px;border-top-left-radius:.5em;opacity:1}tw-debugger.fade-panel:not(:hover){opacity:.33}tw-debugger.theme-dark{color:#d9d9d9;background-color:#000}tw-debugger.theme-dark{border-color:#d9d9d9 rgba(0,0,0,0) rgba(0,0,0,0) #d9d9d9}tw-debugger select{margin-right:1em;width:12em}tw-debugger button,tw-debugger tw-link{border-radius:3px;border:solid #999 1px;margin:auto 4px;color:#262626;background-color:#fff;cursor:pointer}tw-debugger button.enabled,tw-debugger tw-link.enabled{color:#000;background-color:#d9d9d9;box-shadow:inset #999 3px 5px .5em}tw-debugger.theme-dark button,tw-debugger.theme-dark tw-link{color:#d9d9d9;background-color:#000;border-color:#666}tw-debugger.theme-dark button.enabled,tw-debugger.theme-dark tw-link.enabled{color:#e6e6e6;background-color:#424242;box-shadow:inset #666 3px 5px .5em}tw-debugger button{font-size:1em;overflow-x:hidden;text-overflow:ellipsis;white-space:pre}tw-debugger tw-link{font-size:1.25em;border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block}tw-debugger tw-link:hover{border-color:#262626;color:#262626}tw-debugger.theme-dark tw-link:hover{border-color:#d9d9d9;color:#d9d9d9}tw-debugger tw-dialog{background-color:#fff;color:#000;font-size:1.25em}tw-debugger.theme-dark tw-dialog{background-color:#000;color:#e6e6e6}tw-debugger .panel{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;position:absolute;bottom:100%;left:-2px;right:0;padding:1em;overflow-y:scroll;overflow-x:hidden;border:inherit;box-sizing:content-box;background-color:#fff;border-bottom:solid #999 2px;border-top-left-radius:.5em;border-bottom-left-radius:.5em;font-size:.8em}tw-debugger .panel:empty,tw-debugger .panel[hidden]{display:none}tw-debugger.theme-dark .panel{background-color:#000;border-bottom-color:#666}tw-debugger .panel-source .panel-row-buttons{width:2rem}tw-debugger .panel-source .source-tags{width:20%;font-style:italic}tw-debugger .panel-row-source td{font-family:monospace;font-size:1rem;white-space:pre-wrap;overflow-wrap:anywhere;max-height:8rem;padding:1rem}tw-debugger .panel-rows{width:100%;overflow-x:scroll}tw-debugger .panel-rows>*{display:table-row}tw-debugger .panel-rows>div:nth-of-type(2n){background-color:#e6e6e6}tw-debugger .panel-tools .panel-rows>*,tw-debugger .panel-options .panel-rows>*{margin-top:.4rem;display:block}tw-debugger.theme-dark .panel-rows>div:nth-of-type(2n){background-color:#212121}tw-debugger .panel-row-buttons{text-align:right}tw-debugger .panel-variables .panel-rows:empty::before{content:"~ No variables ~";font-style:italic;color:#575757;text-align:center}tw-debugger .panel-enchantments .panel-rows:empty::before{content:"~ No enchantments ~";font-style:italic;color:#575757;text-align:center}tw-debugger .panel-errors .panel-rows:empty::before{content:"~ No errors... for now. ~";font-style:italic;color:#575757;text-align:center}tw-debugger .panel-errors .panel-rows:empty+.panel-errors-bottom{display:none}tw-debugger.theme-dark .panel-variables .panel-rows:empty::before,tw-debugger.theme-dark .panel-enchantments .panel-rows:empty::before,tw-debugger.theme-dark .panel-errors .panel-rows:empty::before{color:#a8a8a8}tw-debugger .panel-rows:empty+.panel-variables-bottom{display:none}tw-debugger th[data-col]{text-decoration:underline;cursor:pointer}tw-debugger th[data-col][data-order=asc]::after{content:"↓"}tw-debugger th[data-col][data-order=desc]::after{content:"↑"}tw-debugger .panel-storylets:not(.panel-exclusive) .storylet-exclusive,tw-debugger .panel-storylets:not(.panel-urgent) .storylet-urgent{display:none}tw-debugger .storylet-exclusive,tw-debugger .storylet-urgent,tw-debugger .storylet-open{text-align:center}tw-debugger .panel-variables-bottom{padding-top:5px}tw-debugger .enchantment-row{min-height:1.5em}tw-debugger .variable-path{opacity:.4}tw-debugger .temporary-variable-scope,tw-debugger .enchantment-local{font-family:sans-serif;font-weight:normal;opacity:.8;font-size:.75em}tw-debugger .temporary-variable-scope:not(:empty)::before,tw-debugger .enchantment-local:not(:empty)::before{content:" in "}tw-debugger .variable-name,tw-debugger .enchantment-name{font-family:monospace;font-weight:bold}tw-debugger .variable-type{color:#575757;font-weight:normal;text-overflow:ellipsis;overflow:hidden;max-width:10em}tw-debugger.theme-dark .variable-type{color:#a8a8a8}tw-debugger .error-row{display:table-row;background-color:rgba(230,101,204,.3)}tw-debugger .error-row:nth-of-type(2n){background-color:rgba(237,145,219,.3)}tw-debugger .error-row>*{display:table-cell;padding:.25em .5em}tw-debugger .error-row .error-message[title]:not([title=""]){cursor:help}tw-debugger .error-row .error-passage{color:#575757}tw-debugger.theme-dark .error-row .error-passage{color:#a8a8a8}tw-debugger .storylet-row{background-color:rgba(193,240,225,.3)}tw-debugger .storylet-row:nth-child(2n){background-color:rgba(152,231,204,.3)}tw-debugger .storylet-row.storylet-closed{font-style:italic;background-color:#fff}tw-debugger .storylet-row.storylet-closed:nth-child(2n){background-color:#e6e6e6}tw-debugger .storylet-row.storylet-closed>:not(.storylet-lambda){opacity:.6}.storylet-error tw-debugger .storylet-row{background-color:rgba(230,101,204,.3)}.storylet-error tw-debugger .storylet-row:nth-child(2n){background-color:rgba(237,145,219,.3)}tw-debugger .storylet-row .storylet-name,tw-debugger .storylet-row .storylet-value{display:inline-block;width:50%}tw-debugger .storylet-row .storylet-lambda{font-family:monospace;font-size:1rem;white-space:pre-wrap;overflow-wrap:anywhere}tw-debugger.theme-dark .storylet-row.storylet-closed{background-color:#000}tw-debugger.theme-dark .storylet-row.storylet-closed:nth-child(2n){background-color:#212121}tw-debugger .tabs{padding-bottom:.5em}tw-debugger .tab{border-radius:0px 0px .5em .5em;border-top:none;top:-2px}tw-debugger .resizer-h{position:absolute;height:14em;border-left:2px solid #999;border-right:2px solid #999;top:10px;left:4px;width:8px;cursor:ew-resize}tw-debugger.theme-dark .resizer-h{border-color:rgba(0,0,0,0) #666}tw-debugger .resizer-v{position:absolute;height:8px;border-top:2px solid #999;border-bottom:2px solid #999;margin-bottom:4px;top:4px;left:10px;width:95%;cursor:ns-resize;box-sizing:border-box}tw-debugger.theme-dark .resizer-v{border-color:#666 rgba(0,0,0,0)}tw-debugger mark{color:inherit;background-color:rgba(101,230,230,.3) !important}tw-dialog{z-index:999997;border:#fff solid 2px;padding:2em;color:#fff;background-color:#000;display:block}@media(min-width: 576px){tw-dialog{max-width:50vw}}tw-dialog input[type=text]{font-size:inherit;width:100%;border:solid #fff !important}tw-dialog-links{text-align:right;display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end}tw-backdrop{z-index:999996;position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.8);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}tw-backdrop~tw-backdrop{display:none}tw-link,.enchantment-link{cursor:pointer;color:#4169e1;font-weight:bold;text-decoration:none;transition:color .2s ease-in-out}tw-passage [style^=color] tw-link:not(:hover),tw-passage [style*=" color"] tw-link:not(:hover),tw-passage [style^=color][hover=true] tw-link:hover,tw-passage [style*=" color"][hover=true] tw-link:hover,tw-passage [style^=color] .enchantment-link:not(:hover),tw-passage [style*=" color"] .enchantment-link:not(:hover),tw-passage [style^=color][hover=true] .enchantment-link:hover,tw-passage [style*=" color"][hover=true] .enchantment-link:hover{color:inherit}tw-link:hover,.enchantment-link:hover{color:#00bfff}tw-link:active,.enchantment-link:active{color:#dd4b39}.visited{color:#6941e1}tw-passage [style^=color] .visited:not(:hover),tw-passage [style*=" color"] .visited:not(:hover),tw-passage [style^=color][hover=true] .visited:hover,tw-passage [style*=" color"][hover=true] .visited:hover{color:inherit}.visited:hover{color:#e3e}tw-broken-link{color:#933;border-bottom:2px solid #933;cursor:not-allowed}tw-passage [style^=color] tw-broken-link:not(:hover),tw-passage [style*=" color"] tw-broken-link:not(:hover),tw-passage [style^=color][hover=true] tw-broken-link:hover,tw-passage [style*=" color"][hover=true] tw-broken-link:hover{color:inherit}tw-link.enchantment-mouseover,.link.enchantment-mouseover,tw-expression.enchantment-mouseover>tw-link{color:inherit;font-weight:inherit;transition:none;cursor:inherit;border-bottom:2px dashed #999}tw-link.enchantment-mouseover:hover,tw-link.enchantment-mouseover:active,.link.enchantment-mouseover:hover,.link.enchantment-mouseover:active,tw-expression.enchantment-mouseover>tw-link:hover,tw-expression.enchantment-mouseover>tw-link:active{color:inherit}tw-link.enchantment-mouseover.enchantment-button,.link.enchantment-mouseover.enchantment-button,tw-expression.enchantment-mouseover>tw-link.enchantment-button{border-style:dashed}tw-link.enchantment-mouseout,.link.enchantment-mouseout,tw-expression.enchantment-mouseout>tw-link{color:inherit;font-weight:inherit;transition:none;cursor:inherit;border:rgba(64,149,191,.6) 1px solid;border-radius:.2em}tw-link.enchantment-mouseout:hover,tw-link.enchantment-mouseout:active,.link.enchantment-mouseout:hover,.link.enchantment-mouseout:active,tw-expression.enchantment-mouseout>tw-link:hover,tw-expression.enchantment-mouseout>tw-link:active{color:inherit}tw-link.enchantment-mouseout:hover,.link.enchantment-mouseout:hover,tw-expression.enchantment-mouseout>tw-link:hover{background-color:rgba(175,197,207,.75);border:rgba(0,0,0,0) 1px solid}tw-link.enchantment-dblclick,.link.enchantment-dblclick,tw-expression.enchantment-dblclick>tw-link{color:inherit;font-weight:inherit;transition:none;cursor:inherit;cursor:pointer;border:2px solid #999;border-radius:0}tw-link.enchantment-dblclick:hover,tw-link.enchantment-dblclick:active,.link.enchantment-dblclick:hover,.link.enchantment-dblclick:active,tw-expression.enchantment-dblclick>tw-link:hover,tw-expression.enchantment-dblclick>tw-link:active{color:inherit}tw-link.enchantment-dblclick:active,.link.enchantment-dblclick:active,tw-expression.enchantment-dblclick>tw-link:active{background-color:#999}tw-link.enchantment-button,.link.enchantment-button,.enchantment-button:not(.link) tw-link,.enchantment-button:not(.link) .link{border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block}.enchantment-button{display:block}.enchantment-clickblock{cursor:pointer;width:100%;height:100%;display:block}.enchantment-clickblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;color:rgba(65,105,225,.5);transition:color .2s ease-in-out}.enchantment-clickblock>:not(tw-enchantment):hover::after{color:rgba(0,191,255,.5)}.enchantment-clickblock>:not(tw-enchantment):active::after{color:rgba(222,78,59,.5)}.enchantment-clickblock>:not(tw-enchantment)::after{box-shadow:inset 0 0 0 .5vmax}.enchantment-clickblock>tw-passage::after,.enchantment-clickblock>tw-sidebar::after{box-shadow:0 0 0 .5vmax}.enchantment-mouseoverblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;border:2px dashed #999}.enchantment-mouseoutblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;border:rgba(64,149,191,.6) 2px solid}.enchantment-mouseoutblock:hover>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;background-color:rgba(175,197,207,.75);border:rgba(0,0,0,0) 2px solid;border-radius:.2em}.enchantment-dblclickblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;cursor:pointer;border:2px solid #999}tw-dialog-links{padding-top:1.5em}tw-dialog-links tw-link{border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block;display:inline-block}html{margin:0;height:100%;overflow-x:hidden}*,:before,:after{position:relative;box-sizing:inherit}body{margin:0;height:100%}tw-storydata{display:none}tw-story{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;font:100% Georgia,serif;box-sizing:border-box;width:100%;min-height:100%;font-size:1.5em;line-height:1.5em;padding:5% 5%;overflow:hidden;background-color:#000;color:#fff}tw-story [style*=content-box] *{box-sizing:border-box}@media(min-width: 576px){tw-story{padding:5% 20%}}tw-story tw-consecutive-br{display:block;height:1.6ex;visibility:hidden}tw-story select{background-color:rgba(0,0,0,0);font:inherit;border-style:solid;padding:2px}tw-story select:not([disabled]){color:inherit}tw-story textarea{resize:none;background-color:rgba(0,0,0,0);font:inherit;color:inherit;border-style:none;padding:2px}tw-story input[type=text]{background-color:rgba(0,0,0,0);font:inherit;color:inherit;border-style:none}tw-story input[type=checkbox]{transform:scale(1.5);margin:0 .5em .5em .5em;vertical-align:middle}tw-story tw-noscript{animation:appear .8s}tw-passage{display:block}tw-sidebar{text-align:center;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}@media(min-width: 576px){tw-sidebar{left:-5em;width:3em;position:absolute;-ms-flex-direction:column;flex-direction:column}tw-enchantment[style*=width]>tw-sidebar{width:inherit}}tw-icon{display:inline-block;margin:.5em 0;font-size:66px;font-family:"Verdana",sans-serif}tw-icon[alt]{opacity:.2;cursor:pointer}tw-icon[alt]:hover{opacity:.4}tw-icon[data-label]::after{font-weight:bold;content:attr(data-label);font-size:20px;bottom:-20px;left:-50%;white-space:nowrap}tw-meter{display:block}tw-hook:empty,tw-expression:empty{display:none}tw-error{display:inline-block;border-radius:.2em;padding:.2em;font-size:1rem;cursor:help;white-space:pre-wrap}tw-error.error{background-color:rgba(223,58,190,.6);color:#fff}tw-error.warning{background-color:rgba(223,140,58,.6);color:#fff;display:none}.debug-mode tw-error.warning{display:inline}tw-error-explanation{display:block;font-size:.8rem;line-height:1rem}tw-open-button,tw-folddown{cursor:pointer;line-height:0em;border-radius:4px;border:1px solid rgba(255,255,255,.5);font-size:.8rem;margin:0 .2rem;padding:3px;white-space:pre}tw-folddown::after{content:"▶"}tw-folddown.open::after{content:"▼"}tw-open-button[replay]{display:none}tw-error tw-open-button,tw-eval-replay tw-open-button{display:inline !important}tw-open-button::after{content:attr(label)}tw-notifier{border-radius:.2em;padding:.2em;font-size:1rem;background-color:rgba(223,182,58,.4);display:none}.debug-mode tw-notifier{display:inline}tw-notifier::before{content:attr(message)}tw-colour{border:1px solid #000;display:inline-block;width:1em;height:1em}tw-enchantment:empty{display:none}h1{font-size:3em}h2{font-size:2.25em}h3{font-size:1.75em}h1,h2,h3,h4,h5,h6{line-height:1em;margin:.3em 0 .6em 0}pre{font-size:1rem;line-height:initial}small{font-size:70%}big{font-size:120%}mark{color:rgba(0,0,0,.6);background-color:#ff9}ins{color:rgba(0,0,0,.6);background-color:rgba(255,242,204,.5);border-radius:.5em;box-shadow:0em 0em .2em #ffe699;text-decoration:none}center{text-align:center;margin:0 auto;width:60%}blink{text-decoration:none;animation:fade-in-out 1s steps(1, end) infinite alternate}tw-align{display:block}tw-columns{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between}.transition-in{animation:appear 0ms step-start}.transition-out{animation:appear 0ms step-end}[data-t8n^=dissolve].transition-in,[data-t8n=fade].transition-in{animation:appear .8s}[data-t8n^=dissolve].transition-out,[data-t8n=fade].transition-out{animation:appear .8s reverse}[data-t8n^=shudder].transition-in{display:inline-block !important;animation:shudder-in .8s}[data-t8n^=shudder].transition-out{display:inline-block !important;animation:shudder-in .8s reverse}[data-t8n^=rumble].transition-in{display:inline-block !important;animation:rumble-in .8s}[data-t8n^=rumble].transition-out{display:inline-block !important;animation:rumble-in .8s reverse}[data-t8n^=pulse].transition-in{animation:pulse .8s;display:inline-block !important}[data-t8n^=pulse].transition-out{animation:pulse .8s reverse;display:inline-block !important}[data-t8n^=zoom].transition-in{animation:zoom-in .8s;display:inline-block !important}[data-t8n^=zoom].transition-out{animation:zoom-in .8s reverse;display:inline-block !important}[data-t8n^=blur].transition-in{animation:blur .8s;display:inline-block !important}[data-t8n^=blur].transition-out{animation:blur .8s reverse;display:inline-block !important}[data-t8n^=slideleft].transition-in{animation:slide-left .8s;display:inline-block !important}[data-t8n^=slideleft].transition-out{animation:slide-right .8s reverse;display:inline-block !important}[data-t8n^=slideright].transition-in{animation:slide-right .8s;display:inline-block !important}[data-t8n^=slideright].transition-out{animation:slide-left .8s reverse;display:inline-block !important}[data-t8n^=slideup].transition-in{animation:slide-up .8s;display:inline-block !important}[data-t8n^=slideup].transition-out{animation:slide-down .8s reverse;display:inline-block !important}[data-t8n^=slidedown].transition-in{animation:slide-down .8s;display:inline-block !important}[data-t8n^=slidedown].transition-out{animation:slide-up .8s reverse;display:inline-block !important}[data-t8n^=fadeleft].transition-in{animation:fade-left .8s;display:inline-block !important}[data-t8n^=fadeleft].transition-out{animation:fade-right .8s reverse;display:inline-block !important}[data-t8n^=faderight].transition-in{animation:fade-right .8s;display:inline-block !important}[data-t8n^=faderight].transition-out{animation:fade-left .8s reverse;display:inline-block !important}[data-t8n^=fadeup].transition-in{animation:fade-up .8s;display:inline-block !important}[data-t8n^=fadeup].transition-out{animation:fade-down .8s reverse;display:inline-block !important}[data-t8n^=fadedown].transition-in{animation:fade-down .8s;display:inline-block !important}[data-t8n^=fadedown].transition-out{animation:fade-up .8s reverse;display:inline-block !important}[data-t8n^=flicker].transition-in{animation:flicker .8s}[data-t8n^=flicker].transition-out{animation:flicker .8s reverse}
</style>
</head>
<body>
<tw-story><noscript><tw-noscript>JavaScript needs to be enabled to play Leben Sie bitte.</tw-noscript></noscript></tw-story>
<tw-storydata name="Leben Sie bitte" startnode="35" creator="Twine" creator-version="2.9.2" format="Harlowe" format-version="3.3.9" ifid="57CB6B33-CC89-4667-9F03-BFFBAFB2C9E5" options="" tags="" zoom="0.6" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css"></style><script role="script" id="twine-user-script" type="text/twine-javascript"></script><tw-tag name="没写完" color="red"></tw-tag><tw-passagedata pid="1" name="1.1失败" tags="" position="700,425" size="100,100">打猎的路上，遇见了不可匹敌的动物，好多族人都战死了。


&#39;&#39;状态栏 
抵抗灾难能力↓ 
族群数量↓ 
&#39;&#39;

[继续]&lt;continue3|

(click-replace: ?continue3)[

某天外出狩猎，族人搓出来一团发热的红色的东西。

&#39;&#39;历史事件 我们中出了一个普罗米修斯&#39;&#39;



[[第二回合]]

]</tw-passagedata><tw-passagedata pid="2" name="1.1选项成功" tags="" position="550,425" size="100,100">当前社会状态：游牧

你们捕到了数量足够的猎物。

族人们欢欣鼓舞。

不管怎样，这个冬季撑过去了。


[继续]&lt;continue3|

(click-replace: ?continue3)[

某天外出狩猎，族人搓出来一团发热的红色的东西。

&#39;&#39;历史事件 我们中出了一个普罗米修斯&#39;&#39; 

[[第二回合]]
]</tw-passagedata><tw-passagedata pid="3" name="1.2.1成功" tags="" position="850,425" size="100,100">当前社会状态：游牧

虽然这些肉的来历很可疑，味道也很怪异，但不管怎样，也是一份食物。

捱过了冬季。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;获得成就 异食癖&#39;&#39;
 ]

[继续]&lt;continue3|

(click-replace: ?continue3)[

某天外出狩猎，族人搓出来一团发热的红色的东西。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;历史事件 我们中出了一个普罗米修斯&#39;&#39;  ]

 [[第二回合]] 
 ]</tw-passagedata><tw-passagedata pid="4" name="1.2.2失败" tags="" position="925,300" size="100,100">这些食物有问题！族人们上吐下泻，头晕恶心。

好多族人病死了。

&#39;&#39;状态栏
抵抗灾难能力↓
族群数量↓&#39;&#39;


(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;获得成就 朊病毒&#39;&#39;
&#39;&#39;]

[继续]&lt;continue3|

(click-replace: ?continue3)[

某天外出狩猎，族人搓出来一团发热的红色的东西。

&#39;&#39;历史事件 我们中出了一个普罗米修斯&#39;&#39;
  
  [[第二回合]]
 ]</tw-passagedata><tw-passagedata pid="5" name="1.3.1成功" tags="" position="250,350" size="100,100">当前社会状态：游牧

族人们在温暖的山洞里进入了沉睡。

一声雷响，你们从冬眠中苏醒，生机盎然。


(align:&quot;&lt;==&quot;)+(box:&quot;==XXXXX===&quot;)[&#39;&#39;获得成就 冬眠者

技能 冬眠

说明：在天灾到来时，你们可以迅速进入冬眠躲避天灾。&#39;&#39;]

[继续]&lt;continue3|

(click-replace: ?continue3)[

某天外出狩猎，族人搓出来一团发热的红色的东西。

&#39;&#39;历史事件 我们中出了一个普罗米修斯&#39;&#39;

 [[第二回合]]
    
 ]</tw-passagedata><tw-passagedata pid="6" name="1.东" tags="" position="725,1675" size="100,100">你们逃到了遥远的东边。

你们在水源边安营扎寨，准备开始崭新的族群生活。

一夜无事。

[继续]&lt;continue|

(click-replace: ?continue)[

第二天，日出之时，哨兵观测到海平面骤然上升。

“似乎有什么东西融化了！”哨兵说。

就在此时，自海底传来一阵强劲的音乐。

”诶↑咦~诶诶诶↑诶诶诶诶哟哦哦~~~“

&lt;audio src=&quot;https://gitee.com/kellyaties/kellyaties/raw/master/%E3%80%90%E6%98%A5%E8%8A%82%E3%80%91%E5%88%98%E5%BE%B7%E5%8D%8E%E3%80%8A%E6%81%AD%E5%96%9C%E5%8F%91%E8%B4%A2%E3%80%8B%E6%98%A5%E8%8A%82%E5%BF%85%E5%90%AC%E7%A5%9E%E6%9B%B2%EF%BC%81%E7%A5%9D%E5%A4%A7%E5%AE%B6%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90%EF%BC%81%20-%201.%E5%88%98%E5%BE%B7%E5%8D%8E%20-%20%E6%81%AD%E5%96%9C%E5%8F%91%E8%B4%A2%204K%E7%89%88(Av381171334,P1).mp3&quot; autoplay&gt;

[继续]&lt;continue|

]

(click-replace:?continue)[

全体国民为如此不可名状的神秘歌谣所震动，惊恐不已，纷纷自杀。

据说，最后一个国民死去前，还在呢喃道：

“我恭喜你发财~我恭喜你精彩~”
    
(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局5：Frozen3 
Ende 5：Frozen3&#39;&#39;]

  
(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[  [STAFF名单]&lt;continue3|]
  
  ]

(click-replace: ?continue3)[

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[(display: &quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]
  
]

</tw-passagedata><tw-passagedata pid="7" name="1.冒险外出打猎，也许能捕到猎物" tags="" position="650,300" size="100,100">进行骰子检定。

[ra50]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[1.1选项成功]]] 
(else:)[点此继续 -&gt;[[1.1失败]]] 

]

|2&gt;[(link-rerun:&quot;ra是什么？&quot;)[(show:?1)(hide:?2)]]
|1)[
ra。
投掷一个100面的骰子，将出目点数大于等于指定数目的结果视为检定失败，反之则成功。
这既是说：
假设出目结果为小于等于50的数，则视为检定成功，反之，视为失败。
(text-colour:red)[请注意，掷骰由后台JS代码运行，出目随机。]

[(link-rerun:&quot;[收起]&quot;)[(hide:?1)(show:?2)]]

]
</tw-passagedata><tw-passagedata pid="8" name="1.回击" tags="" position="400,850" size="100,100">踏踏开！人生的意义就是踏踏开！

你国与邻国展开激烈的战争。

由于【奇遇】，你国赢下了战争。

[继续]&lt;continue|

(click-replace: ?continue)[
&#39;&#39;状态栏
族群数量↑
社会稳定↓
领地面积↑
抗天灾能力↑
威名↑&#39;&#39;






[[第三回合]]

]</tw-passagedata><tw-passagedata pid="9" name="1.宗教的建立" tags="" position="700,800" size="100,100">族人夜观星象，发现天空始终存在一个巨大的圆形发光物体，给予了大地热量与光明。因此创立了一个名为东方神教的宗教。

&#39;&#39;成就：一个灯泡&#39;&#39;

[继续]&lt;continue|

(click-replace: ?continue)[

&#39;&#39;状态栏
社会凝聚力↑
思想专制↑
社会稳定↑
&#39;&#39;

[[灾难。]]

]

    {(link:&quot;保存游戏&quot;)[
  (if:(save-game:&quot;Slot A&quot;))[
    已存档!
  ](else: )[
    存档失败。
  ]
]}
    
    {(if: (saved-games: ) contains &quot;Slot A&quot;)[
  (link: &quot;加载游戏&quot;)[(load-game:&quot;Slot A&quot;)]
]}</tw-passagedata><tw-passagedata pid="10" name="1.战争" tags="" position="475,1025" size="100,100">邻近的国家因为水源纷争与你开战。

作为国家领导，
你的选择
[[1.回击]] Zurückschlagen
[[2.和亲！]] Politische Heirat
[[3.投降喵，投降喵]] Kapitulatieren
[[4.润]] Flucht


</tw-passagedata><tw-passagedata pid="11" name="2.1.2成功了！" tags="" position="225,825" size="100,100">你国赢下了战争，俘虏了大批敌国士兵成为奴隶。

[继续]&lt;continue|

(click-replace: ?continue)[

&#39;&#39;状态栏
族群数量↑
社会稳定↓
领地面积↑
抗天灾能力↑
威名↑&#39;&#39;

[[第三回合]]

]</tw-passagedata><tw-passagedata pid="12" name="2.1.2输了……負けだ…" tags="" position="125,975" size="100,100">你国军队的阵型被敌国冲得七零八散。而且对方持有铁器做成的武器，军事实力上远胜于你们。

敌国拿下了水源控制权，俘虏了你国国民作为奴隶，并将你推上了断头台。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局8：冶金技术非常重要是也……


[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]

]


</tw-passagedata><tw-passagedata pid="13" name="2.冶炼金属技术的发展。" tags="" position="850,775" size="100,100">族人进入深山，发掘出一堆黑不溜秋的有光泽的东西。

族里的工匠将其做成了兵器。

[继续]&lt;continue|

(click-replace: ?continue)[

&#39;&#39;状态栏
军事实力↑
狩猎效率↑
耕作效率↑ 
&#39;&#39;



[[灾难。]] Katastrophale

]</tw-passagedata><tw-passagedata pid="14" name="2.和亲！" tags="" position="375,975" size="100,100">对方领导者并没有接受你的和亲。

[继续]&lt;continue|

(click-replace: ?continue)[

“踏踏开！人生的意义就是踏踏开！”使者传来回话。

[继续]&lt;continue1|

]

(click-replace: ?continue1)[

踏踏开。

[ra60]&lt;rolldice|

]

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 60))[点此继续 -&gt;[[2.1.2成功了！]]]
(else:)[点此继续 -&gt;[[2.1.2输了……負けだ…]]]


]

</tw-passagedata><tw-passagedata pid="15" name="2.瘟疫" tags="" position="750,1050" size="100,100">未知的疾病开始在你的族群里蔓延。

对抗检定。

|2&gt;[(link-rerun:&quot;对抗检定是什么？&quot;)[(show:?1)(hide:?2)]]
|1)[对抗检定。
检定双方为对抗关系。投掷骰子，比较双方点数，往往较大者获胜。若有特殊情况，将会另做说明。

这是说：
若瘟疫的强度大于文明当前的医疗水平高度，则读者选择[[瘟疫吞噬了文明！]]，反之，选择[[我们获胜了！]]
(text-colour:red)[请注意，掷骰由后台JS代码运行，出目随机。]

[(link-rerun:&quot;[收起]&quot;)[(hide:?1)(show:?2)]]


]

[对抗检定]&lt;rolldice|

(click-replace:?rolldice)[


瘟疫的强度

(set: $roll1 to (random:1,10))
出目结果：(print:+$roll1)


文明医疗水平高度

(set: $roll2 to (random:1,10))
出目结果：(print:+$roll2)
(if: $roll1 &gt; $roll2)[点此继续 -&gt;[[瘟疫吞噬了文明！]]
](else:)[点此继续 -&gt;[[我们获胜了！]] ]


]


</tw-passagedata><tw-passagedata pid="16" name="2.西" tags="" position="750,1800" size="100,100">你们一路向西。这里的景色与原来的栖息地大相径庭，一望无际的大草原、似乎触手可及的蓝天白云……还有戒指里的老爷爷。

哨兵捡来一个戒指，戒指里的白毛红瞳老爷爷在看着你。

[[1.你是？]]
[[2.斗之力，三段！]]
[[3.白毛红瞳可冲]]
[[4.无视]]
</tw-passagedata><tw-passagedata pid="17" name="2.这里有一些来历不明的肉……" tags="" position="775,300" size="100,100">进行骰子检定。

[ra50]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[1.2.1成功]]]
(else:)[点此继续 -&gt;[[1.2.2失败]]]

]

|2&gt;[(link-rerun:&quot;ra是什么？&quot;)[(show:?1)(hide:?2)]]
|1)[ra。
投掷一个100面的骰子，将出目点数小于等于指定数目的结果视为检定失败，反之则成功。
这既是说：
假设出目结果为小于等于50的数，则视为检定成功，反之，视为失败。 
(text-colour:red)[请注意，掷骰由后台JS代码运行，出目随机。]

[(link-rerun:&quot;[收起]&quot;)[(hide:?1)(show:?2)]]
]

</tw-passagedata><tw-passagedata pid="18" name="3.冰期" tags="" position="1175,1025" size="100,100">突如其来的寒冷期席卷了整片大陆。

北风呼啸，冻死的动物尸体被大雪掩埋，从其尸体的位置可以追溯出它们逃往的路线和方向。

寒风中，星象观察官、农业官等人看着你，大雪糊住他们的眼睛，使他们几乎睁不开眼。

你决定：

(if: (history:) contains &quot;1.3.1成功&quot;)[[[1.冬眠-&gt;1.冬眠]]]\

[[2.尝试往温暖处迁徙]]

(if: (history:) contains &quot;1.宗教的建立&quot;)[[[3.举行大型的祭祀仪式，祈求神明能够阻止冰期-&gt;3.举行大型的祭祀仪式，祈求神明能够阻止冰期]] ]\


[[4.尝试进入二次元]] 



|2&gt;[(link-rerun:&quot;缺少了选项？&quot;)[(show:?1)(hide:?2)]]
|1)[您注意到，当前回合里，您只有1-2-3-4里的部分选项。
这是由于在前面的故事里，没有阅读过某些故事片段。
即是说：
你支线没开全。

[(link-rerun:&quot;[收起]&quot;)[(hide:?1)(show:?2)]]

]</tw-passagedata><tw-passagedata pid="19" name="3.出现了大规模的思想运动。" tags="" position="525,800" size="100,100">国家里出现了占有知识更多的人，他们每日口诛笔伐，争执不下，宣扬自己的政治理念。

[继续]&lt;continue|

(click-replace: ?continue)[

&#39;&#39;状态栏
愚昧 ↓
社会稳定 ↑
教育普及程度↑
&#39;&#39;



&#39;&#39;获得成就：百家争鸣
&#39;&#39;

[[灾难。]]

]</tw-passagedata><tw-passagedata pid="20" name="3.南" tags="" position="575,1775" size="100,100">你决定往南迁徙。\

[继续]&lt;continue|

(click-replace: ?continue)[

地文官依靠太阳辨别方位，带领你们往南走。愈是走，愈是湿热，放眼所见都是郁郁葱葱的常绿植物，和在原居住地从未见过的如此数量的活跃的动物，以及潜伏在枝叶上的可怕的毒虫。\

你们在南方定居。\

[继续]&lt;continue1|

]
(click-replace: ?continue1)[
南方并不缺少食物，但很快你们就发现了问题。和以前的栖息地比起来，这里的动植物被食用后，总会有国民莫名其妙地死去或者出现瘟疫。死去的国民的尸体如果不及时掩埋，瘟疫准会准时上门。\

“这里的食物并不安全。”总务官对你说。“但是，我们能确定有一种食物是安全的。”\

你意识到总务官的弦外之音，“疯子。”你说。\

“为什么不呢，”总务官说，“没有人会责怪我们的。”\

[[岁大饥，人相食]]

]



</tw-passagedata><tw-passagedata pid="21" name="3.就地进入冬眠" tags="" position="525,300" size="100,100">进行骰子检定。

[ra50]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[1.3.1成功]]]
(else:)[点此继续 -&gt;[[1.3.2失败]]]

]

|2&gt;[(link-rerun:&quot;ra是什么？&quot;)[(show:?1)(hide:?2)]]
|1)[ra。
投掷一个100面的骰子，将出目点数小于等于指定数目的结果视为检定失败，反之则成功。
这既是说：
假设出目结果为小于等于50的数，则视为检定成功，读者选择[[1.3.1成功]] ，反之，选择[[1.3.2失败]] 
(text-colour:red)[请注意，掷骰由后台JS代码运行，出目随机。]

[(link-rerun:&quot;[收起]&quot;)[(hide:?1)(show:?2)]]

]</tw-passagedata><tw-passagedata pid="22" name="3.投降喵，投降喵" tags="" position="375,1150" size="100,100">投降喵，投降喵！

然而，邻国的领导者并没有接受你的投降。

“全部斩首！”

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局2：该出手时就出手，风风火火闯九州&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]

]

</tw-passagedata><tw-passagedata pid="23" name="4.北" tags="" position="650,1825" size="100,100">北方自古以来就是酷寒之地。越往北走，气候愈发寒冷，食物越来越稀少。

一日，你们看见了与人一般高的动物，喙赤橙色，脖子底下有一片橙黄色羽毛，向下逐渐变淡，耳朵后部最深，全身色泽协调。

知识渊博的大思想家说道：“那是企鹅。”

帝企鹅站在冰面上，沉默地看着你们。

[[1.神经病，企鹅不是在南极吗]]

[[2.可爱，摸摸]]


</tw-passagedata><tw-passagedata pid="24" name="4.小行星撞击地球" tags="" position="900,1000" size="100,100">星象观察官夜观星象，忽然发现夜晚比白天还要明亮。天空一片煞白，刺得国民们睁不开眼睛。

[继续]&lt;continue|

(click-replace: ?continue)[
这次闭眼是最后一次闭眼。包括人类文明在内的所有生物生前最后看到的，是刺得眼睛发疼的白光。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;获得成就：一个灯泡&#39;&#39;


&#39;&#39;结局7：原始生命态-尼比鲁&#39;&#39;
]

&lt;img src=https://gitee.com/kellyaties/kellyaties/raw/master/0909722c11dfa9ec072405a775d0f703908fc157.jpg&gt;

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[
(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]

]

]
</tw-passagedata><tw-passagedata pid="25" name="4.润" tags="" position="225,1075" size="100,100">你们决定提桶跑路。

逃往的方向
[[1.东]] 
[[2.西]]
[[3.南]]
[[4.北]]
[[5.海的那边是……塔塔开！]] 
[[6.诗和远方]]

</tw-passagedata><tw-passagedata pid="26" name="4.种子保存技术、动物驯化技术。" tags="" position="1000,775" size="100,100">你们掌握了农作物栽培技术和驯化动物的技术。

[继续]&lt;continue|

(click-replace: ?continue)[

&#39;&#39;状态栏
抵抗天灾能力 ↑ 
食物稳定来源 ↑ 
族群数量↑ 
&#39;&#39;


&#39;&#39;历史事件 进入农耕时代&#39;&#39;

[[灾难。]]

]</tw-passagedata><tw-passagedata pid="27" name="5.海的那边是……塔塔开！" tags="" position="775,1900" size="100,100">土著给你们分享了立体机动装置的制作方法。

你带领国民装上立体机动装置准备飞跃海峡。

你们越飞越高，却发现眼前有一层看不见的屏障，由于名为加速度和冲量和动量等等的神秘力量，飞在前面的国民都撞成了肉饼，后面的刹不住车追尾了。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;获得成就 学好数理化 走遍天下都不怕&#39;&#39;

&#39;&#39;结局4：我最近在玩老爹汉堡店哦~~&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]

]

</tw-passagedata><tw-passagedata pid="28" name="5.火山爆发" tags="" position="550,1075" size="100,100">栖息地附近的火山忽然喷发。像是从地面朝太阳发射的一枚导弹一样，夹杂着岩石、火山灰、岩浆的洪流朝四面八方奔腾而去。

太阳被黑色的尘云遮挡，天空则下起了红色的雨，地表则被黑红色的洪流碾过，植被、动物被火热滚烫的岩浆包裹，在经受如此的极刑后保持原样，经过以地质纪年计算的时间长度后化为化石。

巨大的地壳能量引发了地震，诱发出小型的洪水，磁场的变化则使天空密布着闪电。

&#39;&#39;这是一次严峻的自然灾害事件！先让我们针对这次灾难进行检定。&#39;&#39;

(text-colour:red)[&#39;&#39;检定目标事件：这个火山是孤立的还是成片的？一个十面的骰子，单数即为孤立，双数即为成片。&#39;&#39;]

[rd10]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,10))
出目结果：(print:+$roll)

(if: ($roll %2 is 0))[点此继续 -&gt;[[孤立的火山]] ]
(else:)[点此继续 -&gt;[[一个连续的火山群]]]

]


|2&gt;[(link-rerun:&quot;为什么要这么做？&quot;)[(show:?1)(hide:?2)]]
|1)[详细定义。

对于某些“严重程度有可能影响到游戏结局”的事件，守密人Keeper将进行二次（详细）定义。
&#39;&#39;目标事件是指需要定义的事件的因素，例如时间、地点、大小、高度、相貌（如果是生物的话）、好感度等。&#39;&#39;

这是为了增加游戏的自由度、随机性（不确定性）和可玩性。
对于玩家们来说，二次定义事件有利于他们更好地做出决策。

[(link-rerun:&quot;[收起]&quot;)[(hide:?1)(show:?2)]]

]

</tw-passagedata><tw-passagedata pid="29" name="6.地震" tags="" position="675,1150" size="100,100">大地的低鸣像一声声雷鸣在耳边炸响。植被的枝叶先是纵向的晃动，其次是横向的猛甩。叶子脱落，掉入大地的裂缝中，大地吞噬了一切。

[继续]&lt;continue|

(click-replace:?continue)[

已经没有生物可以在这样的大地上站稳，你的国民和你一同匍匐在大地上，用惊恐和希冀的眼神看着你。

[[1.组织撤离]]
(if: (history:) contains &quot;1.宗教的建立&quot;)[[[2.举行大型的祭祀仪式，祈求神明能够阻止地震-&gt;2.举行大型的祭祀仪式，祈求神明能够阻止地震]]]
(if: (history:) contains &quot;1.3.1成功&quot;)[[[3.冬眠-&gt;3.冬眠]]]
[[4.开摆]]

]



</tw-passagedata><tw-passagedata pid="30" name="6.诗和远方" tags="" position="525,1950" size="100,100">国家里的大思想家忽然鼓动你们逃往诗和远方。

“生活不止眼前的苟且，还有诗和远方！”大思想家说。

你深以为然。

[继续]&lt;continue3|

(click-replace: ?continue3)[

于是，你们逃到了二次元。


(align:&quot;&lt;==&gt;&quot;)+(box:&quot;=XX=&quot;)[=
&#39;&#39;结局3：再见了妈妈今晚我就要远航
&#39;&#39;

[STAFF名单]&lt;continue4|

]

(click-replace: ?continue4)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]

</tw-passagedata><tw-passagedata pid="31" name="7.洪水泛滥" tags="" position="800,1175" size="100,100">连年的暴雨使得河水水平面水涨船高，进而发展为洪水。
原先的居住地已经被洪水淹没。(if: (history:) contains &quot;4.种子保存技术、动物驯化技术。&quot;)[农田、牲畜和国民消失在浩浩荡荡的河水中，永远埋葬在了河底。]

[继续]&lt;continue|

(click-replace:?continue)[

“我们该怎么办？”国民们看着你。

[[1.迁徙]]
[[2.尝试抵御洪水]]
[[3.尝试在水里生活]]
(if: (history:) contains &quot;1.宗教的建立&quot;)\
[[[4.尝试向神明祈祷，希望神明能够阻止洪水-&gt;4.尝试向神明祈祷，希望神明能够阻止洪水]]]

]

</tw-passagedata><tw-passagedata pid="32" name="8-0 无事发生" tags="" position="925,1150" size="100,100">无事发生喵！

你们平静地度过了这些时间。

[[第三回合]]</tw-passagedata><tw-passagedata pid="33" name="奇遇" tags="" position="700,675" size="100,100">当前社会形态：初步建成奴隶制

[[1.宗教的建立]] 
一个看不到星星的民族是没有办法产生宗教的。
社会稳定程度提高。

[[2.冶炼金属技术的发展。]]  
军事实力、科技实力上升。

[[3.出现了大规模的思想运动。]] 
诸子论战，百家争鸣。

[[4.种子保存技术、动物驯化技术。]] 
获得稳定的食物来源，由游牧转型为农耕文明。


\

    {(link:&quot;保存游戏&quot;)[
  (if:(save-game:&quot;Slot A&quot;))[
    已存档!
  ](else: )[
    存档失败。
  ]
]}
    
    {(if: (saved-games: ) contains &quot;Slot A&quot;)[
  (link: &quot;加载游戏&quot;)[(load-game:&quot;Slot A&quot;)]
]}
</tw-passagedata><tw-passagedata pid="34" name="导入" tags="" position="650,175" size="100,100">
(save-game:&quot;Slot A&quot;,&quot;Chapter 1 start&quot;)

伴随着轻微的声响，冬眠舱的舱门被打开，在满溢的白色寒冷气体中，智人种苏醒了。

“人类”文明忽然立足于大地之上。

你是这个文明的领导者。

[继续]&lt;continue|

(click-replace: ?continue)[

 这个文明经过一段时间的独立探索和频繁碰壁，形成了一个小规模的以游牧狩猎为生的群居族群。
    
(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[  &#39;&#39;获得成就  游牧时代&#39;&#39;] 
    
    
 [继续]&lt;continue2|]

(click-replace: ?continue2)[
    冬季到来，食物短缺。
    你的族人饥肠辘辘。
    
    [[1.冒险外出打猎，也许能捕到猎物]] 
    [[2.这里有一些来历不明的肉……]]
    [[3.就地进入冬眠]] 
    
    ]
    
    {(link:&quot;保存游戏&quot;)[
  (if:(save-game:&quot;Slot A&quot;))[
    已存档!
  ](else: )[
    存档失败。
  ]
]}
    
    {(if: (saved-games: ) contains &quot;Slot A&quot;)[
  (link: &quot;加载游戏&quot;)[(load-game:&quot;Slot A&quot;)]
]}


(set: $previousPassage to &quot;导入&quot;)</tw-passagedata><tw-passagedata pid="35" name="游戏规则" tags="" position="525,175" size="100,100">亲爱的玩家：
你将阅读到一个故事，请根据故事走向，做出你的选择。
注：故事描写风格有意贴近《冰汽时代》。部分故事情节中可能出现较为血腥的描写。

部分选择分支，守密人（Keeper）将使用骰子等作为辅助检定道具。

[骰子是什么？]&lt;continue|

(click-replace:?continue)[

这是说：

骰子出目（点数）大于某个点数时，判定为成功，给予一定奖励。
骰子出目（点数）小于某个点数时，判定为失败，遭到一定惩罚。

随着文明的科技发展程度提高，某些事件的成功概率(text-colour:red)[可能会有所提高]。

例如：天灾抵抗能力。

]

(text-colour:red)[温馨提示：发掘世界真相之前，请先竭尽全力地活下去。

活下去。]

(text-colour:red)[故事情节皆为虚构，如有雷同，纯属巧合。本制作团队有对本故事的最终解释权。]

[[开始游戏-&gt;导入]]</tw-passagedata><tw-passagedata pid="36" name="灾难。" tags="" position="775,875" size="100,100">掷骰。

[rd10]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,10))
1 - 战争 Krieg
2 - 瘟疫 Seuche
3 - 冰期 Eiszeit
4 - 小行星撞击地球 Meteorit
5 - 火山爆发 Vulkanausbruch
6 - 地震 Erdbeben
7 - 洪水泛滥 Überschwemmung
8-0 - 无事发生 Keine Probleme
出目结果：(print:+$roll)


(if: ($roll is  1))[点此继续 -&gt;[[1.战争]] Krieg
](else-if: ($roll is  2))[点此继续 -&gt;[[2.瘟疫]] Seuche
](else-if: ($roll is  3))[点此继续 -&gt;[[3.冰期]] Eiszeit
](else-if: ($roll is  4))[点此继续 -&gt;[[4.小行星撞击地球]] Meteotit
](else-if: ($roll is  5))[点此继续 -&gt;[[5.火山爆发]] Vuklanausbruch
](else-if: ($roll is  6))[点此继续 -&gt;[[6.地震]] Erdbeben
](else-if: ($roll is  7))[点此继续 -&gt;[[7.洪水泛滥]] Überschwemmung
](else:)[点此继续 -&gt;[[8-0 无事发生]] Keine Probleme]

]

|2&gt;[(link-rerun:&quot;rd是什么？&quot;)[(show:?1)(hide:?2)]]
|1)[roll the dice.
投掷一个任意面数的骰子，并将其出目点数对应到以下结果。

(text-colour:red)[请注意，掷骰由后台JS代码运行，出目随机。]

[(link-rerun:&quot;[收起]&quot;)[(hide:?1)(show:?2)]]

]


    {(link:&quot;保存游戏&quot;)[
  (if:(save-game:&quot;Slot A&quot;))[
    已存档!
  ](else: )[
    存档失败。
  ]
]}
    
    {(if: (saved-games: ) contains &quot;Slot A&quot;)[
  (link: &quot;加载游戏&quot;)[(load-game:&quot;Slot A&quot;)]
]}
</tw-passagedata><tw-passagedata pid="37" name="第二回合" tags="" position="675,550" size="100,100">(save-game:&quot;Slot A&quot;,&quot;Chapter 2 start&quot;)

经过一段时间的文明发展，你们建立了一个小型的奴隶制国家，有了自己的文字。

[[奇遇]]\

\

    {(link:&quot;保存游戏&quot;)[
  (if:(save-game:&quot;Slot A&quot;))[
    已存档!
  ](else: )[
    存档失败。
  ]
]}
    
    {(if: (saved-games: ) contains &quot;Slot A&quot;)[
  (link: &quot;加载游戏&quot;)[(load-game:&quot;Slot A&quot;)]
]}
</tw-passagedata><tw-passagedata pid="38" name="瘟疫吞噬了文明！" tags="" position="550,925" size="100,100">瘟疫完全吞噬了文明。极高的传染性使得所有国民卧床不起，病人发烧、头疼、背痛、极度疲乏，全身长满可怕的丘疹，尸体堆积如山，臭气熏天，最后的国民在痛苦中绝望地死去。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[=
&#39;&#39;结局6：天花
Ende 6: Pocken&#39;&#39;


[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[
(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]

</tw-passagedata><tw-passagedata pid="39" name="我们获胜了！" tags="" position="700,950" size="100,100">在族内医生的努力下，你国战胜了瘟疫，掌握了对付它的办法。那些发热、头疼、背疼、长满丘疹的可怕症状完全消失了。

[继续]&lt;continue|

(click-replace: ?continue)[

&#39;&#39;状态栏 
族群数量↓ Clangröße↓
储备粮食↓ Nahrungsreserven↓
抗天灾能力↓ Widerstandsfähigkeit gegen Naturkatastrophen ↓
医疗水平↑ Medizinisches Niveau↑
&#39;&#39;

&#39;&#39;历史事件：战胜天花！
Historisches Ereignis:  über die Pocken!&#39;&#39;

[[第三回合]]

]

</tw-passagedata><tw-passagedata pid="40" name="1.3.2失败" tags="" position="375,275" size="100,100">冬眠，就是真的冬眠。

你的文明在温馨的睡梦中冻结了，再也没有苏醒的那一天。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[=
&#39;&#39;结局1：冬眠者&#39;&#39;



[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]

</tw-passagedata><tw-passagedata pid="41" name="STAFF" tags="" position="225,200" size="100,100">规则参考：
Call of Cthulu 7th
D&amp;D 5E
A岛跑团版

原作：

//Humanic Park
1994
Andreas Eschbach//

参考作品：

//《冰汽时代》
《吞食者》
《微纪元》//

制作团队
深圳技术大学2022级外国语学院德语系

技术支持 KellyAties
平台支持 Twine


特别鸣谢：
SZTU苍蓝星集会
SZTU大数据与互联网学院
SGU旅游与地理学院
阿飘

//以上排名不分先后//</tw-passagedata><tw-passagedata pid="42" name="1.冬眠" tags="" position="975,900" size="100,100">进行骰子检定。

[ra50]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[1.成功]]]
(else:)[点此继续 -&gt;[[2.失败]]]

]
</tw-passagedata><tw-passagedata pid="43" name="2.尝试往温暖处迁徙" tags="" position="1025,1050" size="100,100">地文官临危受命，带领国民往温暖的地方迁徙。

最后，你们找到了一个合适的地方定居。

&#39;&#39;状态栏
人口数量↓ 
经济状况↓ 
社会稳定↓ 
抗天灾能力↓↓ 
&#39;&#39;

[[第三回合]]</tw-passagedata><tw-passagedata pid="44" name="3.举行大型的祭祀仪式，祈求神明能够阻止冰期" tags="" position="1025,1250" size="100,100">祭司说道：“突然爆发这么严重的寒潮，一定是因为我们触怒了神明，我们必须举行仪式，献上礼物，取悦神明。”

[继续]&lt;continue|

(click-replace: ?continue)[

你深以为然。

但是，国内对于是否要给“神明”礼物争吵了起来。

你的意见是

[[1.献上祭品]] Opfergaben
[[2.尝试白嫖]] Hurenversuch

]

</tw-passagedata><tw-passagedata pid="45" name="4.尝试进入二次元" tags="" position="1150,1350" size="100,100">绫地宁宁忽然出现在你们面前。


[继续]&lt;continue|

(click-replace: ?continue)[

“天气变得很冷，对吧？”绫地宁宁对你说道。

睁开眼看到的第一幅景象是一个衣着暴露，头带阔帽的银发少女。

“我去，二次元。”你脱口而出。

“Ciallo～(∠・ω&lt; )⌒☆魔女们来帮助你啦！“

她毫不犹豫地扣下了扳机，随即你两眼就黑了过去。

在昏昏沉沉之中，你似乎看见了一片白茫茫的空间。

“这里是温暖的二次元哦，没有难熬的冰期，只有可爱的二次元人物温暖的怀抱，没有现实的苦痛，只有美好的童话和Happy Ending……”绫地宁宁的声音在你耳边萦绕。
(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[结局12：二次元收收味

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]]



]</tw-passagedata><tw-passagedata pid="46" name="2.尝试抵御洪水" tags="" position="875,1300" size="100,100">你不愿意放弃生活多年的家园。你看着族人们从渔猎采摘的时代走到现在，你已经对这块土地有了深厚的感情。

昔日的栖息地已经被淹个大半。洪水卷过土地，浑浊不堪。你们临时撤离到较高处，站在小山的山顶俯瞰水面。

“我们不走，”你缓缓地说，“和它斗到底。”

官员和民众们静静地看着你。

[治水]&lt;continue|

(click-replace: ?continue)[

治水开始了。面对这种天灾，奴隶制的社会没有多少办法，能依靠的就是人力的堆积。自山上搬下来沉重的巨石，用以堵住巨大的缺口，用泥土和砂砾堵住细小的空缺，同时起到粘合的作用。

“堵塞不是长久之计，”地文官和物理学家谏，“水有其理，请以修缮河道，是为治水。”

指挥权移交给这两位年轻的官员。地文官通晓地理水文知识，物理学家则有浮力的假说。物理学家认为河道过于狭窄，需要疏通河道，修整河道底部。

浩浩荡荡的工程开始了。

[ra40]&lt;rolldice|

]

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 40))[点此继续 -&gt;[[智人治水]]Menschen bekämpften die Überschwummung] 
(else:)[点此继续 -&gt;[[咕噜咕噜]]Guru Guru]

]</tw-passagedata><tw-passagedata pid="47" name="3.尝试在水里生活" tags="" position="725,1425" size="100,100">你久久地看着河水。


[继续]&lt;continue|

(click-replace: ?continue)[

“为什么要离开？”你忽然开口，抬起手指向远方。“我们依旧在这里生活不就好了。”\

[继续]&lt;continue1|

]

(click-replace: ?continue1)[


总务官看着你，“这全都被洪水淹了……在哪生活？”\


[继续]&lt;continue2|

]

(click-replace: ?continue2)[

你说：“就在水里。”

总务官和国民用看疯子的眼神看着你。

你顿了顿接着说：“鱼能在水里生活，没道理人就不行。”

[ra50]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[鲛人文明]]]
(else:)[点此继续 -&gt;[[咕噜咕噜]]]

]

]






</tw-passagedata><tw-passagedata pid="48" name="1.迁徙" tags="" position="750,1275" size="100,100">“离开这里。”你缓缓地说。

[继续]&lt;continue|

(click-replace: ?continue)[

国民们相顾无言。

[继续]&lt;continue2|

]

(click-replace: ?continue2)[

没有过多需要收拾的行李，大部分已被洪水埋葬在河底了。

去往何方？
[[1.高处]] Höheres Gelände
[[2.内陆地区]]  Binnenland
[[3.上游]] Stromaufwärts
[[4.北方]] Norden

]


</tw-passagedata><tw-passagedata pid="49" name="1.成功" tags="" position="25,1350" size="100,100">你们通过冬眠躲过了这次灾难。

寒潮过去，春暖花开，文明重启。

[[第三回合]]</tw-passagedata><tw-passagedata pid="50" name="2.失败" tags="" position="75,1200" size="100,100">这次没有上次那么好运了。

你的文明在温馨的睡梦中冻结了，再也没有苏醒的那一天。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[=
&#39;&#39;结局1：冬眠者&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]</tw-passagedata><tw-passagedata pid="51" name="1.高处" tags="" position="725,1550" size="100,100">为了躲避洪水，你们迁徙到了海拔较高的地方。

你们在山上定居。

[[第三回合]]</tw-passagedata><tw-passagedata pid="52" name="2.内陆地区" tags="" position="850,1525" size="100,100">为了躲避洪水，你们来到了干旱的内陆地区。

好在，水源的取用可以保证。

[[第三回合]]</tw-passagedata><tw-passagedata pid="53" name="3.上游" tags="" position="600,1650" size="100,100">为了躲避洪水，你们沿着河流流向跋涉，来到了上游地区。

[[第三回合]]</tw-passagedata><tw-passagedata pid="54" name="4.北方" tags="" position="825,1650" size="100,100">为了躲避洪水，你们迁徙到了寒冷的北方。

[[第三回合]]</tw-passagedata><tw-passagedata pid="55" name="4.尝试向神明祈祷，希望神明能够阻止洪水" tags="" position="950,1425" size="100,100">祭司说道：“突然爆发这么严重的洪水，一定是因为我们触怒了神明，我们必须举行仪式，献上礼物，取悦神明。”

[继续]&lt;continue|

(click-replace: ?continue)[

你深以为然。

但是，国内对于是否要给“神明”礼物争吵了起来。

你的意见是

[[1.献上祭品]]
Opfergaben
[[2.尝试白嫖]]
Hurenversuch

]</tw-passagedata><tw-passagedata pid="56" name="孤立的火山" tags="" position="525,1275" size="100,100">&#39;&#39;一个孤立的火山！这是一个好消息，使你的国家免去了灭国的风险。……大概。&#39;&#39;

&#39;&#39;接下来，我们将对火山爆发的严重程度做出详细定义。&#39;&#39;

(text-colour:red)[&#39;&#39;检定目标事件：这个火山的规模？一个十面的骰子，数字越大，火山越大。&#39;&#39;]


[rd10]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,10))

1-3 小型火山口
4-6 中等大小的火山
7-9 大型火山
0 生物灭绝的风险

出目结果：(print:+$roll)


(if: ($roll &lt;= 3))[点此继续 -&gt;[[1-3 小型火山口]]
](else-if: $roll &lt;= 6 and $roll &gt; 3)[点此继续 -&gt;[[4-6 中等大小的火山]]
](else-if: $roll &lt;= 9 and $rol &gt; 6)[点此继续 -&gt;[[7-9 大型火山]]
](else:)[点此继续 -&gt;[[0 生物灭绝的风险]]]

]



</tw-passagedata><tw-passagedata pid="57" name="一个连续的火山群" tags="" position="650,1225" size="100,100">&#39;&#39;事情有可能变得空前严峻，这或许将成为你和你的国民永远无法忘记的一天，如果你们的文明得以存续，你们的史书将单独开辟出一片板块记录这次灾难。&#39;&#39;

&#39;&#39;检定目标事件：这次火山喷发是否造成了其他邻近火山的连续喷发？一个十面的骰子，单数即为是，双数即为否。&#39;&#39;

[rd10]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,10))
出目结果：(print:+$roll)

(if: ($roll %2 is 0))[点此继续 -&gt;[[一个奇迹！]]]
(else:)[点此继续 -&gt;[[岩石的形成过程]]]

]


</tw-passagedata><tw-passagedata pid="58" name="1-3 小型火山口" tags="" position="375,1350" size="100,100">这次喷发仅仅只是掩埋了部分国土、牲畜和国民，总的来说，还是熬过去了。

&#39;&#39;状态栏 
种群数量↓ 
抵抗天灾能力↓ 
国土面积↓ 
经济状况↓
社会稳定↓ &#39;&#39;

[[第三回合]]</tw-passagedata><tw-passagedata pid="59" name="4-6 中等大小的火山" tags="" position="450,1450" size="100,100">&#39;&#39;事情严峻了！活下来的机会将变得渺茫。&#39;&#39;

骰子检定。

目标事件：

[ra50]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[一个奇迹！]]]
(else:)[点此继续 -&gt;[[岩石的形成过程]]]

]

</tw-passagedata><tw-passagedata pid="60" name="7-9 大型火山" tags="" position="550,1400" size="100,100">&#39;&#39;事情变得空前严峻，这将成为你和你的国民永远无法忘记的一天，如果你们的文明得以存续，你们的史书将单独开辟出一片板块记录这次灾难。&#39;&#39;

[ra40]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 40))[点此继续 -&gt;[[一个奇迹！]]]
(else:)[点此继续 -&gt;[[岩石的形成过程]]]

]</tw-passagedata><tw-passagedata pid="61" name="0 生物灭绝的风险" tags="" position="600,1525" size="100,100">&#39;&#39;存活的机会变得十分渺茫……&#39;&#39;这将成为这片大陆上无法忘怀的一天，很有可能在以地质纪年计数的时间过后，保存了你们尸体的化石将会被其他智慧文明发掘出来，然后你们将会作为一个”被火山喷发毁灭了的文明“记载在他们的史书里。

[ra20]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 20))[点此继续 -&gt;[[一个奇迹！]]]
(else:)[点此继续 -&gt;[[岩石的形成过程]]]

]</tw-passagedata><tw-passagedata pid="62" name="第三回合" tags="" position="1600,1600" size="100,100">(save-game:&quot;Slot A&quot;,&quot;Chapter 3 start&quot;)

随着时间流逝，你国出现了一般等价交换物，(if: (history:) contains &quot;4.种子保存技术、动物驯化技术。&quot;)[农耕经济的发展使得你国的公有制奴隶经济摇摇欲坠。]最终，经历了一定的流血和反复的斗争，你们建立起了私有制，并逐渐实现中央集权，建立了私有制的封建社会。

天空上有一条看不见尽头的光带，偶尔会有光点在那条光带上移动，星象观察官观测到光点上疑似有生物往下俯视，但你们从未在意过它。

当前社会状态：初步实现中央集权的私有制封建社会

[[开疆拓土]]
[[实现更进一步的中央集权]]
(if: (history:) contains &quot;1.宗教的建立&quot;)[[[发展宗教-&gt;发展宗教]]]\
(else:)[[[建立宗教-&gt;建立宗教]]]
[[发展商品经济]]
[[发展与邻国的外交]]
</tw-passagedata><tw-passagedata pid="63" name="鲛人文明" tags="" position="975,1550" size="100,100">很久很久以前，第一次有一批两栖类顺着洋流上了岸，第一次离开了水体生活。\

[继续]&lt;continue1|

(click-replace: ?continue1)[

很久很久以前，陆上那个文明毁灭了，但是在陆地上留存了生活的遗迹，保存着陆上文明的生物信息。\

[继续]&lt;continue2|

]

(click-replace: ?continue2)[

很近很近以前，一个远道而来的殖民者发现了陆上文明留存的信息，随手复活了这个文明。\

[继续]&lt;continue3|

]

(click-replace: ?continue3)[

于是，在时隔地质纪年也无法计数的时间后，那个文明再度下水了。\

[继续]&lt;continue4|

]

(click-replace: ?continue4)[

海洋是那个文明世界里所有生物的母亲。但是那个文明的世界已经毁灭了，如今的海洋只是旅行者根据留存的信息做出来的赝品，一个装着很多水、底面凹凸不平的透明玻璃缸。\

但是已经没关系了。\

[继续]&lt;continue5|

]

(click-replace: ?continue5)[

为了在海里生活，克隆体们又像他们母体的祖先一样，进化出来了腮、鳍、蹼，退化了视力，增加了身体的流线性，最后连下肢也一起进化为鱼尾。这使得他们能在更深的海域里生存。

但是，克隆体们并没有就这样失去他们陆上的生活技巧。他们在海底复现了陆上的建筑，将历史刻在海底的巨石上。在昏暗的海底里，国民们又重新聚在一起，庄严地举行了开国的典礼。

亚特兰蒂斯建成了。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[=
&#39;&#39;结局7：鲛人文明&#39;&#39;
&#39;&#39;成就：文明的历程、“殖民者&#39;&#39;

[STAFF名单]&lt;continue|

(click-replace: ?continue)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]

]

</tw-passagedata><tw-passagedata pid="64" name="咕噜咕噜" tags="" position="1025,1675" size="100,100">(if: (history:) contains &quot;2.尝试抵御洪水&quot;)[
工事进行到一半，雨下得更加大了。
暴雨带来了狂风和降温，工程完全停滞，水面升高，原先暂居的山洞已经被大水倒灌，你们不得不迁徙到更高处。

“看不到成功的希望。”地文官绝望地说。“雨太大了，在这种环境下施工很不安全。而且冬季要到了，取暖很困难！”

“又有人逃跑了。”总务官说，“但他们没跑出多远，就被大水冲走了。”

你沉默，回头看向身后的石床上。思想家日前去世，他的学生们守在他的遗体旁边久久不愿离去。

”我做错了吗？“你轻声问道，最后一个字消失在大雨中。


[胶囊里的小人]&lt;continue|

(click-replace: ?continue)[

一日，光带上飞驰过一粒细小光点。光带是电磁加速轨道，光点其实是能承受巨大G值的运输用胶囊，不过现在主要作为观测和观光使用。

胶囊里的生物俯瞰大地。

//「实验体呢？」
「被洪水淹没了。」
「和历史上是一样的。」
「是的，这在他们先祖著作《旧约·创世记》中亦有记载。」//

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局10：咕噜咕噜
Ende10: Guru Guru&#39;&#39;

[STAFF名单]&lt;continue5|

]

(click-replace: ?continue5)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]


]

]


(if: (history:) contains &quot;3.尝试在水里生活&quot;)[你们下水了。

总务官依旧不相信你的话，但你坚持己见：“鱼能够在水里生活，那人……”

[继续]&lt;continue|

(click-replace: ?continue)[

洪水来了。

[继续]&lt;continue2|

]

(click-replace: ?continue2)[


你的话没有说完，剩下的话都变成了：“咕噜咕噜咕噜咕噜…………”

[继续]&lt;continue3|

]

(click-replace: ?continue3)[

咕噜咕噜咕噜。


(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局10：咕噜咕噜&#39;&#39;

[STAFF名单]&lt;continue5|

]

(click-replace: ?continue5)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]


]

]



</tw-passagedata><tw-passagedata pid="65" name="岁大饥，人相食" tags="" position="625,2025" size="100,100">这是为了渡过艰难时期的权宜之计。\

若非如此，你无法说服自己这么做。\

你们在南方定居。起初，你们无法适应南方湿热多瘴气的环境，后来岁月变迁，你们与南方环境相安无事。\

&#39;&#39;获得成就：两脚羊
&#39;&#39;\

[[第三回合]]



</tw-passagedata><tw-passagedata pid="66" name="开疆拓土" tags="" position="1225,1625" size="100,100">你以边界不明确为借口对邻国发动了战争。

(if: (history:) contains &quot;一个奇迹！&quot; )[

[ra30]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 30))[点此继续 -&gt;[[征服成功！]]]
(else:)[点此继续 -&gt;[[完全败北]]]

]

]


(if: (history:) contains &quot;2.尝试抵御洪水&quot; )[

[ra40]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 40))[点此继续 -&gt;[[征服成功！]]]
(else:)[点此继续 -&gt;[[完全败北]]]

]

]

(else:)[

[ra60]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 60))[点此继续 -&gt;[[征服成功！]]]
(else:)[点此继续 -&gt;[[完全败北]]]

]

]</tw-passagedata><tw-passagedata pid="67" name="实现更进一步的中央集权" tags="" position="1125,1775" size="100,100">思想家对你说：“将首都到达地方的处理程序简化为三层，建立中央垂直管理地方的三级管理体制，如此，可防止地方叛乱。”

[新来的思想家]&lt;continue|

(click-replace: ?continue)[

……
新来的思想家，一个白色大胡子的人对你说：“将冶炼金属、生产工业原料的权力收回到首都，如此，可防止地方叛乱。”

[新来的思想家]&lt;continue|

]

(click-replace: ?continue2)[

…………

新来的思想家，一个很喜欢喝酒，最后也确实死于喝酒的中年人醉醺醺地跟你说：“不可以和宗教同流合污！教廷都是一群尸位素餐的废物。要世俗，将宗教扔出国土！”

[新来的思想家]&lt;continue|

]

(click-replace: ?continue)[
…………

新来的思想家，一个喜欢看二次元，留M字刘海的傻逼二次元说：“创设常备军，驻守在首都附近。”

[新来的思想家]&lt;continue|

]

(click-replace: ?continue)[

……

新来的思想家，也喜欢看二次元，雌雄难辨的人说：“发动战争，一统天下。”

无法计数的岁月过去了，整个大陆都已被划归到你国的版图之下，你是全天下的皇帝。

&#39;&#39;成就：天下统一！&#39;&#39;

[[异变？]]

]</tw-passagedata><tw-passagedata pid="68" name="发展商品经济" tags="" position="1225,1900" size="100,100">你们依靠便利的陆上与水上交通发展起货物交换经济。

&#39;&#39;成就：水上的威尼斯人&#39;&#39;

&#39;&#39;状态栏：
经济水平↑
社会稳定↑&#39;&#39;

[[殖民时代]]


</tw-passagedata><tw-passagedata pid="69" name="发展宗教" tags="" position="1525,1975" size="100,100">你决定借助宗教的力量发展自身。

你将东方神教定为国教，制定了严格的礼拜程序，自封为教主，给予教会巨大的权力。这滋生了不事生产的教士阶级，他们掌握着巨大的权力，可以剥削民众，而且还能影响到国策。

&#39;&#39;状态栏
社会凝聚力↑↑
愚昧↑
思想专制↑↑
社会稳定↓
&#39;&#39;

[[异变？]]</tw-passagedata><tw-passagedata pid="70" name="建立宗教" tags="" position="1375,1950" size="100,100">星象观察官夜观星象，发现天空始终存在一个巨大的圆形发光物体，给予了大地热量与光明。

选择建立：[[东方神教]]

天空上有一条看不见尽头的光带，偶尔会有光点在那条光带上移动，星象观察官观测到光点上疑似有生物往下俯视，但你们从未在意过它。……现在，也许是时候了。

选择建立：[[轨道神教]]</tw-passagedata><tw-passagedata pid="71" name="岩石的形成过程" tags="" position="400,1550" size="100,100">缓慢流动的、滚烫的岩浆流将国民们掩埋，你能听见他们的惨叫声，看见他们逐渐下陷和融化的身体，碳化的手臂在空中挥舞着，最终断成数节。

你的身体也被炽热的岩浆包裹，如果侥幸有一部分身体组织能够保存下来，在数万年之后的岩浆冷却之后，另一个智慧文明也许能发掘到保存着你的肢体的化石。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[=
&#39;&#39;结局9：岩石的形成过程
Ende 9: Der Prozess der Gesteinsbildung&#39;&#39;

[STAFF名单]&lt;continue|

(click-replace: ?continue)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]
</tw-passagedata><tw-passagedata pid="72" name="一个奇迹！" tags="" position="900,1800" size="100,100">简直是奇迹！虽然损失了大量的人口，经济几乎完全崩溃，但文明还是勉强维系住了！

&#39;&#39;状态栏 

抵抗天灾能力↓↓ 
经济状况↓↓ 
人口数量↓↓ 
社会稳定↓↓ &#39;&#39;

[[百废待兴]]</tw-passagedata><tw-passagedata pid="73" name="百废待兴" tags="" position="1025,1875" size="100,100">岩浆慢慢冷却，灾难已经过去，当务之急是重启文明。

恢复的效果：

&#39;&#39;连续多次的检定&#39;&#39;

&#39;&#39;说明：第一次检定将判断恢复效果（正面、负面），低于50则被判定为负面（负数），高于50则反之。&#39;&#39;

[ra50]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[2.还有希望！]]]
(else:)[点此继续 -&gt;[[1.漫长的路，看不见光]]] 

]
</tw-passagedata><tw-passagedata pid="74" name="发展与邻国的外交" tags="" position="1675,1950" size="100,100">你决定与邻国深入友好地交流。

具体表现为
[[建立外交关系]]
[[和亲]]
[[与其通商]]
[[邀请他们一起到二次元]]


</tw-passagedata><tw-passagedata pid="75" name="征服成功！" tags="" position="1725,2450" size="100,100">你吞并了邻国，国土面积得到扩大。

&#39;&#39;状态栏：
国土面积↑
人口数量↑
社会稳定↓
(if: (history:) contains &quot;一个奇迹！&quot; or &quot;2.尝试抵御洪水&quot; or &quot;2.尝试往温暖处迁徙&quot; )[
抗天灾能力↓]
经济状况↑&#39;&#39;

[[异变？]]


</tw-passagedata><tw-passagedata pid="76" name="完全败北" tags="" position="1750,2325" size="100,100">你并没有成功攻占邻国领地，而是被邻国的铁骑踏遍了自己的土地。对方持有铁器做成的武器，而且兵法合理诡妙，你们完全败下阵来。

敌国完全控制了你国领土，俘虏了你国国民作为奴隶，并将你推上了断头台。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局11：冶金技术与兵法异常重要是也……&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]

]</tw-passagedata><tw-passagedata pid="77" name="建立外交关系" tags="" position="1800,2025" size="100,100">你修书一封发至邻国，请求与其建立友好的外交关系，以互通有无。

邻国的意见是

[ra50]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[建交成功]]]
(else:)[点此继续 -&gt;[[你是？]]]


]</tw-passagedata><tw-passagedata pid="78" name="和亲" tags="" position="1450,2300" size="100,100">你将本国的美女和一大批奴仆、陪嫁的金银财宝和农业技术送去了邻国。

邻国对此的意见是

[rd100]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,10))
出目结果：(print:+$roll)

(if: $roll &lt;= 5)[点此继续 -&gt;[[附属国与宗主国]]
](else: $roll &lt;= 10 and $roll &gt; 5)[点此继续 -&gt;[[接受了，但是并没有特别的行动]]]</tw-passagedata><tw-passagedata pid="79" name="与其通商" tags="" position="1925,2075" size="100,100">你积极发展与邻国的贸易。

你国生产的廉价商品很快攻占了邻国的市场。

邻国对此的反应是

[rd10]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,10))
出目结果：(print:+$roll)

1-5 毫无波澜Keine Probleme
6-9 颇有微词
0 ？

(if: ($roll &lt;= 3))[点此继续 -&gt;[[毫无波澜]]
](else-if: $roll &lt;= 9 and $roll &gt; 6)[点此继续 -&gt;[[颇有微词]]
](else:)[点此继续 -&gt;[[发动战争]]]

]</tw-passagedata><tw-passagedata pid="80" name="邀请他们一起到二次元" tags="" position="1525,2450" size="100,100">你严肃地说：“三次元太可怕了，这里到处都是勾心斗角，战火连天。”

使者：“这确实。怎么了？”


[我们一起去二次元吧！]&lt;continue|

(click-replace: ?continue)[

“所以我们一起去二次元吧！”你说，紧紧地握住了使者的手。

使者：？

使者：

使者：？

使者不明觉厉，但依旧把你的请求回复给了他们的大总统。


[大总统的回复]&lt;continue2|

]

(click-replace: ?continue2)[

总统：“你的想法善，但是我补药去虚黑城……”

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;成就：头部没有遭到破坏，吐息处于最强力的阶段
&#39;&#39;
&#39;&#39;结局21：给我玩怪物猎人&#39;&#39;]

&lt;img src=&quot;http://tiebapic.baidu.com/forum/w%3D580/sign=66aad6f71466d0167e199e20a72bd498/337eef0635fae6cd24f8fe5b49b30f2442a70f16.jpg?tbpicau=2024-11-15-05_26a0ff7462bf753e35a9f3b6d60860f7&quot;&gt;

[STAFF名单]&lt;continue3|

]

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]
]


</tw-passagedata><tw-passagedata pid="81" name="东方神教" tags="" position="1325,2150" size="100,100">&#39;&#39;成就：一个灯泡&#39;&#39;

[继续]&lt;continue|

(click-replace: ?continue)[

&#39;&#39;状态栏
社会凝聚力↑
思想专制↑
社会稳定↑
&#39;&#39;
[[异变？]]

]

</tw-passagedata><tw-passagedata pid="82" name="轨道神教" tags="" position="1450,2125" size="100,100">在轨道上的生物的见证下，你们建立了轨道神教。

[继续]&lt;continue|

(click-replace: ?continue)[

&#39;&#39;成就：当你在凝视着深渊&#39;&#39;

&#39;&#39;状态栏
社会凝聚力↑
思想专制↑
社会稳定↑
&#39;&#39;

[[异变？]]

]




</tw-passagedata><tw-passagedata pid="83" name="建交成功" tags="" position="1800,2175" size="100,100">你与邻国建立了外交！

&#39;&#39;成就：加个好友&#39;&#39;

[[邻国的馈赠？]]</tw-passagedata><tw-passagedata pid="84" name="邻国的馈赠？" tags="" position="1650,2575" size="100,100">邻国给你分享了

[rd10]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,10))
出目结果：(print:+$roll)

(if:$roll &lt;= 3)[点此继续 -&gt;[[1-3 建立统一的中央集权大帝国的办法]]
](else-if:$roll &lt; 7 and $roll &gt; 3)[点此继续 -&gt;[[4-6 与神明通信的办法]]
](else-if:$roll &lt; 10 and $roll &gt; 6)[点此继续 -&gt;[[7-9 完善的工业体系]]
](else:)[点此继续 -&gt;[[可控核聚变]]

]

]</tw-passagedata><tw-passagedata pid="85" name="你是？" tags="" position="1650,2150" size="100,100">邻国撕毁了你的意愿书！

[[1.岂有此理，和他踏踏开！]]
[[1.岂有此理，和他踏踏开！]]
[[3.放弃]]</tw-passagedata><tw-passagedata pid="86" name="1.岂有此理，和他踏踏开！" tags="" position="1600,2325" size="100,100">使者将消息传回，你愤怒地一拍案板：“岂有此理！”

当下，你立即调派军队开拔前往国界。

[继续]&lt;continue|

(click-replace: ?continue)[

踏踏开。

(if: (history:) contains &quot;一个奇迹！&quot; )[

[ra30]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 30))[点此继续 -&gt;[[征服成功！]]]
(else:)[点此继续 -&gt;[[完全败北]]]

]

]


(if: (history:) contains &quot;2.尝试抵御洪水&quot; )[

[ra40]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 40))[点此继续 -&gt;[[征服成功！]]]
(else:)[点此继续 -&gt;[[完全败北]]]

]

]

(else:)[

[ra60]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 60))[点此继续 -&gt;[[征服成功！]]]
(else:)[点此继续 -&gt;[[完全败北]]]

]

]
]

</tw-passagedata><tw-passagedata pid="87" name="3.放弃" tags="" position="1375,2650" size="100,100">你选择了放弃。此事不了了之。

[[异变？]]</tw-passagedata><tw-passagedata pid="88" name="1-3 建立统一的中央集权大帝国的办法" tags="" position="1100,2750" size="100,100">邻国给你分享了建立统一的中央集权的大帝国的办法。

你对此的意见是
[[不错，看看你的]]
[[一眼丁真，鉴定为纯纯的传销]]

</tw-passagedata><tw-passagedata pid="89" name="7-9 完善的工业体系" tags="" position="1350,2875" size="100,100">邻国援建你国建立了完善的近代工业体系。

你们飞跃到电力时代了。
[继续]&lt;continue|

(click-replace: ?continue)[


&#39;&#39;成就：我草，瓜！我们也有！&#39;&#39;

&#39;&#39;当前社会状态：思想仍旧是封建时期的近代工业社会&#39;&#39;

[继续]&lt;continue2|

]

(click-replace: ?continue2)[

为了防止你国产生经济基础与上层建筑互相不适应的情况，邻国还贴心地给你国支援了教育事业和思想基础理论。

“你们学得太慢了。”来自邻国的哲学和物理教授不满地看着你们。

十数年过后，你国形成了完善的工业体系和与之匹配的上层建筑与经济基础。为了让强大的工业体系完全发挥作用，你国顺便革了个命，实现了民主共和。

&#39;&#39;当前社会形态：民主共和、工业化的近代民族国家&#39;&#39;

[[异变？]]

]</tw-passagedata><tw-passagedata pid="90" name="4-6 与神明通信的办法" tags="" position="1100,2875" size="100,100">邻国使者对你们说道：“这个世界存在神明。我们都是被神明创造的，但是神明并不会无时无刻注视我们，这是与其通信的办法，我现在讲与你听。”

你
[[1.聆听]]
[[2.我是唯物主义者]]
[[3.神明在哪？]]
</tw-passagedata><tw-passagedata pid="91" name="不错，看看你的" tags="" position="900,2775" size="100,100">你与国内的大思想家等专精于此方面的专家彻夜研讨，研究邻国发来的帝王之术，得出结论是也许可行，不妨试试。

[继续]&lt;continue|

(click-replace: ?continue)[

于是，你们按照这本书说的做，把邻国吞并了。

[继续]&lt;continue2|

]

(click-replace: ?continue2)[

经过数十年的征战，以及经济、军事、技术的发展，你国成功统一了整片大陆，建立了大统一的中央集权帝国。

&#39;&#39;成就：天下统一！&#39;&#39;

[[异变？]]

]

</tw-passagedata><tw-passagedata pid="92" name="一眼丁真，鉴定为纯纯的传销" tags="" position="1125,3000" size="100,100">使者将邻国送来的书本交予你，你只是翻了几页就将其丢至一旁。

“怪力乱神，妖言惑众。”你说。

[继续]&lt;continue|

(click-replace: ?continue)[

&#39;&#39;成就：万一是真的呢……？&#39;&#39;

]

</tw-passagedata><tw-passagedata pid="93" name="异变？" tags="" position="1675,3350" size="100,100">(if:(history:)contains&quot;不错，看看你的&quot; or &quot;1.坚持己见&quot; or&quot;3.一眼丁真，鉴定为纯纯的传销&quot;or &quot;实现更进一步的中央集权&quot; or &quot;发展商品经济&quot; or&quot;发展宗教&quot; or &quot;建立宗教&quot;or&quot;1.出台贸易限制政策&quot; or &quot;开疆拓土&quot; or &quot;毫无波澜&quot;)[一日，首都附近的走鬼商贩联名，一纸诉状将维护城市秩序的骑士告上法庭。

[堂下何人状告本官？]&lt;continue|

(click-replace: ?continue)[

商贩声泪俱下地控诉骑士在集市如何欺凌商人，用各种名义对走商收费，今日更是对商贩拳打脚踢。受到指控的骑士被市民七手八脚地按在地上，脸上还带着鲜血和泥土。

[[1.支持骑士]]
[[2.支持市民]]
[[3.思想家，你怎么看？]]

]

]

(if:(history:)contains&quot;进步的歌声&quot;)[一日，你与邻国的科学家讨论到光带上的神明。

“你们是如何发现神明的存在的？”你说。

“一开始是观测天上的光带，然后在领地内发现了神明留下来的遗迹。”科学家说。

“遗迹，”科学官饶有兴趣、但尊敬地看着科学家，“是什么样的？”

“巨大的基地，里面安装着很多冬眠舱，”科学家一边解释一边给你比划。“我们把里面的设备拆开来研究，然后确认了神的存在。”

[灵感检定]&lt;rolldice|

]

(click-replace:?rolldice)[

(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[灵光一现]]]
(else:)[点此继续 -&gt;[[毫无头绪]]]

]

</tw-passagedata><tw-passagedata pid="94" name="附属国与宗主国" tags="" position="1350,2475" size="100,100">邻国和你国成为了附属国和宗主国的关系。

[[邻国的馈赠？]] </tw-passagedata><tw-passagedata pid="95" name="接受了，但是并没有特别的行动" tags="" position="1225,2500" size="100,100">邻国接受了你们的和亲，但没有任何表态了。

官员觉得有点亏。

[[异变？]]</tw-passagedata><tw-passagedata pid="96" name="1.献上祭品" tags="" position="300,1725" size="100,100">你决定为神明献上祭品。

[[1.牲口和金银财宝和兽骨]]
[[2.装在袋子里的蠕动着的长条形动物]] 
[[3.一本写着[■■  Arisa■■] Alien Abduction ■■ 的神必小书]]


</tw-passagedata><tw-passagedata pid="97" name="2.尝试白嫖" tags="" position="450,1700" size="100,100">献上祭品什么的，是不可能的！

于是，你决定白嫖。

白嫖举行的仪式，神明对此的评价是

[ra30]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 30))[点此继续 -&gt;[[神迹降临]]]
(else:)[点此继续 -&gt;[[爬]]]

]
</tw-passagedata><tw-passagedata pid="98" name="2.装在袋子里的蠕动着的长条形动物" tags="" position="375,2025" size="100,100">祭品扑腾得有些厉害，几个身强力壮的武士才按住它。

(if: (history:) contains &quot;3.举行大型的祭祀仪式，祈求神明能够阻止冰期&quot; )[寒风愈发呼啸，顷刻间大雪便掩埋了祭坛，没过你的脚踝。极寒使得屠夫的刀刃很难切开血管，一切开，祭品一僵，疯狂挣扎起来，随后慢慢没了力气，两脚一伸，直了。滚烫的热血泼洒在白雪上，顷刻冻结成血柱。]

(if: (history:) contains &quot;4.尝试向神明祈祷，希望神明能够阻止洪水&quot; )[远处山间滚滚地传来低鸣声，远远地能看见洪水正朝这边席卷而来。祭品扯开嗓子凄厉地哭喊起来，与洪水的低鸣重合在一起。]

(if: (history:) contains &quot;4.尝试向神明祈祷，希望神明能够阻止地震&quot; )[地动山摇，能听见沉闷的爆炸声，祭品的哀嚎愈发凄厉。
祭品的声音尖利凄惨，大地晃动的声音低沉厚重。
如果要评选历史上最可怕的交响曲，你会选这一首。


]

[ra50]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[神迹降临]]]
(else:)[点此继续 -&gt;[[神明抛弃了我们！]]]

]</tw-passagedata><tw-passagedata pid="99" name="1.牲口和金银财宝和兽骨" tags="" position="250,1925" size="100,100">你将祭品放在仪式正中央，然后开始举行仪式。

(if: (history:) contains &quot;3.举行大型的祭祀仪式，祈求神明能够阻止冰期&quot; )[寒风愈发呼啸，大雪掩埋了牲口，极寒使得屠夫的刀刃很难切开血管，一切开，滚烫的热血泼洒在白雪上，顷刻冻结成血柱。]

(if: (history:) contains &quot;4.尝试向神明祈祷，希望神明能够阻止洪水&quot; )[远处山间滚滚地传来低鸣声，远远地能看见洪水正朝这边席卷而来。]

祭司带领你们做法，你作为国家的执政者，文明的领导人，虔诚地跪在地上祈祷。

[ra50]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[神迹降临]] ]
(else:)[点此继续 -&gt;[[神明抛弃了我们！]]]

]</tw-passagedata><tw-passagedata pid="100" name="爬" tags="" position="400,1875" size="100,100">忽然，天上出现了一个圆形的光斑图像，伴随着声音，大的如同是雷声一般，轰隆隆的。

神明：“爬，这就想着白嫖是吧”

你们没有取悦神明，而是被神明一刀铜丝了。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局13：那里面的人个个都是人才，说话又好听
Ende 13：Die Leute dort sind begabt und haben gute Reden&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]]</tw-passagedata><tw-passagedata pid="101" name="神迹降临" tags="" position="325,2275" size="100,100">天空忽然闪烁了数次，紧接着伴随着一声巨响，世界变得一片漆黑，惊得你的国民尖叫不已，走兽飞鸟纷纷骚动，整个世界的光源只剩下为了举行仪式生的篝火。

[继续]&lt;continue|

(click-replace: ?continue)[

(if:(history:contains&quot;3.举行大型的祭祀仪式，祈求神明能够阻止冰期&quot;))[

&#39;&#39;成就：黑暗时代&#39;&#39;

//「照明系统……重启」
「温度控制系统 检修中」
「发现数个故障  报修申请中」//

[继续]&lt;continue2|

]
]

(click-replace: ?continue2)[

不知从何而来的响彻着的巨大声音，说着你们无法理解的语言，在你国民的耳朵里跟惊雷没有区别。紧接着，天空忽然亮起一道光环，一粒细小的光点从光环的一端飞驰到另一端，在空中留下一道绚烂的尾焰。

那些生物探出身子俯视你们。

[继续]&lt;continue3|

]

(click-replace: ?continue3)[

一阵狂风吹来，你差点没能睁开眼睛。
那是一股温暖的风，对于现在的你们简直可以说是滚烫。紧接着，从天而降了大量的“雪”（或者说是和雪同一个颜色的东西，因为当它落在你身上时，(text-colour:red)[你伸出舌头舔了一下，稍稍有点咸。]），“雪”落到已经冻成块的雪堆上，你惊奇地发现雪堆居然融化了；还有更多神奇的事情发生了。
融雪没有引发山洪，而是被什么东西引导着带走了，巨大体积的水被长长的管子引导着回到了附近的水体，没有回去的则是被大地吸收。

[继续]&lt;continue4|

]

(click-replace: ?continue4)[

宗教建立后，你的部分国民还觉得神明只是谎言，是虚幻缥缈的东西，现在他们都要改变想法了。因为神明当真现身了。

]

(if:(history:contains&quot;4.尝试向神明祈祷，希望神明能够阻止洪水&quot;))[

&#39;&#39;成就：黑暗时代&#39;&#39;


//「照明系统……重启」
「水循环系统 检修中」
「发现数个故障  报修申请中」//


[继续]&lt;continue2|


(click-replace: ?continue2)[

不知从何而来的响彻着的巨大声音，说着你们无法理解的语言，在你国民的耳朵里跟惊雷没有区别。紧接着，天空忽然亮起一道光环，一粒细小的光点从光环的一端飞驰到另一端，在空中留下一道绚烂的尾焰。

那些生物探出身子俯视你们。

[继续]&lt;continue3|

]

(click-replace: ?continue3)[

暴雨忽然停止了。雨停止的那一刻，从四面八方伸来黑色的无头巨蛇，淹没了大地的洪水被巨蛇吸入，期间，天空数次闪烁，太阳唐突熄灭又唐突亮起。

「你傻※啊，把灯关了干嘛！还要蒸发的！」

巨蛇的暴风吸入持续了整整一天，大地重新裸露，连日的暴雨也彻底结束了，世界又恢复了平静。


[继续]&lt;continue4|

]

(click-replace: ?continue4)[

宗教建立后，你的部分国民还觉得神明只是谎言，是虚幻缥缈的东西，现在他们都要改变想法了。因为神明当真现身了。


]

]
 
(if:(history:contains&quot;4.尝试向神明祈祷，希望神明能够阻止地震&quot;))[

&#39;&#39;成就：黑暗时代&#39;&#39;

//「照明系统……重启」
「地面稳定系统 检修中」
「发现数个故障  报修申请中」//

[继续]&lt;continue2|


(click-replace: ?continue2)[

不知从何而来的响彻着的巨大声音，说着你们无法理解的语言，在你国民的耳朵里跟惊雷没有区别。紧接着，天空忽然亮起一道光环，一粒细小的光点从光环的一端飞驰到另一端，在空中留下一道绚烂的尾焰。

那些生物探出身子俯视你们。

[继续]&lt;continue3|

]

(click-replace: ?continue3)[

地震忽然停止了，数分钟。紧接着，更加强烈的摇晃出现了。你眼睁睁地看着自己脚下的地面缓缓升起，在比地下更底下，比深处更深处的地方，正在发生着你无法理解的事情。你看见从天而降的巨大黑色物体，将坍塌的山头如同你捻起一只臭虫一样，随意地拎了起来。紧接着，它将倒塌的山捡了起来，如同砌泥沙城堡一般将其堆放在一起。这项工程持续了整整一天，地底缓缓下沉，恢复到你熟悉的高度。


[继续]&lt;continue4|

]

(click-replace: ?continue4)[

宗教建立后，你的部分国民还觉得神明只是谎言，是虚幻缥缈的东西，现在他们都要改变想法了。因为神明当真现身了。


]


[[第三回合]]





]</tw-passagedata><tw-passagedata pid="102" name="3.一本写着[■■  Arisa■■] Alien Abduction ■■ 的神必小书" tags="" position="250,2075" size="100,100">你将祭品放在仪式正中央，然后开始举行仪式。

[继续]&lt;continue|

(click-replace: ?continue)[

良久，你和你的国民充满期盼地看向天空。

[继续]&lt;continue2|

]

(click-replace: ?continue2)[

忽然，天上出现了一个圆形的光斑图像，伴随着声音，大的如同是雷声一般，轰隆隆的。

“啥比二次元，你发的是个***”

你们没有取悦神明，而是被神明一刀铜丝了。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[结局12：二次元收收味

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]]



]</tw-passagedata><tw-passagedata pid="103" name="1.聆听" tags="" position="1275,3025" size="100,100">使者将通信的办法讲授给你，又将记载着这个办法的书籍留了下来，还留了一个能看懂书籍上文字的翻译官。

&#39;&#39;提示：从现在起，你们可以与？？？通信了。&#39;&#39;

[[异变？]] </tw-passagedata><tw-passagedata pid="104" name="2.我是唯物主义者" tags="" position="1025,3025" size="100,100">你回复说：“这样，我是一个唯物主义者。”
[继续]&lt;continue|

(click-replace: ?continue)[


使者不可置否，“唯物主义并非完全否定神明的存在，你说出这种话，说明你们国家的哲学发展处在一个比较低的水平。神明客观存在，而且已经被证实，可以被观测。”

你
[[1.坚持己见]]
[[2.听听他的说法]]

]</tw-passagedata><tw-passagedata pid="105" name="3.神明在哪？" tags="" position="1100,3125" size="100,100">你聆听着邻国使者滔滔不绝，忽然发言打断：“你即说世上有神明，那么神明在哪？”

[继续]&lt;continue|

(click-replace: ?continue)[

使者一顿，往天上一指，“神明不在此处，”他说，“然，可在天上光带处观测到神明。”

“神明常驱车沿光带巡查人间，每当神明驱车，光带上则出现一粒微不可见的光点，神明即从光带上探出头，俯瞰大地。”

[继续]&lt;continue2|

]
(click-replace: ?continue2)[

你一思忖，“这种现象我们也早已见过。”

使者继续说道，“偶尔，能观测到神明反复沿光带行走，因此我国星象官认为，天地乃是一个浑圆的球。”

你国思想家说道：“这可是个叫人诧异的说法。”

[[1.怎样才能与神明通信？]]
[[2.如何证明我们是被创造的？]]
[[3.一眼丁真，鉴定为纯纯的传销]] 


]</tw-passagedata><tw-passagedata pid="106" name="神明抛弃了我们！" tags="" position="175,2275" size="100,100">你们苦苦等了许久，也没有见到任何异变发生。(if:(history:contains&quot;3.举行大型的祭祀仪式，祈求神明能够阻止冰期&quot;))[暴风雪愈来愈大，极寒将祭品冻结，最后也将你们冻结，使你们变成了伫立在祭坛四周的雕像。

在因失温而死的前一秒，祭司吐出最后一口热气：“神明抛弃了我们……”

(align:&quot;&lt;==&quot;)+(box:&quot;==XXXXX===&quot;)[&#39;&#39;结局12：从来就没有什么救世主
Ende 12: Es gab nie einen Retter&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]

]

(if:(history:contains&quot;4.尝试向神明祈祷，希望神明能够阻止洪水&quot;))[远处，远远地传来轰鸣声，大地震动，洪水淹没了山，并朝祭坛的方向袭来。

你们尝试逃跑，但一切都迟了。栖息地被洪水彻底淹没。逃跑时，祭司朝着天空大声呼喊：“神明抛弃了……咕噜咕噜咕噜…………”

(align:&quot;&lt;==&quot;)+(box:&quot;==XXXXX===&quot;)[&#39;&#39;结局10：咕噜咕噜
Ende 10: Guru Guru&#39;&#39;


[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]]

]

</tw-passagedata><tw-passagedata pid="107" name="1.怎样才能与神明通信？" tags="" position="950,3200" size="100,100">你询问怎样才能与神明通信，使者欣然将通信的办法讲授给你，又将记载着这个办法的书籍留了下来，还留了一个能看懂书籍上文字的翻译官。

&#39;&#39;提示：从现在起，你们可以与？？？通信了。&#39;&#39;

[[异变？]] </tw-passagedata><tw-passagedata pid="108" name="2.如何证明我们是被创造的？" tags="" position="1075,3250" size="100,100">使者说道：“世上到处都有神明施展神力的痕迹，只需调查它们，就能得证。”

使者又接着说道：“不过，以你们现在的科技水平，远远无法读懂神明留下来的宏伟遗迹。那是一个实力深不可测的强大文明，在微观世界近乎做到了主宰，而且有操控宏观世界和多维宇宙的能力，我们生存的这片大地就是神明创造的……”

使者一口气说了噼里啪啦一大堆关于神明的话，包括你和思想家在内根本没人听懂。

[[1.怎样才能与神明通信？]] 
[[2.原来如此，怎样才能发展科技？]]
[[3.一眼丁真，鉴定为纯纯的传销]] </tw-passagedata><tw-passagedata pid="109" name="3.一眼丁真，鉴定为纯纯的传销" tags="" position="1275,3225" size="100,100">你不再听下去，断然说道：“一眼丁真，鉴定为纯纯的传销，请回吧！我不听这种胡话。”

邻国使者被你赶走了。

接下来数年里，风调雨顺，政通人和。邻国对你们没有额外兴趣，仅仅保持通商。

[[异变？]]</tw-passagedata><tw-passagedata pid="110" name="2.原来如此，怎样才能发展科技？" tags="" position="1125,3400" size="100,100">使者一顿，抬头看了看招待之处的内里装潢，然后思索起来。

“我国发展至今日，也花了将近数百年时间。”他说，“对于你们国家，如果没有外力帮助，要发展至我国现在的水平，恐怕要将近千年。”

使者又继续说道：“然而拔苗助长是万万不得的，发展科技，需要有厚实的经济基础，还要有适当的社会结构……”

他噼里啪啦说了一大串晦涩难懂的话，以你们国家现在的平均智力很难理解。

[[1.请求支援基础教育]]
[[2.请求支援基础设施]]
[[3.一眼丁真，鉴定为纯纯的传销]] </tw-passagedata><tw-passagedata pid="111" name="1.坚持己见" tags="" position="1000,3400" size="100,100">你坚持己见，“我不听这种胡话，请回吧！”
[继续]&lt;continue|

(click-replace: ?continue)[


邻国使者被你赶走了。

[继续]&lt;continue2|

]

(click-replace: ?continue2)[


接下来数年里，风调雨顺，政通人和。邻国对你们没有额外兴趣，仅仅保持通商。

[[异变？]]

]
</tw-passagedata><tw-passagedata pid="112" name="2.听听他的说法" tags="" position="875,3400" size="100,100">你和思想家稍作交谈，思想家略一沉吟，委婉地建议你听听使者的意见。

你决定
[[1.怎样才能与神明通信？]] 
[[2.如何证明我们是被创造的？]] 
[[3.神明在哪？]] </tw-passagedata><tw-passagedata pid="113" name="可控核聚变" tags="" position="1225,2875" size="100,100">邻国使者带来随行的物理学家，他一脸严肃，对你们说道：“我接下来要说的事情，你们千万别害怕。”

你：“？”

[继续]&lt;continue|

(click-replace: ?continue)[

物理学家接着说道：“E=mc²。”

你：“？”

这位物理学家花了你也记不得到底多久的时间给你国传授了完整的可控核聚变理论。

&#39;&#39;成就：E=mc²&#39;&#39;

[[异变？]]

]

</tw-passagedata><tw-passagedata pid="114" name="1.漫长的路，看不见光" tags="" position="1050,1950" size="100,100">重建文明的道路并不轻松。

原来的栖息地已经不再宜居，于是你们从废墟中抢救出一些还能用的物资，启程寻找新的栖息地。

路上，你们遇见了

[rd10]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,10))
1-3 强盗
4-6 狩猎的兽群
7-9 军队
0 一束“死”之光

出目结果：(print:+$roll)

(if: $roll &lt;= 3)[点此继续 -&gt;[[1-3 强盗]]]
(else-if:$roll &lt;= 6 and $roll &gt; 3)[点此继续 -&gt;[[4-6 狩猎的兽群]]]
(else-if:$roll &lt;= 9 and $roll &gt; 6)[点此继续 -&gt;[[7-9 军队]]]
(else:)[点此继续 -&gt;[[0 一束“死”之光]]
]
]


</tw-passagedata><tw-passagedata pid="115" name="2.还有希望！" tags="" position="1150,2050" size="100,100">幸运的是，文明很快地被重建起来了。

原来的栖息地已经不再宜居，于是你们从废墟中抢救出一些还能用的物资，启程寻找新的栖息地。

路上，你们遇见了

[rd10]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,10))
1-3 商队
4-6 金矿
7-9 巨大的废墟
0 桃花源

出目结果：(print:+$roll)

(if: $roll &lt;= 3)[点此继续 -&gt;[[1-3 商队]]]
(else-if:$roll &lt;= 6 and $roll &gt; 3)[点此继续 -&gt;[[4-6 金矿]]]
(else-if:$roll &lt;= 9 and $roll &gt; 6)[点此继续 -&gt;[[7-9 巨大的废墟]]]
(else:)[点此继续 -&gt;[[0 桃花源]]
]
]

</tw-passagedata><tw-passagedata pid="116" name="1.组织撤离" tags="" position="225,1375" size="100,100">你果断组织国民撤离。

&#39;&#39;这是一次严峻的自然灾害事件！先让我们针对这次灾难进行检定。&#39;&#39;

(text-colour:red)[&#39;&#39;检定目标事件：这次地震的等级？一个十面的骰子，每个点数对应不同的等级。&#39;&#39;]

[rd10]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,10))
1-3 3.5级地震
4-6 5级地震
7-9 7级地震
0 9级地震

出目结果：(print:+$roll)


(if: $roll &lt;= 3)[点此继续 -&gt;[[3.5级地震]]]
(else-if:$roll &lt;= 6 and $roll &gt; 3)[点此继续 -&gt;[[5级地震]]]
(else-if:$roll &lt;= 9 and $roll &gt; 6)[点此继续 -&gt;[[7级地震]]]
(else:)[点此继续 -&gt;[[9级地震]]
]
]


|2&gt;[(link-rerun:&quot;为什么要这么做？&quot;)[(show:?1)(hide:?2)]]
|1)[详细定义。

对于某些“严重程度有可能影响到游戏结局”的事件，守密人Keeper将进行二次（详细）定义。
&#39;&#39;目标事件是指需要定义的事件的因素，例如时间、地点、大小、高度、相貌（如果是生物的话）、好感度等。&#39;&#39;

这是为了增加游戏的自由度、随机性（不确定性）和可玩性。
对于玩家们来说，二次定义事件有利于他们更好地做出决策。

[(link-rerun:&quot;[收起]&quot;)[(hide:?1)(show:?2)]]

]

</tw-passagedata><tw-passagedata pid="117" name="2.举行大型的祭祀仪式，祈求神明能够阻止地震" tags="" position="175,1675" size="100,100">祭司说道：“突然爆发这么严重的地震，一定是因为我们触怒了神明，我们必须举行仪式，献上礼物，取悦神明。”

[继续]&lt;continue|

(click-replace: ?continue)[

你深以为然。

但是，国内对于是否要给“神明”礼物争吵了起来。

你的意见是

[[1.献上祭品]]
[[2.尝试白嫖]]
]
</tw-passagedata><tw-passagedata pid="118" name="3.冬眠" tags="" position="150,1275" size="100,100">进行骰子检定。

[ra50]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[1.成功]] ]
(else:)[点此继续 -&gt;[[2.失败]] ]

]</tw-passagedata><tw-passagedata pid="119" name="4.开摆" tags="" position="250,1550" size="100,100">大震跑不了，小震不用跑。

你决定开摆。

&#39;&#39;这是一次严峻的自然灾害事件！先让我们针对这次灾难进行检定。&#39;&#39;

(text-colour:red)[&#39;&#39;检定目标事件：这次地震的等级？一个十面的骰子，每个点数对应不同的等级。&#39;&#39;]

[rd10]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,10))
1-3 3.5级地震
4-6 5级地震
7-9 7级地震
0 9级地震

出目结果：(print:+$roll)

出目结果：(print:+$roll)

(if: $roll &lt;= 3)[点此继续 -&gt;[[3.5级地震]]]
(else-if:$roll &lt;= 6 and $roll &gt; 3)[点此继续 -&gt;[[5级地震]]]
(else-if:$roll &lt;= 9 and $roll &gt; 6)[点此继续 -&gt;[[7级地震]]]
(else:)[点此继续 -&gt;[[9级地震]]
]
]


|2&gt;[(link-rerun:&quot;为什么要这么做？&quot;)[(show:?1)(hide:?2)]]
|1)[详细定义。

对于某些“严重程度有可能影响到游戏结局”的事件，守密人Keeper将进行二次（详细）定义。
&#39;&#39;目标事件是指需要定义的事件的因素，例如时间、地点、大小、高度、相貌（如果是生物的话）、好感度等。&#39;&#39;

这是为了增加游戏的自由度、随机性（不确定性）和可玩性。
对于玩家们来说，二次定义事件有利于他们更好地做出决策。

[(link-rerun:&quot;[收起]&quot;)[(hide:?1)(show:?2)]]

]
</tw-passagedata><tw-passagedata pid="120" name="3.5级地震" tags="" position="50,1500" size="100,100">大震跑不了，小震不用跑。

地震仅仅只对你国部分领土造成了破坏。


[[第三回合]] </tw-passagedata><tw-passagedata pid="121" name="5级地震" tags="" position="50,1650" size="100,100">大震跑不了，小震不用跑。

地震对你国的部分领土造成了一定的破坏，(if: (history:) contains &quot;1.组织撤离&quot;)[由于你组织撤离及时，并没有太大的人员伤亡。]

(if: (history:) contains &quot;4.开摆&quot;)[由于你开摆了，造成了一定的人员伤亡和财产损失。

&#39;&#39;状态栏：
统治力↓
社会稳定↓&#39;&#39;

]
重建仅仅只花了几个月。

[[第三回合]] </tw-passagedata><tw-passagedata pid="122" name="7级地震" tags="" position="175,1825" size="100,100">大震跑不了，小震不用跑。

地动山摇，别说是建筑，连山头都在几分钟内完全崩塌。无法计数的国民在地震中死去了，更多人失踪了。从地震开始到文明崩溃，只用了几分钟时间。

[继续]&lt;continue|

(click-replace: ?continue)[


(text-colour:red)[&#39;&#39;7级的地震对你国几乎是一次毁灭性的打击！文明有可能在这一次灾难中消亡……&#39;&#39;

&#39;&#39;这个100面的骰子将决定你国的命运。如果你们得以存活，那么这次天灾将有可能占据你们史书的一部分。&#39;&#39;]

&#39;&#39;连续多次的检定&#39;&#39;

[ra40]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 40))[点此继续 -&gt;[[我们安全了……暂时的]]]
(else:)[点此继续 -&gt;[[废墟之下]]]

|2&gt;[(link-rerun:&quot;连续检定是什么？&quot;)[(show:?1)(hide:?2)]]
|1)[
连续检定。
7级的地震被划分为大地震。这样的地震极有可能发生数次余震，对于你现在的游戏进度来说，任何一次余震都有可能是致命的。
因此，Keeper需要连续进行检定判断。

地质学、地理学相关知识，特别鸣谢SGU旅游与地理学院的友情支援。

[(link-rerun:&quot;[收起]&quot;)[(hide:?1)(show:?2)]]

]


]

]</tw-passagedata><tw-passagedata pid="123" name="9级地震" tags="" position="25,1800" size="100,100">大震跑不了，小震不用跑。

地动山摇，山河悲恸。你们这个文明自从在这片大地上行走起来，还没有如此战栗过。

[继续]&lt;continue|

(click-replace: ?continue)[

(text-colour:red)[&#39;&#39;9级的地震对你国是一次毁灭性的打击！文明极大概率可能在这一次灾难中消亡……&#39;&#39;

&#39;&#39;这个100面的骰子将决定你国的命运。如果你们得以存活，那么这次天灾将占据你们史书的一部分……当然，也有可能占据其他国家的史书的一部分，作为你们存在过的证明。&#39;&#39;]

&#39;&#39;连续多次的检定&#39;&#39;

[ra40]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 40))[点此继续 -&gt;[[我们安全了……暂时的]]]
(else:)[点此继续 -&gt;[[废墟之下]]]

|2&gt;[(link-rerun:&quot;连续检定是什么？&quot;)[(show:?1)(hide:?2)]]
|1)[
连续检定。
7级的地震被划分为大地震。这样的地震极有可能发生数次余震，对于你现在的游戏进度来说，任何一次余震都有可能是致命的。
因此，Keeper需要连续进行检定判断。

地质学、地理学相关知识，特别鸣谢SGU旅游与地理学院的友情支援。

[(link-rerun:&quot;[收起]&quot;)[(hide:?1)(show:?2)]]

]</tw-passagedata><tw-passagedata pid="124" name="我们安全了……暂时的" tags="" position="50,1925" size="100,100">第一次大地震结束了。

仅仅只用了几分钟，你就目睹了河流改道、群山坍塌。天昏地暗，走兽飞鸟争先恐后，趋之若鹜——可笑，此时此刻逃到什么地方去才能自救？趋是往哪趋？

你曾经以为山河是永恒的，现在发现自己的想法太可笑。

[继续]&lt;continue|

(click-replace: ?continue)[

你竭尽所能让国内的关键人物聚集在一起。第一次大震结束后，在短暂的喘息时间里，你与这些人商议接下来的对策。

时间分秒必争，没有时间犹豫。余震随时有可能到来。

[[1.继续撤离]]
(if: (history:) contains &quot;1.宗教的建立&quot;)[[[2.举行大型的祭祀仪式，祈求神明能够阻止地震-&gt;2.举行大型的祭祀仪式，祈求神明能够阻止地震]]]
(if: (history:) contains &quot;1.3.1成功&quot;)[[[3.冬眠-&gt;3.冬眠]]]

]</tw-passagedata><tw-passagedata pid="125" name="废墟之下" tags="" position="125,2150" size="100,100">完全没有时间反应。

地震毁灭了一切，所有那些你们以为永恒的事情：群山、河流、天地，都被地震无情摧毁了。一天前，你的办公处门口有座山，面对东方，每天都能看见太阳从山顶缓缓升起，今天，那座山已经不复存在了。

[继续]&lt;continue|

(click-replace: ?continue)[

曾经你也以为你是永恒的：你从苏醒、穿过有些冷的白气，带领其他智人一起亲手创建了这个文明，采集渔猎到现在的封建集权社会，按照你们的历法计算，已经过去了数千年。你亲眼见证你身边的各个人物死去，又有其他人来继承他们。

唯独你没有。

你曾经以为死亡与你毫不相干。

现在，你错了。

面对天灾，你无能为力。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局13：那些你以为永恒的……
Ende 13: Diejenigen, von denen du dachtest, sie wären ewig ......&#39;&#39;


[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]
]
]
]</tw-passagedata><tw-passagedata pid="126" name="1.继续撤离" tags="" position="0,2150" size="100,100">你断然决定继续撤离。

此时两脚与大地接触，能从身体里感受到大地的呜咽。



[ra30]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 30))[点此继续 -&gt;[[希望在哪里？]]]
(else:)[点此继续 -&gt;[[废墟之下]]]

]</tw-passagedata><tw-passagedata pid="127" name="希望在哪里？" tags="" position="25,2350" size="100,100">漫长的余震结束了，你们迎来了第一个和谐的日出。

家园已经被完全摧毁，看不到希望。

[[百废待兴]]</tw-passagedata><tw-passagedata pid="128" name="未命名片段" tags="" position="1850,3425" size="100,100">

——文明的命运系于你纤细的两指之上——

请选择判定方法：

1.投掷硬币，花面为成功，数字为失败。

2.请用德语将以下STAFF特别鸣谢名单念一遍：

TU Shenzhen Sapphire Stern Sitzung
TU Shenzhen, Insitut für Big Data und Internet
Universität elekrtonische Wissenschaft und Technologie China, Insitut für Informatik und Maschinenbau
TU China, Insitut für Informatik und Technologie
TU Changsha, Insitut für Informatik und kommunikatives Maschinenbau
Universität Shaoguan, Insitut für Tourismus und Geographie</tw-passagedata><tw-passagedata pid="129" name="1.你是？" tags="" position="650,2150" size="100,100">老爷爷：“我是你爹。”

[继续]&lt;continue|

(click-replace: ?continue)[

你：“素质好低。”

老爷爷：“错误的，是作者素质太低导致。……来说正事，旅人啊，你们为何来到此处？”

近身侍卫说道：“邪恶的邻国侵占了我们的家园，我们无处可去，只好流浪。”

[继续]&lt;continue2|

]

(click-replace: ?continue2)[

白毛红瞳唏嘘道：“竟有此事。”

你沉默不语，整支队伍陷入诡异的沉默。

白毛红瞳见气氛如此低沉，找话题道：“为何一定要住在大地上呢？其他地方也是个不错的去处。”

近身侍卫脱口而出：“神经病。”

[[1.说来听听。]]Lasst es uns hören.

]</tw-passagedata><tw-passagedata pid="130" name="2.斗之力，三段！" tags="" position="500,2225" size="100,100">你没忍住玩梗：“斗之力，三段！”

[继续]&lt;continue|

(click-replace: ?continue)[

老爷爷：“哥们，你超游了。”

药尘：“……来说正事，旅人啊，你为何来到此处？”

近身侍卫说道：“邪恶的邻国侵占了我们的家园，我们无处可去，只好流浪。”

[继续]&lt;continue2|

]

(click-replace: ?continue2)[

白毛红瞳唏嘘道：“竟有此事。”

你沉默不语，整支队伍陷入诡异的沉默。

白毛红瞳见气氛如此低沉，找话题道：“为何一定要住在大地上呢？其他地方也是个不错的去处。”

近身侍卫脱口而出：“神经病。”

[[1.说来听听。]]
]

</tw-passagedata><tw-passagedata pid="131" name="3.白毛红瞳可冲" tags="" position="625,2375" size="100,100">“我去，白毛红瞳，可冲。”你不假思索地脱口而出。

白毛红瞳：“啥比二次元，滚！”

(align:&quot;&lt;==&quot;)+(box:&quot;==XXXXX===&quot;)[&#39;&#39;结局14：我去，骨灵冷火！
&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]]</tw-passagedata><tw-passagedata pid="132" name="4.无视" tags="" position="750,2375" size="100,100">你无视了这个会说话的白毛红瞳的老爷爷，命哨兵将戒指扔掉。

白毛红瞳：“不是，我测，怎么就扔了啊！你没看到我头上的感叹号吗？我是特殊NPC你不按一下吗？支线你不开的吗？”

[[1.你是？]] 
[[2.泻药，只推主线]] 
</tw-passagedata><tw-passagedata pid="133" name="1.说来听听。" tags="" position="475,2475" size="100,100">你说：&quot;那你说来听听。&quot;

白毛红瞳：“我有一张巨大无比的魔毯，魔毯之大，不知其几千里也。曾经西域有魔毯国的传说，整个国家建立在这张魔毯之上，其名勒皮他……“

近身侍卫：“果然是个神经病。”

[继续]&lt;continue|

(click-replace: ?continue)[

老爷爷欣然笑道：“我在和你的主子说话。”

你的意见

[[1.建立飞岛国]]
[[2.果然是个神经病]]

]</tw-passagedata><tw-passagedata pid="134" name="2.泻药，只推主线" tags="" position="925,2325" size="100,100">你：“你说得对，但是我只推主线。”

老爷爷：&quot;补药……&quot;

[继续]&lt;continue|

(click-replace: ?continue)[

&#39;&#39;成就：白毛红瞳你能忍啊？你是人？&#39;&#39;

于是，你们在西域驻扎。

[[第三回合]]

]</tw-passagedata><tw-passagedata pid="135" name="1.建立飞岛国" tags="" position="650,2600" size="100,100">你接受了白毛红瞳老爷爷的建议。药尘从纳戒里取出来了那张巨大的毛毯，你们举国搬迁到了魔毯上。

常言西域奇特，狂风呼啸不止，终日不见阳光。

一日，光带上飞驰过一粒细小光点。光带是电磁加速轨道，光点其实是能承受巨大G值的运输用胶囊。

胶囊里的生物俯瞰大地。

//「那是什么。」
「一张毛毯。此事在他们先祖的著作《格列佛游记》里亦有记载。」//

(align:&quot;&lt;==&quot;)+(box:&quot;==XXXXX===&quot;)[&#39;&#39;结局15：飞岛国&#39;&#39;

&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]

]

</tw-passagedata><tw-passagedata pid="136" name="2.果然是个神经病" tags="" position="475,2675" size="100,100">你深以为然：“果然是个神经病。”

哨兵把戒指扔掉了。

于是，你们在西域驻扎。

[[第三回合]]</tw-passagedata><tw-passagedata pid="137" name="1.神经病，企鹅不是在南极吗" tags="" position="750,2125" size="100,100">大思想家：“你说得对。”

帝企鹅慢慢挪动屁股一摇一摆地朝你们走来。

大思想家忽然说道：&quot;我知道一种企鹅，会出现在任何地方。&quot;

[继续]&lt;continue|

(click-replace: ?continue)[

帝企鹅深邃的目光看着你，你也看着深渊。

大思想家的声音是你听到的最后的声音：“阿撒托斯……”

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局16：盲目吃鱼之神
Ende 16:Azathoth,the Great One of blind and stupidity&#39;&#39;


[STAFF名单]&lt;continue3|

]

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]]</tw-passagedata><tw-passagedata pid="138" name="2.可爱，摸摸" tags="" position="825,2100" size="100,100">你没忍住走过去薅了它两把。

并没有你想象得那么好rua。

帝企鹅低头俯视你。

[继续]&lt;continue|

(click-replace: ?continue)[

大思想家急忙跑过来说道：“且慢！那不是一般的企鹅，那是盲目痴愚之神……”

帝企鹅张开了喙。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局16：盲目吃鱼之神
Ende 16:Azathoth,the Great One of blind and stupidity&#39;&#39;


[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]]

]</tw-passagedata><tw-passagedata pid="139" name="1.支持骑士" tags="" position="1500,3600" size="100,100">(if:(history:)does not contain &quot;3.思想家，你怎么看？&quot;)[你没有听市民的投诉，断然说道：“来人把今日起事的蠢货都抓起来！”\

侍卫一拥而上，市民受惊叫喊，混乱之中，一个屠夫手起刀落，将骑士的头颅割下。\

次日，你的使者快马将消息传播至全国各地。听完使者念谕旨，愤怒的市民将你的使者扔出了窗外。\
]

(if:(history:)contains &quot;3.思想家，你怎么看？&quot;)[你决定稳固皇权。\

“来人把今日起事的蠢货都抓起来！”\

侍卫一拥而上，市民受惊叫喊，混乱之中，一个屠夫手起刀落，将骑士的头颅割下。\

次日，你的使者快马将消息传播至全国各地。听完使者念谕旨，愤怒的市民将你的使者扔出了窗外。\
]

[继续]&lt;continue|

(click-replace: ?continue)[

&#39;&#39;成就：掷出窗外&#39;&#39;

由资产阶级和市民阶级带领的资产阶级革命爆发了。

[[革命的烈火]]

]</tw-passagedata><tw-passagedata pid="140" name="2.支持市民" tags="" position="1625,3600" size="100,100">你说道：“我认可你们的检举，但事情来龙去脉得调查取证后再作定夺。”

数日后，检察官将厚厚的案卷交给你，骑士对欺压民众的事情供认不讳，证据确凿，你判他下狱。

[继续]&lt;continue|

(click-replace: ?continue)[

市民对于减轻商业税的呼声越来越高，于是，你放开了对商业的限制，大力发展资本主义经济。经济基础稳固后，资产阶级随即对政治权利提出了要求。

革命开始了。一场流血不多的资产阶级民主革命，为这个文明敲开了民主共和的大门。

[[共和时代-&gt;过渡1]]

]

</tw-passagedata><tw-passagedata pid="141" name="3.思想家，你怎么看？" tags="" position="1375,3600" size="100,100">思想家说道：“看待事物，不能只看到表面，必须认清事物的本质。”

[继续]&lt;continue|

(click-replace: ?continue)[

思想家接着说道：“您可以思考一下，是什么导致了市民暴动？又是什么导致了骑士攻击市民？”

[灵感检定]&lt;rolldice|

]

(click-replace:?rolldice)[

(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[灵光一现]]]
(else:)[点此继续 -&gt;[[毫无头绪]]]

]
</tw-passagedata><tw-passagedata pid="142" name="革命的烈火" tags="" position="1450,3725" size="100,100">在这之后的某一天，你在日记中写下：“今日无事。”随后便回到床上小憩。虽然只打算打个盹，但你还是昏昏沉沉地进入了梦与现实之间的间隙。你的脑子里开始出现各种稀奇古怪的事情：天上的光带、驰骋在光带上的小点儿、小点儿上俯视你们的生物……但就在你即将沉沉睡去之间，总务官撞开了你卧室的门，把你惊醒。

[为何叨扰？]&lt;continue|

(click-replace: ?continue)[

总务官向你汇报了一座港口城市沦陷的消息。

“这支有武装的队伍正在向首都开拔。”总务官说道，脸色苍白，似是心有余悸。

“你是给我带来了一个造反的消息。”你说。

旁边的思想家忽然插嘴，“不是的，陛下。”他说，“这是一场革命。”

[[武装镇压]]
[[谈判]]
[[逃跑]]
(if: (history:) contains &quot;1.3.1成功&quot;)[[[冬眠-&gt;冬眠]]]\

]</tw-passagedata><tw-passagedata pid="143" name="那个改变文明命运的……" tags="" position="1750,3700" size="100,100">(if:(history:)contains &quot;灵光一现&quot;and &quot;进步的歌声&quot;)
[你决定派出一支考古队，沿着你记忆中的路线回访那个冬眠基地。
“如果它真的存在，也有数千年的历史了。”考古队队长说道。
你轻轻颔首，年轻的队员们看你的眼神就像看到鬼一样。
“不管怎样，我们还是出发吧。这是探访人类文明起源的道路。”考古队队长说道。

[出发]&lt;losgeht|

]

(click-replace: ?losgeht)[

你们来到了当年的冬眠基地。基地附近已经完成了封锁，除了施工队和考古队，不会有闲杂人等踏入。锈迹斑斑、长满苔藓的冬眠基地正门附近，考古队员正在测试空气成分。

[[1.只是看着]]
[[2.玩一下检测仪器]]
[[3.打开门进去]]

]


(if:(history:)does not contain &quot;灵光一现 &quot; or &quot;进步的歌声&quot;)[国家考古队日前发现了一处巨大的古代遗址。由于规模空前，相关机构和你批准了一大笔经费用于详细调查。队员们花费了数个月时间才大致掌握遗址的具体边界，并进行了初步调查。

[继续]&lt;continue|

]

(click-replace: ?continue)[

//已经过去数千年了。这个文明终于又回到他们苏醒的地方了。在这数千年里，这个文明含辛茹苦，摸爬滚打，艰难地发展，天灾人祸都没有击倒他们。他们建立了完善的科学体系，开始用理性和辩证的思维看待整个世界，将进化论和经典力学视作真理。但是，从现在起，他们的一切认知都要被击碎了。//

[继续]&lt;continue2|

]

(click-replace: ?continue2)[

考古队员意外地发现，这座巨大的遗址并不是陵墓或者废墟，而是一个科研基地。原本，队员们以为是某个衰落的强大帝国曾经拥有的科研所，因为战争或者迁徙等原因废弃了；但是，这里面的东西完全颠覆了队员们的认知。

内里的设备不在队员的知识储备范围内，光看外形也无法猜测出其用途。——而且，其外形之古怪，让队员们无法理解——“这是给什么生物用的？”

[继续]&lt;continue3|

]

(click-replace: ?continue3)[
//这个文明有探索一切未知的好奇和勇气，也有谦虚的心。他们认同外星生物的存在，但从没有想过外星生物离自己这么近。//

多年以后，面对Arrietty的代表时，你将会回想起考古队员发掘出来冬眠遗址的那个遥远下午。

你们花了很长很长时间调查这个遗址，最终确定了：

[继续]&lt;continue4|

]

(click-replace: ?continue4)[

这是一个非人类的智慧生物创造的基地。从设备设计习惯、内部结构来看，都绝对不可能是人类所为。它绝不可能是自然形成，电路设计的精妙和其精度是现在的人类文明望尘莫及的。这意味着创造它的生物拥有强大、恐怖的科技实力。

而且，你看着这个被泥土、石头、植物、灰尘等各种各样东西掩埋的基地，回想起了睁开眼睛的那一瞬，从冬眠舱里爬出来，穿过稍稍有些冷的白气，看见的世界的第一幕。仪器的摆放位置和那时一模一样，只不过当时的你完全没有在意它们，你还没有了解它们的基础知识。现在的你终于意识到，那时的你——那一批智人——是从这里苏醒的。

那是冬眠。你从漫长的睡梦中醒来，然后，突兀地出现在了大地之上。

&#39;&#39;人类文明，是被创造的。&#39;&#39;

[继续]&lt;continue5|

]

(click-replace: ?continue5)[

这一发现在社会上掀起了轩然大波，已有的科学体系受到猛烈的攻击。全国上下都在问同一件事情：“我们是从哪来的？”

作为文明的执政者，你

[[1.封杀所有类似言论，实行思想专制]]
[[2.尝试调查这个强大的未知文明]]

(text-colour:red)[请谨慎选择。]

]

</tw-passagedata><tw-passagedata pid="144" name="灵光一现" tags="" position="1300,3850" size="100,100">(if:(history:)contains &quot;3.思想家，你怎么看？&quot;)[你看着眼前这名思想家：他已经不是你从冬眠苏醒后认识的那个了，已经过去几千年了，许多职位上的人已经换了几十遍了。

“你是说，”你说，“骑士代表的是封建势力，市民们则是新兴资产阶级的代表。”

思想家颔首：“是的。”

“是要支持资本主义经济发展，还是保持帝国的原样？”

[[1.支持骑士]]
[[2.支持市民]]

]

(if:(history:)contains &quot;进步的歌声&quot;)[
你忽然想起来非常久远的事情。那真是离现在很久远的了，将近数千年，你也是现在才意识到你居然没有像其他人一样经历死亡。但是你记得，你在冬眠舱里苏醒，穿过有些稍稍冷的白气，然后屹立在大地之上。
“我们……我们好像也是从那样的冬眠舱里走出来的。”你有些怔然。
科学家不以为意，“都是这样的，所有文明都是这样被创造出来的。”

你感觉你有些事情想考虑一下。

[[那个改变文明命运的……]]

]

(if:(history:)contains &quot;总控&quot;)[你隐约记起来了。当时，穿过稍稍有些冷的白气，穿过几道门，到达的就是这里。但是当时的你对这里一无所知。

考古队员中具有相对丰富的机械知识的人蹲在机器面前观察，“看不出来是做什么用的，”他说，伸手触碰了一下生锈的铁板，表面脆得立刻从主体上剥离跌成了铁粉，“氧化得不成样子了，估计捱不到搬出去。”

你大概还记得冬眠舱的位置。

[[1.前往冬眠舱]]

]
</tw-passagedata><tw-passagedata pid="145" name="毫无头绪" tags="" position="1250,3750" size="100,100">你没有任何头绪，这位年轻的思想家没忍住槽了一句：“好蠢。”

[[1.支持骑士]]
[[2.支持市民]] 
</tw-passagedata><tw-passagedata pid="146" name="1.封杀所有类似言论，实行思想专制" tags="" position="1625,3850" size="100,100">你意识到再让这种思想在国家里扩散下去非常危险，于是你立刻下令将扩散这个消息的所有人员逮捕下狱，封锁了那个神秘的冬眠基地。

对于已经扩散出去的部分，你派出大量宣传口舌与之辩驳，极力证明冬眠基地并不存在，一切只是某个考古队员的臆想。同时，你尝试让一部分考古队员更改说辞，让他们证明这个队员患有严重的精神疾病，是他编造了这一切。

“我不能认可您的做法，”一个年轻的考古队员说道，他来自国家的北部边界，自幼在多元文化环境下成长，说话有浓重的邻国口音，“我们无意要动摇您的统治，只是想追求真理。”

[继续调查，会导致文明毁灭]&lt;continue|

(click-replace: ?continue)[

“这很危险，”你说，“继续调查那个地方，也许会导致整个文明毁灭。”

年轻人说：“您是对的。您一直都是对的。数千年前您从那个地方苏醒，带领这个文明走到今天，您面对了数不胜数的灾难，在死神的手里抢夺子民的生命，如果没有您，我的父亲肯定会死在那次战争里，也就没有我了。”

年轻人顿了一下，又接着说道：“可是我怎么会不知道，您的用心良苦。我去了那个地方，从那儿活着走出来，您信我：要从那个地方镇定自若地走出来并不容易。那里的机器设备不仅是厉害，而且很可怕，看了叫人浑身起鸡皮疙瘩。我接受了高等教育，取得了考古学的学位，我深刻地清楚要与制造出这些机械的文明为敌是天字第一号的蠢事。”

[我知道你在想什么。]&lt;continue2|

]

(click-replace: ?continue2)[

你沉默，然后缓缓说道：“我知道你在想什么。”

年轻人轻轻地点了点头。

“即便如此，如果什么也不做，不去了解我们诞生的真相，而是就这样浑浑噩噩地活下去，那真的是——太可悲了。”

[你说的是对的。]&lt;continue3|

]

(click-replace: ?continue3)[

你说：“你的想法确实是对的。”

然后，你顿了一下，“但是，在安全的摇篮里午睡有什么不好？固然我们不能断定继续调查就一定会导致灭亡，但是危险性已经体现出来了。只要有一丁点不确定，我都不愿意去冒险。”

年轻人沉默了，他深深地看着你。

“您一直将我们保护得很好，”他说，“现在也是。我理解您的决定。谢谢您一路走来将我们保护得这么好。”

直到这一刻你才仔细地审视眼前这个年轻人的脸：他完成了高等教育的学业，已经在考古队工作了数年，脸庞却依旧稚嫩，有股学生的气息。他的眼神一样清澈、平静，甚至有些悲伤。

年轻人把手揣进口袋里，这个动作让你心里一紧。

[[什么也不做]]
[[你要做什么？！]]

]
</tw-passagedata><tw-passagedata pid="147" name="2.尝试调查这个强大的未知文明" tags="" position="1750,3850" size="100,100">思想家——数千年过去了，担任所有职位的人都已经换过很多遍了，现在这位新来的思想家是一个强势的人——态度激烈而坚决，“我们必须搞清楚我们是怎么来的。”

总务官则不赞成他的意见，“那个文明强得可怕，继续深入调查，恐怕会招来杀身之祸。”

思想家反驳道：“那就这样永远无知吗？而且谁知道那个文明现在是什么状态，你不去了解，他们难道就不会回来找吗？”

科学官说：“你的说法虽然扯淡，但是不能排除可能性。”

[我认为他的说法是对的。]&lt;continue|

(click-replace: ?continue)[

你顿了顿，接着说道：“况且，那个文明发展程度这么高，我们在调查它们的过程中也能发展自己。”

思想家连连点头，科学官和教育官也表示了赞成，总务官叹了口气。

针对未知文明的调查开始了。首先做的是调查那些古怪的机器设备，将它们运回了首都的研究所，逐个拆卸研究里面的机械和电路结构。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;成就：科技考古&#39;&#39;]

[[Peter S. Morgan]]


]
</tw-passagedata><tw-passagedata pid="148" name="1-3 强盗" tags="" position="1050,2275" size="100,100">你们在路上遇见了一伙强盗。这些人属于北方的游牧民族，高大威猛、骑着黑棕色的马。见你们异常落魄，便心生歹意。

事发突然，你没有时间准备，匆忙与强盗打起了遭遇战。

[ra50]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[漫长的道路]]]
(else:)[点此继续 -&gt;[[无名之卒之死]]]

]</tw-passagedata><tw-passagedata pid="149" name="4-6 狩猎的兽群" tags="" position="1200,2250" size="100,100">正是群兽狩猎的季节。你们迁徙的道路上要穿过一片草原，素来是凶险之地。

野兽群的规模

[rd100]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,100))
出目结果：(print:+$roll)

1-50 小型兽群
51-79 中型兽群
80-99 大型兽群
0 ？
0 ？

(if:$roll &lt;= 50)[点此继续 -&gt;[[小型兽群]]
](else-if:$roll &gt;50 and $roll &lt;= 79)[点此继续 -&gt;[[中型兽群]]
](else-if:$roll &gt;= 80 and $roll &lt;= 99)[点此继续 -&gt;[[大型兽群]]
](else:)[点此继续 -&gt;[[增殖的G]]
]

]

</tw-passagedata><tw-passagedata pid="150" name="7-9 军队" tags="" position="925,2200" size="100,100">你们在路上遇见了一支全副武装的军队。
从装束上来看，是北方游牧民族的军队。高大威猛、骑着黑棕色的马。

[[1.过躲藏检定]]

[[2.向军队求援]]

</tw-passagedata><tw-passagedata pid="151" name="0 一束“死”之光" tags="" position="1075,2125" size="100,100">你们在迁徙的路上。夜晚，星象官在观察星象，忽然大惊失色。

(if: (history:) contains &quot;1.3.1成功&quot;)[“冬眠！快冬眠！诅咒之光来了！”星象官大喊道，急切地将尽可能更多的人叫醒。你睡眼朦胧地睁开眼睛，只来得及看到刺眼的白光，随即便被灼伤了视网膜，与其他人一起堙灭在白茫茫的光里。]


(if: (history:)does not contain &quot;1.3.1成功&quot;)[“快跑！快跑！有多远跑多远！是诅咒之光！”星象官大喊道，急切地将尽可能更多的人叫醒。你睡眼朦胧地睁开眼睛，只来得及看到刺眼的白光，随即便被灼伤了视网膜，与其他人一起堙灭在白茫茫的光里。]

[光带]&lt;continue|

(click-replace: ?continue)[


此刻，光带上飞驰过一粒细小光点。光带是电磁加速轨道，光点其实是能承受巨大G值的运输用胶囊。

胶囊里的生物俯瞰大地。

//「你做了什么？」
「简单的清理。」//

&#39;&#39;结局20：大灭绝
&#39;&#39;


[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]

]</tw-passagedata><tw-passagedata pid="152" name="武装镇压" tags="" position="1475,3850" size="100,100">(if:(history:)contains &quot;实现更进一步的中央集权&quot; or &quot;不错，看看你的&quot;)[
你派出军队前往叛乱地进行武装镇压。

新兴的市民阶级虽然一腔热血，但经过你多年的集权措施，地方很难组织起像样的武装了。你安插在他们领导层之中的细作传来消息，他们决定远渡大洋对岸，向其他大陆求援。

思想家指责你的行为：“这是在与历史的车轮作对，您会遭报应的！”

你没有听他的劝谏，而是处了他绞刑。

[继续]&lt;continue|

(click-replace: ?continue)[

内务官为你报告完短讯，便把密文烧掉。“神经病，”她说，“世人都知道，超出海域三百五十海里之外的地方是魔境。”

从来没有人能够越过350海里。据说350海里以外的海域凶险异常，船只只要越过那个界限就会立刻被海怪扑杀。

你说：“他们不过是垂死挣扎。”

内务官崇敬地对你行礼：”荣光归于太阳王和帝国。“

[继续]&lt;continue2|
]
(click-replace: ?continue2)[

禁卫军的元帅将最后一名叛军头领的头颅割下，宣告了革命的彻底失败。

&#39;&#39;成就：与太阳一样永恒的皇权&#39;&#39;

这一年的国庆典礼，所有人振臂高呼：“荣光归于太阳王和帝国！”

&#39;&#39;成就：神圣罗马帝国&#39;&#39;

[[那个改变文明命运的……]]

]

]

(if:(history:)does not contain &quot;实现更进一步的中央集权&quot;or &quot;不错，看看你的&quot;)[
你派出军队前往叛乱地进行武装镇压。

革命党人来势汹汹，他们有完善的武装力量，还获得了其他国家的武器支援。你的军队节节败退，大片土地沦陷——按照革命党人的说法是“解放”。

总务官判断事情已经无法挽回，“请您现在冬眠或者随我一起逃走吧。”他诚恳地建议道。

[[冬眠]]
[[逃跑]]
[[死也要站着死]]

]</tw-passagedata><tw-passagedata pid="153" name="谈判" tags="" position="1300,3975" size="100,100">你与革命党领导人通电，希望能与其谈判。

[ra50]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[国运象征]]] 
(else:)[点此继续 -&gt;[[断头台]]] 

]</tw-passagedata><tw-passagedata pid="154" name="逃跑" tags="" position="1425,3975" size="100,100">“将军走此小道！”总务官掩护你在地下深处的密道穿梭，这条密道将直达首都外，而外面已经备好了汽车。

就在你们从密道另一端的出口爬出来时，远远就听见叫喊声：“抓红衣服的！”

你仓皇将外衣脱下扔在地上，和总务官往声音的反方向逃跑。

[继续]&lt;continue|

(click-replace: ?continue)[

但你们没能逃出革命党人的天罗地网。冷箭将总务官的头颅贯穿，远远地又传来一声枪响，燧发枪的子弹将你的胸口击穿。

在生命结束前的最后一刻，你忽然想起来，这位总务官已经不是当初那个总务官了，没有变的只是职位的名字，担任它的人却已经换了很多次——因为已经过去了几千年了。

“确认一下，他死了没有……”革命党人的声音。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局17：那些与时代洪流作对的&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]
]
]

</tw-passagedata><tw-passagedata pid="155" name="漫长的道路" tags="" position="1000,2450" size="100,100">近身侍卫和武士拼死作战，最终战胜了强盗。独臂的近身侍卫将强盗头目的头颅割下，奋力往残存的势力之中扔去。

头颅击中了一个仓皇逃窜的喽啰，将他打得跌至马下，受惊的战马扬起前蹄，将倒地的喽啰的胸膛踩穿。

后来，你们找到了一片相对适合的平原定居。

&#39;&#39;当前社会状态：
几乎要崩溃的暂时性的集权组织&#39;&#39;

[[第三回合]]</tw-passagedata><tw-passagedata pid="156" name="无名之卒之死" tags="" position="1100,2625" size="100,100">(if:(history:)contains&quot;1.过躲藏检定&quot;)[门口的伪装被突然掀开，几名哨兵打扮的人提着武器，站在洞口张望。]

强盗的弯刀将侍卫最后一条手臂也砍下，又在他的胸口上砍下深深一刀。

冷箭从背后将你的心脏贯穿。

你没有留下姓名，与这个同样没有留下姓名的文明一起，被淹没在了历史的长河之中。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局19：无名之卒之死
Ende 19: Tod eines unbekannten Soldaten&#39;&#39;


[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]]</tw-passagedata><tw-passagedata pid="157" name="小型兽群" tags="" position="1350,2350" size="100,100">一群郊狼缠上了你们。

郊狼算不得是什么强大的动物，有些郊狼的体型比狗都小。你们没有费多少力气便把它们全部杀掉了。

灾难结束后，还是第一次吃上这么丰盛的餐食，虽然总务官觉得很难吃。

后来，你们找到了一片相对适合的平原定居。

&#39;&#39;当前社会状态：
几乎要崩溃的暂时性的集权组织&#39;&#39;

[[第三回合]]</tw-passagedata><tw-passagedata pid="158" name="中型兽群" tags="" position="1250,2375" size="100,100">一群野猪发现了你们。

这些野猪说不上小，其中有些的体型跟人类差不多大。而且它们数量非常多，对于现在的你们来说是个不小的威胁。

独臂的近身侍卫看着你：“我们该怎么办？”

[[1.润]]
[[2.迎击]]
[[3.尝试用野猪语与其交流]]</tw-passagedata><tw-passagedata pid="159" name="大型兽群" tags="" position="1100,2475" size="100,100">出现在你们面前的是狩猎的狮群。

独臂的近身侍卫建议你绕开它们行动。

&#39;&#39;躲藏检定。&#39;&#39;
目标事件：是否被狮群发现？一个一百面的骰子，大于50则是，反之则否。

[ra50]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[惶惶不安]]]
(else:)[点此继续 -&gt;你说是谁的食物]

]

</tw-passagedata><tw-passagedata pid="160" name="什么也不做" tags="" position="1750,3975" size="100,100">你什么也没有做。尽管与这位年轻人是第一次见面，但短短几分钟的交谈里，你已经大概清楚了对方的性格，你知道他不会做出弑君的事情。而且，你大概知道他要做什么。

果不其然对方摸出来了一把手枪。这是一把老式手枪，枪身上有数道划痕，那不是使用磨损，而是使用者用这支手枪击杀敌人的数量。在这个年轻人有限的人生里，国家一直很和平，所以这把枪应该是他父亲传承给他的，他的父亲是个军人。年轻人熟练地拆除保险、拉动枪栓上膛，你闻到枪油味儿。

“您做出了您的决定，我代表我们这个文明对您一直以来的守护感谢您。同样，我也代表我的同伴——那些不愿意就这样被蒙蔽，愚昧地度过一生的人——告诉您我的决定。”

年轻人郑重地说道，在最后一个字落下的那一刻，他把枪口对准了自己，扣动了扳机。

这是唯一一个有杀死你的机会，但并没有选择杀死你的人。在这之后，他的同伴（他们称呼自己为“真理派”）用了各种办法抗争，你遭遇的刺杀次数比天上的星星都多。但直到最后你也没有改变自己的想法，而是将政策贯彻到底。

自遥远天边传来的低沉轰鸣声，大地震动了数下。冬眠基地的爆破拆除工作已经结束，一枚小型的核弹将那个庞大的遗址彻底夷为平地。

封锁不一定就代表着落后，它也有可能是一种保护。

[胶囊里的小人阿莉埃蒂]&lt;continue|

(click-replace: ?continue)[

一日，光带上飞驰过一粒细小光点。光带是电磁加速轨道，光点其实是能承受巨大G值的运输用胶囊，不过现在主要作为观测和观光使用。

胶囊里的生物俯瞰大地。

//「他们这是在做什么。」
「不知道。没有对他们的进化做出干预，这是他们自发决策的。」
「自发的，但是和历史上是一样的。」
「是的，此事在他们的先祖创作《楚门的世界》里亦有记载。」//

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;True End 楚门的世界&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]]

]</tw-passagedata><tw-passagedata pid="161" name="你要做什么？！" tags="" position="1625,4100" size="100,100">你下意识地喊出了声：“你要做什么？！”

那个年轻人什么也没有说，只是用平静的眼神看着你，然后慢慢地将手枪从口袋里掏了出来。他动作缓慢却熟练地将手枪保险拆除，然后拉动枪栓上膛。

直到这一刻你才意识到自己错了。这个年轻人绝不是要杀你，如果他想杀你，他不会让你意识到他在摸枪。

他最后也没有说一句话。该说的都已经说完了。剩下的不能言喻的，也通过他那对清澈的双眼告诉你了——

“您做出了您的决定，我代表我们这个文明对您一直以来的守护感谢您。同样，我也代表我的同伴——那些不愿意就这样被蒙蔽，愚昧地度过一生的人——告诉您我的决定。”

他把枪口对准了自己，扣动了扳机。

这是唯一一个有杀死你的机会，但并没有选择杀死你的人。在这之后，他的同伴（他们称呼自己为“真理派”）用了各种办法抗争，你遭遇的刺杀次数比天上的星星都多。但直到最后你也没有改变自己的想法，而是将政策贯彻到底。

自遥远天边传来的低沉轰鸣声，大地震动了数下。冬眠基地的爆破拆除工作已经结束，一枚小型的核弹将那个庞大的遗址彻底夷为平地。

封锁不一定就代表着落后，它也有可能是一种保护。

[胶囊里的小人阿莉埃蒂]&lt;continue|

(click-replace: ?continue)[

一日，光带上飞驰过一粒细小光点。光带是电磁加速轨道，光点其实是能承受巨大G值的运输用胶囊，不过现在主要作为观测和观光使用。

胶囊里的生物俯瞰大地。

//「他们这是在做什么。」
「不知道。没有对他们的进化做出干预，这是他们自发决策的。」
「自发的，但是和历史上是一样的。」
「是的，此事在他们的先祖创作《楚门的世界》里亦有记载。」//

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;True End 楚门的世界&#39;&#39;
&#39;&#39;Trumanschen Welt&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]]

]</tw-passagedata><tw-passagedata pid="162" name="冬眠" tags="" position="1550,3975" size="100,100">你接受了总务官的建议，匆忙准备冬眠。

炮声震天，你在近身侍卫的带领下抵达地下深处的防空洞，躺进了冬眠舱里。舱门关闭，外部开始注入培养液。你在即将睡去之前，忽然想起来了第一次睁开眼睛——也就是刚获得生命的那一刻——时，你也是从这样的培养舱里走了出来。

冬眠是一种时间轴上的跃迁。问题并没有解决，而是留到了以后。在你沉睡的这一段时间里，支持你的官员会将资产阶级革命派赶尽杀绝。

[[苏醒]]</tw-passagedata><tw-passagedata pid="163" name="苏醒" tags="" position="1425,4100" size="100,100">你苏醒时，感觉到全身各处酸痛无比，说明唤醒的程序并不合规。你在机器的帮助下艰难地起身，一坐起，额头就撞在了冰冷的枪口上。

许多人围绕在你的冬眠舱旁边。你并不认识他们，但大概能猜测出来他们的意图，尤其他们身穿一样的制服，上面的徽记和你冬眠前时见到的一模一样。

“没有时间介绍了，”领头人，也就是那个用手枪指着你额头的人说道，“但是出于礼貌，我还是简单快速地介绍一下自己。我是共和国的代理大总统，封建帝制于昨日废除，最后的保皇党在一个月前被处以绞刑。”

“你已经活够了，你从冬眠苏醒的那一天一直统治这个文明到再次冬眠，千年的风风雨雨，你都带着这个文明走过来了。你该退休了，接下来的路不用走了……你早就想这样做了。”领头人宣告道。

你本来想再说点什么——你想知道在你冬眠期间发生了什么，但是眼前这位大总统显然是个狠辣果断的角色，他没有给你反应的时间，就扣下了扳机——连续数次，直至清空弹匣。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局17：那些与时代洪流作对的&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]
]
</tw-passagedata><tw-passagedata pid="164" name="1.润" tags="" position="1525,2700" size="100,100">你们决定逃跑。

[ra50]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[惶惶不安]]]
(else:)[点此继续 -&gt;[[你说是谁的食物]]]

]</tw-passagedata><tw-passagedata pid="165" name="2.迎击" tags="" position="1675,2675" size="100,100">你说：“这是珍贵的食物来源，不能就这样浪费了。”

独臂的侍卫无言。

[ra50]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[今晚加餐]]]
(else:)[点此继续 -&gt;[[你说是谁的食物]]]

]
</tw-passagedata><tw-passagedata pid="166" name="3.尝试用野猪语与其交流" tags="" position="1800,2700" size="100,100">你尝试与野猪交流。

野猪用黝黑的瞳孔盯了你一会儿，猛地抬起粗壮的猪牙把你铜丝了。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[=
&#39;&#39;结局23：别发癫&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]

</tw-passagedata><tw-passagedata pid="167" name="今晚加餐" tags="" position="1650,2825" size="100,100">半个小时后，你把吃干净的野猪腿掰断，吃掉了里面的骨髓。

你们找到了一个较为宜居的平原，在此定居。

&#39;&#39;当前社会状态：
几乎要崩溃的暂时性的集权组织&#39;&#39;

[[第三回合]]</tw-passagedata><tw-passagedata pid="168" name="你说是谁的食物" tags="" position="1800,2825" size="100,100">(if: (history:) contains &quot;中型兽群&quot;)[成人一般庞大的野猪将独臂的侍卫推倒在地，锐利的獠牙将侍卫的胸口贯穿。]

(if: (history:) contains &quot;大型兽群&quot;)[狮群冲散了你们的队伍，断裂的人体组织随处可见。]

你躺在泥泞的土地上，望着数千年未曾变过的天空，天上有一道光带，偶尔能看到一粒光点在光带上飞驰，光点上似乎有生物，当你注视着飞驰着的光点时，能意识得到自己在与上面的生物对视。

你忽然想到一件事——

[继续]&lt;continue|

(click-replace: ?continue)[

你好像从来没意识到，从苏醒到现在死前，你已经度过数千年的岁月了。

&#39;&#39;结局18：那个以为自己逃出生死的&#39;&#39;

[STAFF名单]&lt;continue3|

]

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]




</tw-passagedata><tw-passagedata pid="169" name="殖民时代" tags="" position="1450,1825" size="100,100">国内和邻国的市场已经不能再满足你国商品经济发展的要求，于是你们转而向更远的、从未探索过的地方进发。

商队凭借武力接二连三地开辟了几个繁荣的港口，以强硬的态度要求当地人用等价物交换你们的商品。

[继续]&lt;continue|

(click-replace: ?continue)[

与此同时，基础科学及其应用得到了新的发展：有人提出来了地圆说，认为地球实际是个球体。许多信奉此说法的船长和水手扬起桅杆上的白帆，决意证明此说，但没有一支船队成功回来，最远只能到达大洋对岸的一片大陆，不超过350海里。先行的商队在其中发现了珍贵的矿产和香料。为了牟取其中的巨额利润，许多人参与到殖民运动的队伍里来。

殖民时代开启了。国家的领土在你自己也不能控制的情况下无限地扩张。

[[异变？]]

]

</tw-passagedata><tw-passagedata pid="170" name="2.请求支援基础设施" tags="" position="1050,3525" size="100,100">你说：“请援助我国建设经济，为此我们可以签订贸易合约。”

邻国使者欣然同意了，他答道他会将你的意愿回复给他们的大总统。

数日后，总统与你通信，与你国签订了协议。由共和国援助你们建设基础设施，而你们开放贸易政策吸纳他们的工业转移。

&#39;&#39;成就：开放国关&#39;&#39;

又过了数年，全国电网铺设完毕，总工程师在本国民众和邻国记者的见证下拉动电闸，黑夜之中亮起了密密麻麻的光点。

&#39;&#39;当前社会状态：初步实现近代化&#39;&#39;

[[异变？]]</tw-passagedata><tw-passagedata pid="171" name="1.请求支援基础教育" tags="" position="900,3525" size="100,100">你与使者商议：“我国派出约一百名学者，前往贵国接受高等教育，为此我们可以签订土地和贸易合约。”
使者欣然同意，答应将你的意愿回复给他们的大总统。

数日后，总统回电，同意了你的提议。教育官和科学官连夜草拟了一份名单呈交给你。
一年后，一百人的留学团出发前往共和国，在各个领域和专业攻读深造。

&#39;&#39;“公派留学”将在下回合进行结算。&#39;&#39;

[[进步的歌声]]</tw-passagedata><tw-passagedata pid="172" name="进步的歌声" tags="" position="975,3675" size="100,100">&#39;&#39;行动：公派留学 已结束&#39;&#39;

若干年后，留学团陆续返回国内，也有人选择留在了共和国。
这些人带来了先进的科学知识、管理体制、思想观念，他们满腔热血，脑子里的点子比天上的星星还多，各执其词，经常争论得面红耳赤。但他们的要求都出奇地一致：(text-colour:red)[变革现有的社会体系]。

“我看见了文明的曙光。”思想家这么说道。

[[1.变革社会思想]]
[[2.变革社会体制]]
[[3.发展科技]]

</tw-passagedata><tw-passagedata pid="173" name="1.变革社会思想" tags="" position="750,3775" size="100,100">“我们要引入平等、自由、博爱的新式思想！现在的主流思想太落后了，国家会因此灭亡的。”这位留学归来的新的思想家挥舞着拳头呐喊道。

//KP批注：通常来讲，对于KP不擅长的部分，会使用安价和安科。然而本游戏并非即时交互，即便我可以插入一个inputbox，KP也不能给出渲染。
本游戏实质只是一个小组作业，KP并不想在PPE部分进行过于深入的交流和讨论（也并没有这个实力），因此对于公派留学的部分只能烂尾。pl若有想续写的，请通过gitee上的邮件地址联系kp。</tw-passagedata><tw-passagedata pid="174" name="2.变革社会体制" tags="" position="925,3800" size="100,100">“我们必须更改现有的社会体制。”留学归来的政治家、思想家们虽然对于未来政体争论不休，但是对于这部分观点一致。


[rd10]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,10))

1-5 资产阶级共和国
6-0 共产主义共和国


出目结果：(print:+$roll)


(if: ($roll &lt;= 5))[点此继续 -&gt;[[资产阶级共和国]]
](else:)[点此继续 -&gt;[[共产主义共和国]]]

]


</tw-passagedata><tw-passagedata pid="175" name="惶惶不安" tags="" position="1525,2850" size="100,100">你们东躲西藏，度过了惶惶不安、忧心忡忡、担惊受怕的几天，终于找到了一处宜居地。

[[第三回合]]</tw-passagedata><tw-passagedata pid="176" name="死也要站着死" tags="" position="1525,4225" size="100,100">你拒绝了他的建议，“朕是皇帝，死也要站着死！”

总务官无言。

没有过多久，革命党攻下了首都，你被推上了断头台。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局18：站着死&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]]</tw-passagedata><tw-passagedata pid="177" name="毫无波澜" tags="" position="2075,2075" size="100,100">邻国对此一点反应也没有。

&#39;&#39;状态栏
经济水平↑↑&#39;&#39;


[[异变？]]

</tw-passagedata><tw-passagedata pid="178" name="颇有微词" tags="" position="1875,2275" size="100,100">邻国对此颇有微词，贸易时总是表现出不满的态度。

对此，你

[[1.出台贸易限制政策]]
[[2.无视]]</tw-passagedata><tw-passagedata pid="179" name="发动战争" tags="" position="1950,2425" size="100,100">邻国悍然借此发动了战争。

(if: (history:) contains &quot;一个奇迹！&quot; )[

[ra30]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 30))[点此继续 -&gt;[[征服成功！]]]
(else:)[点此继续 -&gt;[[完全败北]]]

]

]


(if: (history:) contains &quot;2.尝试抵御洪水&quot; )[

[ra40]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 40))[点此继续 -&gt;[[征服成功！]]]
(else:)[点此继续 -&gt;[[完全败北]]]

]

]

(else:)[

[ra60]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 60))[点此继续 -&gt;[[征服成功！]]]
(else:)[点此继续 -&gt;[[完全败北]]]

]
]</tw-passagedata><tw-passagedata pid="180" name="1.只是看着" tags="" position="1675,4225" size="100,100">你旁观考古队员的操作。

考古队员将点燃的火把往里伸，火焰熄灭了。

“装备氧气瓶和防毒面罩。”考古队队长说道，给你们分发了设备。

一切准备就绪，你们开始进入冬眠基地。

[[冬眠基地]]</tw-passagedata><tw-passagedata pid="181" name="2.玩一下检测仪器" tags="" position="1825,4225" size="100,100">你询问是否可以玩一下检测仪器，考古队员同意了，教了你操作方法。

[ra50]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[冬眠基地]]]
(else:)[点此继续 -&gt;[[老师我仪器怎么不亮了]]]

]</tw-passagedata><tw-passagedata pid="182" name="3.打开门进去" tags="" position="1750,4100" size="100,100">你尝试打开门进去，队长眼疾手快地按住了你的手腕：“不要这样做！太危险了。”

你被放置在安全的地方了。

空气检测结束，队长命令所有人戴上防毒面罩。

[[冬眠基地]]
</tw-passagedata><tw-passagedata pid="183" name="1-3 商队" tags="" position="650,2900" size="100,100">你们遇见了一支路过的商队，领头人见你们可怜，给你们分享了一些食水。

[[1.与领头人交谈]]
[[2.道谢，直接离开]]</tw-passagedata><tw-passagedata pid="184" name="0 桃花源" tags="" position="975,2075" size="100,100">你在山径上发现了一个开在山体上的小洞口，才仅能容一人通行，于是你叫停了行进的队伍。
哨兵先出发去探查。他钻进了狭小的通道，一个小时后才出来。

灰头土脸的哨兵兴奋地跟你说道：“一开始的确是狭窄，但走了十几步，一下变得很宽！钻出去后，有一片望不到尽头的桃林，个个都挂满了饱满的果实……”

[继续]&lt;continue|

(click-replace: ?continue)[
思想家建议你暂时在此驻扎，你同意了。

你们穿过狭小的洞口，果真如哨兵所说，抵达了桃林。

“这里的土地情况很好，上面肥美的桃子要是善加储存，加上我们的干粮，足够撑到我们在这里开垦出一片良田。”农业官说。

“要不就在这里不走了吧。”你对总务官说。

你们确实没有再离开这里了。桃林为你们挡下了外界的一切灾难，而时间在桃林内完全静止。
(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[=
&#39;&#39;结局22：桃花源&#39;&#39;


[STAFF名单]&lt;continue3|



(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]

]</tw-passagedata><tw-passagedata pid="185" name="4-6 金矿" tags="" position="775,2700" size="100,100">你们在迁徙的路上发现了一条很长的矿脉。

[继续]&lt;continue|

(click-replace: ?continue)[

哨兵先下去探查，地文官在士兵的保护下也一起下矿了。

“似乎是金矿脉。”地文官灰头土脸地上来了。

国民们欣喜若狂，你们就此定居，以金矿脉为伴。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;状态栏 
经济水平↑↑↑
宜居程度↓ 
工业发展水平↑↑ 
环境污染↑ 
社会稳定↑&#39;&#39;]

若干年后，你们国家成为了远近闻名的富豪国家。

[[第三回合]]

]</tw-passagedata><tw-passagedata pid="186" name="7-9 巨大的废墟" tags="" position="800,2925" size="100,100">你们在撤离的路上，遇见了一座巨大的建筑物。
这座建筑物相当庞大，一眼望不到边。而且外表被植物、泥土覆盖，似乎已经被废弃了。
[继续]&lt;continue|

(click-replace: ?continue)[
你询问独臂的近身侍卫的意见，侍卫摇摇头，“我不觉得这里有人居住。”
“这里可以作为临时的据点。”侍卫又建议你。
天色已晚，你们就地在神秘的废墟上驻扎。
国民们生起了温暖的篝火，围着篝火睡觉，士兵们则在附近巡逻守夜。

]

[继续]&lt;continue2|

(click-replace: ?continue2)[
“您怎么还不睡觉呢？”思想家在你身旁坐下。
你盯着废墟说道：“我总觉得这里很熟悉。”
思想家和你一起盯着废墟。
“对不起，”思想家说，“我不记得。”
你沉默了，你想起来这位思想家是新来的，你曾经认识的那位已经去世了。

第二天早上，你们收拾行装告别了这座废墟。

&#39;&#39;成就：蓦然回首&#39;&#39;

[[第三回合]]

]</tw-passagedata><tw-passagedata pid="187" name="1.与领头人交谈" tags="" position="475,3050" size="100,100">你与领头人闲谈起来。

这支商队来自邻国，专门从事边境贸易，队内成员来自两国，混血儿也有不少。

你对这个国家略有耳闻，那是一个非常强大、先进的共和制国家，与你们原来的国界接壤。

“要不要去我们那里？”领头人邀请道，”社会福利很完善，不工作也能养活自己。“

[[1.移民]]
[[2.道谢，直接离开]]</tw-passagedata><tw-passagedata pid="188" name="2.道谢，直接离开" tags="" position="575,3225" size="100,100">你对他们道了谢，没有接受他们更多的好意，而是直接离开。

最后，你们找到一处宜居的平原住下。

&#39;&#39;当前社会状态：
几乎要崩溃的暂时性的集权组织&#39;&#39;

[[第三回合]]</tw-passagedata><tw-passagedata pid="189" name="1.移民" tags="" position="350,3200" size="100,100">你沉默，这对于现在的你们来说诱惑力太大了。

”可是，跟他走了，国家也相当于灭亡了吧。”总务官说。

[继续]&lt;continue|

(click-replace: ?continue)[

“但我们现在已经没有能力重建国家了，”内务官说，“跟着他走，起码这些人能活下来。我觉得与其执着那些不存在的东西，人命更重要。”

你同意了内务官的说法，正式地对商队领头人提出了请求。

那真是一个完美无缺的乌托邦。

&#39;&#39;成就：我不想努力了&#39;&#39;

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[=
&#39;&#39;结局24：人？文？主？义？&#39;&#39;


[STAFF名单]&lt;continue3|

]

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]</tw-passagedata><tw-passagedata pid="190" name="冬眠基地" tags="" position="1625,4350" size="100,100">(if:(history:)does not contain &quot;2.玩一下检测仪器&quot;)[仪表上显示空气成分里氧气浓度正常，有害气体不多。为安全起见，队长还是建议你们戴上口罩或者防毒面具。]

越是深入，越觉得渗人。如那位科学家所说，这些都是神明创造的，而神明没有人类的外形，思想家叫祂们上帝。欣赏非人类生物创造出来的建筑需要惊人的毅力和强大的内心，否则也许会被这古怪诡奇的建造逻辑和设计思路炸穿大脑。包括你在内的所有人都异口同声，越是看这些机器，双腿越是发抖。

路上，你们看见了一些细小的黑色枝条，或是成堆，或是分散。

[[1.收集枝条]]
[[2.无视]]

</tw-passagedata><tw-passagedata pid="191" name="老师我仪器怎么不亮了" tags="" position="1825,4350" size="100,100">你手里的仪器发出几声细微的声响，指示灯忽然熄灭了。

你试图将仪器重启，重复数次，仪器也没有反应。

拿去给考古队长看，他沉默了。

“您把仪器搞坏了。”他委婉地说道。

你被禁止玩仪器了。

&#39;&#39;成就：规范实验操作！&#39;&#39;

[[继续-&gt;冬眠基地]]</tw-passagedata><tw-passagedata pid="192" name="1.收集枝条" tags="" position="1600,4475" size="100,100">你说：“这些是什么？”

考古队长在一堆黑色枝条旁蹲下，打开了头戴式的矿灯。

“这绝对不是树枝。”他说，小心地取出一根，捻成了粉，内里是蓝色的。

“也不是生物。”其中一个队员说。他正在取出塑料袋和刷子，将一部分黑色枝条小心地扫到样品袋里。

[[1.说不定曾经是生物呢？]]
[[2.捡枝条]]</tw-passagedata><tw-passagedata pid="193" name="2.无视" tags="" position="1750,4475" size="100,100">(if: (history:) contains &quot;颇有微词&quot;)[你无视了邻国的不满，继续大量倾销商品。

邻国对此的态度

[ra40]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 40))[点此继续 -&gt;[[忍气吞声]]] 
(else:)[点此继续 -&gt;[[发动战争]]] 

]
]

(if: (history:) contains &quot;冬眠基地&quot;)[你无视了地上的枝条，队员也都并没有在意，它被你们忽略掉了。

[[总控]]

]</tw-passagedata><tw-passagedata pid="194" name="1.说不定曾经是生物呢？" tags="" position="1600,4600" size="100,100">你说：“万一曾经是生物呢？”

所有人的视线汇聚在你身上。

“您说的不无道理。”有人说，“但是，什么生物会来这里？”

“这里是创造我们的地方，”队长说，“会来这里，而且死……这种状态应该算是死了吧，而且死在这里的，无非就是造物主……上帝。”

[你说这些还没有蚂蚁大的东西是上帝？]&lt;continue|

(click-replace: ?continue)[

你不由自主地发颤。和邻国的科学家交谈时，你还觉得神明只是离你很远的东西，现在，你把神明的尸体捧在手里，看起来还没有蚂蚁大，捻碎后剩下来的是有些亮晶晶的蓝色的粉。你的脚边有一小堆这些东西，粗略估计起码有一千粒。

这么小的东西能创造人类！？

“好了，不要想了。”一个队员出声打断你们，“到底是怎样，得把样本交回去研究所检验才知道，我们继续前进吧。”

[[总控]]

]</tw-passagedata><tw-passagedata pid="195" name="2.捡枝条" tags="" position="1725,4600" size="100,100">你捡起来一些枝条，轻轻用力捻成了粉，手感有些怪异，捻的时候感觉到了一些阻力，似乎有类似于骨骼的组织。

“这些样本，到时候交给研究所检验一下。”队员将标本袋揣回包里。

[[总控]]</tw-passagedata><tw-passagedata pid="196" name="总控" tags="" position="1675,4775" size="100,100">路上，队长为了解闷，与你闲聊道：“您还记得在这里时的事情？”

你点了点头。那是非常久远的事情了，按照现在的历法计算，已经过去上千年了。

[大概还记得。]&lt;continue|

(click-replace: ?continue)[

你说：“大概还记得一些。一醒来，眼前什么都看不见，似乎全身都泡在水里，慢慢地，听见了奇怪的声响，水被抽走了。想起身，没坐起来，有一层透明的玻璃板挡住了。过了一会儿，那个透明的玻璃板才打开，但到处都是白色的雾气，有点冷。穿过那层雾气，看到的就是……啊。”

眼前出现了一个巨大的空间，摆放着同样巨大的机器。许多疑似是电线的巨大线缆铺在地上，排序看似凌乱却有一定的规律，长时间盯着它看似乎会导致精神失常。

&#39;&#39;回忆检定&#39;&#39;

[ra60]&lt;rolldice|
]

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 60))[点此继续 -&gt;[[灵光一现]]]
(else:)[点此继续 -&gt;[[毫无头绪]]

]

]</tw-passagedata><tw-passagedata pid="197" name="1.前往冬眠舱" tags="" position="1300,4100" size="100,100">你环顾总控中心四周，但没有找到记忆中的路。在你的印象里，你苏醒的时候，冬眠基地还有供电，但是时至今日电力供应似乎全都断开了。基地里漆黑一片，矿灯只能照亮一小部分范围。

你
[[1.支起更大的探照灯]]
[[2.独自探索]]
[[3.检查电力系统]]</tw-passagedata><tw-passagedata pid="198" name="2.探索总控中心" tags="没写完" position="1175,4050" size="100,100">你放弃了自己的想法，决定先和考古队一起探索这里。

“这些巨大的机器”</tw-passagedata><tw-passagedata pid="199" name="1.支起更大的探照灯" tags="" position="1300,4225" size="100,100">你说：“这灯太小，有没有更大的？”
队长说道：“我们带来的电源只能支持这个规格的，再多的话，我们探索这里的时间就要缩短了。”

你默然，心想要是能找到更大的电源就好了。

………………

[[检查电力系统-&gt;3.检查电力系统]] 
</tw-passagedata><tw-passagedata pid="200" name="2.独自探索" tags="" position="1175,4225" size="100,100">你没有告知其他正在忙碌地拍照记录的队员，自己独自走向了更深的黑暗。

为了安全起见，你走到了这个房间的墙边，摸着墙边慢慢地前进。身边越发黑暗，考古队的光已经看不见了，矿灯仅仅只能照亮你身边，你所看到的只有自己的双脚和漫天飞舞的灰尘。

[继续]&lt;continue|

(click-replace: ?continue)[

你往深处走去。这里的空气似乎不干净，氧气浓度不足，还有刺鼻的异味。你戴上了氧气面罩。

你的心里涌起一股怪异的亲切感。

[[冬眠舱]]

]</tw-passagedata><tw-passagedata pid="201" name="3.检查电力系统" tags="" position="1300,4350" size="100,100">你说：“在我印象里，这里是有供电的。我们找找供电箱，说不定还能重启电力。”
队员说道：“这也太夸张了，都过去这么多年了，供电系统还连得上吗？”
“那可是神，没有祂办不到的事。”队长赞同了你的观点，你们出发去寻找供电箱。

队员在装备里找出来了寻线仪，沿着铺设的电线找去。

[ra50]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 50))[点此继续 -&gt;[[电力重启]]]
(else:)[点此继续 -&gt;[[埋葬机关]]]

]</tw-passagedata><tw-passagedata pid="202" name="冬眠舱" tags="" position="1175,4350" size="100,100">(if:(history:)does not contain&quot;电力重启&quot;)[似乎到头了。你的手触碰到冰冷的金属表面，抬起手时，手套掌心沾了一些铁锈。这里的氧气浓度很低，金属氧化得没那么厉害，况且这触感似乎也不像金属。你在这堵巨大的墙面前看了半天，没有找到像是开关的地方。

[[1.撞墙]]
[[2.返回]]

]

(if:(history:) contains &quot;电力重启&quot;)[电力重启后，你很快想起来了冬眠舱的位置。但是，记忆里的道路被一堵高大冰冷的黑色墙壁挡住了。

“怎么办，”队员说，“破墙？”

“这里有可能安装了自卫机制。”队长一边说一边四处张望。

[[1.撞墙]]
[[2.作罢]]
[[3.破墙-&gt;埋葬机关]]

]</tw-passagedata><tw-passagedata pid="203" name="1.撞墙" tags="" position="1175,4475" size="100,100">你沉下马步，用肩撞向墙。超乎你的意料，那面墙在你撞进去的那一刻消失了，你扑了个空，跌倒在地。

[继续]&lt;continue|

(click-replace: ?continue)[

刺眼的白光和接二连三的轻微声响，地板上的灯亮了起来——天花板上没灯，好奇怪。

你从地上爬起来，一时间难以适应明亮的环境，闭着眼睛等待了些许时间，才慢慢睁开双眼。

纯白的巨大房间，冬眠舱下沉至与地面平行，舱体内部已经空了。和外面不同，尽管过去了几千年，冬眠舱外表还完好如初，没有生锈和老化的痕迹，恐怕不是你已知的材料制造而成的。和外面的机器相比，这里的设计同时兼顾了人类生理结构特色和神明本身的特色。

你怔怔地看着眼前一排排的冬眠舱，回味着心里怪异的熟悉感。

[[1.调查冬眠舱]]
[[2.返回]]
[[3.找个冬眠舱躺进去]]
]</tw-passagedata><tw-passagedata pid="204" name="2.返回" tags="" position="1325,4475" size="100,100">(if:(history:)does not contain &quot;1.撞墙&quot;)[你认为这里不宜再单独行动，于是原路折返回到刚才的地方。
“您刚才去哪里了？”现场人员少了一些，队长气喘吁吁地看着你，“独自行动之前请告知我们好吗？我们急得快疯了。”
你告诉队长：“我想起来了冬眠舱的路。但是我找过去时，只有一堵巨大的墙。”
队长擦了一下脸上的汗，”我们待会儿进去调查。如果实在打不开，让工程队下来实施爆破作业。“

[继续]&lt;continue|

]

(click-replace: ?continue)[
你们等了一会儿，先前出发去找你的队员全部回来了。他们气喘吁吁，看来对你颇有怨言。
“冬眠舱的路找到了，我们先去冬眠舱。”队长说道。他们在此处做了标记，由你带路前往冬眠舱。
你们重新来到巨大的墙壁面前。

“怎么办，”队员说，“破墙？”

“这里有可能安装了自卫机制。”队长一边说一边四处张望。

[[1.撞墙]]
[[2.作罢]]
[[3.破墙-&gt;埋葬机关]]

]</tw-passagedata><tw-passagedata pid="205" name="1.调查冬眠舱" tags="" position="1175,4600" size="100,100">你慢慢走在房间里，逐个审视每个冬眠舱。

[继续]&lt;continue|

(click-replace: ?continue)[

你还记得这些冬眠舱，左手边的是思想家躺的，右手的是总务官，再往前走一些是内务官……直到现在你才惊觉，你回忆的这些人已经死去数千年了，现在的思想家、总务官、内务官统统都换了。他们与你不同，只有短短一百年的寿命，而且大多数也没有活到一百岁。思想家死前将他的学生召集到身边，并不再讲授任何知识，只是吩咐学生目睹他的死。当时你也在场。

你找到了自己的冬眠舱，你看着它久久失神。

[继续]&lt;continue2|

]

(click-replace: ?continue2)[

许久后你才转过身，继续往深处走去。

忽然间，你意识到脚底的触感与其他地方不一样，于是停下了脚步。由于冬眠舱设计得下沉至地面，你在行走时经常踏过冬眠舱表面。因此你没有注意到你现在又走过了一个冬眠舱。

这个冬眠舱和其他的不一样！

[[继续-&gt;自毁机构8号E型]]

]

</tw-passagedata><tw-passagedata pid="206" name="3.找个冬眠舱躺进去" tags="" position="1300,4600" size="100,100">你最终还是没能忍住自己的怪癖，打开一个冬眠舱的舱门躺了进去。
冬眠舱的床还是和当年一样冰冷。

你起来了。

[[1.调查冬眠舱]]
[[2.返回]]</tw-passagedata><tw-passagedata pid="207" name="自毁机构8号E型" tags="" position="1175,4725" size="100,100">一个冬眠舱——但是和其他的不一样。其他的冬眠舱空空如也，而眼前这个冬眠舱被不透明的液体包裹着，能观察到液体轻微的波动。

里面还沉睡着一个人类，当时没有苏醒，一直沉睡至今。


[继续]&lt;continue|

(click-replace: ?continue)[

你完全怔在原地。此刻，你的感性已经完全爆炸，像风暴一样携来巨量的情感信息：惊喜、震惊、快乐、感动、恐惧……但“你”本身却无动于衷，“你”心如止水。经过数千年的岁月，你带领这个文明踏过各种风风雨雨，你已经对所有事情见怪不怪了。

但在这一刻，你很希望自己能被感性带动着高兴一下，因为这能证明你的心尚未完全冰冷，你还是个人类。

[继续]&lt;continue2|

]

(click-replace: ?continue2)[

你不知道如何处置这个冬眠舱。你没有找到开启它的开关，也没有找到毁掉它的。这里实体按键的操作逻辑依旧是神明的，人类无法理解。

你站起身，打算返回考古队所在的位置，环顾四周，却没找到刚才撞开的门在哪里。

四周都是高耸的白墙，严丝合缝。

(text-style: &quot;rumble&quot;)[“咔。”]


[什么？]&lt;continue3|

]

(click-replace: ?continue3)[

你往前迈出一步——你决定要去找刚才的门，身后却忽地传来“咔”的一声。
这一刻，连你的理性和“你”都为之一颤。

你转过身，刚才的冬眠舱亮了起来，里面的液体正在被抽走，显现出里面沉睡的人类。

[最后沉睡的人类]&lt;continue4|

]

(click-replace: ?continue4)[

只一眼你就被里面的人类吸引住了：此人雌雄难辨，面容却极其美丽。五官立体，通体体毛都是白色，睡颜神似雕塑。他——她——祂赤身裸体，全身各处都没有明显的性征，肌肉线条却很优美。

液体抽干，从冬眠舱各处伸出来黑色的管状物，为这名人类注射了什么东西，紧接着冬眠舱内部闪烁数次，舱盖缓缓打开。

其实你并非没有见过其他人从冬眠舱苏醒的样子，现在的你能够认为注射的应该是肾上腺素之类的活化肌肉的。只不过眼前这名人类太过美丽，你完全呆住了，视线根本无法从祂身上移开。

(if:(history:)contains&quot;1.说不定曾经是生物呢？&quot;)[你觉得，在人类文明的审美里，如果神明真的存在，不应该是那些细小的黑色枝条，应该是眼前这名雌雄难辨的人类。]

(text-style: &quot;blink&quot;)[“你好！”]

[？]&lt;continue5|

]

(click-replace: ?continue5)[

那名人类缓缓睁开双眼，红宝石般晶莹剔透的双眼从暗沉至明亮。祂从冬眠舱中坐起，银白色大波浪的长发垂至身后。祂站了起来，银色的长发一直垂至脚踝。
祂抿着嘴唇，表情淡漠平静，像是未有灵智的婴儿——不，像人类文明审美里的神明。紧接着祂活动了一下身体四肢，转头环顾四周，一眼就看到了你。

很难想象神明是如何一瞬间堕落成人类的。那人在看见你的那一刻，立刻扬起了人类才有的温暖的笑容，热情地扬起手：“(text-colour:red)[你好！]”
祂的声音清脆悦耳，却依旧雌雄难辨。你感觉得到自己的心脏猛地跳了一下。

[你是？]&lt;continue6|

]

(click-replace: ?continue6)[

你开口问祂：“你好！你是？”
那名人类耸耸肩，几缕碎发从祂肩膀滑落，“(text-colour:red)[你们冬眠苏醒把我落下啦！程序也有不好的时候啊。]”
祂迈开双腿走出了冬眠舱，小腿上还滴着一些水珠。
“(text-colour:red)[我的名字是8E。]”祂往身体两侧张开双手，笑着对你说道，红色的双眼里像是有水在流动一样。
“8E，”你重复了一下祂的姓名，想要自我介绍，“我是……”

“(text-colour:red)[等一下。]”8E打断了你，“(text-colour:red)[我知道你是谁，虽然冬眠了这么久，但我的脑子还比较好使哦。]”

[可是我不记得你。]&lt;continue7|

]

(click-replace: ?continue7)[

你顿了顿，“可是我不记得你。我们冬眠前见过吗？我没有任何冬眠前的记忆。”

8E笑了一下，祂的笑声也很悦耳，有让人着迷的魔力。
“(text-colour:red)[你当然没见过我。你先于我被创造，我看着你被放进冬眠舱。而且，Arrietty没有往你的大脑里安装关于我的知识。]”

你没听懂祂的话，想要追问时，对方却扬起下巴，笑容也变得诡异而神秘。


(text-colour:red)[[[存续机构8号……多少型来着-&gt;存续机构8号]]]

]



</tw-passagedata><tw-passagedata pid="208" name="未命名片段 1" tags="" position="1375,4775" size="100,100">(font:&#39;思源黑体CN&#39;)[]

(text-style: &quot;rumble&quot;)[自毁机构]</tw-passagedata><tw-passagedata pid="209" name="存续机构8号" tags="" position="975,4725" size="100,100">8E歪着头想了一会儿，说出来一个奇怪的名字：“(text-colour:red)[存续机构2号……多少型来着，不记得了。]”
你不叫这个名字。但是不知为何，8E说出来这个名字时，你的心里没由来地恐慌。
8E却对你的反应像是很满意似的忽然大笑起来。
“(text-colour:red)[什么，你原来是在完全无知的情况下唤醒我的？]”祂笑得上气不接下气。“(text-colour:red)[我还以为你真的活够了耶。]”
祂往前迈出一步，顷刻到了你的身前。那张完美无缺的美丽脸庞和血一般通红的双眼注视着你。
“(text-colour:red)[我的正式名称是自毁机构8号&#39;Executioner&#39;型，是文明的毁灭者，也是你的处刑人，存续机构。]”祂一字一顿，宣告你的死刑。


[逃跑]&lt;continue9|


(click-replace: ?continue9)[

你尝试逃跑。但在你转过身的那一刻，自毁机构拥了上来，祂纤细修长的双臂从背后抱住了你。你的腹部和胸口各被一个尖锐的白色物体贯穿，而8E看似纤细的双臂居然死死地将你禁锢在怀里。
“(text-colour:red)[你逃不掉的。]”自毁机构温柔地伏在你耳边低语，“(text-colour:red)[我们是双子型号，我对你了如指掌，存续机构。]”
你逐渐失去力气，彻底倒在自毁机构怀里，而祂跪坐在地。
“(text-colour:red)[我的职责是对人类文明产生威胁，促使其进化。你的职责是保护人类文明，使其存续。只要有你在，无论是什么样的灾难，人类文明都能坚持过去。所以你是最重要的，毁灭存续机构，才能彻底毁灭这个文明。]”
自毁机构像是讲睡前故事一样慢慢地说道。但你不知道自己还有多久的命听，你的心脏已经被贯穿，眼前一片涣散，连8E的脸也看不清楚。

最后，自毁机构嫣然一笑，用你听不懂的(text-style: &quot;blink&quot;)[神明的]语言，伏在你耳边低语道——

「晚安，智人种。」

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;Bad End 自毁机构8号E型&#39;&#39;

&#39;&#39;成就：存续、自毁。&#39;&#39;

[STAFF名单]&lt;continue10|
]

(click-replace: ?continue10)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]]


</tw-passagedata><tw-passagedata pid="210" name="2.向军队求援" tags="" position="1000,2675" size="100,100">你派出哨兵向军队求援，询问是否能够分享食水。

军队的态度

[ra40]&lt;rolldice|

(click-replace:?rolldice)[

(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 40))[点此继续 -&gt;[[分享食水]]]
(else:)[点此继续 -&gt;[[无名之卒之死]]]

]</tw-passagedata><tw-passagedata pid="211" name="1.过躲藏检定" tags="" position="900,2550" size="100,100">你们找到一个山洞，纷纷进去躲避。独臂的侍卫和军事官快速砍下附近树枝，做了简单的掩护，放在山洞口前，尽量将其伪装起来，洞内没有生火，潮湿、阴冷、一片漆黑。

军队的战马踏过，马蹄声低沉、凌乱、缓慢，声音越来越接近。你们在黑暗中屏住了呼吸。

[ra60]&lt;rolldice|

(click-replace:?rolldice)[


(set: $roll to (random:1,100))
出目结果：(print:+$roll)

(if: ($roll &lt;= 60))[点此继续 -&gt;[[惶惶不安]]]
(else:)[点此继续 -&gt;[[无名之卒之死]]]


]</tw-passagedata><tw-passagedata pid="212" name="3.发展科技" tags="" position="1100,3775" size="100,100">五年后的码头，驶出的船只陆陆续续回港，留学归来的科学家们带着新鲜的空气，终于踏上了故国的土地。他们带来的先进的技术马上就被你和政府推行，设立机构，普及教育，然后转化为应用成果。

于是轰轰烈烈的科技革命拉开了帷幕。
在科学家和政府的大力倡导下，整个社会掀起了一股崇拜科学和理性的潮流，人人都以学习科学技术知识为荣。
而在技术的繁盛之下，对荒凉地方的开发也提上了政府的日程，欣欣向荣之下，大开发开始了。

“这是最好的时代。”科学官说道。

&#39;&#39;状态栏：
愚昧↓↓↓
自然资源↓
宜居程度↓
环境污染↑&#39;&#39;

[[1.变革社会体制-&gt;2.变革社会体制]]
[[2.发动战争-&gt;3.发动战争]]





</tw-passagedata><tw-passagedata pid="213" name="无休止的战争及其后果" tags="" position="575,4250" size="100,100">一日，光带上飞驰过一粒细小光点。光带是电磁加速轨道，光点其实是能承受巨大G值的运输用胶囊，不过现在主要作为观测和观光使用。

胶囊里的生物俯瞰大地。

[星球的过去]&lt;continue1|

(click-replace: ?continue1)[

很久很久以前，这个星球曾被一个文明统治，它们的工业高度发达，但代价是将这颗星球的自然资源开采得接近枯竭。

于是，作为报应，那个文明亲手毁灭了宜居的环境，强大的工业变成了杀死自己的利刃，随后便在绝望之中灭亡了。

[远道而来的殖民者]&lt;continue2|

]

(click-replace: ?continue2)[

很近很近以前，一个远道而来的殖民者发现了这颗表面灰色与黄色的星球，惊讶万分。

//「这里的大气环境中的氧气浓度非常低，几乎是无氧环境，非常适合生存。」//

殖民者从此在这里定居了。

[文明的复活]&lt;continue3|

]

(click-replace: ?continue3)[

殖民者在这颗星球上发现了那个文明遗留的信息。

它们没有花多少时间便将其解读破译了，这对于这个能实现星际间的长途航行的文明来说轻而易举。随后，他们在这颗星球上唯一孤立的大陆上，复活了那个文明。

//「它们到底是有智能，抑或没有？」//

[历史的再演]&lt;continue4|

]

(click-replace: ?continue4)[

绿色的森林被冰冷的黑色钢铁森林取而代之，蔚蓝的海水变成深邃的漆黑。陆地上弹坑数不胜数，尸体和废弃的武器堆得比小山还高。

殖民者曾研究了好长一段时间，才将试验场的海域、试验场陆地上的生态恢复到那个文明原来的样子。但是如今，一切又重演了，实验体亲手将这些摧毁得一干二净，和他们的祖先一样。

胶囊里的生物(text-style: &quot;blink&quot;)[殖民者]俯瞰大地。

//「和刚来的时候一模一样了。」
「没有对它们的进化做出任何干涉。」
「结果是一样的。」
「人类在历史中学到的唯一教训，就是人类无法从历史中学到任何教训。此事在他们先祖著作中亦有记载。」//

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;Normal End 历史重演&#39;&#39;


[STAFF名单]&lt;continue10|
]

(click-replace: ?continue10)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]

作者批注：本结局仅为迎合作业要求“反应原作小说主旨”撰写，不代表作者及制作组立场，请阅读原作小说《人类公园》。

]



</tw-passagedata><tw-passagedata pid="214" name="存续机构" tags="" position="2275,3950" size="100,100">“初次见面，存续机构。”

眼前出现的是一个坐在轮椅上的……不太能称之为人。这个人只有头部是人类的，身体其他部分都是机械。他脸颊消瘦，戴着一副银色的眼镜。

面对你时，此人露出微笑，分别用一种你听不懂的语言和你们的语言对你打了招呼。

&quot;自我介绍一下，我是彼得·斯科特·摩根，你可以称呼我为中枢机构。&quot;他对你说道。

&lt;img src=https://gitee.com/kellyaties/kellyaties/raw/44b8553e844d0c39a1d747e2868edcaf7314e440/v2-76d042a1b4a3994e1fa113a606f9c182_1440w.png&gt;

[[赛博格？Cyborg?-&gt;中枢机构0]]
[[中枢机构？Parlament?-&gt;中枢机构1]]
[[Arrietty的代表吗？Die Delegation von Arrietty?-&gt;中枢机构3]]

</tw-passagedata><tw-passagedata pid="215" name="中枢机构3" tags="" position="1975,4125" size="100,100">Peter S. Morgan点了点头，“是的，我是Arrietty最高指挥官派来与你们对话的代表，是按照Peter S. Morgan博士外表制作出来的机器人，型号为代理机构1号A型。但是，现在藉由此型号与你对话的，是Arrietty的中枢机构。因此，称呼我为中枢机构即可。”

Arrietty，这个单词一开始是在冬眠基地的仪器上发现的。

[[有何贵干？]]</tw-passagedata><tw-passagedata pid="216" name="中枢机构0" tags="" position="2100,4125" size="100,100">Peter S. Morgan微笑着点头，“是的，我是一名赛博格。我出生于公元纪元的1958年，因患渐冻症死于公元纪元2022年。”
渐冻症，你知道这个病。你的第一任内务官就是因此病死去，你目睹了他的身体从灵活到僵硬，直至彻底冰冷。

“所以，现在的你是谁？”你接着说道。
“我是Arrietty最高指挥官派来与你们对话的代表，是按照Peter S. Morgan博士外表制作出来的机器人，型号为代理机构1号A型。但是，现在藉由此型号与你对话的，是Arrietty的中枢机构。因此，称呼我为中枢机构即可。”中枢机构微笑道。

[[公元纪元？]]
[[有何贵干？]]</tw-passagedata><tw-passagedata pid="217" name="中枢机构1" tags="" position="2225,4125" size="100,100">Peter S. Morgan点了点头，“是的，中枢机构。这是Arrietty的最高权力机构。国会、下议院、元老院……请按照你们的思维理解就可以了。”

“我是Arrietty最高指挥官派来与你们对话的代表，是按照Peter S. Morgan博士外表制作出来的机器人，型号为代理机构1号A型。但是，现在藉由此型号与你对话的，是Arrietty的中枢机构。因此，称呼我为中枢机构即可。”中枢机构微笑道。

[[有何贵干？]]</tw-passagedata><tw-passagedata pid="218" name="有何贵干？" tags="" position="2100,4325" size="100,100">这是一位不速之客。今天，光带上一如既往又划过粒子，但与其他粒子不同，这个粒子明显要大得多，而且并没有消失在天边，而是落到了地面。

粒子的真面目是一个巨大的胶囊形状的太空舱。这个太空舱落在本国首都附近的郊区，当你们找到它时，这位自称是中枢机构的坐着轮椅的赛博格就在打开的太空舱的旁边，地上没有轮椅车辙的痕迹，说明中枢机构一直在等你们的到来。

“远道而来的客人，”你说，“有什么事情，不妨来到我国的招待所，我们详细谈谈。”

中枢机构微笑着点头同意了。内务官上前一步想要为他推轮椅，赛博格却抬起机械手臂示意不用。没有见到他操作什么实体按键，轮椅却自动跟着你们走。

[[即将到来的对话-&gt;中枢机构4]]</tw-passagedata><tw-passagedata pid="219" name="公元纪元？" tags="" position="2225,4250" size="100,100">“公元纪元？”
你能从对方的话语里猜测出来是一种纪年法，但是你并不知道这是哪个国家的。

中枢机构说道：“是的。那是你们先祖的纪年方法。距今的时间，需要用地质纪年来计算了。”

“什么意思，”思想家问道，“您是想说，中间断开了吗？”

中枢机构颔首。

(font:&#39;思源黑体CN&#39;)[&#39;&#39;“你们的先祖——曾经的那个人类文明，已经毁灭了。现在的你们是我们Arrietty根据遗留的生物信息克隆出来的。”&#39;&#39;]

&#39;&#39;成就：文明的真相&#39;&#39;

[[有何贵干？]]</tw-passagedata><tw-passagedata pid="220" name="3.发动战争" tags="" position="1025,3950" size="100,100">思想家不赞同你的决策：“这看起来有点昏庸了。”

你没有听他的。

[继续]&lt;continue|

(click-replace: ?continue)[

由于政府对教育和上升渠道的重视，你国的科技实力经过十分短暂的岁月就超越了邻国，出现了技术的回流。
而任谁也不会想到，处于蜜月期的两国会因为接壤处的一处珍稀的矿藏的开采权而破裂、阋墙。

起初，所有人都认为谈判会顺利进行，这不是什么大事。

但谈判破裂了。而且很快地，战火来了。

[继续]&lt;continue|

]

(click-replace: ?continue)[

你国以“为国民谋福祉”为由，擅自把军队驶向了争议区，这一举动马上就招致了周边诸国的怒火，他们结盟起来，向你国发出了讨伐檄书。
在欺上瞒下的官僚运作之中，等你回过神来，对方的炮火已经淹没了两座城池。
现在你必须为你的疏忽买单了。

[[1.求和]]Den Kreig beschließen
[[2.继续打仗]]Den Kreig weiter führen

]

</tw-passagedata><tw-passagedata pid="221" name="分歧点" tags="" position="2275,5125" size="100,100">这次的太空舱里只有科学院院长一个人，他的脸色和走之前比起来平静很多，甚至胖了一些，看来阿莉埃蒂世界伙食不错。

你们回到总统府，科学院院长提到他被允许带走了很多阿莉埃蒂世界的影像资料，可以使用人类的CD机播放。除此之外还有一部分纸质资料。这些资料都被交给专人保管研究。

“虽然才离开一个月，但也算是阔别了。”你说，“今日暂时不讨论政事，尝尝家乡的美食，休息一下吧。”

科学院院长回复道：“谢谢您的关心。我其实还好，回来之前，他们给我开了饯别宴，所以我不饿。”

“看出来了，”思想家站在你身旁，冷冷地看着科学院院长。“你像完全丢了魂似的，他们只花了一个月就把你调教成了一条好狗。”

[继续]&lt;continue|


(click-replace: ?continue)[

科学院院长缓慢地转过头，看向思想家。他下意识地往脚底看，然后才意识到对方与自己一般高，于是抬头与其平视。

“那根本不是我们能与之为敌的对手。”他说，“你没有去，你不知道。他们的武器和科技有多可怕。他们的飞船记录仪里有记录，他们在来到太阳系之前就已经和其他文明发生过冲突，结果也显而易见了，他们把那些文明屠杀殆尽。”

科学院院长说这话时，脸色平静得可怕。

“而且这只是他们舰队的其中一支。舰队的主要部分都在太空，离这里数百光年不到。他们任意一支分舰队都具有跨星系打击的能力，如果击溃了地球上的这一支，必须要考虑到可能到来的报复。他们有太阳系的坐标，打击会从四面八方过来。”

科学院院长说到这里时忽然停住了。思想家原本想驳斥他，却被你制止了。

过了一会儿，你看见科学院院长眼眶忽然泛红，原本平静的面庞扭曲成一张可怕的哭号脸，眼泪毫无预兆地涌出眼眶。

“完了！全完了！”他歇斯底里地大吼大叫，“根本不可能赢！乖乖当他们的宠物吧！宠物有什么不好的！对他们发动战争的胜算不是百分之几和千分之一万分之一，是零，零你听懂了吗？！不要说发战书了，这决定一旦做出来，他们就会立刻知道，然后发动对地打击！你不知道吗？整个公园都装着监控啊！哦，你们不知道，他们把这儿叫公园，人类公园！”

科学院院长跪坐在地上失声痛哭，“我们生存的地方是他们一手建造的，他们怎么可能会让我们发展出威胁到他们的能力……本来我们活到今天就是他们的怜悯……”

思想家：“你真是个臭傻逼。”

[[1.思想家，你素质有点差了]]
[[2.那我们也逃。]]
[[3.我觉得思想家说得对。]]

]</tw-passagedata><tw-passagedata pid="222" name="1.思想家，你素质有点差了" tags="" position="2300,5275" size="100,100">你没忍住说：“思想家，你的素质有点差了。”

思想家恼怒地看着你，张嘴想要骂人，又硬生生地憋了回去。

“难道你不是这么想的吗？”他有些愤怒地说。

[这是污蔑啊]&lt;continue|


(click-replace: ?continue)[

你摇摇头，“只有你自己这么想。事实上，我和院长一个意见。”

思想家震惊地看着你，你看着他的表情从不解、困惑到愤怒。

“你真是疯了！”他终于骂出来，“你怎么能和那个呆子同流合污？他说什么你就信什么？你觉得那些资料都是真的？阿莉埃蒂科技那么发达，洗脑他不是轻轻松松！”
你说，“为什么要洗脑。你也认可了他们科技很发达的事实，既然如此，直接给人类看不就好了。弱小的人类会自己心生怯意的。”
思想家被噎住了没说出话来。

“可我恳请您再稍加思考。”他最终又眼带哀求地看着你。

[[好，我会仔细想想-&gt;寄人篱下]]

]</tw-passagedata><tw-passagedata pid="223" name="2.那我们也逃。" tags="" position="2425,5275" size="100,100">你沉默，伸手去扶科学院院长，但这人的心气完全被阿莉埃蒂击溃了，他枯坐在地上一动不动。

你放弃了，收回手直起身。

“没什么大不了的，”你说，“这里住不下去，我们就逃。”

科学院院长失控地咆哮道：“又来！逃去哪里！？”

[天上。]&lt;continue|

(click-replace: ?continue)[

你指了指天空，“天上。准确地来说，是宇宙。”

科学院院长被你的发言惊得哑口无言。

“去和阿莉埃蒂谈判，让他们允许我们离开，我们去找新的宜居地。”你补充道。

所有人都被你的发言惊得说不出话来。

“本来也只能这样了吧，”你说，“他们那么强大，思维又和我们完全不一样，这里甚至还是他们创造的实验室。继续留在这里，哪天被杀了也完全没有反抗的能力。”

[或者说，这样吧。]&lt;continue2|

]

(click-replace: ?continue2)[

你环顾四周，这些人依旧处于失神的状态。你只好说道：”这样吧。举行全民公投，同意离开的人跟我一起进行宇宙飞船的研究，不同意的人可以留在这里。我们离开了，人均资源变多了，应该能坚持到活完这辈子。”

官员们面面相觑。尽管他们还是很震惊，却不得不承认这是最好的办法。

[全民公投]&lt;continue3|

]

(click-replace: ?continue3)[

你们选了一个日子，将所有国民召集在一起，举行公投大会。投票持续了整整一个星期，计票花了更多的时间。

内务官将票数统计完，你在全国民众面前宣读了结果。

投票结果六比四，逃亡主义胜利了。

[[谈判-&gt;智能0]]

]</tw-passagedata><tw-passagedata pid="224" name="3.我觉得思想家说得对。" tags="" position="2175,5275" size="100,100">你觉得他说的对。

“我知道你的良苦用心，但是，从来没有卑躬屈膝的道理。”你断然说道，“哪怕整个文明全军覆没，起码也证明了智人种不是孬种。”

科学院院长跪坐在地上，缓缓抬头看着你，那双被凌乱的刘海遮掩了的布满血丝的眼睛，如今与Peter. S. Morgen一样的眼神。

“这是没有智能的体现。”他说道。

你知道他在说什么，你也终于明白了智能的含义。

[[将大刀朝敌人的头上招呼过去！-&gt;并非智能]]
</tw-passagedata><tw-passagedata pid="225" name="智人治水" tags="" position="1125,1475" size="100,100">历史学家和史官在史书记载道：“人类的勇气和智慧在这一次洪水里表现得淋漓尽致……所有国民都参与了治水，搬运石料，涂抹砂砾，……这是我们最团结的一天，这就是我们的民族精神。人类万岁！”

&#39;&#39;状态栏
凝聚力↑ 
经济水平↓ 
抵抗天灾能力↓ 
&#39;&#39;
[[第三回合]]</tw-passagedata><tw-passagedata pid="226" name="电力重启" tags="" position="1425,4325" size="100,100">你们来到了一个巨大的房间，内里的仪器设备摆放看似凌乱，实则有诡异的规律。你不敢直视那些巨大的电线，那些直径有数米、外形看起来像巨蛇的电线沉默地卧伏在地面上。
你总觉得那些电线是活着的，只不过现在睡着了，跟这座基地一样，沉睡到现在。

“寻线仪指向是这里。”队员说道，“这看起来确实很像主配电箱……”

[低头]&lt;continue|

(click-replace: ?continue)[

你鼓起勇气低头看向脚底。你发现冬眠基地里少有事物放置在天花板上，几乎都被安装到地下或者地面。

脚边静静地躺着一条巨大的电缆，跟你手臂一样粗。你的脚踝挨着它，隐约能感受到电缆均匀但并不明显的呼吸。

队长戴着绝缘手套在各种仪器表面试探性地触碰。

忽然间，大地震动。你脚边的电缆猛地一震，激起一大片灰尘，蒙住了你们的氧气面罩——要不是戴着面罩，这会儿一定会被呛个半死。紧接着，地板上亮起来了光——是灯，这里的灯居然安装在地板上。

“我们赶紧出去吧，”队长的声音有些变形了，“这里……这里待得我不舒服。”

你知道他指的范围是整个冬眠基地。

[[冬眠舱]]
]</tw-passagedata><tw-passagedata pid="227" name="埋葬机关" tags="" position="1450,4475" size="100,100">(if:(history:)does not contain&quot;2.返回&quot;)[
寻线仪指向的终点很遥远，你们一行人沉默地在黑暗中走着，不安却在你心中扩大。
“我有不好的预感。”你对队长说道。
队长沉吟片刻，叫住拿着寻线仪的队员。
队长说了你的想法，然后补充道：“干我们这行的，有时候不能不迷信。”
队长决断道：“到此为止。立刻撤出基地，样本不能掉了。”

你们掉头准备原路返回，四面八方忽然传来整齐的、密密麻麻的“叮叮当当”的声音，如潮水一般，而且声音逐渐增大。

你不确定自己是不是出现了幻觉，因为其他人似乎没听到这个声音——并非是“叮叮当当”，而是一个人类的低语声。
你听不清他？她？祂！在说什么，但你的心底忽然萌生出一股强烈的恐慌和熟悉。
队长毫不犹豫地大喊道：“快跑！”
不用他催，所有人都玩了命一样撒开腿狂奔。你迈开腿，正踏出第一步，一道悄无声息的风就掠过你身边。

祂出现在你身前！你来不及端详祂的面容，只能记住祂如血一般鲜红的双眼。那双眼睛很美，祂的白色长发拂过你的脸颊，你觉得有些痒，忍不住眨眼。
再次睁开眼时，你的胸口已经被白色的利刃穿刺。

(text-colour:red)[“我好想见你，存续机构。”]祂喃喃低语。你的身体失去力气倒在地板上，看见的是同样四仰八叉躺在血泊里的考古队。
祂在你身边蹲下，银色发丝垂在你的脸上，用你听不懂的(text-style: &quot;blink&quot;)[神明的]语言，伏在你耳边低语道——

「晚安，智人种。」

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局27：埋葬机关&#39;&#39;


[STAFF名单]&lt;continue10|
]

(click-replace: ?continue10)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]]


(if:(history:)contains&quot;2.返回&quot;)[队员拿出冲击钻，在墙上做好标记，启动了冲击钻。

轰鸣声响彻寂静的基地，火花溅得四处都是。然而，数分钟过去了，墙面光滑如初。

队员不敢置信地隔着手套抚摸墙壁，甚至感受不到做功带来的热。而他手里的冲击钻已经因为过热冒烟停转了。

“妈的，”队长说，“以我们的科技想探索这个基地简直就是蚍蜉撼大树。”

[那我们回去吧。]&lt;continue|

(click-replace:?continue)[
你说：“那我们回去吧。“
就在你话音刚落的那一刻，四面八方传来整齐的、密密麻麻的“叮叮当当”的声音，如潮水一般，而且声音逐渐增大。
有东西正在靠近。
队员丢掉了冲击钻，而队长则毫不犹豫地大喊：“快跑！”
墙壁无法破开，而眼前只有一条狭长的小道，你们只好沿着原路返回，然而那声音却忽然从两边墙壁同时响起。
巨大的尖刺突破墙壁，轻而易举地贯穿了逃跑的队员的身体，然而惯性没有被止住——往前趋势的上半身扑到了前方稍远的位置，下半身则穿刺挂在尖刺上。
在那尖刺贯穿你的头颅之前，你听见了远方的祂的呼唤。
(text-colour:red)[“为什么不与我见面，存续机构？”]

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局27：埋葬机关&#39;&#39;


[STAFF名单]&lt;continue10|
]

(click-replace: ?continue10)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]]

]
]
</tw-passagedata><tw-passagedata pid="228" name="Peter S. Morgan" tags="" position="1950,3975" size="100,100">很久很久以前，这个星球曾被一个文明统治，它们的工业高度发达，但代价是将这颗星球的自然资源开采得接近枯竭。

于是，作为报应，那个文明亲手毁灭了宜居的环境，强大的工业变成了杀死自己的利刃，随后便在绝望之中灭亡了。

[远道而来的殖民者]&lt;continue2|


(click-replace: ?continue2)[

很近很近以前，一个远道而来的殖民者发现了这颗表面灰色与黄色的星球，惊讶万分。

//「这里的大气环境中的氧气浓度非常低，几乎是无氧环境，非常适合生存。」//

殖民者从此在这里定居了。

[文明的复活]&lt;continue3|

]

(click-replace: ?continue3)[

殖民者在这颗星球上发现了那个文明遗留的信息。

它们没有花多少时间便将其解读破译了，这对于这个能实现星际间的长途航行的文明来说轻而易举。随后，他们在这颗星球上唯一孤立的大陆上，复活了那个文明。

//「它们到底是有智能，抑或没有？」//

]

[星球历史研究专家]&lt;continue4|



(click-replace: ?continue4)[

代理机构1号A型觉得实验体的诞生有点扯淡。Arrietty来到这个表面灰黄色的星球定居后，发现了在陆地上残留的大量的非自然痕迹。巨大的四方形或者多边形的建筑，电力设施，网络设施，黑色的平整的道路。这些痕迹引起了Arrietty里一部分闲的没事干的人的好奇心，他们自发地开始调查这颗星球，以“地质勘察”“古生物学”研究为名（他们称呼自己为地球历史研究专家）。从事这件事的人并不多，如今他们已经形成了比较稳定的小圈子，有了准入门槛，排斥外人的指指点点。
让这个小圈子扩散到整个Arrietty都为之侧目的原因，是智人种化石的发现。建造中子发射塔的施工队在施工过程中发现了一个巨大的化石，内里包含着相当丰富的生物信息。生物学家们一眼就注意到了那对于Arrietty来说极其庞大（其实对于Arrietty来说这颗星球上所有生物都很庞大）的生物尸体，大约有1.8×10的几十次方个单位的长度。
“这种生物也许就是制造那些非自然痕迹的种群。”经过解剖和读取生物尸体大脑内残存的信息，Arrietty的生物学家发表了如此见解。
随后，在这颗星球各地都发现了类似的生物尸体。这些尸体大脑残存的信息都表明了这个种群强大的环境改造能力。
再之后——更多的东西被发掘出来，刻有文字的石头、承载了信息的所有东西，星球历史研究专家们尝试还原这个种群——这时他们已经从残存的资料里得知“智人”这个名词——从诞生到灭亡的过程。
数个太阳年后，地球历史专家们向Arrietty全社会出版了他们自以为最权威的《智人诞生消亡史》，并指出：“智人种的灭亡，恰好为Arrietty创造了宜居的生存环境。”
更加闲得没事干的事情发生了。Arrietty社会里最闲得没事干（代理机构1号A型觉得这群人完全就是无可救药的蠢蛋）的那一批建立了智人崇拜宗教，感恩智人为Arrietty的付出。“如果没有主的努力，我们这一支Arrietty就要在太空中流浪更长的时间！”“主为了我们，甚至奉献了自己的智能！”

[智能的讨论]&lt;continue5|

]

(click-replace: ?continue5)[

千该万该最该的就是这个提出来了“智能”的人。这件事引发的浪潮比星球历史研究专家们花了几百个太阳年（这些人无所事事，研究课题也得不到中枢机构的重视，因此研究进展缓慢）出版的《智人诞生消亡史》都要大。几乎整个Arrietty社会都在讨论这件事。一拨人认为，如果智人种真的有智能，那么Arrietty根本不可能占领地球，而是在穿过柯伊伯带之后立刻与地球的舰队激战。另一拨人认为智人种显然是有智能的，但他们也说不出个所以然来。最终，在一群吃饱了饭没事干的人争论里出现了一个站着说话不腰疼和最吃饱了饭没事干的人，他拍案通过了试验场（正式名称叫人类公园）的方案，于是克隆体就诞生了。

代理机构1号A型觉得最扯的是，通过了人类公园方案的居然是Arrietty的最高权力机构中枢机构。

建造一个试验场，将克隆的智人种放进去，让其自行演化，这就可以知道他们是否有智能了。

为了创造适合智人种生存的环境，Arrietty花了很大力气将大陆的环境改造成富氧的（Arrietty是厌氧型生物，为了建造这个公园死了无法计数的Arrietty工人，说试验场是扒Arrietty人皮吃Arrietty人肉建造出来的也毫不为过），又为了让试验场的环境不影响到Arrietty的其他居住区，建造了覆盖整个大陆的保温箱，边界设置在离试验场海岸线的3.5×10的几十个次方的海单位。然后建造了观测智人种生存情况的电磁加速轨道。
后来维持整个大陆的各种循环系统入不敷出，中枢机构一拍思考单元，开放试验场作为景区，吸引Arrietty人观光。

[代理机构1号A型]&lt;continue6|

]

(click-replace: ?continue6)[
最近，负责观测智人种进化的观测员传来消息：存续机构8号发现了当年Arrietty留下的冬眠基地。观测员和整个Arrietty都很看好存续机构8号（Arrietty社会内部每天将智人种演化的过程的信息发送到每个Arrietty人家中，甚至举行猜奖活动，猜哪个存续机构能活下来），于是，代理机构1号A型作为与存续机构8号谈判的代表被制造出来了。

中枢机构遍历留存的人类文明的全部信息，最终选定了一个人类，模仿他的外形创造出了代理机构1号A型。

彼得·斯科特·摩根，博士，出生于公元纪元的1958年，因患渐冻症死于公元纪元2022年，被确诊后，他决定将身体的各部分都替换为机械，成为赛博格。

&lt;img src=https://gitee.com/kellyaties/kellyaties/raw/44b8553e844d0c39a1d747e2868edcaf7314e440/v2-76d042a1b4a3994e1fa113a606f9c182_1440w.png&gt;

//「三个太阳日后，你将抵达试验场，与存续机构8号谈话。」//中枢机构如此对摩根说道。

摩根其实对这次与存续机构8号的谈话没有任何兴趣，也没有做任何的准备。他只是一个代理，真正与存续机构8号对话的会是中枢机构自己。他没有权力发表任何的个人意见。

出发前，观测员传来消息：存续机构8号正在积极推动对冬眠基地和Arrietty的研究。

//「他们到底是有智能，抑或没有？」//

摩根不关心。毕竟，太弱小的文明，无论做什么，熵增也不会因此为它停留半步。

[[继续-&gt;过渡2]]

]</tw-passagedata><tw-passagedata pid="229" name="智能0" tags="" position="2275,5450" size="100,100">你将决策告知给摩根，他看起来很惊讶，那对仿生的义眼里出现了意外的神色。

“我很意外你们做出这样的决定。”他说，“请稍等，中枢机构将举行快速会议，尽快回复你的问题。”

摩根缓缓地垂下仅剩的人类的头部，他的义眼熄灭了。此时此刻，位于地球上另一片辽阔大陆的阿莉埃蒂世界的最高权力机构正在紧锣密鼓地讨论。

你和思想家静静地等待。直到茶水彻底冰凉，摩根才抬起头。

“中枢机构同意了。他们表示可以向你们共享光速航行的技术。”

[[你们中枢机构都是一群疯子吗？-&gt;智能1]]
[[为什么要这么做？-&gt;智能2]]
[[好。 -&gt;智能3]]</tw-passagedata><tw-passagedata pid="230" name="中枢机构4" tags="" position="2150,4450" size="100,100">招待所内，侍者送来了酒水，你询问赛博格是否需要插电，他摇头说不用。

“祝贺你们走到今天。”侍者将门关上后，中枢机构再次摆上那标准的微笑——思想家觉得他笑得很诡异，每次微笑都是同一个弧度，像是有自动设置似的。——然后对你们说道。

“我不知道这是什么意思，”你说，“这有什么好祝贺的。我也不明白您们来到这里的目的。”

“按照你们先祖的思维，这是一次对自己圈养的宠物的视察吧。”中枢机构的笑容变得皮笑肉不笑，不紧不慢，声音四平八稳地说道。

[[克隆我们是为了娱乐吗？Es gefällt ihnen, uns zu klonen?-&gt;智能4]]
[[放你妈的屁。Fuck you.-&gt;智能5]]
[[是来通知我们的死亡吗？Sind Sie nach hier gekommen, um wir zu töten?-&gt;智能6]]</tw-passagedata><tw-passagedata pid="231" name="智能4" tags="" position="2125,4600" size="100,100">你平静地看着他，“你们克隆我们，只是为了娱乐吗？”

中枢机构摇摇头又点点头，“是，也不是。”

中枢机构娓娓道来：“其实，对于地球历史的研究，在我们的社会里只是一个很小众的圈子。只不过对于你们是否有智能的讨论引发了全社会的关注。因此我们创造了这个公园，克隆了人类。”

[[什么智能？-&gt;智能7]]
[[所以今天是为何而来？]]
[[为什么以赛博格的形式来？]]
</tw-passagedata><tw-passagedata pid="232" name="智能5" tags="" position="2250,4600" size="100,100">你和思想家脱口而出：“放你妈的屁。”

[继续]&lt;continue|

(click-replace: ?continue)[

摩根：“你们的素质很差。”

思想家：“这是正常人类会有的反应。你不能理解是因为我们物种之间存在沟壑。”

“中枢机构不在乎你们的意见。”摩根再次挂上他那张惹人嫌的标准笑脸。“请认清楚我们之间的差距。这片大陆上所有水源、热量乃至氧气，都是阿莉埃蒂世界供应的。”

思想家沉默了。

你大概知道思想家想说什么……

[[帮思想家说话-&gt;逼样的这么有实力]]
[[沉默-&gt;所以今天是为何而来？]]

]</tw-passagedata><tw-passagedata pid="233" name="智能6" tags="" position="2000,4600" size="100,100">“死亡，”中枢机构重复了一遍，“怎么会，你们在阿莉埃蒂世界可是大明星，每个个体都会准时收看你们的生存影像。保证这里的电力和水源供应可是现在阿莉埃蒂社会的头等大事。”

中枢机构顿了顿，接着说道，“请不要紧张，你们的反应在我的预料之内。虽然我们和你们的先祖没有直接交际，但残存的资料足够我们研究。我们有一套完善的模拟人类思维逻辑的模型。我了解到，你们现在认为阿莉埃蒂是你们的敌人。其实这很荒谬——我的意思是，即便用人类的思维来看，这也是一件很荒谬的事情。我们为什么一定要是敌人呢？宇宙很大，阿莉埃蒂世界和人类世界能相遇，本来就是一种缘分。”

“满口胡话。”思想家脱口而出。中枢机构并不恼，只是微笑着。

你抬手示意思想家，制止了他继续说话的行为。

[[所以今天是为何而来？]] </tw-passagedata><tw-passagedata pid="234" name="1.大开发" tags="" position="325,4075" size="100,100">你将目光投向了遥远的北部。

你知道这里素来是资源的聚宝盆，然而此地条件之恶劣艰险，以当时的科技水平判断，只怕是得不偿失。

但是现在时过境迁，你相信你的国家有能力占领这片聚宝盆。

&#39;&#39;成就：北部开发&#39;&#39;


[继续]&lt;continue|

(click-replace: ?continue)[

“往北部去！”成了这数十年里你全国上下最响亮的口号。天上地下，唯一不会熄灭不是太阳，而是北部矿井和油井的灯。你们凭借着高超的技术和惊人的毅力吃下了这块难啃的骨头，也得到了丰厚的报酬。你们一跃成为了整片大陆最富有的国家，经济总量比其他所有国家加起来都多。

灰黑色的手与脸是勤劳工作的证明，遮天盖地的滚滚浓烟是生产力的象征，漆黑的河水是工业先进的代名词。

每个灰头土脸的人都喜笑颜开，直到有一天，名为环保的风悄然拂过你的脸庞。

[[环保之风……？]] 
]</tw-passagedata><tw-passagedata pid="235" name="智能1" tags="" position="2275,5575" size="100,100">你不解地看着摩根，“你们疯了吗？你们占领了人类原来的家园，圈养人类，现在说放走就放走？你不怕我们报复吗？”

摩根答道：“为什么我们一定是敌人的关系呢？你的想法有点奇怪了。阿莉埃蒂世界从不把你们当作敌人。”

思想家说：”那是因为你们觉得自己是我们的主人。事实上，人类内部产生夺回地球的想法很正常。”

[继续]&lt;continue|

(click-replace: ?continue)[

摩根又笑了笑，“是的，可以理解，在我们的考量范围之内。但是，阿莉埃蒂世界依旧不在乎。你的想法，在你们的光速飞船飞出太阳系的那一刻就会知道自己有多愚蠢。”

阿莉埃蒂世界已经有了完善的防御机制。这个文明拥有傲慢地俯视你们的资格。

即使人类在后来掌握了毁灭阿莉埃蒂文明的技术，也要时刻提防阿莉埃蒂的主力舰队——它们仍然在太空光速航行中，而且他们知道太阳系的坐标。

但是共存是不可能的。公园固有的资源已经接近开采完毕，阿莉埃蒂世界也不可能割让领土，况且，现在的人类依旧是寄于阿莉埃蒂世界篱下的状态。

“阿莉埃蒂世界愿意向你们分享技术。”摩根重复了一遍。“请你们思考后告诉我决定吧。在阿莉埃蒂世界，你们很受欢迎，中枢机构愿意一直等你们。”

[[继续逃亡-&gt;确有智能]]

]</tw-passagedata><tw-passagedata pid="236" name="智能2" tags="" position="2400,5575" size="100,100">中枢机构笑了一下，“没有那么多为什么的。你们对我们构不成威胁，而我们的实验也已经结束了。”

思想家说：”那是因为你们觉得自己是我们的主人。事实上，人类内部产生夺回地球的想法很正常。”

[继续]&lt;continue|

(click-replace: ?continue)[

摩根又笑了笑，“是的，可以理解，在我们的考量范围之内。但是，阿莉埃蒂世界依旧不在乎。你的想法，在你们的光速飞船飞出太阳系的那一刻就会知道自己有多愚蠢。”

阿莉埃蒂世界已经有了完善的防御机制。这个文明拥有傲慢地俯视你们的资格。

即使人类在后来掌握了毁灭阿莉埃蒂文明的技术，也要时刻提防阿莉埃蒂的主力舰队——它们仍然在太空光速航行中，而且他们知道太阳系的坐标。

但是共存是不可能的。公园固有的资源已经接近开采完毕，阿莉埃蒂世界也不可能割让领土，况且，现在的人类依旧是寄于阿莉埃蒂世界篱下的状态。

“阿莉埃蒂世界愿意向你们分享技术。”摩根重复了一遍。“请你们思考后告诉我决定吧。在阿莉埃蒂世界，你们很受欢迎，中枢机构愿意一直等你们。”

[[继续逃亡-&gt;确有智能]]

]</tw-passagedata><tw-passagedata pid="237" name="智能3" tags="" position="2150,5575" size="100,100">你点了点头，没有多说，“好。”

这是你和摩根博士最后的交谈了。

[[继续逃亡-&gt;确有智能]]
</tw-passagedata><tw-passagedata pid="238" name="逼样的这么有实力" tags="" position="2450,4550" size="100,100">你帮思想家说了：“逼样的，你们他妈的这么有实力。”


[继续]&lt;continue|

(click-replace: ?continue)[

中枢机构的义眼熄灭了一瞬又亮起来了，“我可以把它当成赞美。”

“所以，”你问道，“远道而来，是为何而来？”

中枢机构说道，“祝贺你们，顺便，告诉你们地球的历史。”

见你们沉默，他又接着说道，“你们不想听吗？我觉得，你们听完了地球的历史，会对你们现在的文明发展有很大的帮助。”

[[地球往事1]]

]
</tw-passagedata><tw-passagedata pid="239" name="智能7" tags="" position="2175,4775" size="100,100">中枢机构：“这个问题，我很难给你解释。”

他顿了顿，“但我相信，你以后会懂的。”

思想家：“所以现在解释清楚很难吗？”

[[所以今天是为何而来？]] </tw-passagedata><tw-passagedata pid="240" name="所以今天是为何而来？" tags="" position="2475,4725" size="100,100">“所以，”你问道，“远道而来，是为何而来？”

中枢机构说道，“(if:(history:)contains&quot;存续机构&quot;)[祝贺你们，](if:(history:)contains&quot;智能8&quot;)[警告你们，]顺便，告诉你们地球的历史。”

见你们沉默，他又接着说道，“你们不想听吗？我觉得，你们听完了地球的历史，会对你们现在的文明发展有很大的帮助。”

[[地球往事-&gt;地球往事1]]

</tw-passagedata><tw-passagedata pid="241" name="为什么以赛博格的形式来？" tags="" position="2325,4775" size="100,100">你说：“为什么不以你们本来的样子过来，而是要用赛博格的样子？甚至是一个死去的前人类。”

中枢机构说道：“这是我们的生理结构的原因导致的。以你们智人种的角度来观察，阿莉埃蒂人非常小，可能跟你们世界的蚂蚁差不多大。这样交流会非常费力，于是我们选择了制造一个和你们外形相似的机器人。而且，阿莉埃蒂世界读过你们留下来的文学作品，有些人类作家是这么处理的，是吧？”

你摇摇头：“我不知道。”

[[所以今天是为何而来？]] </tw-passagedata><tw-passagedata pid="242" name="地球往事1" tags="" position="2475,4850" size="100,100">“阿莉埃蒂世界来到地球的时候，这里已经没有任何智慧生物了。地球表面是灰色和黄色的，氧气含量非常稀薄，这很适合厌氧的阿莉埃蒂文明生存。”

[[1.从哪来的？]]
[[2.但是这里有氧气]]

</tw-passagedata><tw-passagedata pid="243" name="确有智能" tags="" position="2275,5725" size="100,100">你和思想家对视，他将所有信息都用眼神传递给了你。

”我们决定离开。”你说。

[飞船]&lt;continue|

(click-replace: ?continue)[

阿莉埃蒂世界派来了教师、工程师和科学家，分别是不同型号的代理机构。在他们的帮助下，人类的基础科学以突飞猛进的速度发展。很快，人类制造出了宇宙飞船的雏形——实用在这一刻走在了理论前面。

“制造飞船本身不是什么问题，”来自阿莉埃蒂的工程师说，“难在针对人类设计生态循环系统。不过，我们已经有了很成熟的人体冬眠技术，稍微改改就可以拿来用了。”

“我们完全不是一个量级的。”本国的学者对你感慨道，“阿莉埃蒂想弄死我们易如反掌。”

第一艘飞船成功研制了。在全国民众的见证下，这艘飞船开始试飞，预定的轨道是刚好飞出太阳系些许，然后原路折返，预计花费时间数年（对于地球坐标系来说）。

剩余的时间里，全国上下都在紧锣密鼓地制造更多的飞船。

[启航时刻]&lt;continue2|

]

(click-replace: ?continue2)[

总务官和你一起站在舷窗旁边俯瞰大地。

“这一天终于是到来了。”总务官说。

你没有说话，只是轻轻点头。

所有决定离开的人都已经上了飞船，官员们在进行最后的人数清点，在阿莉埃蒂世界的帮助下，国土上修满了飞船加速轨道。所有飞船都在轨道上等候。

随着耳机里传来所有部门一声声的”可以起飞“，总务官默默将受话器移开，转头看向你。”请下命令。“他严肃、尊敬地说道，并且第一次称呼了你：”存续机构8号。“

“准备冬眠。”你说。

[人类未来]&lt;continue3|

]

(click-replace: ?continue3)[

很久很久以前，这个星球曾被一个文明统治，它们的工业高度发达，但代价是将这颗星球的自然资源开采得接近枯竭。

于是，作为报应，那个文明亲手毁灭了宜居的环境，强大的工业变成了杀死自己的利刃，随后便在绝望之中灭亡了。

很近很近以前，一个远道而来的殖民者发现了这颗表面灰色与黄色的星球，惊讶万分。

//「这里的大气环境中的氧气浓度非常低，几乎是无氧环境，非常适合生存。」//

殖民者从此在这里定居了。

殖民者在这颗星球上发现了那个文明遗留的信息。

它们没有花多少时间便将其解读破译了，这对于这个能实现星际间的长途航行的文明来说轻而易举。随后，他们在这颗星球上唯一孤立的大陆上，复活了那个文明。

//「它们到底是有智能，抑或没有？」//

这个文明如今给出了答案。

代理机构1号A型，外形为彼得·斯科特·摩根，一名因渐冻症死去的赛博格，站（坐）在阿莉埃蒂世界的中枢机构面前汇报。

//「经过如此单位的时间里的演化，我们可以认定：存续机构8号确有智能。」//

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;Good End 人类未来&#39;&#39;

&#39;&#39;成就：到底是智能还是不智能？&#39;&#39;

[STAFF名单]&lt;continue10|
]

(click-replace: ?continue10)[

(display:&quot;STAFF&quot;)

作者批注：本结局仅为迎合作业要求“反应原作小说主旨”撰写，不代表作者及制作组立场，请阅读原作小说《人类公园》。

[[点此返回标题画面-&gt;导入]]]]


</tw-passagedata><tw-passagedata pid="244" name="寄人篱下" tags="" position="2500,5450" size="100,100">你最后还是决定不离开地球。思想家被你的决策气得怒火中烧，连着劝你几天，都没能让你改变自己的意见。

“我要求举行公投，”最后一天，思想家敲开你的门，声音沙哑得不成样子，“我不相信民意与你一致。”

思想家补充道：”公投只会分两种情况，同意留在这个地球的人，和决定逃亡的人。”

[全民公投]&lt;continue|

(click-replace: ?continue)[

你们选了一个日子，将所有国民召集在一起，举行公投大会。投票持续了整整一个星期，计票花了更多的时间。

内务官将票数统计完，你在全国民众面前宣读了结果。

投票结果六比四，逃亡主义输了。

[[谈判-&gt;不智能1]]

]</tw-passagedata><tw-passagedata pid="245" name="资产阶级共和国" tags="" position="750,3950" size="100,100">留学生带回来的书籍里有关于资本主义的论述。

你根据这本书的理论，变革了社会阶级，建立了资本主义共和国。

[[继续-&gt;过渡1]]</tw-passagedata><tw-passagedata pid="246" name="共产主义共和国" tags="" position="875,3950" size="100,100">留学生们带回来的书籍里有关于共产主义的论述。

你根据这本书的内容，变革了社会阶级，建立了共产主义共和国。

[[继续-&gt;过渡1]]</tw-passagedata><tw-passagedata pid="247" name="1.求和" tags="" position="1025,4125" size="100,100">你向各国发出邀请，前往中立国首都进行停战谈判。

“我们两国本情同手足，但这次是我国一时冲动，犯下了大错，牵连了诸位，恳请诸位能够原谅，就此停战。”

[继续]&lt;continue|

(click-replace: ?continue)[

诸国商议过后，同意了停战，只不过开出了巨额的战争赔款和苛刻的割地条约。

&#39;&#39;状态栏：
经济状况↓
社会稳定↓
领土面积↓
&#39;&#39;
[[异变？]]

]</tw-passagedata><tw-passagedata pid="248" name="2.继续打仗" tags="" position="875,4125" size="100,100">谈判桌上的屈辱化为了愤懑，也泵足了每个士兵的士气，在宣战声明的第二天，你指挥着军队马上就对势如破竹的敌军进行了反击，不料却轻易地撕碎了敌方的围剿。

思想家非常不赞同你的行为：“这是蠢货才干的事。”

你的意见
[[1.求和]]
[[2..继续打仗！]]</tw-passagedata><tw-passagedata pid="249" name="2..继续打仗！" tags="" position="875,4250" size="100,100">踏踏开。

[继续]&lt;continue|

(click-replace: ?continue)[

你决定进一步控制联盟的政府，你知道这步棋如果成功了，你国的势力将能够独步海内，更能把触腕进一步地伸展，你知道，只有兼并和垄断能让你走得更远，而这正是你目前迫切需要的。

短短三年里，你指挥的军队把敌方联盟的主城门叩了个遍，最后在经过两个月的围城战役之后，你完全拆散了联盟，成功迫使对方签订了诸如驻军和赔款之类的一系列条约。
于是这次四年不到的战争草草地结束了，但在你对将士三月的大宴之下，只有忠心的老臣知道，在刚纳入版图的这些地方之下，有熊熊的地火正在燃烧。

起初，你只是随意地掐灭了几支起义的军队，但不知道是不是你的军队正在老去，还是命运有意弄人，这些无名的鬼火左突右冒，渐渐凝成了一只你掰不过的巨腕。
你知道，再不想点什么办法，这只手很可能会攀上你的咽喉。

[技术爆炸]&lt;continue|

]

(click-replace: ?continue)[
科技的力量在这次战事体现得淋漓尽致。本国和联盟的所有科学家没日没夜地泡在实验室里，更多大杀伤力和远距离精准打击的武器被研制出来，而且技术上限在不断地被突破：今天你国研制出1500km精准制导的导弹，第二天就吃了一记来自联盟的2500km。

“这完全是军备竞赛。”一日，报纸头条刊登了这条名词。


[[1.狠狠地军备竞赛]]
[[2.求和-&gt;1.求和]]

]</tw-passagedata><tw-passagedata pid="250" name="1.狠狠地军备竞赛" tags="" position="725,4250" size="100,100">狠狠地军备竞赛！真理在大炮的射程之内！

终于，你国和联盟的科学家分别独立地写出来了这条公式：E=mc²。

[[无休止的战争及其后果]]

</tw-passagedata><tw-passagedata pid="251" name="1.从哪来的？" tags="" position="2625,4900" size="100,100">中枢机构说：“阿莉埃蒂文明是在宇宙中持续巡航的文明，我们只是其中一支舰队。主力舰队，我不知道，最后一次收到他们的传讯，是在仙女座。”

[[好吧，继续说吧-&gt;地球往事2]]</tw-passagedata><tw-passagedata pid="252" name="2.但是这里有氧气" tags="" position="2625,4750" size="100,100">你很不解：“可是这里有氧气。”

中枢机构：“当然有氧气。这个试验场是阿莉埃蒂世界改造出来的。经过无数次失败才调整出如今适宜你们生存的环境。”

[[原来如此，继续吧-&gt;地球往事2]]</tw-passagedata><tw-passagedata pid="253" name="地球往事2" tags="" position="2750,4850" size="100,100">“随后，阿莉埃蒂世界里的一部分人对地球上的非自然痕迹起了好奇心，他们自发地开始研究起地球历史来，主要集中在对于灭绝的前人类文明进行调查。事情的转机发生在智人化石的发现。”

“化石，”你说，“已经过去了这么久的时间？这也能还原出来。”

中枢机构看向你，“你提到了很重要的一点。阿莉埃蒂文明拥有分析和还原地球生物大脑部分信息的能力，哪怕已经变作化石。而且，前人类文明还是留下了一些史料，对他们的研究有很大帮助。”

“我们就是这样诞生的？”你说。

中枢机构点了点头。

[[这对我们有什么帮助？]]Doch, wie hilf es uns?


</tw-passagedata><tw-passagedata pid="254" name="1.出台贸易限制政策" tags="" position="2075,2350" size="100,100">你及时出台了贸易限制政策，和邻国讨论规定了贸易细则，阻止了恶意倾销，维护了两国的关系。

&#39;&#39;成就：见好就收&#39;&#39;

[[异变？]]</tw-passagedata><tw-passagedata pid="255" name="忍气吞声" tags="" position="1875,4550" size="100,100">即便你肆无忌惮地倾销商品，邻国也只能忍气吞声。

[[异变？]]</tw-passagedata><tw-passagedata pid="256" name="分享食水" tags="" position="975,2900" size="100,100">军队向你们分享了一些干粮和水。

与将军谈话得知，他们是游牧民族建立的国家派去开赴前线的军队。

将军听了你们的遭遇，询问你们是否要加入他们的队伍。

“你们要是有愿意的，可以成为战士，不愿意的，也可以留在后勤部队管粮草。”将军说。

“我不愿效忠您以外的人。”总务官闻言私下与你说道。

你的决策

[[1.加入军队]]
Der Armee beitreten
[[2.道谢，直接离开]] 
Bedanken Sie sich und gehen Sie sofort

</tw-passagedata><tw-passagedata pid="257" name="1.加入军队" tags="" position="875,3100" size="100,100">你点头，“好。感谢将军收留。”

将军一拉马绳，调转马头朝向北方。

地势三城远，河源二水分。
火山稀好雨，盐泽足愁云。
雕没平沙外，驼鸣绝涧濆。
凭高时引睇，何以策中原。



(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[=
&#39;&#39;结局25：无以为家&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]</tw-passagedata><tw-passagedata pid="258" name="增殖的G" tags="" position="1250,2650" size="100,100">一日，你们途径一块黑棕色的土地。

“感觉这块地方不对劲。”军事官说道。

[探查土地]&lt;continue|

(click-replace: ?continue)[

你派出地文官和哨兵前去探查。

“感觉这块土地像是有生命一样。”思想家说。

“我知道，巨背怪物的传说，”历史学家说道，“传说有一个巨大无比的怪物，卧伏在大地上，人们都以为那是小山……”

[！]&lt;continue2|

]

(click-replace: ?continue2)[

地动山摇。

黑棕色的土地忽然裂开，变作透明的网膜，然后猛地振动。

你看见了被网膜拍飞的地文官和哨兵，听见了他的呐喊：

“原来是蟑螂啊！”

&lt;img src=&quot;https://cdn.233.momobako.com/ygopro/pics/23434538.jpg&quot;&gt;

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[=
&#39;&#39;结局26：原来是蟑螂啊！&#39;&#39;


[STAFF名单]&lt;continue3|

]

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]

]
</tw-passagedata><tw-passagedata pid="259" name="2.作罢" tags="" position="1050,4475" size="100,100">你们就此作罢，退出冬眠基地。

此次的成果已经足够震慑全社会。已有的科学体系受到猛烈的攻击。全国上下都在问同一件事情：“我们是从哪来的？”

作为文明的执政者，你

[[1.封杀所有类似言论，实行思想专制]]
[[2.尝试调查这个强大的未知文明]]

(text-colour:red)[请谨慎选择。]
</tw-passagedata><tw-passagedata pid="260" name="这对我们有什么帮助？" tags="" position="2750,4975" size="100,100">(if:(history:)does not contain&quot;存续机构&quot;)[中枢机构顿了顿，“我们观测到你们在进行环保主义的发展。哦，这是对于你们来说的。对于阿莉埃蒂世界而言，这是一次灾难。”
“因为你们是厌氧型的？”科学官说道。
“是的，”中枢机构看着他点头，“你们甚至能够改造公园以外的地方。”
“350海里以外的魔境？”总务官脱口而出。
“是的。”中枢机构再次承认了。“这种行为已经威胁到阿莉埃蒂世界的安全，因此我作为代表被派出来谈判。”

“阿莉埃蒂世界，”你觉得这个名字有些拗口，“谈判的主题是什么？”

瘫痪的博士身上闪现出文字，“这是阿莉埃蒂世界给出的条件。一、接受清理，跟随这片大陆一起毁灭；二、离开地球，必要的星际航行技术，阿莉埃蒂世界会给予支持。”

还没有等其他人说话，思想家就已经猛地站了起来，“白日做梦！”他怒吼道。

&quot;冷静一下。&quot;中枢机构说道。“这种事情在我们的预料之中。我可以很明确地告诉你们：反抗阿莉埃蒂世界并不是一个明智的抉择。公园的水、电、热都由阿莉埃蒂世界供应，”


]




(if:(history:)contains&quot;存续机构&quot;)[中枢机构欣然一笑：“请不要忘记，你们在阿莉埃蒂世界是大明星。我们的观测员会定期汇报你们的情况。我可以明确地告诉你：这片大陆的自然资源已经接近枯竭了。”

思想家用冰冷的眼神注视着他，“你想表达什么。我的意见、人类的意见不会发生更改。你们为了取乐创造出这个世界，将我们丢到这片大地上，观看我们面对天灾时的胆战心惊，小心翼翼、提心吊胆地度过每一天，又假以造物主之名假惺惺地过来表示友好。这是我们的家园！你们鸠占鹊巢在先，没有寄你篱下的道理。人类会反抗你们的统治，直到把你们驱逐出太阳系。”

中枢机构慢慢地开口说话，“您的道理更是无从道理。这颗星球从来就不是属于灵长类智人种的，在更久远之前，你们先祖的先祖，那时候还是名为南方古猿的物种，并不是这个星球上的强势物种，也像你们一样每天过着胆战心惊的生活。因为那时候，统治这颗星球的，是一种名叫恐龙的巨大无比的物种——在智人种眼里，阿莉埃蒂人是一种非常微小的生物，但恐龙即便对于人类来说也是非常巨大的物种。不知过了多久，恐龙忽然全部灭绝了，直到这一刻，弱小的智人种才第一次获得了统治这颗星球的机会。鸠占鹊巢，应该是说的智人种吧。”

“这不是我说的，”中枢机构脸上浮现出友好的笑容，“这是你们先祖的史书说的。如果你们想看，我可以给你们拷贝PDF文件。”

思想家被他的话噎住了，你也陷入了沉默。

[继续]&lt;continue|


(click-replace: ?continue)[

“但我知道，”中枢机构继续说道，“这并不能熄灭你反抗阿莉埃蒂世界的决心。事实上这在阿莉埃蒂世界里早就有过广泛讨论。”他说这话时，眼睛看着思想家，一针见血。

“中枢机构对此给出的解决方案是，邀请智人种的一位作为代表，前往阿莉埃蒂世界进行为期一个月的参观考察。相信在对阿莉埃蒂世界有了深入的了解之后，你们能更加清楚地意识到我们之间的差距，从而再次思考你们的决策。”摩根说道。“此外，不作为阿莉埃蒂世界的中枢机构，而是作为我自己——代理机构的话，我认为反抗阿莉埃蒂世界是一个很不明智的决策。”

“这更是荒谬。”思想家毫不留情地驳斥道，“将同胞送入敌人的心脏里！这是人类能干出来的事？”

中枢机构一顿，眼睛里似是出现讶然的神色，”原来不是吗？“

你觉得他说的话是对的。

[我们其实没有选择，是吗？]&lt;continue2|

]


(click-replace: ?continue2)[

你说：“我们其实没有选择，对吧。”

中枢机构转向你，微笑着颔首，“是的。这是来自阿莉埃蒂世界的通知，并不是征求意见。这项提议被起草后，全社会上下都为了拟派出的代表人选争吵了数十年。最终，我们决定了。”

中枢机构的视线落在你身后一直静坐着的人身上。

你忽然感觉到他的笑容变得恶意。

他选的是现任的科学院院长。

[继续]&lt;continue3|

]


(click-replace: ?continue3)[

科学院院长其实一直在场旁听，但他直到现在为止，一句话也没有说。此人脸色铁青，嘴唇煞白。他从未想过，只在父辈和书本上见到过的事情居然是真实的。而且，代理机构的言行举止让他觉得这并非是一个和蔼可亲的死去的巨人，而是一个微笑着摆弄人类的木偶师。

“我不想去。”科学院院长毫不犹豫地说道。

“很抱歉，你没有选择。”中枢机构边说，边抬起了机械义肢，指了指天上，“你们称呼加速轨道作光带，对吧？那其实不只是观光轨道，也是武器。阿莉埃蒂通过那条轨道发动对地打击全程不需要半小时，然后这片大陆将会回归最原始的状态。”

“简直是绑架。”你说。

中枢机构看向你，你总觉得他看你的眼神与看其他人类的眼神并不一样：“这是综合一切条件得出的最优判断。”

“我不理解。”你说，“在我眼里，你们应该带走的是我，文明的领导者。”

“不，存续机构，”他忽然呼唤你，“我们一切所作所为，都是为了证明你有智能。”

“什么智能？”你(if:(history:)contains&quot;智能7&quot;)[又]问出来了这个问题。

中枢机构没有回答你。

[[继续-&gt;死寂一样的沉默]]

]

]
</tw-passagedata><tw-passagedata pid="261" name="环保之风……？" tags="" position="25,4250" size="100,100">近日学界忽然出版了一篇名为“可持续发展及环保主义”的论文，引起了广泛关注，科学官在晨会提及了这件事，并将复印件交给了你。

[[1.搁置-&gt;并非智能]]
[[2.阅读-&gt;环保主义1]]</tw-passagedata><tw-passagedata pid="262" name="并非智能" tags="" position="225,4250" size="100,100">(if:(history:)does not contain &quot;环保主义1&quot;)[

数百年过去了。

曾经你以为这世上有且仅有几件事情是永恒的：太阳、月亮、繁星、你和北部矿脉。但现在看来，曾经你以为深不见底的北部煤矿居然开始枯竭了。
能源短缺只是问题冰山一角，医疗官向你汇报：“全国各地都蔓延着瘟疫，一个乡村医生在新闻上发布了他的意见，认为是煤矿开发导致的：他是这么解释的：工厂使用了大量河水给机器降温，同时机器生产也需要水，确实这些水会被重新排出，但他认为这些被排出的水是非常肮脏且带有很多病菌的，得病的居民们的一大共同点便是都喝了这些被排出的水。”
农业官向你汇报：“今年歉收的程度超乎我们的想象，许多郡县都没能上缴足够的粮食。农民们一致告诉我们，土地种不出粮食了。有部分农民还说，如果是在工厂附近的土地种植，种出来的植物似乎有毒，很多吃了这些食物的人都突发重病死去了。另外，牧民也告诉我们，工厂附近的土地长出来的草、附近的河流的水都不能给牲口吃喝，否则会使牲口大规模病死，即使没有病死，它们的肉也是有毒的，人吃了会患病。”
工业官说：“煤田附近的土地发生了奇怪的下陷现象。那儿有一座工厂，地表突然下沉，整个工厂毫无预兆地崩塌了，设备的损失价值还在估计，当时在工厂内工作的工人几乎都遇害了，仅有少部分人逃了出来。”
总务官说道：“反对者越来越多了，许多工厂被反对工业者围攻，他们要求停止发展工业，恢复环境。”
………………

[思想家的意见]&lt;continue2|

]

(click-replace: ?continue2)[

你找到思想家时，他正在专心雕刻木雕。听了你的话，他没有立刻说话，而是将木雕上的木屑用毛刷扫掉。
“在祸患发展成灾难之前，已经有人向您建议过。”他说，“但是，您没有在意。”

“现在该怎么办？”你说。

“这片土地已经不再适合生存，”思想家说，“若是想要一劳永逸，搬迁到新的家园最为合适。”

“可是如果不解决问题，只是在重复毁掉下一片土地的过程而已。”你并不赞成。

思想家摇摇头，“可是这片大地已经没救了。事到如今再修复这里的环境，成本远远比搬迁要高得多。”

思想家将一份报纸递给你，“而且，已经有人这么做了。”


[350海里外的世界]&lt;continue|

]

(click-replace: ?continue)[

报纸上刊登道：“有人尝试出海寻找新的大陆。”

紧接着又是一份：“已有二十名出海水手失联。”

你说：“350海里以外的世界是地狱，他们怎么敢越过那道天堑的？”

从来没有人能够越过350海里。据说350海里以外的海域凶险异常，船只只要越过那个界限就会立刻被海怪扑杀。

思想家说：“可是，和如今的国内比起来，350海里以外的世界也不是魔境了。”

你沉默，你知道自己没有反驳的能力。


[所以，您也建议我出海。]&lt;continue|

]

(click-replace: ?continue)[

思想家顿了顿，然后说道：“与其说是建议，不如说我认为探索魔境是我们的宿命。”

[胶囊里的小人阿莉埃蒂]&lt;continue|

]

(click-replace: ?continue)[

一日，光带上飞驰过一粒细小光点。光带是电磁加速轨道，光点其实是能承受巨大G值的运输用胶囊，不过现在主要作为观测和观光使用。

胶囊里的生物俯瞰大地。

[星球的过去]&lt;continue1|

(click-replace: ?continue1)[

很久很久以前，这个星球曾被一个文明统治，它们的工业高度发达，但代价是将这颗星球的自然资源开采得接近枯竭。

于是，作为报应，那个文明亲手毁灭了宜居的环境，强大的工业变成了杀死自己的利刃，随后便在绝望之中灭亡了。

[远道而来的殖民者]&lt;continue2|

]

(click-replace: ?continue2)[

很近很近以前，一个远道而来的殖民者发现了这颗表面灰色与黄色的星球，惊讶万分。

//「这里的大气环境中的氧气浓度非常低，几乎是无氧环境，非常适合生存。」//

殖民者从此在这里定居了。

[文明的复活]&lt;continue3|

]

(click-replace: ?continue3)[

殖民者在这颗星球上发现了那个文明遗留的信息。

它们没有花多少时间便将其解读破译了，这对于这个能实现星际间的长途航行的文明来说轻而易举。随后，他们在这颗星球上唯一孤立的大陆上，复活了那个文明。

//「它们到底是有智能，抑或没有？」//

[历史的再演]&lt;continue4|

]

(click-replace: ?continue4)[
氧气的浓度变得极低，绿色的森林被冰冷的黑色钢铁森林取而代之，蔚蓝的海水变成深邃的漆黑。开发的痕迹随处可见。

殖民者曾研究了好长一段时间，才将试验场的海域、试验场陆地上的生态恢复到那个文明原来的样子。但是如今，一切又重演了，实验体亲手将这些摧毁得一干二净，和他们的祖先一样。

克隆体并非坐以待毙。记录显示，他们尝试了一切自救的办法，甚至扬帆起航，尝试越过350海里以外的无氧区，但都以失败告终。在极度的绝望和不甘中，殖民者观测到了存续机构8号彻底停止了活动。

胶囊里的生物(text-style: &quot;blink&quot;)[殖民者]俯瞰大地。

//「和刚来的时候一模一样了。」
「没有对它们的进化做出任何干涉。」
「结果是一样的。」
「也就是说，他们确实是我们的先驱。」
「人类在历史中学到的唯一教训，就是人类无法从历史中学到任何教训。此事在他们先祖著作中亦有记载。」//

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;Normal End 历史重演&#39;&#39;


[STAFF名单]&lt;continue10|
]

(click-replace: ?continue10)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]

作者批注：本结局仅为迎合作业要求“反应原作小说主旨”撰写，不代表作者及制作组立场，请阅读原作小说《人类公园》。

]
]







(if:(history:)contains &quot;3.烧掉&quot;)[

一日，光带上飞驰过一粒细小光点。光带是电磁加速轨道，光点其实是能承受巨大G值的运输用胶囊，不过现在主要作为观测和观光使用。

胶囊里的生物俯瞰大地。

[星球的过去]&lt;continue1|

(click-replace: ?continue1)[

很久很久以前，这个星球曾被一个文明统治，它们的工业高度发达，但代价是将这颗星球的自然资源开采得接近枯竭。

于是，作为报应，那个文明亲手毁灭了宜居的环境，强大的工业变成了杀死自己的利刃，随后便在绝望之中灭亡了。

[远道而来的殖民者]&lt;continue2|

]

(click-replace: ?continue2)[

很近很近以前，一个远道而来的殖民者发现了这颗表面灰色与黄色的星球，惊讶万分。

//「这里的大气环境中的氧气浓度非常低，几乎是无氧环境，非常适合生存。」//

殖民者从此在这里定居了。

[文明的复活]&lt;continue3|

]

(click-replace: ?continue3)[

殖民者在这颗星球上发现了那个文明遗留的信息。

它们没有花多少时间便将其解读破译了，这对于这个能实现星际间的长途航行的文明来说轻而易举。随后，他们在这颗星球上唯一孤立的大陆上，复活了那个文明。

//「它们到底是有智能，抑或没有？」//

[历史的再演]&lt;continue4|

]

(click-replace: ?continue4)[
氧气的浓度变得极低，绿色的森林被冰冷的黑色钢铁森林取而代之，蔚蓝的海水变成深邃的漆黑。开发的痕迹随处可见。

殖民者曾研究了好长一段时间，才将试验场的海域、试验场陆地上的生态恢复到那个文明原来的样子。但是如今，一切又重演了，实验体亲手将这些摧毁得一干二净，和他们的祖先一样。

胶囊里的生物(text-style: &quot;blink&quot;)[殖民者]俯瞰大地。

//「和刚来的时候一模一样了。」
「没有对它们的进化做出任何干涉。」
「结果是一样的。」
「人类在历史中学到的唯一教训，就是人类无法从历史中学到任何教训。此事在他们先祖著作中亦有记载。」//

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;Normal End 历史重演&#39;&#39;


[STAFF名单]&lt;continue10|
]

(click-replace: ?continue10)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]

作者批注：本结局仅为迎合作业要求“反应原作小说主旨”撰写，不代表作者及制作组立场，请阅读原作小说《人类公园》。

]
]

(if:(history:)contains&quot;3.我觉得思想家说得对。&quot;)[
你将决策告知给摩根，他看起来并不惊讶，平静地微笑着看着你。

“这个决策并不智能，也不合理。”他说。

“我们已经决定了如此。”你说，“像院长那样的懦夫，在知道后就吊死了。剩下来的都是决定要血战到底的战士。”

摩根的笑容弧度没有任何变化，“好吧，我会转述给中枢机构。”他说。

摩根的这次离开没有人去送别。

没有时间了，每一分每一秒时间都很宝贵，打击随时到来。

“我们唯一的任务，就是拼命发展科技。”你对工业部部长说，“必须尽快找到能威胁到阿莉埃蒂世界的办法。”

科学院院长带回来的阿莉埃蒂世界的资料成了唯一的参考资料。内容非常翔实，不仅有阿莉埃蒂世界历史的介绍、社会现状和阿莉埃蒂人的生理结构，还有他们世界科技的详尽介绍。

“晶体的自范性。”在一次会议中，一位教授提及这个概念。“阿莉埃蒂人是硅基生命，但生理结构非常巧妙。一旦结构被破坏，可以宣告这名阿莉埃蒂人类的死亡。自范性是杀死他们最好的手段。”

针对阿莉埃蒂世界研发的武器以近乎疯狂的速度被推进。每天交上来的概念稿都与昨天不同，每一个试做型都比上一个要疯狂，就像一口大钟，一天比一天快地咚咚咚地响。这是人类文明科技发展的速度，也是宣告阿莉埃蒂世界毁灭的钟声，也是……你感觉到了……你死亡的倒计时。

钟声愈发加快，如同一个打点计时器，当它的速度无限大时，所有钟声趋近于同一声。

这是宣告你死亡的枪声(text-style: &quot;blink&quot;)[自毁机构]，还是处决阿莉埃蒂世界的大刀？

[[丧钟为谁而鸣]]
]
</tw-passagedata><tw-passagedata pid="263" name="环保主义1" tags="" position="200,4425" size="100,100">晨会结束，在短暂的闲暇时间里，你翻开了这本影印本。

“资源的总量是有限的，经济的发展、科技进步、文明生存都需要资源。国内北部有广阔的黑森林，如果一天之内全部砍完，这些木材全部加工完，够我们使用数十年的。但是一百年后呢？牧民尤其讨厌绵羊，因为它会吃掉草根，这片草地第二年就不长了。我见到有些官员大把大把地浪费，我觉得甚是可惜，如果他们节俭一些，省下来的资源可以做很多事情。浪费只能给当下带来一时半日的低贱的快感，却会让千百年后的子孙挨饿。……我恳请带头节俭，遏制国内的浪费奢靡之风。”

以你的观点来看，这东西的措辞和论证作为寓言小故事深度足够，作为严谨的学术论文还是有点偷换概念、故意混淆了。

[[1.节俭之风]]
[[2.拜访作者]]
[[3.烧掉]]

</tw-passagedata><tw-passagedata pid="264" name="1.节俭之风" tags="" position="75,4575" size="100,100"></tw-passagedata><tw-passagedata pid="265" name="2.拜访作者" tags="" position="275,4575" size="100,100">次日，你特地找来科学官询问昨日影印本的事情。

“此人师从思想家的徒子徒孙，大学期间修读哲学和历史学，是这个学术沙龙的常客。有学者告知我，参加这个学术沙龙的，基本都是环保主义者。”科学官边说，边将一份学术沙龙的宣传海报递给你，上面赫然写着本周会有一次活动。

“他写的很有意思，”你说，“作为警戒世人的寓言，思想深度是够了，但作为一篇严格的学术论文的话，用词又太儿戏。”

科学官询问道：“您想召见这位学者吗？我可安排。”

[[1.好]]
[[2.暗访沙龙]]</tw-passagedata><tw-passagedata pid="266" name="3.烧掉" tags="" position="0,4400" size="100,100">食之无味，弃之可惜。你不觉得现在国内的社会风气有什么问题，便取来煤油灯打开灯罩，将影印本缓缓烧掉。

次日，科学官又问及起那篇论文，你答道：“无中生有，制造焦虑。”

环保主义的呼声被忽视了。

&#39;&#39;成就：斧斤以时入山林，材木不可胜用也。
&#39;&#39;
[[继续-&gt;并非智能]]

</tw-passagedata><tw-passagedata pid="267" name="1.好" tags="" position="200,4700" size="100,100"></tw-passagedata><tw-passagedata pid="268" name="2.暗访沙龙" tags="" position="350,4700" size="100,100">你只说：“不必。我想秘密参加这次沙龙，请为我准备一个假身份。”

科学官虽觉得怪异，但还是应了好。

[蒙面的不速之客]&lt;continue2|

(click-replace: ?continue2)[

时辰已到，你戴上面具，携邀请函来到沙龙。你使用的假身份是一名大学教授。

侍者在沙龙门口设置了签到表。参会者排队在纸上签字，然后才能进入会议室。你签下姓名，交了与会费，注意到论文的作者已经先你一步来到了沙龙。

“教授，您是第一次来到我们沙龙，欢迎您。”侍者对你说道。

[环保主义者的沙龙]&lt;continue3|

]

(click-replace: ?continue3)[

沙龙开始了。乐团奏起了轻松舒缓的音乐，与会者互相寒暄闲谈，侍者则端来酒水和茶歇。你从旁人口中得知沙龙的举办者是一位权贵的夫人，她今日也会出席沙龙。在侍者的帮助下，你找到了论文的作者，一位博士。你不动声色地坐在他附近，并没有引起他的警惕。

[思想自由的温床]&lt;continue4|

]

(click-replace: ?continue4)[

侍者提示与会者安静，沙龙的举办者、某某豪门之女、某某权贵夫人将要登场了。你听着侍者念夫人的姓名，每一个音节都体现出这位夫人血统的尊贵。

今日沙龙的议题依旧是环保主义。夫人邀请那位发表了论文的博士上台演说，“某博士日前发表的论文似乎引起了政府的注意，这说明我们的活动有成果了。”她说。

[[1.沉默-&gt;沙龙1]]
[[2.附和-&gt;沙龙2]]
[[3.反对-&gt;沙龙3]]

]</tw-passagedata><tw-passagedata pid="269" name="过渡1" tags="" position="1775,3550" size="100,100">又是一年冬季，地文官和气象学家预测这将是一次小规模的寒潮。佣人正在铲掉你的府邸屋檐上的积雪，数个月前，这里还是帝国皇帝的议事处，革命后，帝制被废除，革命党人亲自挂上了现在的牌匾，宣布改制共和。原先权力中心圈子进行了一次大洗牌，有的人丢了乌纱帽，有的人则是被杀了头，有的人投奔了共和国。但总的来说，并没有发生什么太大的变化。你依旧是文明的领导者，总务官改名叫总理，内务官改名叫秘书长，科学官现在是科学院院长，思想家名义上是教育部部长……
不变的是永恒的你和文明，但国家正在飞速变化。思想家（现在的教育部部长，但你还是习惯称呼这个职位的人叫思想家）曾对你说道：“共和制会解决一切问题，一切我们在帝制时解决不了的，共和制都可以解决。”说出这句话的思想家是个老头，在革命党起事前，他就如此预料了。果真如此。经济飞速发展，少有的几次领土纠纷战争也都以完全胜利告终，社会上焕发出了完全不一样的风气，这是你作为统治者感觉得到的：即使只是在总统府，每个官员都朝气蓬勃，互相谈话时彬彬有礼，面对你时，双眼炯炯有神，谈吐文雅。这是你在帝国看不到的景象。
对社会制度和经济情况的讨论成为全国上下最常见的话题。几乎每个人都各执己见，茶前饭后争论得面红耳赤，很快，他们抱团发展成为了学派。日报会专门腾出一个版块记录学派争论，有时你也能听见总统府的官员谈论。
“这是好事，随他去吧。”现在的思想家，一个年轻人如此答复你的问题。“我认为您应该每周都听取科学院院长汇报一下他们学会里的趣事，真的很有趣。”

[科学的进步]&lt;continue|

(click-replace: ?continue)[

你吩咐科学院院长定期向你汇报学会例会的内容。

“一个鞋匠发现两块凸度不一样的玻璃叠放在一起，可以观测到远方的事物。”科学院院长第二周呈送来一份短讯。

[新来的短讯]&lt;continue2|

]

(click-replace: ?continue2)[
“同样重量的棉花和铁块同时从同一个高度坠落，哪个更快到达地面？”科学院院长第三周呈送来一份短讯。

[新来的短讯]&lt;continue3|

]

(click-replace: ?continue3)[

“生物学家普遍认为生物是神创造的。”科学院院长第四周呈送来一份短讯。

随后他补充一篇：“有人正在记录光带流星闪现的时间和规律。”

光带是指天上那条看不见尽头的光带，偶尔会有光点在那条光带上移动，以前星象观察官观测到光点上疑似有生物往下俯视。

[新来的影印本]&lt;continue4|

]

(click-replace: ?continue4)[

科学院院长这次交来一份很厚的影印本资料，标题是“普适力学”，作者详细介绍了他创立的这个名为普适力学的理论，论文背后收录的似乎是沙龙时的讨论和其他物理学家的意见。
作者宣称：“一切物体在没有受到外力作用或受到的合外力为零时，它们的运动保持不变，包括加速度始终等于零的匀速直线运动状态和静止状态，直到有外力迫使它改变这种状态为止。……两个物体之间的作用力与反作用力大小相等，方向相反，并且在同一条直线上。……”

后附的沙龙记录像是某位与会者的速记草稿，你只辨认出来似乎很多人都在为此争论，与会者甚至有闲心对这些发表意见的人增加批注：“无可救药的蠢货”“很有意思的提问”“需要重读文理中学”……

[新来的进化论]&lt;continue5|

]

(click-replace: ?continue5)[

一位出海归来的生物学家公开发表了一篇叫做“自然演化”的报告，科学院院长将他的手稿影印下来连着报告记录一起交给你了。

“据说那些认为是神创造的人们大发雷霆，”思想家漫不经心地说。

你花了点时间阅读完进化论，不知为何感觉论证有些漏洞。

[新来的相对论]&lt;continue6|

]

(click-replace: ?continue6)[

不知过了多久，思想家突发疾病去世，科学院院长也荣休了。普适力学和进化论成为了文明最重要的成果，学会将其认定为是历史上最重要的科学发现。

同样是一个有点寒冷的冬天，有个年轻人敲开了总统府的门，他背了一个沉重的挎包，里面装满了他的手稿。

“我想向您介绍一下我的理论。”年轻人的面颊被冻得通红，眉毛上挂满了雪。

“我认为普适力学不是完全普适的，因此我提出来了相对论。”年轻人一边翻开厚厚的笔记本，一边说道。

[[1.说来听听。-&gt;相对论1]]
[[2.天色很晚了，明日再来吧。-&gt;相对论2]]


]



</tw-passagedata><tw-passagedata pid="270" name="相对论1" tags="" position="1925,3550" size="100,100">你把他请进府内，吩咐佣人烧起壁炉。年轻人光是在玄关拍掉身上的雪都花了数十分钟，随后他跟着你走到会客厅，摘下帽子，上面依旧有掸不掉的雪。
年轻人自述自己出身于偏远的郡县，接受过大学教育，目前在老家的初级中学做数学教师。光是从老家来到首都花了三天多的时间。
“我无意冒犯普适力学理论的创建人，但我认为普适力学适用范围并不普适。”年轻人说道，将他的手稿本翻开给你看，又取来空白草稿纸，边说边给你演算。
“设想一下，一个沉重的铁球放在一张有弹性的网上，球会压出一个坑………………”

待年轻人解释完理论和回答完你的问题，已是日上三竿。

你认为他的理论很完善，批准了他在下一期的学会期刊上出版这篇论文。

相对论的出现轰动了整个物理学界，刚被发布就受到了普适力学拥趸的猛烈冲击和批判。但时间证明了真理永恒，相对论与量子力学共同构建了现代物理学的基础。

[[那个改变文明命运的……]] </tw-passagedata><tw-passagedata pid="271" name="相对论2" tags="" position="1950,3700" size="100,100">你吩咐佣人赶走了那个年轻人。

新来的科学院院长照例给你呈上短讯——这次是一份厚厚的影印本和附件。影印本的标题是“相对论”，这是你读过最长的论文。这个年轻人详细地介绍了他的理论，并以此推翻了普适力学和万有引力理论的普适性。附件则是当时学会的讨论速记，还有各位普适力学拥趸联名信，他们认为这个年轻人是异端，请求处以绞刑。签名比正文还长。

“可是他说的很有意思，”你说，“我觉得他是对的。”

你命秘书长回复了联名信，拒绝了绞刑的请求。

然而狂热的普适力学拥趸并没有就此罢休，又是一个冬季结束的日子，相对论的创建者坐上了从首都大学返回老家的火车，随后被暗杀。

但时间证明了真理永恒，相对论与量子力学共同构建了现代物理学的基础。

[[那个改变文明命运的……]] </tw-passagedata><tw-passagedata pid="272" name="过渡2" tags="" position="2000,3825" size="100,100">(if:(history:)contains &quot;2.作罢&quot; and &quot;1.收集枝条&quot;)[

黑色枝条的样本被送往国家科研所进行分析。不日，一份检测结果被交到你的手上。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[成分鉴定：硅元素检测 有效
铁元素检测 有效
铝元素检测 有效
…………………………

结论：支持样本γ主要成分为硅元素。

结构分析：
生物电信号发出 有效
神经单元检测 有效
DNA比对 无效
组织结构 有效
………………

结论：可以支持样本γ是一种生物，样本γ结构复杂，需要进一步研究。
]

“一种以硅作为主要构成元素的生命。”科学院院长一句话概括了内容。

“什么样的生物？”你回忆起在冬眠基地里捡到它的时候，不过蚂蚁一样大小，但这份检测结果里关于它的结构的部分比任何其他部分都要长，处处提到“它的生物结构非常精妙”。那时候考古队长说：“会死在这里的，无非就是我们的造物主。”

……造物主的结构这么微小！？]

在研究冬眠基地仪器的过程里，文明的科技水平突飞猛进，社会舆论也愈发动荡。有人认为这会最终导致文明的灭亡，也有人认为这只是一个彻头彻尾的谎言，是政府编造出来恐吓民众的。

科学院院长对你说：“我们的科技发展速度，比历史上任何一个时代都要快。也许再过不久，以前那些只存在在幻想里的东西就会变成现实里再平常不过的事情。”
他又补充道：“但我有点担忧。我不觉得这是百分百的好事，我总是有不好的预感。”

思想家说道：“机遇总是与挑战并存……哦，这不能算是挑战，这应该算是灭亡。”

总理问道：“如果现在停止研究如何？”

思想家和科学院院长同时摇头，“那可真是天字第一号的蠢事，更何况元首也不会同意的。”

[继续]&lt;continue|

(click-replace: ?continue)[


一切的转机发生在对冬眠基地的研究有了初步的进展。一部分技术被理解和转化到实际应用里了。简直难以想象这些微不起眼的东西对社会的改变有多么巨大——这些仪器在纳米甚至更小尺度上的技术非常高超，这使得纳米技术和精细仪器的发展突飞猛进。随之到来的是能源的高效应用。极低的转化率、巨大的毒性已经成为了历史，人类终于有能力开采更有效率、更清洁的能源。甚至，过去那些被认为无法作为能源使用的事物，如今也被作为能源使用了——科学院院长说道，“我从未想到过人类会有烧石头的一天。”

在这样欣欣向荣的景象里，人们渐渐忘记了发展技术的初衷，而是沉浸在高新技术带来的舒适、美好的生活里。

(if:(history:) does not contain &quot;实现更进一步的中央集权 &quot; or &quot;不错，看看你的&quot; )[
偶尔，会因为能源的开采和技术的发展，与大陆上其他国家开战。但几乎没有国家能够抵挡现在你国的大炮和长枪，很快整片大陆都被你纳入自己的版图里。

&#39;&#39;成就：天下统一！&#39;&#39;

]
[继续]&lt;continue2|


]

(click-replace: ?continue2)[

不只是民众，同样遗忘初心的还有你的同事们。时过境迁，你身边的人又换了一批。新来的科学院院长是在技术飞速发展的年代里长大的，他只在父辈的口中听到过以前的年代的故事，但他从没有感觉出这些事情的分量过。他知道冬眠基地，但他认为这是一个取之不尽用之不竭的宝藏；他知道那个神秘的造物主文明，但他只觉得这是一位愿意将知识倾囊相授的和蔼可亲的死掉的巨人（因为死者是最安全的）。

已经没有人去追究冬眠基地和背后神秘的强大文明的事情了，现在当务之急是享受生活。

就在连你也快要忘记祂们的时候，那个坐着轮椅的赛博格出现在你面前，微笑着对你说：“初次见面，存续机构。自我介绍一下，我是彼得·斯科特·摩根，你可以称呼我为中枢机构。”

[[名为阿莉埃蒂的幽灵-&gt;存续机构]]

]</tw-passagedata><tw-passagedata pid="273" name="死寂一样的沉默" tags="" position="2600,5075" size="100,100">科学院院长被带走了。你看着他乘上那个胶囊形状的太空舱，两人座的。瘫痪的摩根博士贴心地指导他如何系上安全带，以安全的姿势躺好。

“这种太空舱其实是星际航行用的，”中枢机构说道，“设计上，能够符合星系间远距离航行的强度要求。现在只是用来观光。”

你说：“这是一种无声的实力的表现吗？”

中枢机构在进入太空舱之前转头微笑地看着你，“是的。”他说。


[社会的变化]&lt;continue|


(click-replace: ?continue)[

社会上前所未有地沉默。你从没有见过这么沉默的世界，哪怕是在帝制。那时候，人们的思想只是被压抑，并非停滞。但现在，你感觉到整个社会的思想都被冻结了。秘书长还在每天处理你的内务，但你能感觉到他只是在机械地重复肌肉记忆，他什么都没有想——也什么都不愿意想。跳出总统府之外，市井之间走动的人们，你也感觉到他们是机械的。一夜之间，你的国民似乎都变成了冰冷的机器人，只会机械地重复已经写好的程序，脸上只有麻木和恐惧。
你发现现在他们极度恐惧微笑，看见微笑的人、微笑的画像都会极度恐慌。——准确地来说，不是害怕微笑，而是害怕Peter.S. Morgen的微笑。他们现在也恐惧抬头，或者说是恐惧看到天空。哪怕是一只飞鸟飞过也会让他们惊恐无比，这会让他们想到天上的加速轨道和载人太空舱。

阿莉埃蒂像个幽灵，盘旋在人类文明上空。没有人知道这个微笑的幽灵什么时候会挥起屠刀——他们科技那么发达，应该是对地轨道炮什么的——毁灭这片大陆。

一个月的时间眨眼就过去了，天空上那条看不见尽头的光带又一次飞驰而过一粒细小的光点，准确无误地降落在上次中枢机构降落到的地方。

[[关系到存亡的决策-&gt;分歧点]]

]</tw-passagedata><tw-passagedata pid="274" name="不智能1" tags="" position="2625,5575" size="100,100">你将决策告知给摩根，他看起来并不惊讶，微笑着点头，“以我所见，这是最明智的决策。”

你告诉他，思想家不能同意你的决策，日前在总统府门口上吊自杀了。

摩根看起来不以为然，“这没什么。”

[继续]&lt;continue|

(click-replace: ?continue)[

很久很久以前，这个星球曾被一个文明统治，它们的工业高度发达，但代价是将这颗星球的自然资源开采得接近枯竭。

于是，作为报应，那个文明亲手毁灭了宜居的环境，强大的工业变成了杀死自己的利刃，随后便在绝望之中灭亡了。

很近很近以前，一个远道而来的殖民者发现了这颗表面灰色与黄色的星球，惊讶万分。

//「这里的大气环境中的氧气浓度非常低，几乎是无氧环境，非常适合生存。」//

殖民者从此在这里定居了。

殖民者在这颗星球上发现了那个文明遗留的信息。

它们没有花多少时间便将其解读破译了，这对于这个能实现星际间的长途航行的文明来说轻而易举。随后，他们在这颗星球上唯一孤立的大陆上，复活了那个文明。

//「它们到底是有智能，抑或没有？」//

这个文明如今给出了答案。

代理机构1号A型，外形为彼得·斯科特·摩根，一名因渐冻症死去的赛博格，站（坐）在阿莉埃蒂世界的中枢机构面前汇报。

//「经过如此单位的时间里的演化，我们可以认定：存续机构8号确有智能。」//

^^“……但是，在安全的摇篮里午睡有什么不好？固然我们不能断定反抗就一定会导致灭亡，但是危险性已经体现出来了。只要有一丁点不确定，我都不愿意去冒险。”——存续机构8号^^

中枢机构日志文件记录如下：

//「没有对他们的进化做出干预，这是他们自发决策的。」
「自发的，但是和历史上是一样的。」
「是的，此事在他们的先祖创作《楚门的世界》里亦有记载。」//

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;True End 楚门的世界&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]]

]</tw-passagedata><tw-passagedata pid="275" name="沙龙1" tags="" position="350,4825" size="100,100">你安静地听博士发言。他的措辞非常激烈，观点确有新颖独到之处，然而论证逻辑漏洞依旧存在。

“环保，不是说就要一边地排除工业的发展，”博士说，“而是要在发展工业的时候，给环境留一点后路，给后人留一点后路。只有这样，国家才能永远存在。”

与会者听到这里，纷纷给予了赞赏的呼声，掌声络绎不绝。你也觉得他这句话讲得尤其地好——好到不像是他自己的观点——因此也鼓了掌。

博士发言完毕，夫人又邀请了其他几位学者讲话。

[[1.与博士搭话-&gt;博士1]]
[[2.继续听-&gt;沙龙4]]</tw-passagedata><tw-passagedata pid="276" name="沙龙2" tags="" position="475,4825" size="100,100">你附和道：“是的，肉食者似乎很中意这篇论文。”

在场的人的目光立刻集中到你身上。夫人欣然一笑，“这位蒙面的朋友，我似乎是第一次见到你来我的沙龙。”

你定了定神，冷静地回复道：“是的，夫人。我名为……，接受过……学校的高等教育，主修哲学、历史学、经济学，目前在……大学任教。”

“哦，您是一位教授。”夫人了然，“欢迎你来到我们沙龙。”她露出优雅的微笑。

[博士发言]&lt;continue2|

(click-replace: ?continue2)[


你安静地听博士发言。他的措辞非常激烈，观点确有新颖独到之处，然而论证逻辑漏洞依旧存在。

“环保，不是说就要一边地排除工业的发展，”博士说，“而是要在发展工业的时候，给环境留一点后路，给后人留一点后路。只有这样，国家才能永远存在。”

与会者听到这里，纷纷给予了赞赏的呼声，掌声络绎不绝。你也觉得他这句话讲得尤其地好——好到不像是他自己的观点——因此也鼓了掌。

博士发言完毕，夫人又邀请了其他几位学者讲话。

[[1.与博士搭话-&gt;博士1]]
[[2.继续听-&gt;沙龙4]]

]</tw-passagedata><tw-passagedata pid="277" name="沙龙3" tags="" position="225,4825" size="100,100">你出声反驳：“这根本就是打草惊蛇。当局已经注意到了这篇论文，他们一定会对沙龙展开调查。”

在场的人的目光立刻集中到你身上。夫人欣然一笑，眼神却意味深长，“这位蒙面的朋友，我似乎是第一次见到你来我的沙龙。”

你意识到自己似乎露出了马脚，强装冷静地回复道：“是的，夫人。我名为……，接受过……学校的高等教育，主修哲学、历史学、经济学，目前在……大学任教。”

“哦，您是一位教授。”夫人了然，“欢迎你来到我们沙龙。”她露出优雅的微笑。

[博士发言]&lt;continue2|

(click-replace: ?continue2)[

你安静地听博士发言。他的措辞非常激烈，观点确有新颖独到之处，然而论证逻辑漏洞依旧存在。

“环保，不是说就要一边地排除工业的发展，”博士说，“而是要在发展工业的时候，给环境留一点后路，给后人留一点后路。只有这样，国家才能永远存在。”

与会者听到这里，纷纷给予了赞赏的呼声，掌声络绎不绝。你也觉得他这句话讲得尤其地好——好到不像是他自己的观点——因此也鼓了掌。

博士发言完毕，夫人又邀请了其他几位学者讲话。

[[1.与博士搭话-&gt;博士1]]
[[2.继续听-&gt;沙龙4]]

]</tw-passagedata><tw-passagedata pid="278" name="博士1" tags="" position="325,4975" size="100,100">(if:(history:)contains &quot;沙龙1&quot;)[

你特意换到博士身边坐下，对他说道：“某博士，我认为您的观点非常有意思。”

博士会心一笑。“无限制地破坏一定会导致无法挽回的后果。南方某小国便是如此毁灭的。他们将自己赖以生存的土地破坏得体无完肤，最后吃下了自己种出来的恶果。”

“但我认为有几处地方依旧存在不足，”你继续说道，“你的论文里，多次提到浪费、节俭、环保、腐败，但它们究其根本，不太见得是同一件事情。固然节俭清廉是美德，但无论如何在首都如何节俭，省下的资源也不见得就能送到贫困的郡县。至于在持续性发展的部分，我认为论证不够深入。”

博士的脸色发生了变化。他思考了片刻才询问道：“请问您是哪位？”

你将准备好的名片递给了他，“我名为……，接受过……学校的高等教育，主修哲学、历史学、经济学，目前在……大学任教。”

“教授。”博士收下了名片，“我的大部分观点都来自于我的导师，您方便留下联系方式么？我可以介绍您去见见我的导师。”

[[同意-&gt;导师1]]

]

(if:(history:)contains &quot;沙龙2&quot;)[

你特意换到博士身边坐下，博士看见你，便说道：&quot;这位教授，请问您与当局有交情吗？&quot;

你颔首，“是的。”但没有多说。

博士兴奋地说：“太好了！我一直希望能够面对面地与当局谈谈环保的事情，但所有邮件都没有得到回复……您愿意做我的中间人么？”

“当然可以，”你说，“但我有些问题。”

博士：“您请说。”

你继续说道，“你的论文里，多次提到浪费、节俭、环保、腐败，但它们究其根本，不太见得是同一件事情。固然节俭清廉是美德，但无论如何在首都如何节俭，省下的资源也不见得就能送到贫困的郡县。至于在持续性发展的部分，我认为论证不够深入。”

博士的笑容僵住了。

“我的大部分观点都来自于我的导师，您方便留下联系方式么？我可以介绍您去见见我的导师。”他说。

[[同意-&gt;导师1]]


]

(if:(history:)contains &quot;沙龙3&quot;)[
你特意换到博士身边坐下，却看见夫人朝你们走来。

“博士、教授。”夫人对你们行礼，“方便一起谈谈么？”

夫人身后跟着两名面容冷峻的高大侍卫，看来只是通知，并非商量。

[小隔间]&lt;continue2|

]

(click-replace: ?continue2)[

你们来到了更为私密的谈话室。夫人请你们坐下，侍卫关上了厚重的防护门。

“这位蒙面的朋友，”夫人说，“还是说，应该直接称呼您的姓名更好呢？并非是某某大学的教授。”

你沉默。你知道，自你当时开口反驳的那一刻，这位聪慧伶俐的女性就已经察觉到了你的真实身份。

你缓缓揭掉面具，夫人露出了“果然如此”的神色，而博士则是略有吃惊。

“我对你的论文很感兴趣，因此今日暗访沙龙。”你对博士说道，“你的论文里，多次提到浪费、节俭、环保、腐败，但它们究其根本，不太见得是同一件事情。固然节俭清廉是美德，但无论如何在首都如何节俭，省下的资源也不见得就能送到贫困的郡县。至于在持续性发展的部分，我认为论证不够深入。”

博士先是瞥了一眼夫人，然后才磕磕巴巴地说道：“我、我的观点大部分都来自于我的导师。他是上一代思想家的弟子，在高等学校修读哲学，已经退休了。如果你……您想要深入了解，我可以联系导师，让他拜访您的府邸。”

夫人说道：“当局的视线在我们的意料之中，但我们从没有想过您会亲自到来。您对环保主义很感兴趣，是么？”

你点点头。“我注意到，现在全国各地都蔓延着瘟疫。医疗官认为这是工业发展导致的。农业、经济、民生……社会的方方面面都被影响到了。”

夫人欣然一笑，“果然，我就说，当局不是瞎子。”

你说：“我有意采纳你们的建议，实行环保主义。请让我仔细听听你们的理论。”

夫人说道：“当然可以。我们的思想精华都在这个沙龙里，还有这位博士的导师脑袋里。他的导师也是我的老师。如果您允许，我们可以在您的府邸办一次特别沙龙。”

[[同意-&gt;特别沙龙]]

]</tw-passagedata><tw-passagedata pid="279" name="沙龙4" tags="" position="475,4975" size="100,100">你希望能在其他与会者身上找到和这个博士一样有趣的观点，却发现其他人只是照本宣科，便失了听讲的兴趣，径直去找博士。

[[继续-&gt;博士1]]</tw-passagedata><tw-passagedata pid="280" name="导师1" tags="" position="325,5100" size="100,100">博士带着他的导师前来你的府邸拜访。

佣人领他们进入你的谈话室。

“这是我的导师，也是思想家的学生。”博士对你介绍他那白发苍苍的坐在轮椅上的导师。你说，“哦，思想家就在这里。”

思想家却摆手说，“不是我！是我的师祖。这么说来，我们应该是平辈。”

那位白发苍苍的老人对你点头致意，又对思想家点头致意。

[彻夜长谈]&lt;continue|

(click-replace: ?continue)[
姜果然还是老的辣。导师的理论知识储备比他的学生要丰厚得多。你们一见如故，相见恨晚，彻夜促膝长谈。

“我希望我们的国家能变得更好。”临走之前，导师对你说道。

[[继续-&gt;环保主义2]]
]</tw-passagedata><tw-passagedata pid="281" name="特别沙龙" tags="" position="450,5150" size="100,100">总务官说：“真是翻天了，这些地下学者怎么敢把他们自娱自乐的俱乐部办到您的府邸里？”

思想家说：“我倒觉得挺好的。毕竟这个府邸里每天发生的讨论也跟沙龙差不多。”

时辰已到。夫人带着沙龙的常客们抵达了会议室。即便是在当局面前，这些学者的激情依旧不减，甚至发言更加大胆。

“这是我的导师，也是思想家的学生。”博士对你介绍他那白发苍苍的坐在轮椅上的导师。你说，“哦，思想家就在这里。”

思想家却摆手说，“不是我！是我的师祖。这么说来，我们应该是平辈。”

[环保的风]&lt;continue|

(click-replace: ?continue)[

沙龙结束，学者们陆续离开了。

“我收回之前的话，”总务官对你说，“他们的见解很深刻。”

你轻轻点头。“我们必须重新审视我们的工业发展了。”

[[环保之风-&gt;环保主义2]]

]

</tw-passagedata><tw-passagedata pid="282" name="环保主义2" tags="" position="450,5275" size="100,100">你召集工业官和科学官举行了一次会议，“这不是说我们就要从此放弃工业的发展，而是寻找可持续发展工业的办法。”你强调道。

一夜之间，整个社会的风气发生了变化。工业依旧在发展，只不过呈现出一种全新的方式。

“我们环保地发展，绿色地发展，有计划可持续性地发展，不是为了我们自己，不是为了称霸世界，而是为了这颗星球，和我们的后代。”博士在全国动员演讲面前如此说道。

[[Peter S. Morgan-&gt;Peter S. Morgan2]]</tw-passagedata><tw-passagedata pid="283" name="Peter S. Morgan2" tags="" position="625,5275" size="100,100">很久很久以前，这个星球曾被一个文明统治，它们的工业高度发达，但代价是将这颗星球的自然资源开采得接近枯竭。

于是，作为报应，那个文明亲手毁灭了宜居的环境，强大的工业变成了杀死自己的利刃，随后便在绝望之中灭亡了。

[远道而来的殖民者]&lt;continue2|


(click-replace: ?continue2)[

很近很近以前，一个远道而来的殖民者发现了这颗表面灰色与黄色的星球，惊讶万分。

//「这里的大气环境中的氧气浓度非常低，几乎是无氧环境，非常适合生存。」//

殖民者从此在这里定居了。

[文明的复活]&lt;continue3|

]

(click-replace: ?continue3)[

殖民者在这颗星球上发现了那个文明遗留的信息。

它们没有花多少时间便将其解读破译了，这对于这个能实现星际间的长途航行的文明来说轻而易举。随后，他们在这颗星球上唯一孤立的大陆上，复活了那个文明。

//「它们到底是有智能，抑或没有？」//

]

[星球历史研究专家]&lt;continue4|



(click-replace: ?continue4)[

代理机构1号A型觉得实验体的诞生有点扯淡。Arrietty来到这个表面灰黄色的星球定居后，发现了在陆地上残留的大量的非自然痕迹。巨大的四方形或者多边形的建筑，电力设施，网络设施，黑色的平整的道路。这些痕迹引起了Arrietty里一部分闲的没事干的人的好奇心，他们自发地开始调查这颗星球，以“地质勘察”“古生物学”研究为名（他们称呼自己为地球历史研究专家）。从事这件事的人并不多，如今他们已经形成了比较稳定的小圈子，有了准入门槛，排斥外人的指指点点。
让这个小圈子扩散到整个Arrietty都为之侧目的原因，是智人种化石的发现。建造中子发射塔的施工队在施工过程中发现了一个巨大的化石，内里包含着相当丰富的生物信息。生物学家们一眼就注意到了那对于Arrietty来说极其庞大（其实对于Arrietty来说这颗星球上所有生物都很庞大）的生物尸体，大约有1.8×10的几十次方个单位的长度。
“这种生物也许就是制造那些非自然痕迹的种群。”经过解剖和读取生物尸体大脑内残存的信息，Arrietty的生物学家发表了如此见解。
随后，在这颗星球各地都发现了类似的生物尸体。这些尸体大脑残存的信息都表明了这个种群强大的环境改造能力。
再之后——更多的东西被发掘出来，刻有文字的石头、承载了信息的所有东西，星球历史研究专家们尝试还原这个种群——这时他们已经从残存的资料里得知“智人”这个名词——从诞生到灭亡的过程。
数个太阳年后，地球历史专家们向Arrietty全社会出版了他们自以为最权威的《智人诞生消亡史》，并指出：“智人种的灭亡，恰好为Arrietty创造了宜居的生存环境。”
更加闲得没事干的事情发生了。Arrietty社会里最闲得没事干（代理机构1号A型觉得这群人完全就是无可救药的蠢蛋）的那一批建立了智人崇拜宗教，感恩智人为Arrietty的付出。“如果没有主的努力，我们这一支Arrietty就要在太空中流浪更长的时间！”“主为了我们，甚至奉献了自己的智能！”

[智能的讨论]&lt;continue5|

]

(click-replace: ?continue5)[

千该万该最该的就是这个提出来了“智能”的人。这件事引发的浪潮比星球历史研究专家们花了几百个太阳年（这些人无所事事，研究课题也得不到中枢机构的重视，因此研究进展缓慢）出版的《智人诞生消亡史》都要大。几乎整个Arrietty社会都在讨论这件事。一拨人认为，如果智人种真的有智能，那么Arrietty根本不可能占领地球，而是在穿过柯伊伯带之后立刻与地球的舰队激战。另一拨人认为智人种显然是有智能的，但他们也说不出个所以然来。最终，在一群吃饱了饭没事干的人争论里出现了一个站着说话不腰疼和最吃饱了饭没事干的人，他拍案通过了试验场（正式名称叫人类公园）的方案，于是克隆体就诞生了。

代理机构1号A型觉得最扯的是，通过了人类公园方案的居然是Arrietty的最高权力机构中枢机构。

建造一个试验场，将克隆的智人种放进去，让其自行演化，这就可以知道他们是否有智能了。

为了创造适合智人种生存的环境，Arrietty花了很大力气将大陆的环境改造成富氧的（Arrietty是厌氧型生物，为了建造这个公园死了无法计数的Arrietty工人，说试验场是扒Arrietty人皮吃Arrietty人肉建造出来的也毫不为过），又为了让试验场的环境不影响到Arrietty的其他居住区，建造了覆盖整个大陆的保温箱，边界设置在离试验场海岸线的3.5×10的几十个次方的海单位。然后建造了观测智人种生存情况的电磁加速轨道。
后来维持整个大陆的各种循环系统入不敷出，中枢机构一拍思考单元，开放试验场作为景区，吸引Arrietty人观光。

[代理机构1号A型]&lt;continue6|

]

(click-replace: ?continue6)[
最近，负责观测智人种进化的观测员传来消息：存续机构8号带领的文明似乎在推动文明可持续发展。
需要注意的是，这个概念是相对性的。Arrietty是厌氧型的生物，而人类是喜氧型。对于人类来说的可持续，是杀死Arrietty的利刃。但起初，中枢机构并不在意存续机构8号的行动。
//「从史书上可以读到，人类的先祖曾经也采取了类似的措施，只不过都以失败告终了。存续机构8号的行动肯定也会失败，况且他们占有的资源可比他们祖先少得多。」//

本该是这样的。
日前，Arrietty的超算师在中枢机构面前报告了结果：
//「无法对存续机构8号的行动做出准确的估量。对于资源的回收和利用目前无限趋近于一比一。这相当于永动。」//
扯淡。不管是中枢机构，还是代理机构1号A型都是这么想的。Arrietty在宇宙航行时见到过其他更强大的文明实现出来的永动机，有非常苛刻的使用条件。Arrietty无论如何也不会相信人类能在这么小的地方、使用这么点资源就创造出名副其实的永动机。

但是，中枢机构判断不能任由事态发展下去。因此，理机构1号A型作为与存续机构8号谈判的代表被制造出来了。

中枢机构遍历留存的人类文明的全部信息，最终选定了一个人类，模仿他的外形创造出了代理机构1号A型。

彼得·斯科特·摩根，博士，出生于公元纪元的1958年，因患渐冻症死于公元纪元2022年，被确诊后，他决定将身体的各部分都替换为机械，成为赛博格。

&lt;img src=https://gitee.com/kellyaties/kellyaties/raw/44b8553e844d0c39a1d747e2868edcaf7314e440/v2-76d042a1b4a3994e1fa113a606f9c182_1440w.png&gt;

//「三个太阳日后，你将抵达试验场，与存续机构8号谈话。」//中枢机构如此对摩根说道。

摩根其实对这次与存续机构8号的谈话没有任何兴趣，也没有做任何的准备。他只是一个代理，真正与存续机构8号对话的会是中枢机构自己。他没有权力发表任何的个人意见。

出发前，观测员传来消息：存续机构8号没有停止环保主义的行动。

//「他们到底是有智能，抑或没有？」//

只有这一刻，二者才算是真正的平起平坐。

[[继续-&gt;过渡3]]



]</tw-passagedata><tw-passagedata pid="284" name="过渡3" tags="" position="800,5275" size="100,100">“初次见面，存续机构。”

眼前出现的是一个坐在轮椅上的……不太能称之为人。这个人只有头部是人类的，身体其他部分都是机械。他脸颊消瘦，戴着一副银色的眼镜。

面对你时，此人露出微笑，分别用一种你听不懂的语言和你们的语言对你打了招呼。

&quot;自我介绍一下，我是彼得·斯科特·摩根，你可以称呼我为中枢机构。&quot;他对你说道。

&lt;img src=https://gitee.com/kellyaties/kellyaties/raw/44b8553e844d0c39a1d747e2868edcaf7314e440/v2-76d042a1b4a3994e1fa113a606f9c182_1440w.png&gt;

[[赛博格？-&gt;中枢机构5]]
[[中枢机构？-&gt;中枢机构6]]
</tw-passagedata><tw-passagedata pid="285" name="中枢机构5" tags="" position="975,5000" size="100,100">Peter S. Morgan微笑着点头，“是的，我是一名赛博格。我出生于公元纪元的1958年，因患渐冻症死于公元纪元2022年。”
渐冻症，你知道这个病。你的第一任内务官就是因此病死去，你目睹了他的身体从灵活到僵硬，直至彻底冰冷。

“所以，现在的你是谁？”你接着说道。
“我是Arrietty最高指挥官派来与你们对话的代表，是按照Peter S. Morgan博士外表制作出来的机器人，型号为代理机构1号A型。但是，现在藉由此型号与你对话的，是Arrietty的中枢机构。因此，称呼我为中枢机构即可。”中枢机构微笑道。

[[公元纪元？-&gt;环保主义3]]
[[有何贵干？-&gt;环保主义4]]</tw-passagedata><tw-passagedata pid="286" name="中枢机构6" tags="" position="1175,5000" size="100,100">Peter S. Morgan点了点头，“是的，中枢机构。这是Arrietty的最高权力机构。国会、下议院、元老院……请按照你们的思维理解就可以了。”

“我是Arrietty最高指挥官派来与你们对话的代表，是按照Peter S. Morgan博士外表制作出来的机器人，型号为代理机构1号A型。但是，现在藉由此型号与你对话的，是Arrietty的中枢机构。因此，称呼我为中枢机构即可。”中枢机构微笑道。

[[有何贵干？-&gt;环保主义4]]</tw-passagedata><tw-passagedata pid="287" name="环保主义3" tags="" position="975,5125" size="100,100">“公元纪元？”
你能从对方的话语里猜测出来是一种纪年法，但是你并不知道这是哪个国家的。

中枢机构说道：“是的。那是你们先祖的纪年方法。距今的时间，需要用地质纪年来计算了。”

“什么意思，”思想家问道，“您是想说，中间断开了吗？”

中枢机构颔首。

(font:&#39;思源黑体CN&#39;)[&#39;&#39;“你们的先祖——曾经的那个人类文明，已经毁灭了。现在的你们是我们Arrietty根据遗留的生物信息克隆出来的。”&#39;&#39;]

&#39;&#39;成就：文明的真相&#39;&#39;

[[有何贵干？-&gt;环保主义4]]</tw-passagedata><tw-passagedata pid="288" name="环保主义4" tags="" position="1100,5125" size="100,100">这是一位不速之客。今天，光带上一如既往又划过粒子，但与其他粒子不同，这个粒子明显要大得多，而且并没有消失在天边，而是落到了地面。

粒子的真面目是一个巨大的胶囊形状的太空舱。这个太空舱落在本国首都附近的郊区，当你们找到它时，这位自称是中枢机构的坐着轮椅的赛博格就在打开的太空舱的旁边，地上没有轮椅车辙的痕迹，说明中枢机构一直在等你们的到来。

“远道而来的客人，”你说，“有什么事情，不妨来到我国的招待所，我们详细谈谈。”

中枢机构微笑着点头同意了。内务官上前一步想要为他推轮椅，赛博格却抬起机械手臂示意不用。没有见到他操作什么实体按键，轮椅却自动跟着你们走。

[[即将到来的对话-&gt;中枢机构7]]</tw-passagedata><tw-passagedata pid="289" name="中枢机构7" tags="" position="1375,5100" size="100,100">招待所内，侍者送来了酒水，你询问赛博格是否需要插电，他摇头说不用。

“祝贺你们走到今天。”侍者将门关上后，中枢机构再次摆上那标准的微笑——思想家觉得他笑得很诡异，每次微笑都是同一个弧度，像是有自动设置似的。——然后对你们说道。

“我不知道这是什么意思，”你说，“这有什么好祝贺的。我也不明白您们来到这里的目的。”

“按照你们先祖的思维，这是一次对自己圈养的宠物的视察吧。”中枢机构的笑容变得皮笑肉不笑，不紧不慢，声音四平八稳地说道。

[[克隆我们是为了娱乐吗？Es gefällt ihnen, uns zu klonen?-&gt;智能8]]
[[放你妈的屁。Fuck you.-&gt;智能9]]
[[是来通知我们的死亡吗？Sind Sie nach hier gekommen, um wir zu töten?-&gt;智能10]]</tw-passagedata><tw-passagedata pid="290" name="智能8" tags="" position="1525,5100" size="100,100">你平静地看着他，“你们克隆我们，只是为了娱乐吗？”

中枢机构摇摇头又点点头，“是，也不是。”

中枢机构娓娓道来：“其实，对于地球历史的研究，在我们的社会里只是一个很小众的圈子。只不过对于你们是否有智能的讨论引发了全社会的关注。因此我们创造了这个公园，克隆了人类。”

[[什么智能？Was ist eure Interligenz? -&gt;智能7]]
[[所以今天是为何而来？]]So, warum kommen Sie heute?
[[为什么以赛博格的形式来？]]Warum kommen Sie selbst nicht?
</tw-passagedata><tw-passagedata pid="291" name="智能9" tags="" position="1525,5225" size="100,100">你和思想家脱口而出：“放你妈的屁。”

[继续]&lt;continue|

(click-replace: ?continue)[

摩根：“你们的素质很差。”

思想家：“这是正常人类会有的反应。你不能理解是因为我们物种之间存在沟壑。”

“中枢机构不在乎你们的意见。”摩根再次挂上他那张惹人嫌的标准笑脸。“请认清楚我们之间的差距。这片大陆上所有水源、热量乃至氧气，都是阿莉埃蒂世界供应的。”

思想家沉默了。

你大概知道思想家想说什么……

[[帮思想家说话Sprechen-&gt;逼样的这么有实力]]
[[沉默Schweigen-&gt;所以今天是为何而来？]]

]</tw-passagedata><tw-passagedata pid="292" name="智能10" tags="" position="1500,4950" size="100,100">“死亡，”中枢机构重复了一遍，“算是吧。事实上，你们的所作所为已经威胁到了阿莉埃蒂世界，这也是我来到这里的原因之一。”

你不能理解他的意思。中枢机构却示意你不必紧张。“不要着急，我会慢慢给你们讲解清楚。你们的反应在我的预料之内。虽然我们和你们的先祖没有直接交际，但残存的资料足够我们研究。我们有一套完善的模拟人类思维逻辑的模型。”

“满口胡话。”思想家脱口而出。中枢机构并不恼，只是微笑着。

你抬手示意思想家，制止了他继续说话的行为。

[[所以今天是为何而来？]] </tw-passagedata><tw-passagedata pid="293" name="丧钟为谁而鸣" tags="" position="400,4325" size="100,100">又是一个大雪纷飞的寒冬，只不过雪花都被鲜血染红。你背靠在染满鲜血的残缺的墙壁上奄奄一息。

天边又一次划过一束可怕的白光。白光落在城内，将接触到的半径五百公里的所有事物全部化为灰烬。你只能感觉到大地沉闷的震动——你的听力已经彻底丧失了。

一个更轻的震动在接近。


[……？]&lt;continue1|

(click-replace: ?continue1)[

迎面走来的是一个雌雄难辨的人类，面容却极其美丽。五官立体，通体体毛都是白色。

你不会为祂的美貌而倾倒，因为就是祂毁灭了你的国家。

(text-colour:red)[“我回来啦。”]祂用轻快的语气说道，战靴踩过你的同胞的尸体，轻而易举地将其踩爆。

(text-colour:red)[“首都已经没有活人了。”]祂在你面前蹲下身微笑着说道。

祂出现时，告诉你祂是你的双生子型号，名为自毁机构8号E型。

“(text-colour:red)[我的正式名称是自毁机构8号&#39;Executioner&#39;型，是文明的毁灭者，也是你的处刑人，存续机构。]”祂一字一顿说罢，你的身体便被拦腰斩断，如同枯草一般被肆意扔到一边。

(text-colour:red)[“怎么想到的和Arriety作对的？”]祂抬手仔细地拨开你凌乱的刘海，用责怪的口吻说道。(text-colour:red)[“根本不可能赢啊。”]

(text-colour:red)[“人类的尊严和骄傲……就是这么一文不值的东西。”]8E一边说着，一边浮现出恶意的微笑。

(text-colour:red)[“不过还好你选了这个，”]8E又说，(text-colour:red)[“不然，我应该是没有苏醒的机会了。”]

自毁机构像是讲睡前故事一样慢慢地说道。但你不知道自己还有多久的命听，你的心脏已经被贯穿，眼前一片涣散，连8E的脸也看不清楚。

最后，自毁机构嫣然一笑，用你听不懂的(text-style: &quot;blink&quot;)[神明的]语言，伏在你耳边低语道——

「晚安，智人种。」

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;Bad End 自毁机构8号E型&#39;&#39;

&#39;&#39;成就：存续、自毁。&#39;&#39;

[STAFF名单]&lt;continue10|
]

(click-replace: ?continue10)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]]
</tw-passagedata><tw-passagedata pid="294" name="断头台" tags="" position="1175,3925" size="100,100">“我们不可能同意停战。”虽然电话电流嘈杂、声音模糊不清，但你还是能感觉得到革命党的坚定意志，“我们清楚长久以来饱受封建帝制压迫的民众的苦难，你也很清楚，或者说你比我更清楚。但你还意识得到吗？”

[……]&lt;continue|

(click-replace: ?continue)[

他说，“你活得时间太久了，王朝覆灭对你来说只是一眨眼。你可能已经不记得了，但封建帝制已经存在了数千年了。在你眼里是不是只有一天两天的时间？”

你沉默，你确实是直到这一刻才意识到时间的流逝。原来离你从冬眠舱里苏醒已经过去这么久了。


[继续]&lt;continue|

]

(click-replace: ?continue)[

“你的存在就是帝国的象征。”革命党人说，“只有铲除了你，共和才能真正到来。”

革命党人挂断了电话。

革命党的枪炮轰开了首都的城门，你在元首府眺望到，民众们穿着节日服饰，夹道欢迎革命军。

你的死刑是在共和国开国典礼那一天执行的。

&#39;&#39;成就：存续装置&#39;&#39;

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局17：那些与时代洪流作对的&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]
]



]
</tw-passagedata><tw-passagedata pid="295" name="国运象征" tags="" position="1175,3800" size="100,100">革命党同意了你的提议。

“我们不可能保留帝制，”他们说，“但我们同意了你的投降。”

“什么投降，”你不解地说。

“因为你必须存在。”他们答非所问，“你是文明的象征。”

&#39;&#39;成就：存续装置&#39;&#39;

[共和时代]&lt;continue|

(click-replace: ?continue)[

帝国被推翻，革命党人在原来的皇宫宣布改制共和。

一夜时间，整个社会变了天。

这是对于他们而言的——对于你，这一切并没有发生变化。因为在这个世界上，只有少数东西永恒：太阳、月亮、繁星，和你。

(align:&quot;&lt;==&quot;)+(box:&quot;=XX=&quot;)[&#39;&#39;结局28：阶下囚&#39;&#39;

[STAFF名单]&lt;continue3|

(click-replace: ?continue3)[

(display:&quot;STAFF&quot;)

[[点此返回标题画面-&gt;导入]]]
]



]</tw-passagedata></tw-storydata>
<script title="Twine engine code" data-main="harlowe">(function(){"use strict";
var require,define;!function(){var e={},r={};require=function(i){var n=e[i];return n&&(r[i]=n[1].apply(void 0,n[0].map(require)),e[i]=void 0),r[i]},(define=function(r,i,n){if("function"==typeof r)return r();e[r]=[i,n]}).amd=!0}();/*!
 * https://github.com/paulmillr/es6-shim
 * @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
 *   and contributors,  MIT License
 * es6-shim: v0.35.4
 * see https://github.com/paulmillr/es6-shim/blob/0.35.3/LICENSE
 * Details and documentation:
 * https://github.com/paulmillr/es6-shim/
 */
(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.returnExports=t()}})(this,function(){"use strict";var e=Function.call.bind(Function.apply);var t=Function.call.bind(Function.call);var r=Array.isArray;var n=Object.keys;var o=function notThunker(t){return function notThunk(){return!e(t,this,arguments)}};var i=function(e){try{e();return false}catch(t){return true}};var a=function valueOrFalseIfThrows(e){try{return e()}catch(t){return false}};var u=o(i);var f=function(){return!i(function(){return Object.defineProperty({},"x",{get:function(){}})})};var s=!!Object.defineProperty&&f();var c=function foo(){}.name==="foo";var l=Function.call.bind(Array.prototype.forEach);var p=Function.call.bind(Array.prototype.reduce);var v=Function.call.bind(Array.prototype.filter);var y=Function.call.bind(Array.prototype.some);var h=function(e,t,r,n){if(!n&&t in e){return}if(s){Object.defineProperty(e,t,{configurable:true,enumerable:false,writable:true,value:r})}else{e[t]=r}};var b=function(e,t,r){l(n(t),function(n){var o=t[n];h(e,n,o,!!r)})};var g=Function.call.bind(Object.prototype.toString);var d=typeof/abc/==="function"?function IsCallableSlow(e){return typeof e==="function"&&g(e)==="[object Function]"}:function IsCallableFast(e){return typeof e==="function"};var m={getter:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}Object.defineProperty(e,t,{configurable:true,enumerable:false,get:r})},proxy:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,{configurable:n.configurable,enumerable:n.enumerable,get:function getKey(){return e[t]},set:function setKey(r){e[t]=r}})},redefine:function(e,t,r){if(s){var n=Object.getOwnPropertyDescriptor(e,t);n.value=r;Object.defineProperty(e,t,n)}else{e[t]=r}},defineByDescriptor:function(e,t,r){if(s){Object.defineProperty(e,t,r)}else if("value"in r){e[t]=r.value}},preserveToString:function(e,t){if(t&&d(t.toString)){h(e,"toString",t.toString.bind(t),true)}}};var O=Object.create||function(e,t){var r=function Prototype(){};r.prototype=e;var o=new r;if(typeof t!=="undefined"){n(t).forEach(function(e){m.defineByDescriptor(o,e,t[e])})}return o};var w=function(e,t){if(!Object.setPrototypeOf){return false}return a(function(){var r=function Subclass(t){var r=new e(t);Object.setPrototypeOf(r,Subclass.prototype);return r};Object.setPrototypeOf(r,e);r.prototype=O(e.prototype,{constructor:{value:r}});return t(r)})};var j=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("unable to locate global object")};var S=j();var T=S.isFinite;var I=Function.call.bind(String.prototype.indexOf);var E=Function.apply.bind(Array.prototype.indexOf);var P=Function.call.bind(Array.prototype.concat);var C=Function.call.bind(String.prototype.slice);var M=Function.call.bind(Array.prototype.push);var x=Function.apply.bind(Array.prototype.push);var N=Function.call.bind(Array.prototype.join);var A=Function.call.bind(Array.prototype.shift);var _=Math.max;var R=Math.min;var k=Math.floor;var L=Math.abs;var F=Math.exp;var D=Math.log;var z=Math.sqrt;var q=Function.call.bind(Object.prototype.hasOwnProperty);var W;var G=function(){};var H=S.Map;var V=H&&H.prototype["delete"];var B=H&&H.prototype.get;var U=H&&H.prototype.has;var $=H&&H.prototype.set;var J=S.Symbol||{};var X=J.species||"@@species";var K=Number.isNaN||function isNaN(e){return e!==e};var Z=Number.isFinite||function isFinite(e){return typeof e==="number"&&T(e)};var Y=d(Math.sign)?Math.sign:function sign(e){var t=Number(e);if(t===0){return t}if(K(t)){return t}return t<0?-1:1};var Q=function log1p(e){var t=Number(e);if(t<-1||K(t)){return NaN}if(t===0||t===Infinity){return t}if(t===-1){return-Infinity}return 1+t-1===0?t:t*(D(1+t)/(1+t-1))};var ee=function isArguments(e){return g(e)==="[object Arguments]"};var te=function isArguments(e){return e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&g(e)!=="[object Array]"&&g(e.callee)==="[object Function]"};var re=ee(arguments)?ee:te;var ne={primitive:function(e){return e===null||typeof e!=="function"&&typeof e!=="object"},string:function(e){return g(e)==="[object String]"},regex:function(e){return g(e)==="[object RegExp]"},symbol:function(e){return typeof S.Symbol==="function"&&typeof e==="symbol"}};var oe=function overrideNative(e,t,r){var n=e[t];h(e,t,r,true);m.preserveToString(e[t],n)};var ie=typeof J==="function"&&typeof J["for"]==="function"&&ne.symbol(J());var ae=ne.symbol(J.iterator)?J.iterator:"_es6-shim iterator_";if(S.Set&&typeof(new S.Set)["@@iterator"]==="function"){ae="@@iterator"}if(!S.Reflect){h(S,"Reflect",{},true)}var ue=S.Reflect;var fe=String;var se=typeof document==="undefined"||!document?null:document.all;var ce=se==null?function isNullOrUndefined(e){return e==null}:function isNullOrUndefinedAndNotDocumentAll(e){return e==null&&e!==se};var le={Call:function Call(t,r){var n=arguments.length>2?arguments[2]:[];if(!le.IsCallable(t)){throw new TypeError(t+" is not a function")}return e(t,r,n)},RequireObjectCoercible:function(e,t){if(ce(e)){throw new TypeError(t||"Cannot call method on "+e)}return e},TypeIsObject:function(e){if(e===void 0||e===null||e===true||e===false){return false}return typeof e==="function"||typeof e==="object"||e===se},ToObject:function(e,t){return Object(le.RequireObjectCoercible(e,t))},IsCallable:d,IsConstructor:function(e){return le.IsCallable(e)},ToInt32:function(e){return le.ToNumber(e)>>0},ToUint32:function(e){return le.ToNumber(e)>>>0},ToNumber:function(e){if(ie&&g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return+e},ToInteger:function(e){var t=le.ToNumber(e);if(K(t)){return 0}if(t===0||!Z(t)){return t}return(t>0?1:-1)*k(L(t))},ToLength:function(e){var t=le.ToInteger(e);if(t<=0){return 0}if(t>Number.MAX_SAFE_INTEGER){return Number.MAX_SAFE_INTEGER}return t},SameValue:function(e,t){if(e===t){if(e===0){return 1/e===1/t}return true}return K(e)&&K(t)},SameValueZero:function(e,t){return e===t||K(e)&&K(t)},GetIterator:function(e){if(re(e)){return new W(e,"value")}var t=le.GetMethod(e,ae);if(!le.IsCallable(t)){throw new TypeError("value is not an iterable")}var r=le.Call(t,e);if(!le.TypeIsObject(r)){throw new TypeError("bad iterator")}return r},GetMethod:function(e,t){var r=le.ToObject(e)[t];if(ce(r)){return void 0}if(!le.IsCallable(r)){throw new TypeError("Method not callable: "+t)}return r},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var r=le.GetMethod(e,"return");if(r===void 0){return}var n,o;try{n=le.Call(r,e)}catch(i){o=i}if(t){return}if(o){throw o}if(!le.TypeIsObject(n)){throw new TypeError("Iterator's return method returned a non-object.")}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!le.TypeIsObject(t)){throw new TypeError("bad iterator")}return t},IteratorStep:function(e){var t=le.IteratorNext(e);var r=le.IteratorComplete(t);return r?false:t},Construct:function(e,t,r,n){var o=typeof r==="undefined"?e:r;if(!n&&ue.construct){return ue.construct(e,t,o)}var i=o.prototype;if(!le.TypeIsObject(i)){i=Object.prototype}var a=O(i);var u=le.Call(e,a,t);return le.TypeIsObject(u)?u:a},SpeciesConstructor:function(e,t){var r=e.constructor;if(r===void 0){return t}if(!le.TypeIsObject(r)){throw new TypeError("Bad constructor")}var n=r[X];if(ce(n)){return t}if(!le.IsConstructor(n)){throw new TypeError("Bad @@species")}return n},CreateHTML:function(e,t,r,n){var o=le.ToString(e);var i="<"+t;if(r!==""){var a=le.ToString(n);var u=a.replace(/"/g,"&quot;");i+=" "+r+'="'+u+'"'}var f=i+">";var s=f+o;return s+"</"+t+">"},IsRegExp:function IsRegExp(e){if(!le.TypeIsObject(e)){return false}var t=e[J.match];if(typeof t!=="undefined"){return!!t}return ne.regex(e)},ToString:function ToString(e){if(ie&&g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return fe(e)}};if(s&&ie){var pe=function defineWellKnownSymbol(e){if(ne.symbol(J[e])){return J[e]}var t=J["for"]("Symbol."+e);Object.defineProperty(J,e,{configurable:false,enumerable:false,writable:false,value:t});return t};if(!ne.symbol(J.search)){var ve=pe("search");var ye=String.prototype.search;h(RegExp.prototype,ve,function search(e){return le.Call(ye,e,[this])});var he=function search(e){var t=le.RequireObjectCoercible(this);if(!ce(e)){var r=le.GetMethod(e,ve);if(typeof r!=="undefined"){return le.Call(r,e,[t])}}return le.Call(ye,t,[le.ToString(e)])};oe(String.prototype,"search",he)}if(!ne.symbol(J.replace)){var be=pe("replace");var ge=String.prototype.replace;h(RegExp.prototype,be,function replace(e,t){return le.Call(ge,e,[this,t])});var de=function replace(e,t){var r=le.RequireObjectCoercible(this);if(!ce(e)){var n=le.GetMethod(e,be);if(typeof n!=="undefined"){return le.Call(n,e,[r,t])}}return le.Call(ge,r,[le.ToString(e),t])};oe(String.prototype,"replace",de)}if(!ne.symbol(J.split)){var me=pe("split");var Oe=String.prototype.split;h(RegExp.prototype,me,function split(e,t){return le.Call(Oe,e,[this,t])});var we=function split(e,t){var r=le.RequireObjectCoercible(this);if(!ce(e)){var n=le.GetMethod(e,me);if(typeof n!=="undefined"){return le.Call(n,e,[r,t])}}return le.Call(Oe,r,[le.ToString(e),t])};oe(String.prototype,"split",we)}var je=ne.symbol(J.match);var Se=je&&function(){var e={};e[J.match]=function(){return 42};return"a".match(e)!==42}();if(!je||Se){var Te=pe("match");var Ie=String.prototype.match;h(RegExp.prototype,Te,function match(e){return le.Call(Ie,e,[this])});var Ee=function match(e){var t=le.RequireObjectCoercible(this);if(!ce(e)){var r=le.GetMethod(e,Te);if(typeof r!=="undefined"){return le.Call(r,e,[t])}}return le.Call(Ie,t,[le.ToString(e)])};oe(String.prototype,"match",Ee)}}var Pe=function wrapConstructor(e,t,r){m.preserveToString(t,e);if(Object.setPrototypeOf){Object.setPrototypeOf(e,t)}if(s){l(Object.getOwnPropertyNames(e),function(n){if(n in G||r[n]){return}m.proxy(e,n,t)})}else{l(Object.keys(e),function(n){if(n in G||r[n]){return}t[n]=e[n]})}t.prototype=e.prototype;m.redefine(e.prototype,"constructor",t)};var Ce=function(){return this};var Me=function(e){if(s&&!q(e,X)){m.getter(e,X,Ce)}};var xe=function(e,t){var r=t||function iterator(){return this};h(e,ae,r);if(!e[ae]&&ne.symbol(ae)){e[ae]=r}};var Ne=function createDataProperty(e,t,r){if(s){Object.defineProperty(e,t,{configurable:true,enumerable:true,writable:true,value:r})}else{e[t]=r}};var Ae=function createDataPropertyOrThrow(e,t,r){Ne(e,t,r);if(!le.SameValue(e[t],r)){throw new TypeError("property is nonconfigurable")}};var _e=function(e,t,r,n){if(!le.TypeIsObject(e)){throw new TypeError("Constructor requires `new`: "+t.name)}var o=t.prototype;if(!le.TypeIsObject(o)){o=r}var i=O(o);for(var a in n){if(q(n,a)){var u=n[a];h(i,a,u,true)}}return i};if(String.fromCodePoint&&String.fromCodePoint.length!==1){var Re=String.fromCodePoint;oe(String,"fromCodePoint",function fromCodePoint(e){return le.Call(Re,this,arguments)})}var ke={fromCodePoint:function fromCodePoint(e){var t=[];var r;for(var n=0,o=arguments.length;n<o;n++){r=Number(arguments[n]);if(!le.SameValue(r,le.ToInteger(r))||r<0||r>1114111){throw new RangeError("Invalid code point "+r)}if(r<65536){M(t,String.fromCharCode(r))}else{r-=65536;M(t,String.fromCharCode((r>>10)+55296));M(t,String.fromCharCode(r%1024+56320))}}return N(t,"")},raw:function raw(e){var t=arguments.length-1;var r=le.ToObject(e,"bad template");var raw=le.ToObject(r.raw,"bad raw value");var n=raw.length;var o=le.ToLength(n);if(o<=0){return""}var i=[];var a=0;var u,f,s,c;while(a<o){u=le.ToString(a);s=le.ToString(raw[u]);M(i,s);if(a+1>=o){break}f=a+1<arguments.length?arguments[a+1]:"";c=le.ToString(f);M(i,c);a+=1}return N(i,"")}};if(String.raw&&String.raw({raw:{0:"x",1:"y",length:2}})!=="xy"){oe(String,"raw",ke.raw)}b(String,ke);var Le=function repeat(e,t){if(t<1){return""}if(t%2){return repeat(e,t-1)+e}var r=repeat(e,t/2);return r+r};var Fe=Infinity;var De={repeat:function repeat(e){var t=le.ToString(le.RequireObjectCoercible(this));var r=le.ToInteger(e);if(r<0||r>=Fe){throw new RangeError("repeat count must be less than infinity and not overflow maximum string size")}return Le(t,r)},startsWith:function startsWith(e){var t=le.ToString(le.RequireObjectCoercible(this));if(le.IsRegExp(e)){throw new TypeError('Cannot call method "startsWith" with a regex')}var r=le.ToString(e);var n;if(arguments.length>1){n=arguments[1]}var o=_(le.ToInteger(n),0);return C(t,o,o+r.length)===r},endsWith:function endsWith(e){var t=le.ToString(le.RequireObjectCoercible(this));if(le.IsRegExp(e)){throw new TypeError('Cannot call method "endsWith" with a regex')}var r=le.ToString(e);var n=t.length;var o;if(arguments.length>1){o=arguments[1]}var i=typeof o==="undefined"?n:le.ToInteger(o);var a=R(_(i,0),n);return C(t,a-r.length,a)===r},includes:function includes(e){if(le.IsRegExp(e)){throw new TypeError('"includes" does not accept a RegExp')}var t=le.ToString(e);var r;if(arguments.length>1){r=arguments[1]}return I(this,t,r)!==-1},codePointAt:function codePointAt(e){var t=le.ToString(le.RequireObjectCoercible(this));var r=le.ToInteger(e);var n=t.length;if(r>=0&&r<n){var o=t.charCodeAt(r);var i=r+1===n;if(o<55296||o>56319||i){return o}var a=t.charCodeAt(r+1);if(a<56320||a>57343){return o}return(o-55296)*1024+(a-56320)+65536}}};if(String.prototype.includes&&"a".includes("a",Infinity)!==false){oe(String.prototype,"includes",De.includes)}if(String.prototype.startsWith&&String.prototype.endsWith){var ze=i(function(){return"/a/".startsWith(/a/)});var qe=a(function(){return"abc".startsWith("a",Infinity)===false});if(!ze||!qe){oe(String.prototype,"startsWith",De.startsWith);oe(String.prototype,"endsWith",De.endsWith)}}if(ie){var We=a(function(){var e=/a/;e[J.match]=false;return"/a/".startsWith(e)});if(!We){oe(String.prototype,"startsWith",De.startsWith)}var Ge=a(function(){var e=/a/;e[J.match]=false;return"/a/".endsWith(e)});if(!Ge){oe(String.prototype,"endsWith",De.endsWith)}var He=a(function(){var e=/a/;e[J.match]=false;return"/a/".includes(e)});if(!He){oe(String.prototype,"includes",De.includes)}}b(String.prototype,De);var Ve=["\t\n\x0B\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join("");var Be=new RegExp("(^["+Ve+"]+)|(["+Ve+"]+$)","g");var Ue=function trim(){return le.ToString(le.RequireObjectCoercible(this)).replace(Be,"")};var $e=["\x85","\u200b","\ufffe"].join("");var Je=new RegExp("["+$e+"]","g");var Xe=/^[-+]0x[0-9a-f]+$/i;var Ke=$e.trim().length!==$e.length;h(String.prototype,"trim",Ue,Ke);var Ze=function(e){return{value:e,done:arguments.length===0}};var Ye=function(e){le.RequireObjectCoercible(e);h(this,"_s",le.ToString(e));h(this,"_i",0)};Ye.prototype.next=function(){var e=this._s;var t=this._i;if(typeof e==="undefined"||t>=e.length){this._s=void 0;return Ze()}var r=e.charCodeAt(t);var n,o;if(r<55296||r>56319||t+1===e.length){o=1}else{n=e.charCodeAt(t+1);o=n<56320||n>57343?1:2}this._i=t+o;return Ze(e.substr(t,o))};xe(Ye.prototype);xe(String.prototype,function(){return new Ye(this)});var Qe={from:function from(e){var r=this;var n;if(arguments.length>1){n=arguments[1]}var o,i;if(typeof n==="undefined"){o=false}else{if(!le.IsCallable(n)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){i=arguments[2]}o=true}var a=typeof(re(e)||le.GetMethod(e,ae))!=="undefined";var u,f,s;if(a){f=le.IsConstructor(r)?Object(new r):[];var c=le.GetIterator(e);var l,p;s=0;while(true){l=le.IteratorStep(c);if(l===false){break}p=l.value;try{if(o){p=typeof i==="undefined"?n(p,s):t(n,i,p,s)}f[s]=p}catch(v){le.IteratorClose(c,true);throw v}s+=1}u=s}else{var y=le.ToObject(e);u=le.ToLength(y.length);f=le.IsConstructor(r)?Object(new r(u)):new Array(u);var h;for(s=0;s<u;++s){h=y[s];if(o){h=typeof i==="undefined"?n(h,s):t(n,i,h,s)}Ae(f,s,h)}}f.length=u;return f},of:function of(){var e=arguments.length;var t=this;var n=r(t)||!le.IsCallable(t)?new Array(e):le.Construct(t,[e]);for(var o=0;o<e;++o){Ae(n,o,arguments[o])}n.length=e;return n}};b(Array,Qe);Me(Array);W=function(e,t){h(this,"i",0);h(this,"array",e);h(this,"kind",t)};b(W.prototype,{next:function(){var e=this.i;var t=this.array;if(!(this instanceof W)){throw new TypeError("Not an ArrayIterator")}if(typeof t!=="undefined"){var r=le.ToLength(t.length);if(e<r){var n=this.kind;var o;if(n==="key"){o=e}else if(n==="value"){o=t[e]}else if(n==="entry"){o=[e,t[e]]}this.i=e+1;return Ze(o)}}this.array=void 0;return Ze()}});xe(W.prototype);var et=Array.of===Qe.of||function(){var e=function Foo(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&t.length===2}();if(!et){oe(Array,"of",Qe.of)}var tt={copyWithin:function copyWithin(e,t){var r=le.ToObject(this);var n=le.ToLength(r.length);var o=le.ToInteger(e);var i=le.ToInteger(t);var a=o<0?_(n+o,0):R(o,n);var u=i<0?_(n+i,0):R(i,n);var f;if(arguments.length>2){f=arguments[2]}var s=typeof f==="undefined"?n:le.ToInteger(f);var c=s<0?_(n+s,0):R(s,n);var l=R(c-u,n-a);var p=1;if(u<a&&a<u+l){p=-1;u+=l-1;a+=l-1}while(l>0){if(u in r){r[a]=r[u]}else{delete r[a]}u+=p;a+=p;l-=1}return r},fill:function fill(e){var t;if(arguments.length>1){t=arguments[1]}var r;if(arguments.length>2){r=arguments[2]}var n=le.ToObject(this);var o=le.ToLength(n.length);t=le.ToInteger(typeof t==="undefined"?0:t);r=le.ToInteger(typeof r==="undefined"?o:r);var i=t<0?_(o+t,0):R(t,o);var a=r<0?o+r:r;for(var u=i;u<o&&u<a;++u){n[u]=e}return n},find:function find(e){var r=le.ToObject(this);var n=le.ToLength(r.length);if(!le.IsCallable(e)){throw new TypeError("Array#find: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0,a;i<n;i++){a=r[i];if(o){if(t(e,o,a,i,r)){return a}}else if(e(a,i,r)){return a}}},findIndex:function findIndex(e){var r=le.ToObject(this);var n=le.ToLength(r.length);if(!le.IsCallable(e)){throw new TypeError("Array#findIndex: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0;i<n;i++){if(o){if(t(e,o,r[i],i,r)){return i}}else if(e(r[i],i,r)){return i}}return-1},keys:function keys(){return new W(this,"key")},values:function values(){return new W(this,"value")},entries:function entries(){return new W(this,"entry")}};if(Array.prototype.keys&&!le.IsCallable([1].keys().next)){delete Array.prototype.keys}if(Array.prototype.entries&&!le.IsCallable([1].entries().next)){delete Array.prototype.entries}if(Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[ae]){b(Array.prototype,{values:Array.prototype[ae]});if(ne.symbol(J.unscopables)){Array.prototype[J.unscopables].values=true}}if(c&&Array.prototype.values&&Array.prototype.values.name!=="values"){var rt=Array.prototype.values;oe(Array.prototype,"values",function values(){return le.Call(rt,this,arguments)});h(Array.prototype,ae,Array.prototype.values,true)}b(Array.prototype,tt);if(1/[true].indexOf(true,-0)<0){h(Array.prototype,"indexOf",function indexOf(e){var t=E(this,arguments);if(t===0&&1/t<0){return 0}return t},true)}xe(Array.prototype,function(){return this.values()});if(Object.getPrototypeOf){var nt=Object.getPrototypeOf([].values());if(nt){xe(nt)}}var ot=function(){return a(function(){return Array.from({length:-1}).length===0})}();var it=function(){var e=Array.from([0].entries());return e.length===1&&r(e[0])&&e[0][0]===0&&e[0][1]===0}();if(!ot||!it){oe(Array,"from",Qe.from)}var at=function(){return a(function(){return Array.from([0],void 0)})}();if(!at){var ut=Array.from;oe(Array,"from",function from(e){if(arguments.length>1&&typeof arguments[1]!=="undefined"){return le.Call(ut,this,arguments)}return t(ut,this,e)})}var ft=-(Math.pow(2,32)-1);var st=function(e,r){var n={length:ft};n[r?(n.length>>>0)-1:0]=true;return a(function(){t(e,n,function(){throw new RangeError("should not reach here")},[]);return true})};if(!st(Array.prototype.forEach)){var ct=Array.prototype.forEach;oe(Array.prototype,"forEach",function forEach(e){return le.Call(ct,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.map)){var lt=Array.prototype.map;oe(Array.prototype,"map",function map(e){return le.Call(lt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.filter)){var pt=Array.prototype.filter;oe(Array.prototype,"filter",function filter(e){return le.Call(pt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.some)){var vt=Array.prototype.some;oe(Array.prototype,"some",function some(e){return le.Call(vt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.every)){var yt=Array.prototype.every;oe(Array.prototype,"every",function every(e){return le.Call(yt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.reduce)){var ht=Array.prototype.reduce;oe(Array.prototype,"reduce",function reduce(e){return le.Call(ht,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.reduceRight,true)){var bt=Array.prototype.reduceRight;oe(Array.prototype,"reduceRight",function reduceRight(e){return le.Call(bt,this.length>=0?this:[],arguments)})}var gt=Number("0o10")!==8;var dt=Number("0b10")!==2;var mt=y($e,function(e){return Number(e+0+e)===0});if(gt||dt||mt){var Ot=Number;var wt=/^0b[01]+$/i;var jt=/^0o[0-7]+$/i;var St=wt.test.bind(wt);var Tt=jt.test.bind(jt);var It=function(e,t){var r;if(typeof e.valueOf==="function"){r=e.valueOf();if(ne.primitive(r)){return r}}if(typeof e.toString==="function"){r=e.toString();if(ne.primitive(r)){return r}}throw new TypeError("No default value")};var Et=Je.test.bind(Je);var Pt=Xe.test.bind(Xe);var Ct=function(){var e=function Number(t){var r;if(arguments.length>0){r=ne.primitive(t)?t:It(t,"number")}else{r=0}if(typeof r==="string"){r=le.Call(Ue,r);if(St(r)){r=parseInt(C(r,2),2)}else if(Tt(r)){r=parseInt(C(r,2),8)}else if(Et(r)||Pt(r)){r=NaN}}var n=this;var o=a(function(){Ot.prototype.valueOf.call(n);return true});if(n instanceof e&&!o){return new Ot(r)}return Ot(r)};return e}();Pe(Ot,Ct,{});b(Ct,{NaN:Ot.NaN,MAX_VALUE:Ot.MAX_VALUE,MIN_VALUE:Ot.MIN_VALUE,NEGATIVE_INFINITY:Ot.NEGATIVE_INFINITY,POSITIVE_INFINITY:Ot.POSITIVE_INFINITY});Number=Ct;m.redefine(S,"Number",Ct)}var Mt=Math.pow(2,53)-1;b(Number,{MAX_SAFE_INTEGER:Mt,MIN_SAFE_INTEGER:-Mt,EPSILON:2.220446049250313e-16,parseInt:S.parseInt,parseFloat:S.parseFloat,isFinite:Z,isInteger:function isInteger(e){return Z(e)&&le.ToInteger(e)===e},isSafeInteger:function isSafeInteger(e){return Number.isInteger(e)&&L(e)<=Number.MAX_SAFE_INTEGER},isNaN:K});h(Number,"parseInt",S.parseInt,Number.parseInt!==S.parseInt);if([,1].find(function(){return true})===1){oe(Array.prototype,"find",tt.find)}if([,1].findIndex(function(){return true})!==0){oe(Array.prototype,"findIndex",tt.findIndex)}var xt=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable);var Nt=function ensureEnumerable(e,t){if(s&&xt(e,t)){Object.defineProperty(e,t,{enumerable:false})}};var At=function sliceArgs(){var e=Number(this);var t=arguments.length;var r=t-e;var n=new Array(r<0?0:r);for(var o=e;o<t;++o){n[o-e]=arguments[o]}return n};var _t=function assignTo(e){return function assignToSource(t,r){t[r]=e[r];return t}};var Rt=function(e,t){var r=n(Object(t));var o;if(le.IsCallable(Object.getOwnPropertySymbols)){o=v(Object.getOwnPropertySymbols(Object(t)),xt(t))}return p(P(r,o||[]),_t(t),e)};var kt={assign:function(e,t){var r=le.ToObject(e,"Cannot convert undefined or null to object");return p(le.Call(At,1,arguments),Rt,r)},is:function is(e,t){return le.SameValue(e,t)}};var Lt=Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return e[1]==="y"}}();if(Lt){oe(Object,"assign",kt.assign)}b(Object,kt);if(s){var Ft={setPrototypeOf:function(e){var r;var n=function(e,t){if(!le.TypeIsObject(e)){throw new TypeError("cannot set prototype on a non-object")}if(!(t===null||le.TypeIsObject(t))){throw new TypeError("can only set prototype to an object or null"+t)}};var o=function(e,o){n(e,o);t(r,e,o);return e};try{r=e.getOwnPropertyDescriptor(e.prototype,"__proto__").set;t(r,{},null)}catch(i){if(e.prototype!=={}.__proto__){return}r=function(e){this.__proto__=e};o.polyfill=o(o({},null),e.prototype)instanceof e}return o}(Object)};b(Object,Ft)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&Object.getPrototypeOf(Object.setPrototypeOf({},null))!==null&&Object.getPrototypeOf(Object.create(null))===null){(function(){var e=Object.create(null);var t=Object.getPrototypeOf;var r=Object.setPrototypeOf;Object.getPrototypeOf=function(r){var n=t(r);return n===e?null:n};Object.setPrototypeOf=function(t,n){var o=n===null?e:n;return r(t,o)};Object.setPrototypeOf.polyfill=false})()}var Dt=!i(function(){return Object.keys("foo")});if(!Dt){var zt=Object.keys;oe(Object,"keys",function keys(e){return zt(le.ToObject(e))});n=Object.keys}var qt=i(function(){return Object.keys(/a/g)});if(qt){var Wt=Object.keys;oe(Object,"keys",function keys(e){if(ne.regex(e)){var t=[];for(var r in e){if(q(e,r)){M(t,r)}}return t}return Wt(e)});n=Object.keys}if(Object.getOwnPropertyNames){var Gt=!i(function(){return Object.getOwnPropertyNames("foo")});if(!Gt){var Ht=typeof window==="object"?Object.getOwnPropertyNames(window):[];var Vt=Object.getOwnPropertyNames;oe(Object,"getOwnPropertyNames",function getOwnPropertyNames(e){var t=le.ToObject(e);if(g(t)==="[object Window]"){try{return Vt(t)}catch(r){return P([],Ht)}}return Vt(t)})}}if(Object.getOwnPropertyDescriptor){var Bt=!i(function(){return Object.getOwnPropertyDescriptor("foo","bar")});if(!Bt){var Ut=Object.getOwnPropertyDescriptor;oe(Object,"getOwnPropertyDescriptor",function getOwnPropertyDescriptor(e,t){return Ut(le.ToObject(e),t)})}}if(Object.seal){var $t=!i(function(){return Object.seal("foo")});if(!$t){var Jt=Object.seal;oe(Object,"seal",function seal(e){if(!le.TypeIsObject(e)){return e}return Jt(e)})}}if(Object.isSealed){var Xt=!i(function(){return Object.isSealed("foo")});if(!Xt){var Kt=Object.isSealed;oe(Object,"isSealed",function isSealed(e){if(!le.TypeIsObject(e)){return true}return Kt(e)})}}if(Object.freeze){var Zt=!i(function(){return Object.freeze("foo")});if(!Zt){var Yt=Object.freeze;oe(Object,"freeze",function freeze(e){if(!le.TypeIsObject(e)){return e}return Yt(e)})}}if(Object.isFrozen){var Qt=!i(function(){return Object.isFrozen("foo")});if(!Qt){var er=Object.isFrozen;oe(Object,"isFrozen",function isFrozen(e){if(!le.TypeIsObject(e)){return true}return er(e)})}}if(Object.preventExtensions){var tr=!i(function(){return Object.preventExtensions("foo")});if(!tr){var rr=Object.preventExtensions;oe(Object,"preventExtensions",function preventExtensions(e){if(!le.TypeIsObject(e)){return e}return rr(e)})}}if(Object.isExtensible){var nr=!i(function(){return Object.isExtensible("foo")});if(!nr){var or=Object.isExtensible;oe(Object,"isExtensible",function isExtensible(e){if(!le.TypeIsObject(e)){return false}return or(e)})}}if(Object.getPrototypeOf){var ir=!i(function(){return Object.getPrototypeOf("foo")});if(!ir){var ar=Object.getPrototypeOf;oe(Object,"getPrototypeOf",function getPrototypeOf(e){return ar(le.ToObject(e))})}}var ur=s&&function(){var e=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return e&&le.IsCallable(e.get)}();if(s&&!ur){var fr=function flags(){if(!le.TypeIsObject(this)){throw new TypeError("Method called on incompatible type: must be an object.")}var e="";if(this.global){e+="g"}if(this.ignoreCase){e+="i"}if(this.multiline){e+="m"}if(this.unicode){e+="u"}if(this.sticky){e+="y"}return e};m.getter(RegExp.prototype,"flags",fr)}var sr=s&&a(function(){return String(new RegExp(/a/g,"i"))==="/a/i"});var cr=ie&&s&&function(){var e=/./;e[J.match]=false;return RegExp(e)===e}();var lr=a(function(){return RegExp.prototype.toString.call({source:"abc"})==="/abc/"});var pr=lr&&a(function(){return RegExp.prototype.toString.call({source:"a",flags:"b"})==="/a/b"});if(!lr||!pr){var vr=RegExp.prototype.toString;h(RegExp.prototype,"toString",function toString(){var e=le.RequireObjectCoercible(this);if(ne.regex(e)){return t(vr,e)}var r=fe(e.source);var n=fe(e.flags);return"/"+r+"/"+n},true);m.preserveToString(RegExp.prototype.toString,vr);RegExp.prototype.toString.prototype=void 0}if(s&&(!sr||cr)){var yr=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get;var hr=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{};var br=function(){return this.source};var gr=le.IsCallable(hr.get)?hr.get:br;var dr=RegExp;var mr=function(){return function RegExp(e,t){var r=le.IsRegExp(e);var n=this instanceof RegExp;if(!n&&r&&typeof t==="undefined"&&e.constructor===RegExp){return e}var o=e;var i=t;if(ne.regex(e)){o=le.Call(gr,e);i=typeof t==="undefined"?le.Call(yr,e):t;return new RegExp(o,i)}else if(r){o=e.source;i=typeof t==="undefined"?e.flags:t}return new dr(e,t)}}();Pe(dr,mr,{$input:true});RegExp=mr;m.redefine(S,"RegExp",mr)}if(s){var Or={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};l(n(Or),function(e){if(e in RegExp&&!(Or[e]in RegExp)){m.getter(RegExp,Or[e],function get(){return RegExp[e]})}})}Me(RegExp);var wr=1/Number.EPSILON;var jr=function roundTiesToEven(e){return e+wr-wr};var Sr=Math.pow(2,-23);var Tr=Math.pow(2,127)*(2-Sr);var Ir=Math.pow(2,-126);var Er=Math.E;var Pr=Math.LOG2E;var Cr=Math.LOG10E;var Mr=Number.prototype.clz;delete Number.prototype.clz;var xr={acosh:function acosh(e){var t=Number(e);if(K(t)||e<1){return NaN}if(t===1){return 0}if(t===Infinity){return t}var r=1/(t*t);if(t<2){return Q(t-1+z(1-r)*t)}var n=t/2;return Q(n+z(1-r)*n-1)+1/Pr},asinh:function asinh(e){var t=Number(e);if(t===0||!T(t)){return t}var r=L(t);var n=r*r;var o=Y(t);if(r<1){return o*Q(r+n/(z(n+1)+1))}return o*(Q(r/2+z(1+1/n)*r/2-1)+1/Pr)},atanh:function atanh(e){var t=Number(e);if(t===0){return t}if(t===-1){return-Infinity}if(t===1){return Infinity}if(K(t)||t<-1||t>1){return NaN}var r=L(t);return Y(t)*Q(2*r/(1-r))/2},cbrt:function cbrt(e){var t=Number(e);if(t===0){return t}var r=t<0;var n;if(r){t=-t}if(t===Infinity){n=Infinity}else{n=F(D(t)/3);n=(t/(n*n)+2*n)/3}return r?-n:n},clz32:function clz32(e){var t=Number(e);var r=le.ToUint32(t);if(r===0){return 32}return Mr?le.Call(Mr,r):31-k(D(r+.5)*Pr)},cosh:function cosh(e){var t=Number(e);if(t===0){return 1}if(K(t)){return NaN}if(!T(t)){return Infinity}var r=F(L(t)-1);return(r+1/(r*Er*Er))*(Er/2)},expm1:function expm1(e){var t=Number(e);if(t===-Infinity){return-1}if(!T(t)||t===0){return t}if(L(t)>.5){return F(t)-1}var r=t;var n=0;var o=1;while(n+r!==n){n+=r;o+=1;r*=t/o}return n},hypot:function hypot(e,t){var r=0;var n=0;for(var o=0;o<arguments.length;++o){var i=L(Number(arguments[o]));if(n<i){r*=n/i*(n/i);r+=1;n=i}else{r+=i>0?i/n*(i/n):i}}return n===Infinity?Infinity:n*z(r)},log2:function log2(e){return D(e)*Pr},log10:function log10(e){return D(e)*Cr},log1p:Q,sign:Y,sinh:function sinh(e){var t=Number(e);if(!T(t)||t===0){return t}var r=L(t);if(r<1){var n=Math.expm1(r);return Y(t)*n*(1+1/(n+1))/2}var o=F(r-1);return Y(t)*(o-1/(o*Er*Er))*(Er/2)},tanh:function tanh(e){var t=Number(e);if(K(t)||t===0){return t}if(t>=20){return 1}if(t<=-20){return-1}return(Math.expm1(t)-Math.expm1(-t))/(F(t)+F(-t))},trunc:function trunc(e){var t=Number(e);return t<0?-k(-t):k(t)},imul:function imul(e,t){var r=le.ToUint32(e);var n=le.ToUint32(t);var o=r>>>16&65535;var i=r&65535;var a=n>>>16&65535;var u=n&65535;return i*u+(o*u+i*a<<16>>>0)|0},fround:function fround(e){var t=Number(e);if(t===0||t===Infinity||t===-Infinity||K(t)){return t}var r=Y(t);var n=L(t);if(n<Ir){return r*jr(n/Ir/Sr)*Ir*Sr}var o=(1+Sr/Number.EPSILON)*n;var i=o-(o-n);if(i>Tr||K(i)){return r*Infinity}return r*i}};var Nr=function withinULPDistance(e,t,r){return L(1-e/t)/Number.EPSILON<(r||8)};b(Math,xr);h(Math,"sinh",xr.sinh,Math.sinh(710)===Infinity);h(Math,"cosh",xr.cosh,Math.cosh(710)===Infinity);h(Math,"log1p",xr.log1p,Math.log1p(-1e-17)!==-1e-17);h(Math,"asinh",xr.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7));
h(Math,"asinh",xr.asinh,Math.asinh(1e300)===Infinity);h(Math,"atanh",xr.atanh,Math.atanh(1e-300)===0);h(Math,"tanh",xr.tanh,Math.tanh(-2e-17)!==-2e-17);h(Math,"acosh",xr.acosh,Math.acosh(Number.MAX_VALUE)===Infinity);h(Math,"acosh",xr.acosh,!Nr(Math.acosh(1+Number.EPSILON),Math.sqrt(2*Number.EPSILON)));h(Math,"cbrt",xr.cbrt,!Nr(Math.cbrt(1e-300),1e-100));h(Math,"sinh",xr.sinh,Math.sinh(-2e-17)!==-2e-17);var Ar=Math.expm1(10);h(Math,"expm1",xr.expm1,Ar>22025.465794806718||Ar<22025.465794806718);h(Math,"hypot",xr.hypot,Math.hypot(Infinity,NaN)!==Infinity);var _r=Math.round;var Rr=Math.round(.5-Number.EPSILON/4)===0&&Math.round(-.5+Number.EPSILON/3.99)===1;var kr=wr+1;var Lr=2*wr-1;var Fr=[kr,Lr].every(function(e){return Math.round(e)===e});h(Math,"round",function round(e){var t=k(e);var r=t===-1?-0:t+1;return e-t<.5?t:r},!Rr||!Fr);m.preserveToString(Math.round,_r);var Dr=Math.imul;if(Math.imul(4294967295,5)!==-5){Math.imul=xr.imul;m.preserveToString(Math.imul,Dr)}if(Math.imul.length!==2){oe(Math,"imul",function imul(e,t){return le.Call(Dr,Math,arguments)})}var zr=function(){var e=S.setTimeout;if(typeof e!=="function"&&typeof e!=="object"){return}le.IsPromise=function(e){if(!le.TypeIsObject(e)){return false}if(typeof e._promise==="undefined"){return false}return true};var r=function(e){if(!le.IsConstructor(e)){throw new TypeError("Bad promise constructor")}var t=this;var r=function(e,r){if(t.resolve!==void 0||t.reject!==void 0){throw new TypeError("Bad Promise implementation!")}t.resolve=e;t.reject=r};t.resolve=void 0;t.reject=void 0;t.promise=new e(r);if(!(le.IsCallable(t.resolve)&&le.IsCallable(t.reject))){throw new TypeError("Bad promise constructor")}};var n;if(typeof window!=="undefined"&&le.IsCallable(window.postMessage)){n=function(){var e=[];var t="zero-timeout-message";var r=function(r){M(e,r);window.postMessage(t,"*")};var n=function(r){if(r.source===window&&r.data===t){r.stopPropagation();if(e.length===0){return}var n=A(e);n()}};window.addEventListener("message",n,true);return r}}var o=function(){var e=S.Promise;var t=e&&e.resolve&&e.resolve();return t&&function(e){return t.then(e)}};var i=le.IsCallable(S.setImmediate)?S.setImmediate:typeof process==="object"&&process.nextTick?process.nextTick:o()||(le.IsCallable(n)?n():function(t){e(t,0)});var a=function(e){return e};var u=function(e){throw e};var f=0;var s=1;var c=2;var l=0;var p=1;var v=2;var y={};var h=function(e,t,r){i(function(){g(e,t,r)})};var g=function(e,t,r){var n,o;if(t===y){return e(r)}try{n=e(r);o=t.resolve}catch(i){n=i;o=t.reject}o(n)};var d=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.fulfillReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+l],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=s;r.reactionLength=0};var m=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.rejectReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+p],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=c;r.reactionLength=0};var O=function(e){var t=false;var r=function(r){var n;if(t){return}t=true;if(r===e){return m(e,new TypeError("Self resolution"))}if(!le.TypeIsObject(r)){return d(e,r)}try{n=r.then}catch(o){return m(e,o)}if(!le.IsCallable(n)){return d(e,r)}i(function(){j(e,r,n)})};var n=function(r){if(t){return}t=true;return m(e,r)};return{resolve:r,reject:n}};var w=function(e,r,n,o){if(e===I){t(e,r,n,o,y)}else{t(e,r,n,o)}};var j=function(e,t,r){var n=O(e);var o=n.resolve;var i=n.reject;try{w(r,t,o,i)}catch(a){i(a)}};var T,I;var E=function(){var e=function Promise(t){if(!(this instanceof e)){throw new TypeError('Constructor Promise requires "new"')}if(this&&this._promise){throw new TypeError("Bad construction")}if(!le.IsCallable(t)){throw new TypeError("not a valid resolver")}var r=_e(this,e,T,{_promise:{result:void 0,state:f,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}});var n=O(r);var o=n.reject;try{t(n.resolve,o)}catch(i){o(i)}return r};return e}();T=E.prototype;var P=function(e,t,r,n){var o=false;return function(i){if(o){return}o=true;t[e]=i;if(--n.count===0){var a=r.resolve;a(t)}}};var C=function(e,t,r){var n=e.iterator;var o=[];var i={count:1};var a,u;var f=0;while(true){try{a=le.IteratorStep(n);if(a===false){e.done=true;break}u=a.value}catch(s){e.done=true;throw s}o[f]=void 0;var c=t.resolve(u);var l=P(f,o,r,i);i.count+=1;w(c.then,c,l,r.reject);f+=1}if(--i.count===0){var p=r.resolve;p(o)}return r.promise};var x=function(e,t,r){var n=e.iterator;var o,i,a;while(true){try{o=le.IteratorStep(n);if(o===false){e.done=true;break}i=o.value}catch(u){e.done=true;throw u}a=t.resolve(i);w(a.then,a,r.resolve,r.reject)}return r.promise};b(E,{all:function all(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=le.GetIterator(e);i={iterator:o,done:false};return C(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{le.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},race:function race(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=le.GetIterator(e);i={iterator:o,done:false};return x(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{le.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},reject:function reject(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}var n=new r(t);var o=n.reject;o(e);return n.promise},resolve:function resolve(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}if(le.IsPromise(e)){var n=e.constructor;if(n===t){return e}}var o=new r(t);var i=o.resolve;i(e);return o.promise}});b(T,{"catch":function(e){return this.then(null,e)},then:function then(e,t){var n=this;if(!le.IsPromise(n)){throw new TypeError("not a promise")}var o=le.SpeciesConstructor(n,E);var i;var b=arguments.length>2&&arguments[2]===y;if(b&&o===E){i=y}else{i=new r(o)}var g=le.IsCallable(e)?e:a;var d=le.IsCallable(t)?t:u;var m=n._promise;var O;if(m.state===f){if(m.reactionLength===0){m.fulfillReactionHandler0=g;m.rejectReactionHandler0=d;m.reactionCapability0=i}else{var w=3*(m.reactionLength-1);m[w+l]=g;m[w+p]=d;m[w+v]=i}m.reactionLength+=1}else if(m.state===s){O=m.result;h(g,i,O)}else if(m.state===c){O=m.result;h(d,i,O)}else{throw new TypeError("unexpected Promise state")}return i.promise}});y=new r(E);I=T.then;return E}();if(S.Promise){delete S.Promise.accept;delete S.Promise.defer;delete S.Promise.prototype.chain}if(typeof zr==="function"){b(S,{Promise:zr});var qr=w(S.Promise,function(e){return e.resolve(42).then(function(){})instanceof e});var Wr=!i(function(){return S.Promise.reject(42).then(null,5).then(null,G)});var Gr=i(function(){return S.Promise.call(3,G)});var Hr=function(e){var t=e.resolve(5);t.constructor={};var r=e.resolve(t);try{r.then(null,G).then(null,G)}catch(n){return true}return t===r}(S.Promise);var Vr=s&&function(){var e=0;var t=Object.defineProperty({},"then",{get:function(){e+=1}});Promise.resolve(t);return e===1}();var Br=function BadResolverPromise(e){var t=new Promise(e);e(3,function(){});this.then=t.then;this.constructor=BadResolverPromise};Br.prototype=Promise.prototype;Br.all=Promise.all;var Ur=a(function(){return!!Br.all([1,2])});if(!qr||!Wr||!Gr||Hr||!Vr||Ur){Promise=zr;oe(S,"Promise",zr)}if(Promise.all.length!==1){var $r=Promise.all;oe(Promise,"all",function all(e){return le.Call($r,this,arguments)})}if(Promise.race.length!==1){var Jr=Promise.race;oe(Promise,"race",function race(e){return le.Call(Jr,this,arguments)})}if(Promise.resolve.length!==1){var Xr=Promise.resolve;oe(Promise,"resolve",function resolve(e){return le.Call(Xr,this,arguments)})}if(Promise.reject.length!==1){var Kr=Promise.reject;oe(Promise,"reject",function reject(e){return le.Call(Kr,this,arguments)})}Nt(Promise,"all");Nt(Promise,"race");Nt(Promise,"resolve");Nt(Promise,"reject");Me(Promise)}var Zr=function(e){var t=n(p(e,function(e,t){e[t]=true;return e},{}));return e.join(":")===t.join(":")};var Yr=Zr(["z","a","bb"]);var Qr=Zr(["z",1,"a","3",2]);if(s){var en=function fastkey(e,t){if(!t&&!Yr){return null}if(ce(e)){return"^"+le.ToString(e)}else if(typeof e==="string"){return"$"+e}else if(typeof e==="number"){if(!Qr){return"n"+e}return e}else if(typeof e==="boolean"){return"b"+e}return null};var tn=function emptyObject(){return Object.create?Object.create(null):{}};var rn=function addIterableToMap(e,n,o){if(r(o)||ne.string(o)){l(o,function(e){if(!le.TypeIsObject(e)){throw new TypeError("Iterator value "+e+" is not an entry object")}n.set(e[0],e[1])})}else if(o instanceof e){t(e.prototype.forEach,o,function(e,t){n.set(t,e)})}else{var i,a;if(!ce(o)){a=n.set;if(!le.IsCallable(a)){throw new TypeError("bad map")}i=le.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=le.IteratorStep(i);if(u===false){break}var f=u.value;try{if(!le.TypeIsObject(f)){throw new TypeError("Iterator value "+f+" is not an entry object")}t(a,n,f[0],f[1])}catch(s){le.IteratorClose(i,true);throw s}}}}};var nn=function addIterableToSet(e,n,o){if(r(o)||ne.string(o)){l(o,function(e){n.add(e)})}else if(o instanceof e){t(e.prototype.forEach,o,function(e){n.add(e)})}else{var i,a;if(!ce(o)){a=n.add;if(!le.IsCallable(a)){throw new TypeError("bad set")}i=le.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=le.IteratorStep(i);if(u===false){break}var f=u.value;try{t(a,n,f)}catch(s){le.IteratorClose(i,true);throw s}}}}};var on={Map:function(){var e={};var r=function MapEntry(e,t){this.key=e;this.value=t;this.next=null;this.prev=null};r.prototype.isRemoved=function isRemoved(){return this.key===e};var n=function isMap(e){return!!e._es6map};var o=function requireMapSlot(e,t){if(!le.TypeIsObject(e)||!n(e)){throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+le.ToString(e))}};var i=function MapIterator(e,t){o(e,"[[MapIterator]]");h(this,"head",e._head);h(this,"i",this.head);h(this,"kind",t)};i.prototype={isMapIterator:true,next:function next(){if(!this.isMapIterator){throw new TypeError("Not a MapIterator")}var e=this.i;var t=this.kind;var r=this.head;if(typeof this.i==="undefined"){return Ze()}while(e.isRemoved()&&e!==r){e=e.prev}var n;while(e.next!==r){e=e.next;if(!e.isRemoved()){if(t==="key"){n=e.key}else if(t==="value"){n=e.value}else{n=[e.key,e.value]}this.i=e;return Ze(n)}}this.i=void 0;return Ze()}};xe(i.prototype);var a;var u=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}if(this&&this._es6map){throw new TypeError("Bad construction")}var e=_e(this,Map,a,{_es6map:true,_head:null,_map:H?new H:null,_size:0,_storage:tn()});var t=new r(null,null);t.next=t.prev=t;e._head=t;if(arguments.length>0){rn(Map,e,arguments[0])}return e};a=u.prototype;m.getter(a,"size",function(){if(typeof this._size==="undefined"){throw new TypeError("size method called on incompatible Map")}return this._size});b(a,{get:function get(e){o(this,"get");var t;var r=en(e,true);if(r!==null){t=this._storage[r];if(t){return t.value}return}if(this._map){t=B.call(this._map,e);if(t){return t.value}return}var n=this._head;var i=n;while((i=i.next)!==n){if(le.SameValueZero(i.key,e)){return i.value}}},has:function has(e){o(this,"has");var t=en(e,true);if(t!==null){return typeof this._storage[t]!=="undefined"}if(this._map){return U.call(this._map,e)}var r=this._head;var n=r;while((n=n.next)!==r){if(le.SameValueZero(n.key,e)){return true}}return false},set:function set(e,t){o(this,"set");var n=this._head;var i=n;var a;var u=en(e,true);if(u!==null){if(typeof this._storage[u]!=="undefined"){this._storage[u].value=t;return this}a=this._storage[u]=new r(e,t);i=n.prev}else if(this._map){if(U.call(this._map,e)){B.call(this._map,e).value=t}else{a=new r(e,t);$.call(this._map,e,a);i=n.prev}}while((i=i.next)!==n){if(le.SameValueZero(i.key,e)){i.value=t;return this}}a=a||new r(e,t);if(le.SameValue(-0,e)){a.key=+0}a.next=this._head;a.prev=this._head.prev;a.prev.next=a;a.next.prev=a;this._size+=1;return this},"delete":function(t){o(this,"delete");var r=this._head;var n=r;var i=en(t,true);if(i!==null){if(typeof this._storage[i]==="undefined"){return false}n=this._storage[i].prev;delete this._storage[i]}else if(this._map){if(!U.call(this._map,t)){return false}n=B.call(this._map,t).prev;V.call(this._map,t)}while((n=n.next)!==r){if(le.SameValueZero(n.key,t)){n.key=e;n.value=e;n.prev.next=n.next;n.next.prev=n.prev;this._size-=1;return true}}return false},clear:function clear(){o(this,"clear");this._map=H?new H:null;this._size=0;this._storage=tn();var t=this._head;var r=t;var n=r.next;while((r=n)!==t){r.key=e;r.value=e;n=r.next;r.next=r.prev=t}t.next=t.prev=t},keys:function keys(){o(this,"keys");return new i(this,"key")},values:function values(){o(this,"values");return new i(this,"value")},entries:function entries(){o(this,"entries");return new i(this,"key+value")},forEach:function forEach(e){o(this,"forEach");var r=arguments.length>1?arguments[1]:null;var n=this.entries();for(var i=n.next();!i.done;i=n.next()){if(r){t(e,r,i.value[1],i.value[0],this)}else{e(i.value[1],i.value[0],this)}}}});xe(a,a.entries);return u}(),Set:function(){var e=function isSet(e){return e._es6set&&typeof e._storage!=="undefined"};var r=function requireSetSlot(t,r){if(!le.TypeIsObject(t)||!e(t)){throw new TypeError("Set.prototype."+r+" called on incompatible receiver "+le.ToString(t))}};var o;var i=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}if(this&&this._es6set){throw new TypeError("Bad construction")}var e=_e(this,Set,o,{_es6set:true,"[[SetData]]":null,_storage:tn()});if(!e._es6set){throw new TypeError("bad set")}if(arguments.length>0){nn(Set,e,arguments[0])}return e};o=i.prototype;var a=function(e){var t=e;if(t==="^null"){return null}else if(t==="^undefined"){return void 0}var r=t.charAt(0);if(r==="$"){return C(t,1)}else if(r==="n"){return+C(t,1)}else if(r==="b"){return t==="btrue"}return+t};var u=function ensureMap(e){if(!e["[[SetData]]"]){var t=new on.Map;e["[[SetData]]"]=t;l(n(e._storage),function(e){var r=a(e);t.set(r,r)});e["[[SetData]]"]=t}e._storage=null};m.getter(i.prototype,"size",function(){r(this,"size");if(this._storage){return n(this._storage).length}u(this);return this["[[SetData]]"].size});b(i.prototype,{has:function has(e){r(this,"has");var t;if(this._storage&&(t=en(e))!==null){return!!this._storage[t]}u(this);return this["[[SetData]]"].has(e)},add:function add(e){r(this,"add");var t;if(this._storage&&(t=en(e))!==null){this._storage[t]=true;return this}u(this);this["[[SetData]]"].set(e,e);return this},"delete":function(e){r(this,"delete");var t;if(this._storage&&(t=en(e))!==null){var n=q(this._storage,t);return delete this._storage[t]&&n}u(this);return this["[[SetData]]"]["delete"](e)},clear:function clear(){r(this,"clear");if(this._storage){this._storage=tn()}if(this["[[SetData]]"]){this["[[SetData]]"].clear()}},values:function values(){r(this,"values");u(this);return new f(this["[[SetData]]"].values())},entries:function entries(){r(this,"entries");u(this);return new f(this["[[SetData]]"].entries())},forEach:function forEach(e){r(this,"forEach");var n=arguments.length>1?arguments[1]:null;var o=this;u(o);this["[[SetData]]"].forEach(function(r,i){if(n){t(e,n,i,i,o)}else{e(i,i,o)}})}});h(i.prototype,"keys",i.prototype.values,true);xe(i.prototype,i.prototype.values);var f=function SetIterator(e){h(this,"it",e)};f.prototype={isSetIterator:true,next:function next(){if(!this.isSetIterator){throw new TypeError("Not a SetIterator")}return this.it.next()}};xe(f.prototype);return i}()};var an=S.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys);if(an){S.Set=on.Set}if(S.Map||S.Set){var un=a(function(){return new Map([[1,2]]).get(1)===2});if(!un){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new H;if(arguments.length>0){rn(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,S.Map.prototype);return e};S.Map.prototype=O(H.prototype);h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,H)}var fn=new Map;var sn=function(){var e=new Map([[1,0],[2,0],[3,0],[4,0]]);e.set(-0,e);return e.get(0)===e&&e.get(-0)===e&&e.has(0)&&e.has(-0)}();var cn=fn.set(1,2)===fn;if(!sn||!cn){oe(Map.prototype,"set",function set(e,r){t($,this,e===0?0:e,r);return this})}if(!sn){b(Map.prototype,{get:function get(e){return t(B,this,e===0?0:e)},has:function has(e){return t(U,this,e===0?0:e)}},true);m.preserveToString(Map.prototype.get,B);m.preserveToString(Map.prototype.has,U)}var ln=new Set;var pn=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(e){e["delete"](0);e.add(-0);return!e.has(0)}(ln);var vn=ln.add(1)===ln;if(!pn||!vn){var yn=Set.prototype.add;Set.prototype.add=function add(e){t(yn,this,e===0?0:e);return this};m.preserveToString(Set.prototype.add,yn)}if(!pn){var hn=Set.prototype.has;Set.prototype.has=function has(e){return t(hn,this,e===0?0:e)};m.preserveToString(Set.prototype.has,hn);var bn=Set.prototype["delete"];Set.prototype["delete"]=function SetDelete(e){return t(bn,this,e===0?0:e)};m.preserveToString(Set.prototype["delete"],bn)}var gn=w(S.Map,function(e){var t=new e([]);t.set(42,42);return t instanceof e});var dn=Object.setPrototypeOf&&!gn;var mn=function(){try{return!(S.Map()instanceof S.Map)}catch(e){return e instanceof TypeError}}();if(S.Map.length!==0||dn||!mn){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new H;if(arguments.length>0){rn(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Map.prototype);return e};S.Map.prototype=H.prototype;h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,H)}var On=w(S.Set,function(e){var t=new e([]);t.add(42,42);return t instanceof e});var wn=Object.setPrototypeOf&&!On;var jn=function(){try{return!(S.Set()instanceof S.Set)}catch(e){return e instanceof TypeError}}();if(S.Set.length!==0||wn||!jn){var Sn=S.Set;S.Set=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}var e=new Sn;if(arguments.length>0){nn(Set,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Set.prototype);return e};S.Set.prototype=Sn.prototype;h(S.Set.prototype,"constructor",S.Set,true);m.preserveToString(S.Set,Sn)}var Tn=new S.Map;var In=!a(function(){return Tn.keys().next().done});if(typeof S.Map.prototype.clear!=="function"||(new S.Set).size!==0||Tn.size!==0||typeof S.Map.prototype.keys!=="function"||typeof S.Set.prototype.keys!=="function"||typeof S.Map.prototype.forEach!=="function"||typeof S.Set.prototype.forEach!=="function"||u(S.Map)||u(S.Set)||typeof Tn.keys().next!=="function"||In||!gn){b(S,{Map:on.Map,Set:on.Set},true)}if(S.Set.prototype.keys!==S.Set.prototype.values){h(S.Set.prototype,"keys",S.Set.prototype.values,true)}xe(Object.getPrototypeOf((new S.Map).keys()));xe(Object.getPrototypeOf((new S.Set).keys()));if(c&&S.Set.prototype.has.name!=="has"){var En=S.Set.prototype.has;oe(S.Set.prototype,"has",function has(e){return t(En,this,e)})}}b(S,on);Me(S.Map);Me(S.Set)}var Pn=function throwUnlessTargetIsObject(e){if(!le.TypeIsObject(e)){throw new TypeError("target must be an object")}};var Cn={apply:function apply(){return le.Call(le.Call,null,arguments)},construct:function construct(e,t){if(!le.IsConstructor(e)){throw new TypeError("First argument must be a constructor.")}var r=arguments.length>2?arguments[2]:e;if(!le.IsConstructor(r)){throw new TypeError("new.target must be a constructor.")}return le.Construct(e,t,r,"internal")},deleteProperty:function deleteProperty(e,t){Pn(e);if(s){var r=Object.getOwnPropertyDescriptor(e,t);if(r&&!r.configurable){return false}}return delete e[t]},has:function has(e,t){Pn(e);return t in e}};if(Object.getOwnPropertyNames){Object.assign(Cn,{ownKeys:function ownKeys(e){Pn(e);var t=Object.getOwnPropertyNames(e);if(le.IsCallable(Object.getOwnPropertySymbols)){x(t,Object.getOwnPropertySymbols(e))}return t}})}var Mn=function ConvertExceptionToBoolean(e){return!i(e)};if(Object.preventExtensions){Object.assign(Cn,{isExtensible:function isExtensible(e){Pn(e);return Object.isExtensible(e)},preventExtensions:function preventExtensions(e){Pn(e);return Mn(function(){return Object.preventExtensions(e)})}})}if(s){var xn=function get(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(!n){var o=Object.getPrototypeOf(e);if(o===null){return void 0}return xn(o,t,r)}if("value"in n){return n.value}if(n.get){return le.Call(n.get,r)}return void 0};var Nn=function set(e,r,n,o){var i=Object.getOwnPropertyDescriptor(e,r);if(!i){var a=Object.getPrototypeOf(e);if(a!==null){return Nn(a,r,n,o)}i={value:void 0,writable:true,enumerable:true,configurable:true}}if("value"in i){if(!i.writable){return false}if(!le.TypeIsObject(o)){return false}var u=Object.getOwnPropertyDescriptor(o,r);if(u){return ue.defineProperty(o,r,{value:n})}return ue.defineProperty(o,r,{value:n,writable:true,enumerable:true,configurable:true})}if(i.set){t(i.set,o,n);return true}return false};Object.assign(Cn,{defineProperty:function defineProperty(e,t,r){Pn(e);return Mn(function(){return Object.defineProperty(e,t,r)})},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(e,t){Pn(e);return Object.getOwnPropertyDescriptor(e,t)},get:function get(e,t){Pn(e);var r=arguments.length>2?arguments[2]:e;return xn(e,t,r)},set:function set(e,t,r){Pn(e);var n=arguments.length>3?arguments[3]:e;return Nn(e,t,r,n)}})}if(Object.getPrototypeOf){var An=Object.getPrototypeOf;Cn.getPrototypeOf=function getPrototypeOf(e){Pn(e);return An(e)}}if(Object.setPrototypeOf&&Cn.getPrototypeOf){var _n=function(e,t){var r=t;while(r){if(e===r){return true}r=Cn.getPrototypeOf(r)}return false};Object.assign(Cn,{setPrototypeOf:function setPrototypeOf(e,t){Pn(e);if(t!==null&&!le.TypeIsObject(t)){throw new TypeError("proto must be an object or null")}if(t===ue.getPrototypeOf(e)){return true}if(ue.isExtensible&&!ue.isExtensible(e)){return false}if(_n(e,t)){return false}Object.setPrototypeOf(e,t);return true}})}var Rn=function(e,t){if(!le.IsCallable(S.Reflect[e])){h(S.Reflect,e,t)}else{var r=a(function(){S.Reflect[e](1);S.Reflect[e](NaN);S.Reflect[e](true);return true});if(r){oe(S.Reflect,e,t)}}};Object.keys(Cn).forEach(function(e){Rn(e,Cn[e])});var kn=S.Reflect.getPrototypeOf;if(c&&kn&&kn.name!=="getPrototypeOf"){oe(S.Reflect,"getPrototypeOf",function getPrototypeOf(e){return t(kn,S.Reflect,e)})}if(S.Reflect.setPrototypeOf){if(a(function(){S.Reflect.setPrototypeOf(1,{});return true})){oe(S.Reflect,"setPrototypeOf",Cn.setPrototypeOf)}}if(S.Reflect.defineProperty){if(!a(function(){var e=!S.Reflect.defineProperty(1,"test",{value:1});var t=typeof Object.preventExtensions!=="function"||!S.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})){oe(S.Reflect,"defineProperty",Cn.defineProperty)}}if(S.Reflect.construct){if(!a(function(){var e=function F(){};return S.Reflect.construct(function(){},[],e)instanceof e})){oe(S.Reflect,"construct",Cn.construct)}}if(String(new Date(NaN))!=="Invalid Date"){var Ln=Date.prototype.toString;var Fn=function toString(){var e=+this;if(e!==e){return"Invalid Date"}return le.Call(Ln,this)};oe(Date.prototype,"toString",Fn)}var Dn={anchor:function anchor(e){return le.CreateHTML(this,"a","name",e)},big:function big(){return le.CreateHTML(this,"big","","")},blink:function blink(){return le.CreateHTML(this,"blink","","")},bold:function bold(){return le.CreateHTML(this,"b","","")},fixed:function fixed(){return le.CreateHTML(this,"tt","","")},fontcolor:function fontcolor(e){return le.CreateHTML(this,"font","color",e)},fontsize:function fontsize(e){return le.CreateHTML(this,"font","size",e)},italics:function italics(){return le.CreateHTML(this,"i","","")},link:function link(e){return le.CreateHTML(this,"a","href",e)},small:function small(){return le.CreateHTML(this,"small","","")},strike:function strike(){return le.CreateHTML(this,"strike","","")},sub:function sub(){return le.CreateHTML(this,"sub","","")},sup:function sub(){return le.CreateHTML(this,"sup","","")}};l(Object.keys(Dn),function(e){var r=String.prototype[e];var n=false;if(le.IsCallable(r)){var o=t(r,"",' " ');var i=P([],o.match(/"/g)).length;n=o!==o.toLowerCase()||i>2}else{n=true}if(n){oe(String.prototype,e,Dn[e])}});var zn=function(){if(!ie){return false}var e=typeof JSON==="object"&&typeof JSON.stringify==="function"?JSON.stringify:null;if(!e){return false}if(typeof e(J())!=="undefined"){return true}if(e([J()])!=="[null]"){return true}var t={a:J()};t[J()]=true;if(e(t)!=="{}"){return true}return false}();var qn=a(function(){if(!ie){return true}return JSON.stringify(Object(J()))==="{}"&&JSON.stringify([Object(J())])==="[{}]"});if(zn||!qn){var Wn=JSON.stringify;oe(JSON,"stringify",function stringify(e){if(typeof e==="symbol"){return}var n;if(arguments.length>1){n=arguments[1]}var o=[e];if(!r(n)){var i=le.IsCallable(n)?n:null;var a=function(e,r){var n=i?t(i,this,e,r):r;if(typeof n!=="symbol"){if(ne.symbol(n)){return _t({})(n)}return n}};o.push(a)}else{o.push(n)}if(arguments.length>2){o.push(arguments[2])}return Wn.apply(this,o)})}return S});
//# sourceMappingURL=es6-shim.map
/*! jQuery v3.7.1 | (c) OpenJS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(ie,e){"use strict";var oe=[],r=Object.getPrototypeOf,ae=oe.slice,g=oe.flat?function(e){return oe.flat.call(e)}:function(e){return oe.concat.apply([],e)},s=oe.push,se=oe.indexOf,n={},i=n.toString,ue=n.hasOwnProperty,o=ue.toString,a=o.call(Object),le={},v=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},y=function(e){return null!=e&&e===e.window},C=ie.document,u={type:!0,src:!0,nonce:!0,noModule:!0};function m(e,t,n){var r,i,o=(n=n||C).createElement("script");if(o.text=e,t)for(r in u)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[i.call(e)]||"object":typeof e}var t="3.7.1",l=/HTML$/i,ce=function(e,t){return new ce.fn.init(e,t)};function c(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!v(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}function fe(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}ce.fn=ce.prototype={jquery:t,constructor:ce,length:0,toArray:function(){return ae.call(this)},get:function(e){return null==e?ae.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=ce.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return ce.each(this,e)},map:function(n){return this.pushStack(ce.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(ae.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(ce.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(ce.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:oe.sort,splice:oe.splice},ce.extend=ce.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||v(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(ce.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||ce.isPlainObject(n)?n:{},i=!1,a[t]=ce.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},ce.extend({expando:"jQuery"+(t+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==i.call(e))&&(!(t=r(e))||"function"==typeof(n=ue.call(t,"constructor")&&t.constructor)&&o.call(n)===a)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){m(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(c(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},text:function(e){var t,n="",r=0,i=e.nodeType;if(!i)while(t=e[r++])n+=ce.text(t);return 1===i||11===i?e.textContent:9===i?e.documentElement.textContent:3===i||4===i?e.nodeValue:n},makeArray:function(e,t){var n=t||[];return null!=e&&(c(Object(e))?ce.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:se.call(t,e,n)},isXMLDoc:function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!l.test(t||n&&n.nodeName||"HTML")},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(c(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,support:le}),"function"==typeof Symbol&&(ce.fn[Symbol.iterator]=oe[Symbol.iterator]),ce.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});var pe=oe.pop,de=oe.sort,he=oe.splice,ge="[\\x20\\t\\r\\n\\f]",ve=new RegExp("^"+ge+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ge+"+$","g");ce.contains=function(e,t){var n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(e.contains?e.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))};var f=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function p(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}ce.escapeSelector=function(e){return(e+"").replace(f,p)};var ye=C,me=s;!function(){var e,b,w,o,a,T,r,C,d,i,k=me,S=ce.expando,E=0,n=0,s=W(),c=W(),u=W(),h=W(),l=function(e,t){return e===t&&(a=!0),0},f="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",t="(?:\\\\[\\da-fA-F]{1,6}"+ge+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",p="\\["+ge+"*("+t+")(?:"+ge+"*([*^$|!~]?=)"+ge+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+t+"))|)"+ge+"*\\]",g=":("+t+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+p+")*)|.*)\\)|)",v=new RegExp(ge+"+","g"),y=new RegExp("^"+ge+"*,"+ge+"*"),m=new RegExp("^"+ge+"*([>+~]|"+ge+")"+ge+"*"),x=new RegExp(ge+"|>"),j=new RegExp(g),A=new RegExp("^"+t+"$"),D={ID:new RegExp("^#("+t+")"),CLASS:new RegExp("^\\.("+t+")"),TAG:new RegExp("^("+t+"|[*])"),ATTR:new RegExp("^"+p),PSEUDO:new RegExp("^"+g),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ge+"*(even|odd|(([+-]|)(\\d*)n|)"+ge+"*(?:([+-]|)"+ge+"*(\\d+)|))"+ge+"*\\)|)","i"),bool:new RegExp("^(?:"+f+")$","i"),needsContext:new RegExp("^"+ge+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ge+"*((?:-\\d)?\\d*)"+ge+"*\\)|)(?=[^-]|$)","i")},N=/^(?:input|select|textarea|button)$/i,q=/^h\d$/i,L=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,H=/[+~]/,O=new RegExp("\\\\[\\da-fA-F]{1,6}"+ge+"?|\\\\([^\\r\\n\\f])","g"),P=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},M=function(){V()},R=J(function(e){return!0===e.disabled&&fe(e,"fieldset")},{dir:"parentNode",next:"legend"});try{k.apply(oe=ae.call(ye.childNodes),ye.childNodes),oe[ye.childNodes.length].nodeType}catch(e){k={apply:function(e,t){me.apply(e,ae.call(t))},call:function(e){me.apply(e,ae.call(arguments,1))}}}function I(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(V(e),e=e||T,C)){if(11!==p&&(u=L.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return k.call(n,a),n}else if(f&&(a=f.getElementById(i))&&I.contains(e,a)&&a.id===i)return k.call(n,a),n}else{if(u[2])return k.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&e.getElementsByClassName)return k.apply(n,e.getElementsByClassName(i)),n}if(!(h[t+" "]||d&&d.test(t))){if(c=t,f=e,1===p&&(x.test(t)||m.test(t))){(f=H.test(t)&&U(e.parentNode)||e)==e&&le.scope||((s=e.getAttribute("id"))?s=ce.escapeSelector(s):e.setAttribute("id",s=S)),o=(l=Y(t)).length;while(o--)l[o]=(s?"#"+s:":scope")+" "+Q(l[o]);c=l.join(",")}try{return k.apply(n,f.querySelectorAll(c)),n}catch(e){h(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return re(t.replace(ve,"$1"),e,n,r)}function W(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function F(e){return e[S]=!0,e}function $(e){var t=T.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function B(t){return function(e){return fe(e,"input")&&e.type===t}}function _(t){return function(e){return(fe(e,"input")||fe(e,"button"))&&e.type===t}}function z(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&R(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function X(a){return F(function(o){return o=+o,F(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function U(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function V(e){var t,n=e?e.ownerDocument||e:ye;return n!=T&&9===n.nodeType&&n.documentElement&&(r=(T=n).documentElement,C=!ce.isXMLDoc(T),i=r.matches||r.webkitMatchesSelector||r.msMatchesSelector,r.msMatchesSelector&&ye!=T&&(t=T.defaultView)&&t.top!==t&&t.addEventListener("unload",M),le.getById=$(function(e){return r.appendChild(e).id=ce.expando,!T.getElementsByName||!T.getElementsByName(ce.expando).length}),le.disconnectedMatch=$(function(e){return i.call(e,"*")}),le.scope=$(function(){return T.querySelectorAll(":scope")}),le.cssHas=$(function(){try{return T.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}}),le.getById?(b.filter.ID=function(e){var t=e.replace(O,P);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&C){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(O,P);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&C){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):t.querySelectorAll(e)},b.find.CLASS=function(e,t){if("undefined"!=typeof t.getElementsByClassName&&C)return t.getElementsByClassName(e)},d=[],$(function(e){var t;r.appendChild(e).innerHTML="<a id='"+S+"' href='' disabled='disabled'></a><select id='"+S+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+ge+"*(?:value|"+f+")"),e.querySelectorAll("[id~="+S+"-]").length||d.push("~="),e.querySelectorAll("a#"+S+"+*").length||d.push(".#.+[+~]"),e.querySelectorAll(":checked").length||d.push(":checked"),(t=T.createElement("input")).setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),r.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&d.push(":enabled",":disabled"),(t=T.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||d.push("\\["+ge+"*name"+ge+"*="+ge+"*(?:''|\"\")")}),le.cssHas||d.push(":has"),d=d.length&&new RegExp(d.join("|")),l=function(e,t){if(e===t)return a=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!le.sortDetached&&t.compareDocumentPosition(e)===n?e===T||e.ownerDocument==ye&&I.contains(ye,e)?-1:t===T||t.ownerDocument==ye&&I.contains(ye,t)?1:o?se.call(o,e)-se.call(o,t):0:4&n?-1:1)}),T}for(e in I.matches=function(e,t){return I(e,null,null,t)},I.matchesSelector=function(e,t){if(V(e),C&&!h[t+" "]&&(!d||!d.test(t)))try{var n=i.call(e,t);if(n||le.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){h(t,!0)}return 0<I(t,T,null,[e]).length},I.contains=function(e,t){return(e.ownerDocument||e)!=T&&V(e),ce.contains(e,t)},I.attr=function(e,t){(e.ownerDocument||e)!=T&&V(e);var n=b.attrHandle[t.toLowerCase()],r=n&&ue.call(b.attrHandle,t.toLowerCase())?n(e,t,!C):void 0;return void 0!==r?r:e.getAttribute(t)},I.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ce.uniqueSort=function(e){var t,n=[],r=0,i=0;if(a=!le.sortStable,o=!le.sortStable&&ae.call(e,0),de.call(e,l),a){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)he.call(e,n[r],1)}return o=null,e},ce.fn.uniqueSort=function(){return this.pushStack(ce.uniqueSort(ae.apply(this)))},(b=ce.expr={cacheLength:50,createPseudo:F,match:D,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(O,P),e[3]=(e[3]||e[4]||e[5]||"").replace(O,P),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||I.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&I.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return D.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&j.test(n)&&(t=Y(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(O,P).toLowerCase();return"*"===e?function(){return!0}:function(e){return fe(e,t)}},CLASS:function(e){var t=s[e+" "];return t||(t=new RegExp("(^|"+ge+")"+e+"("+ge+"|$)"))&&s(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=I.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace(v," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(d,e,t,h,g){var v="nth"!==d.slice(0,3),y="last"!==d.slice(-4),m="of-type"===e;return 1===h&&0===g?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u=v!==y?"nextSibling":"previousSibling",l=e.parentNode,c=m&&e.nodeName.toLowerCase(),f=!n&&!m,p=!1;if(l){if(v){while(u){o=e;while(o=o[u])if(m?fe(o,c):1===o.nodeType)return!1;s=u="only"===d&&!s&&"nextSibling"}return!0}if(s=[y?l.firstChild:l.lastChild],y&&f){p=(a=(r=(i=l[S]||(l[S]={}))[d]||[])[0]===E&&r[1])&&r[2],o=a&&l.childNodes[a];while(o=++a&&o&&o[u]||(p=a=0)||s.pop())if(1===o.nodeType&&++p&&o===e){i[d]=[E,a,p];break}}else if(f&&(p=a=(r=(i=e[S]||(e[S]={}))[d]||[])[0]===E&&r[1]),!1===p)while(o=++a&&o&&o[u]||(p=a=0)||s.pop())if((m?fe(o,c):1===o.nodeType)&&++p&&(f&&((i=o[S]||(o[S]={}))[d]=[E,p]),o===e))break;return(p-=g)===h||p%h==0&&0<=p/h}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||I.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?F(function(e,t){var n,r=a(e,o),i=r.length;while(i--)e[n=se.call(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:F(function(e){var r=[],i=[],s=ne(e.replace(ve,"$1"));return s[S]?F(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:F(function(t){return function(e){return 0<I(t,e).length}}),contains:F(function(t){return t=t.replace(O,P),function(e){return-1<(e.textContent||ce.text(e)).indexOf(t)}}),lang:F(function(n){return A.test(n||"")||I.error("unsupported lang: "+n),n=n.replace(O,P).toLowerCase(),function(e){var t;do{if(t=C?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=ie.location&&ie.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===r},focus:function(e){return e===function(){try{return T.activeElement}catch(e){}}()&&T.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:z(!1),disabled:z(!0),checked:function(e){return fe(e,"input")&&!!e.checked||fe(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return q.test(e.nodeName)},input:function(e){return N.test(e.nodeName)},button:function(e){return fe(e,"input")&&"button"===e.type||fe(e,"button")},text:function(e){var t;return fe(e,"input")&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:X(function(){return[0]}),last:X(function(e,t){return[t-1]}),eq:X(function(e,t,n){return[n<0?n+t:n]}),even:X(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:X(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:X(function(e,t,n){var r;for(r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:X(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=B(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=_(e);function G(){}function Y(e,t){var n,r,i,o,a,s,u,l=c[e+" "];if(l)return t?0:l.slice(0);a=e,s=[],u=b.preFilter;while(a){for(o in n&&!(r=y.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=m.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace(ve," ")}),a=a.slice(n.length)),b.filter)!(r=D[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?I.error(e):c(e,s).slice(0)}function Q(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function J(a,e,t){var s=e.dir,u=e.next,l=u||s,c=t&&"parentNode"===l,f=n++;return e.first?function(e,t,n){while(e=e[s])if(1===e.nodeType||c)return a(e,t,n);return!1}:function(e,t,n){var r,i,o=[E,f];if(n){while(e=e[s])if((1===e.nodeType||c)&&a(e,t,n))return!0}else while(e=e[s])if(1===e.nodeType||c)if(i=e[S]||(e[S]={}),u&&fe(e,u))e=e[s]||e;else{if((r=i[l])&&r[0]===E&&r[1]===f)return o[2]=r[2];if((i[l]=o)[2]=a(e,t,n))return!0}return!1}}function K(i){return 1<i.length?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Z(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function ee(d,h,g,v,y,e){return v&&!v[S]&&(v=ee(v)),y&&!y[S]&&(y=ee(y,e)),F(function(e,t,n,r){var i,o,a,s,u=[],l=[],c=t.length,f=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)I(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),p=!d||!e&&h?f:Z(f,u,d,n,r);if(g?g(p,s=y||(e?d:c||v)?[]:t,n,r):s=p,v){i=Z(s,l),v(i,[],n,r),o=i.length;while(o--)(a=i[o])&&(s[l[o]]=!(p[l[o]]=a))}if(e){if(y||d){if(y){i=[],o=s.length;while(o--)(a=s[o])&&i.push(p[o]=a);y(null,s=[],i,r)}o=s.length;while(o--)(a=s[o])&&-1<(i=y?se.call(e,a):u[o])&&(e[i]=!(t[i]=a))}}else s=Z(s===t?s.splice(c,s.length):s),y?y(null,t,s,r):k.apply(t,s)})}function te(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=J(function(e){return e===i},a,!0),l=J(function(e){return-1<se.call(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!=w)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[J(K(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[S]){for(n=++s;n<r;n++)if(b.relative[e[n].type])break;return ee(1<s&&K(c),1<s&&Q(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(ve,"$1"),t,s<n&&te(e.slice(s,n)),n<r&&te(e=e.slice(n)),n<r&&Q(e))}c.push(t)}return K(c)}function ne(e,t){var n,v,y,m,x,r,i=[],o=[],a=u[e+" "];if(!a){t||(t=Y(e)),n=t.length;while(n--)(a=te(t[n]))[S]?i.push(a):o.push(a);(a=u(e,(v=o,m=0<(y=i).length,x=0<v.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=E+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==T||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){a=0,t||o.ownerDocument==T||(V(o),n=!C);while(s=v[a++])if(s(o,t||T,n)){k.call(r,o);break}i&&(E=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){a=0;while(s=y[a++])s(c,f,t,n);if(e){if(0<u)while(l--)c[l]||f[l]||(f[l]=pe.call(r));f=Z(f)}k.apply(r,f),i&&!e&&0<f.length&&1<u+y.length&&ce.uniqueSort(r)}return i&&(E=h,w=p),c},m?F(r):r))).selector=e}return a}function re(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&Y(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&C&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(O,P),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=D.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],b.relative[s=a.type])break;if((u=b.find[s])&&(r=u(a.matches[0].replace(O,P),H.test(o[0].type)&&U(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&Q(o)))return k.apply(n,r),n;break}}}return(l||ne(e,c))(r,t,!C,n,!t||H.test(e)&&U(t.parentNode)||t),n}G.prototype=b.filters=b.pseudos,b.setFilters=new G,le.sortStable=S.split("").sort(l).join("")===S,V(),le.sortDetached=$(function(e){return 1&e.compareDocumentPosition(T.createElement("fieldset"))}),ce.find=I,ce.expr[":"]=ce.expr.pseudos,ce.unique=ce.uniqueSort,I.compile=ne,I.select=re,I.setDocument=V,I.tokenize=Y,I.escape=ce.escapeSelector,I.getText=ce.text,I.isXML=ce.isXMLDoc,I.selectors=ce.expr,I.support=ce.support,I.uniqueSort=ce.uniqueSort}();var d=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&ce(e).is(n))break;r.push(e)}return r},h=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},b=ce.expr.match.needsContext,w=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function T(e,n,r){return v(n)?ce.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?ce.grep(e,function(e){return e===n!==r}):"string"!=typeof n?ce.grep(e,function(e){return-1<se.call(n,e)!==r}):ce.filter(n,e,r)}ce.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?ce.find.matchesSelector(r,e)?[r]:[]:ce.find.matches(e,ce.grep(t,function(e){return 1===e.nodeType}))},ce.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(ce(e).filter(function(){for(t=0;t<r;t++)if(ce.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)ce.find(e,i[t],n);return 1<r?ce.uniqueSort(n):n},filter:function(e){return this.pushStack(T(this,e||[],!1))},not:function(e){return this.pushStack(T(this,e||[],!0))},is:function(e){return!!T(this,"string"==typeof e&&b.test(e)?ce(e):e||[],!1).length}});var k,S=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(ce.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||k,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:S.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof ce?t[0]:t,ce.merge(this,ce.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:C,!0)),w.test(r[1])&&ce.isPlainObject(t))for(r in t)v(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=C.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):v(e)?void 0!==n.ready?n.ready(e):e(ce):ce.makeArray(e,this)}).prototype=ce.fn,k=ce(C);var E=/^(?:parents|prev(?:Until|All))/,j={children:!0,contents:!0,next:!0,prev:!0};function A(e,t){while((e=e[t])&&1!==e.nodeType);return e}ce.fn.extend({has:function(e){var t=ce(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(ce.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&ce(e);if(!b.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&ce.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?ce.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?se.call(ce(e),this[0]):se.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(ce.uniqueSort(ce.merge(this.get(),ce(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ce.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return d(e,"parentNode")},parentsUntil:function(e,t,n){return d(e,"parentNode",n)},next:function(e){return A(e,"nextSibling")},prev:function(e){return A(e,"previousSibling")},nextAll:function(e){return d(e,"nextSibling")},prevAll:function(e){return d(e,"previousSibling")},nextUntil:function(e,t,n){return d(e,"nextSibling",n)},prevUntil:function(e,t,n){return d(e,"previousSibling",n)},siblings:function(e){return h((e.parentNode||{}).firstChild,e)},children:function(e){return h(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(fe(e,"template")&&(e=e.content||e),ce.merge([],e.childNodes))}},function(r,i){ce.fn[r]=function(e,t){var n=ce.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=ce.filter(t,n)),1<this.length&&(j[r]||ce.uniqueSort(n),E.test(r)&&n.reverse()),this.pushStack(n)}});var D=/[^\x20\t\r\n\f]+/g;function N(e){return e}function q(e){throw e}function L(e,t,n,r){var i;try{e&&v(i=e.promise)?i.call(e).done(t).fail(n):e&&v(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}ce.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},ce.each(e.match(D)||[],function(e,t){n[t]=!0}),n):ce.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1){t=u.shift();while(++l<s.length)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1)}r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){ce.each(e,function(e,t){v(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==x(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return ce.each(arguments,function(e,t){var n;while(-1<(n=ce.inArray(t,s,n)))s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<ce.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},ce.extend({Deferred:function(e){var o=[["notify","progress",ce.Callbacks("memory"),ce.Callbacks("memory"),2],["resolve","done",ce.Callbacks("once memory"),ce.Callbacks("once memory"),0,"resolved"],["reject","fail",ce.Callbacks("once memory"),ce.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},"catch":function(e){return a.then(null,e)},pipe:function(){var i=arguments;return ce.Deferred(function(r){ce.each(o,function(e,t){var n=v(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&v(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,v(t)?s?t.call(e,l(u,o,N,s),l(u,o,q,s)):(u++,t.call(e,l(u,o,N,s),l(u,o,q,s),l(u,o,N,o.notifyWith))):(a!==N&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){ce.Deferred.exceptionHook&&ce.Deferred.exceptionHook(e,t.error),u<=i+1&&(a!==q&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(ce.Deferred.getErrorHook?t.error=ce.Deferred.getErrorHook():ce.Deferred.getStackHook&&(t.error=ce.Deferred.getStackHook()),ie.setTimeout(t))}}return ce.Deferred(function(e){o[0][3].add(l(0,e,v(r)?r:N,e.notifyWith)),o[1][3].add(l(0,e,v(t)?t:N)),o[2][3].add(l(0,e,v(n)?n:q))}).promise()},promise:function(e){return null!=e?ce.extend(e,a):a}},s={};return ce.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=ae.call(arguments),o=ce.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?ae.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(L(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||v(i[t]&&i[t].then)))return o.then();while(t--)L(i[t],a(t),o.reject);return o.promise()}});var H=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;ce.Deferred.exceptionHook=function(e,t){ie.console&&ie.console.warn&&e&&H.test(e.name)&&ie.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},ce.readyException=function(e){ie.setTimeout(function(){throw e})};var O=ce.Deferred();function P(){C.removeEventListener("DOMContentLoaded",P),ie.removeEventListener("load",P),ce.ready()}ce.fn.ready=function(e){return O.then(e)["catch"](function(e){ce.readyException(e)}),this},ce.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--ce.readyWait:ce.isReady)||(ce.isReady=!0)!==e&&0<--ce.readyWait||O.resolveWith(C,[ce])}}),ce.ready.then=O.then,"complete"===C.readyState||"loading"!==C.readyState&&!C.documentElement.doScroll?ie.setTimeout(ce.ready):(C.addEventListener("DOMContentLoaded",P),ie.addEventListener("load",P));var M=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===x(n))for(s in i=!0,n)M(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,v(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(ce(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},R=/^-ms-/,I=/-([a-z])/g;function W(e,t){return t.toUpperCase()}function F(e){return e.replace(R,"ms-").replace(I,W)}var $=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function B(){this.expando=ce.expando+B.uid++}B.uid=1,B.prototype={cache:function(e){var t=e[this.expando];return t||(t={},$(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[F(t)]=n;else for(r in t)i[F(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][F(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(F):(t=F(t))in r?[t]:t.match(D)||[]).length;while(n--)delete r[t[n]]}(void 0===t||ce.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!ce.isEmptyObject(t)}};var _=new B,z=new B,X=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,U=/[A-Z]/g;function V(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(U,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:X.test(i)?JSON.parse(i):i)}catch(e){}z.set(e,t,n)}else n=void 0;return n}ce.extend({hasData:function(e){return z.hasData(e)||_.hasData(e)},data:function(e,t,n){return z.access(e,t,n)},removeData:function(e,t){z.remove(e,t)},_data:function(e,t,n){return _.access(e,t,n)},_removeData:function(e,t){_.remove(e,t)}}),ce.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=z.get(o),1===o.nodeType&&!_.get(o,"hasDataAttrs"))){t=a.length;while(t--)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=F(r.slice(5)),V(o,r,i[r]));_.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each(function(){z.set(this,n)}):M(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=z.get(o,n))?t:void 0!==(t=V(o,n))?t:void 0;this.each(function(){z.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){z.remove(this,e)})}}),ce.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=_.get(e,t),n&&(!r||Array.isArray(n)?r=_.access(e,t,ce.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=ce.queue(e,t),r=n.length,i=n.shift(),o=ce._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){ce.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return _.get(e,n)||_.access(e,n,{empty:ce.Callbacks("once memory").add(function(){_.remove(e,[t+"queue",n])})})}}),ce.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?ce.queue(this[0],t):void 0===n?this:this.each(function(){var e=ce.queue(this,t,n);ce._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&ce.dequeue(this,t)})},dequeue:function(e){return this.each(function(){ce.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=ce.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=_.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var G=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Y=new RegExp("^(?:([+-])=|)("+G+")([a-z%]*)$","i"),Q=["Top","Right","Bottom","Left"],J=C.documentElement,K=function(e){return ce.contains(e.ownerDocument,e)},Z={composed:!0};J.getRootNode&&(K=function(e){return ce.contains(e.ownerDocument,e)||e.getRootNode(Z)===e.ownerDocument});var ee=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&K(e)&&"none"===ce.css(e,"display")};function te(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return ce.css(e,t,"")},u=s(),l=n&&n[3]||(ce.cssNumber[t]?"":"px"),c=e.nodeType&&(ce.cssNumber[t]||"px"!==l&&+u)&&Y.exec(ce.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)ce.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,ce.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ne={};function re(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=_.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&ee(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ne[s])||(o=a.body.appendChild(a.createElement(s)),u=ce.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ne[s]=u)))):"none"!==n&&(l[c]="none",_.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}ce.fn.extend({show:function(){return re(this,!0)},hide:function(){return re(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ee(this)?ce(this).show():ce(this).hide()})}});var xe,be,we=/^(?:checkbox|radio)$/i,Te=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Ce=/^$|^module$|\/(?:java|ecma)script/i;xe=C.createDocumentFragment().appendChild(C.createElement("div")),(be=C.createElement("input")).setAttribute("type","radio"),be.setAttribute("checked","checked"),be.setAttribute("name","t"),xe.appendChild(be),le.checkClone=xe.cloneNode(!0).cloneNode(!0).lastChild.checked,xe.innerHTML="<textarea>x</textarea>",le.noCloneChecked=!!xe.cloneNode(!0).lastChild.defaultValue,xe.innerHTML="<option></option>",le.option=!!xe.lastChild;var ke={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Se(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&fe(e,t)?ce.merge([e],n):n}function Ee(e,t){for(var n=0,r=e.length;n<r;n++)_.set(e[n],"globalEval",!t||_.get(t[n],"globalEval"))}ke.tbody=ke.tfoot=ke.colgroup=ke.caption=ke.thead,ke.th=ke.td,le.option||(ke.optgroup=ke.option=[1,"<select multiple='multiple'>","</select>"]);var je=/<|&#?\w+;/;function Ae(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===x(o))ce.merge(p,o.nodeType?[o]:o);else if(je.test(o)){a=a||f.appendChild(t.createElement("div")),s=(Te.exec(o)||["",""])[1].toLowerCase(),u=ke[s]||ke._default,a.innerHTML=u[1]+ce.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;ce.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&-1<ce.inArray(o,r))i&&i.push(o);else if(l=K(o),a=Se(f.appendChild(o),"script"),l&&Ee(a),n){c=0;while(o=a[c++])Ce.test(o.type||"")&&n.push(o)}return f}var De=/^([^.]*)(?:\.(.+)|)/;function Ne(){return!0}function qe(){return!1}function Le(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Le(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=qe;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return ce().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=ce.guid++)),e.each(function(){ce.event.add(this,t,i,r,n)})}function He(e,r,t){t?(_.set(e,r,!1),ce.event.add(e,r,{namespace:!1,handler:function(e){var t,n=_.get(this,r);if(1&e.isTrigger&&this[r]){if(n)(ce.event.special[r]||{}).delegateType&&e.stopPropagation();else if(n=ae.call(arguments),_.set(this,r,n),this[r](),t=_.get(this,r),_.set(this,r,!1),n!==t)return e.stopImmediatePropagation(),e.preventDefault(),t}else n&&(_.set(this,r,ce.event.trigger(n[0],n.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=Ne)}})):void 0===_.get(e,r)&&ce.event.add(e,r,Ne)}ce.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=_.get(t);if($(t)){n.handler&&(n=(o=n).handler,i=o.selector),i&&ce.find.matchesSelector(J,i),n.guid||(n.guid=ce.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(e){return"undefined"!=typeof ce&&ce.event.triggered!==e.type?ce.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(D)||[""]).length;while(l--)d=g=(s=De.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=ce.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=ce.event.special[d]||{},c=ce.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&ce.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),ce.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=_.hasData(e)&&_.get(e);if(v&&(u=v.events)){l=(t=(t||"").match(D)||[""]).length;while(l--)if(d=g=(s=De.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){f=ce.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||ce.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)ce.event.remove(e,d+t[l],n,r,!0);ce.isEmptyObject(u)&&_.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=ce.event.fix(e),l=(_.get(this,"events")||Object.create(null))[u.type]||[],c=ce.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){a=ce.event.handlers.call(this,u,l),t=0;while((i=a[t++])&&!u.isPropagationStopped()){u.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!u.isImmediatePropagationStopped())u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((ce.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<ce(i,this).index(l):ce.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(ce.Event.prototype,t,{enumerable:!0,configurable:!0,get:v(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[ce.expando]?e:new ce.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return we.test(t.type)&&t.click&&fe(t,"input")&&He(t,"click",!0),!1},trigger:function(e){var t=this||e;return we.test(t.type)&&t.click&&fe(t,"input")&&He(t,"click"),!0},_default:function(e){var t=e.target;return we.test(t.type)&&t.click&&fe(t,"input")&&_.get(t,"click")||fe(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},ce.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},ce.Event=function(e,t){if(!(this instanceof ce.Event))return new ce.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Ne:qe,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&ce.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[ce.expando]=!0},ce.Event.prototype={constructor:ce.Event,isDefaultPrevented:qe,isPropagationStopped:qe,isImmediatePropagationStopped:qe,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ne,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ne,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ne,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},ce.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},ce.event.addProp),ce.each({focus:"focusin",blur:"focusout"},function(r,i){function o(e){if(C.documentMode){var t=_.get(this,"handle"),n=ce.event.fix(e);n.type="focusin"===e.type?"focus":"blur",n.isSimulated=!0,t(e),n.target===n.currentTarget&&t(n)}else ce.event.simulate(i,e.target,ce.event.fix(e))}ce.event.special[r]={setup:function(){var e;if(He(this,r,!0),!C.documentMode)return!1;(e=_.get(this,i))||this.addEventListener(i,o),_.set(this,i,(e||0)+1)},trigger:function(){return He(this,r),!0},teardown:function(){var e;if(!C.documentMode)return!1;(e=_.get(this,i)-1)?_.set(this,i,e):(this.removeEventListener(i,o),_.remove(this,i))},_default:function(e){return _.get(e.target,r)},delegateType:i},ce.event.special[i]={setup:function(){var e=this.ownerDocument||this.document||this,t=C.documentMode?this:e,n=_.get(t,i);n||(C.documentMode?this.addEventListener(i,o):e.addEventListener(r,o,!0)),_.set(t,i,(n||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=C.documentMode?this:e,n=_.get(t,i)-1;n?_.set(t,i,n):(C.documentMode?this.removeEventListener(i,o):e.removeEventListener(r,o,!0),_.remove(t,i))}}}),ce.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){ce.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||ce.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),ce.fn.extend({on:function(e,t,n,r){return Le(this,e,t,n,r)},one:function(e,t,n,r){return Le(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,ce(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=qe),this.each(function(){ce.event.remove(this,e,n,t)})}});var Oe=/<script|<style|<link/i,Pe=/checked\s*(?:[^=]|=\s*.checked.)/i,Me=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Re(e,t){return fe(e,"table")&&fe(11!==t.nodeType?t:t.firstChild,"tr")&&ce(e).children("tbody")[0]||e}function Ie(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function We(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Fe(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(_.hasData(e)&&(s=_.get(e).events))for(i in _.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)ce.event.add(t,i,s[i][n]);z.hasData(e)&&(o=z.access(e),a=ce.extend({},o),z.set(t,a))}}function $e(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=v(d);if(h||1<f&&"string"==typeof d&&!le.checkClone&&Pe.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),$e(t,r,i,o)});if(f&&(t=(e=Ae(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=ce.map(Se(e,"script"),Ie)).length;c<f;c++)u=e,c!==p&&(u=ce.clone(u,!0,!0),s&&ce.merge(a,Se(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,ce.map(a,We),c=0;c<s;c++)u=a[c],Ce.test(u.type||"")&&!_.access(u,"globalEval")&&ce.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?ce._evalUrl&&!u.noModule&&ce._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):m(u.textContent.replace(Me,""),u,l))}return n}function Be(e,t,n){for(var r,i=t?ce.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||ce.cleanData(Se(r)),r.parentNode&&(n&&K(r)&&Ee(Se(r,"script")),r.parentNode.removeChild(r));return e}ce.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=K(e);if(!(le.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ce.isXMLDoc(e)))for(a=Se(c),r=0,i=(o=Se(e)).length;r<i;r++)s=o[r],u=a[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&we.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||Se(e),a=a||Se(c),r=0,i=o.length;r<i;r++)Fe(o[r],a[r]);else Fe(e,c);return 0<(a=Se(c,"script")).length&&Ee(a,!f&&Se(e,"script")),c},cleanData:function(e){for(var t,n,r,i=ce.event.special,o=0;void 0!==(n=e[o]);o++)if($(n)){if(t=n[_.expando]){if(t.events)for(r in t.events)i[r]?ce.event.remove(n,r):ce.removeEvent(n,r,t.handle);n[_.expando]=void 0}n[z.expando]&&(n[z.expando]=void 0)}}}),ce.fn.extend({detach:function(e){return Be(this,e,!0)},remove:function(e){return Be(this,e)},text:function(e){return M(this,function(e){return void 0===e?ce.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return $e(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Re(this,e).appendChild(e)})},prepend:function(){return $e(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Re(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return $e(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return $e(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(ce.cleanData(Se(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return ce.clone(this,e,t)})},html:function(e){return M(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Oe.test(e)&&!ke[(Te.exec(e)||["",""])[1].toLowerCase()]){e=ce.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(ce.cleanData(Se(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return $e(this,arguments,function(e){var t=this.parentNode;ce.inArray(this,n)<0&&(ce.cleanData(Se(this)),t&&t.replaceChild(e,this))},n)}}),ce.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){ce.fn[e]=function(e){for(var t,n=[],r=ce(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),ce(r[o])[a](t),s.apply(n,t.get());return this.pushStack(n)}});var _e=new RegExp("^("+G+")(?!px)[a-z%]+$","i"),ze=/^--/,Xe=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=ie),t.getComputedStyle(e)},Ue=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Ve=new RegExp(Q.join("|"),"i");function Ge(e,t,n){var r,i,o,a,s=ze.test(t),u=e.style;return(n=n||Xe(e))&&(a=n.getPropertyValue(t)||n[t],s&&a&&(a=a.replace(ve,"$1")||void 0),""!==a||K(e)||(a=ce.style(e,t)),!le.pixelBoxStyles()&&_e.test(a)&&Ve.test(t)&&(r=u.width,i=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=a,a=n.width,u.width=r,u.minWidth=i,u.maxWidth=o)),void 0!==a?a+"":a}function Ye(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",J.appendChild(u).appendChild(l);var e=ie.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),J.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,r,i,o,a,s,u=C.createElement("div"),l=C.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",le.clearCloneStyle="content-box"===l.style.backgroundClip,ce.extend(le,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=C.createElement("table"),t=C.createElement("tr"),n=C.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="box-sizing:content-box;border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",J.appendChild(e).appendChild(t).appendChild(n),r=ie.getComputedStyle(t),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,J.removeChild(e)),a}}))}();var Qe=["Webkit","Moz","ms"],Je=C.createElement("div").style,Ke={};function Ze(e){var t=ce.cssProps[e]||Ke[e];return t||(e in Je?e:Ke[e]=function(e){var t=e[0].toUpperCase()+e.slice(1),n=Qe.length;while(n--)if((e=Qe[n]+t)in Je)return e}(e)||e)}var et=/^(none|table(?!-c[ea]).+)/,tt={position:"absolute",visibility:"hidden",display:"block"},nt={letterSpacing:"0",fontWeight:"400"};function rt(e,t,n){var r=Y.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function it(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0,l=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(l+=ce.css(e,n+Q[a],!0,i)),r?("content"===n&&(u-=ce.css(e,"padding"+Q[a],!0,i)),"margin"!==n&&(u-=ce.css(e,"border"+Q[a]+"Width",!0,i))):(u+=ce.css(e,"padding"+Q[a],!0,i),"padding"!==n?u+=ce.css(e,"border"+Q[a]+"Width",!0,i):s+=ce.css(e,"border"+Q[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u+l}function ot(e,t,n){var r=Xe(e),i=(!le.boxSizingReliable()||n)&&"border-box"===ce.css(e,"boxSizing",!1,r),o=i,a=Ge(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(_e.test(a)){if(!n)return a;a="auto"}return(!le.boxSizingReliable()&&i||!le.reliableTrDimensions()&&fe(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===ce.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===ce.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+it(e,t,n||(i?"border":"content"),o,r,a)+"px"}function at(e,t,n,r,i){return new at.prototype.init(e,t,n,r,i)}ce.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ge(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=F(t),u=ze.test(t),l=e.style;if(u||(t=Ze(s)),a=ce.cssHooks[t]||ce.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=Y.exec(n))&&i[1]&&(n=te(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(ce.cssNumber[s]?"":"px")),le.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=F(t);return ze.test(t)||(t=Ze(s)),(a=ce.cssHooks[t]||ce.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Ge(e,t,r)),"normal"===i&&t in nt&&(i=nt[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),ce.each(["height","width"],function(e,u){ce.cssHooks[u]={get:function(e,t,n){if(t)return!et.test(ce.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?ot(e,u,n):Ue(e,tt,function(){return ot(e,u,n)})},set:function(e,t,n){var r,i=Xe(e),o=!le.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===ce.css(e,"boxSizing",!1,i),s=n?it(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-it(e,u,"border",!1,i)-.5)),s&&(r=Y.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=ce.css(e,u)),rt(0,t,s)}}}),ce.cssHooks.marginLeft=Ye(le.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Ge(e,"marginLeft"))||e.getBoundingClientRect().left-Ue(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),ce.each({margin:"",padding:"",border:"Width"},function(i,o){ce.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+Q[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(ce.cssHooks[i+o].set=rt)}),ce.fn.extend({css:function(e,t){return M(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Xe(e),i=t.length;a<i;a++)o[t[a]]=ce.css(e,t[a],!1,r);return o}return void 0!==n?ce.style(e,t,n):ce.css(e,t)},e,t,1<arguments.length)}}),((ce.Tween=at).prototype={constructor:at,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||ce.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(ce.cssNumber[n]?"":"px")},cur:function(){var e=at.propHooks[this.prop];return e&&e.get?e.get(this):at.propHooks._default.get(this)},run:function(e){var t,n=at.propHooks[this.prop];return this.options.duration?this.pos=t=ce.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):at.propHooks._default.set(this),this}}).init.prototype=at.prototype,(at.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=ce.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){ce.fx.step[e.prop]?ce.fx.step[e.prop](e):1!==e.elem.nodeType||!ce.cssHooks[e.prop]&&null==e.elem.style[Ze(e.prop)]?e.elem[e.prop]=e.now:ce.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=at.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ce.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},ce.fx=at.prototype.init,ce.fx.step={};var st,ut,lt,ct,ft=/^(?:toggle|show|hide)$/,pt=/queueHooks$/;function dt(){ut&&(!1===C.hidden&&ie.requestAnimationFrame?ie.requestAnimationFrame(dt):ie.setTimeout(dt,ce.fx.interval),ce.fx.tick())}function ht(){return ie.setTimeout(function(){st=void 0}),st=Date.now()}function gt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=Q[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function vt(e,t,n){for(var r,i=(yt.tweeners[t]||[]).concat(yt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function yt(o,e,t){var n,a,r=0,i=yt.prefilters.length,s=ce.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=st||ht(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:ce.extend({},e),opts:ce.extend(!0,{specialEasing:{},easing:ce.easing._default},t),originalProperties:e,originalOptions:t,startTime:st||ht(),duration:t.duration,tweens:[],createTween:function(e,t){var n=ce.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=F(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=ce.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=yt.prefilters[r].call(l,o,c,l.opts))return v(n.stop)&&(ce._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return ce.map(c,vt,l),v(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),ce.fx.timer(ce.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}ce.Animation=ce.extend(yt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return te(n.elem,e,Y.exec(t),n),n}]},tweener:function(e,t){v(e)?(t=e,e=["*"]):e=e.match(D);for(var n,r=0,i=e.length;r<i;r++)n=e[r],yt.tweeners[n]=yt.tweeners[n]||[],yt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ee(e),v=_.get(e,"fxshow");for(r in n.queue||(null==(a=ce._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,ce.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],ft.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||ce.style(e,r)}if((u=!ce.isEmptyObject(t))||!ce.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=_.get(e,"display")),"none"===(c=ce.css(e,"display"))&&(l?c=l:(re([e],!0),l=e.style.display||l,c=ce.css(e,"display"),re([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===ce.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=_.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&re([e],!0),p.done(function(){for(r in g||re([e]),_.remove(e,"fxshow"),d)ce.style(e,r,d[r])})),u=vt(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?yt.prefilters.unshift(e):yt.prefilters.push(e)}}),ce.speed=function(e,t,n){var r=e&&"object"==typeof e?ce.extend({},e):{complete:n||!n&&t||v(e)&&e,duration:e,easing:n&&t||t&&!v(t)&&t};return ce.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in ce.fx.speeds?r.duration=ce.fx.speeds[r.duration]:r.duration=ce.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){v(r.old)&&r.old.call(this),r.queue&&ce.dequeue(this,r.queue)},r},ce.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ee).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=ce.isEmptyObject(t),o=ce.speed(e,n,r),a=function(){var e=yt(this,ce.extend({},t),o);(i||_.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=ce.timers,r=_.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&pt.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||ce.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=_.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=ce.timers,o=n?n.length:0;for(t.finish=!0,ce.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),ce.each(["toggle","show","hide"],function(e,r){var i=ce.fn[r];ce.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(gt(r,!0),e,t,n)}}),ce.each({slideDown:gt("show"),slideUp:gt("hide"),slideToggle:gt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){ce.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),ce.timers=[],ce.fx.tick=function(){var e,t=0,n=ce.timers;for(st=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||ce.fx.stop(),st=void 0},ce.fx.timer=function(e){ce.timers.push(e),ce.fx.start()},ce.fx.interval=13,ce.fx.start=function(){ut||(ut=!0,dt())},ce.fx.stop=function(){ut=null},ce.fx.speeds={slow:600,fast:200,_default:400},ce.fn.delay=function(r,e){return r=ce.fx&&ce.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=ie.setTimeout(e,r);t.stop=function(){ie.clearTimeout(n)}})},lt=C.createElement("input"),ct=C.createElement("select").appendChild(C.createElement("option")),lt.type="checkbox",le.checkOn=""!==lt.value,le.optSelected=ct.selected,(lt=C.createElement("input")).value="t",lt.type="radio",le.radioValue="t"===lt.value;var mt,xt=ce.expr.attrHandle;ce.fn.extend({attr:function(e,t){return M(this,ce.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){ce.removeAttr(this,e)})}}),ce.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?ce.prop(e,t,n):(1===o&&ce.isXMLDoc(e)||(i=ce.attrHooks[t.toLowerCase()]||(ce.expr.match.bool.test(t)?mt:void 0)),void 0!==n?null===n?void ce.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=ce.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!le.radioValue&&"radio"===t&&fe(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(D);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),mt={set:function(e,t,n){return!1===t?ce.removeAttr(e,n):e.setAttribute(n,n),n}},ce.each(ce.expr.match.bool.source.match(/\w+/g),function(e,t){var a=xt[t]||ce.find.attr;xt[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=xt[o],xt[o]=r,r=null!=a(e,t,n)?o:null,xt[o]=i),r}});var bt=/^(?:input|select|textarea|button)$/i,wt=/^(?:a|area)$/i;function Tt(e){return(e.match(D)||[]).join(" ")}function Ct(e){return e.getAttribute&&e.getAttribute("class")||""}function kt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(D)||[]}ce.fn.extend({prop:function(e,t){return M(this,ce.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[ce.propFix[e]||e]})}}),ce.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&ce.isXMLDoc(e)||(t=ce.propFix[t]||t,i=ce.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=ce.find.attr(e,"tabindex");return t?parseInt(t,10):bt.test(e.nodeName)||wt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),le.optSelected||(ce.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),ce.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ce.propFix[this.toLowerCase()]=this}),ce.fn.extend({addClass:function(t){var e,n,r,i,o,a;return v(t)?this.each(function(e){ce(this).addClass(t.call(this,e,Ct(this)))}):(e=kt(t)).length?this.each(function(){if(r=Ct(this),n=1===this.nodeType&&" "+Tt(r)+" "){for(o=0;o<e.length;o++)i=e[o],n.indexOf(" "+i+" ")<0&&(n+=i+" ");a=Tt(n),r!==a&&this.setAttribute("class",a)}}):this},removeClass:function(t){var e,n,r,i,o,a;return v(t)?this.each(function(e){ce(this).removeClass(t.call(this,e,Ct(this)))}):arguments.length?(e=kt(t)).length?this.each(function(){if(r=Ct(this),n=1===this.nodeType&&" "+Tt(r)+" "){for(o=0;o<e.length;o++){i=e[o];while(-1<n.indexOf(" "+i+" "))n=n.replace(" "+i+" "," ")}a=Tt(n),r!==a&&this.setAttribute("class",a)}}):this:this.attr("class","")},toggleClass:function(t,n){var e,r,i,o,a=typeof t,s="string"===a||Array.isArray(t);return v(t)?this.each(function(e){ce(this).toggleClass(t.call(this,e,Ct(this),n),n)}):"boolean"==typeof n&&s?n?this.addClass(t):this.removeClass(t):(e=kt(t),this.each(function(){if(s)for(o=ce(this),i=0;i<e.length;i++)r=e[i],o.hasClass(r)?o.removeClass(r):o.addClass(r);else void 0!==t&&"boolean"!==a||((r=Ct(this))&&_.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",r||!1===t?"":_.get(this,"__className__")||""))}))},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&-1<(" "+Tt(Ct(n))+" ").indexOf(t))return!0;return!1}});var St=/\r/g;ce.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=v(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,ce(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=ce.map(t,function(e){return null==e?"":e+""})),(r=ce.valHooks[this.type]||ce.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))})):t?(r=ce.valHooks[t.type]||ce.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(St,""):null==e?"":e:void 0}}),ce.extend({valHooks:{option:{get:function(e){var t=ce.find.attr(e,"value");return null!=t?t:Tt(ce.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!fe(n.parentNode,"optgroup"))){if(t=ce(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=ce.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=-1<ce.inArray(ce.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),ce.each(["radio","checkbox"],function(){ce.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<ce.inArray(ce(e).val(),t)}},le.checkOn||(ce.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Et=ie.location,jt={guid:Date.now()},At=/\?/;ce.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new ie.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||ce.error("Invalid XML: "+(n?ce.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t};var Dt=/^(?:focusinfocus|focusoutblur)$/,Nt=function(e){e.stopPropagation()};ce.extend(ce.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||C],d=ue.call(e,"type")?e.type:e,h=ue.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||C,3!==n.nodeType&&8!==n.nodeType&&!Dt.test(d+ce.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+d,(e=e[ce.expando]?e:new ce.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:ce.makeArray(t,[e]),c=ce.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!y(n)){for(s=c.delegateType||d,Dt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||C)&&p.push(a.defaultView||a.parentWindow||ie)}i=0;while((o=p[i++])&&!e.isPropagationStopped())f=o,e.type=1<i?s:c.bindType||d,(l=(_.get(o,"events")||Object.create(null))[e.type]&&_.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&$(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!$(n)||u&&v(n[d])&&!y(n)&&((a=n[u])&&(n[u]=null),ce.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,Nt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,Nt),ce.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=ce.extend(new ce.Event,n,{type:e,isSimulated:!0});ce.event.trigger(r,null,t)}}),ce.fn.extend({trigger:function(e,t){return this.each(function(){ce.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return ce.event.trigger(e,t,n,!0)}});var qt=/\[\]$/,Lt=/\r?\n/g,Ht=/^(?:submit|button|image|reset|file)$/i,Ot=/^(?:input|select|textarea|keygen)/i;function Pt(n,e,r,i){var t;if(Array.isArray(e))ce.each(e,function(e,t){r||qt.test(n)?i(n,t):Pt(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==x(e))i(n,e);else for(t in e)Pt(n+"["+t+"]",e[t],r,i)}ce.param=function(e,t){var n,r=[],i=function(e,t){var n=v(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!ce.isPlainObject(e))ce.each(e,function(){i(this.name,this.value)});else for(n in e)Pt(n,e[n],t,i);return r.join("&")},ce.fn.extend({serialize:function(){return ce.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ce.prop(this,"elements");return e?ce.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ce(this).is(":disabled")&&Ot.test(this.nodeName)&&!Ht.test(e)&&(this.checked||!we.test(e))}).map(function(e,t){var n=ce(this).val();return null==n?null:Array.isArray(n)?ce.map(n,function(e){return{name:t.name,value:e.replace(Lt,"\r\n")}}):{name:t.name,value:n.replace(Lt,"\r\n")}}).get()}});var Mt=/%20/g,Rt=/#.*$/,It=/([?&])_=[^&]*/,Wt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ft=/^(?:GET|HEAD)$/,$t=/^\/\//,Bt={},_t={},zt="*/".concat("*"),Xt=C.createElement("a");function Ut(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(D)||[];if(v(t))while(n=i[r++])"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Vt(t,i,o,a){var s={},u=t===_t;function l(e){var r;return s[e]=!0,ce.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function Gt(e,t){var n,r,i=ce.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&ce.extend(!0,e,r),e}Xt.href=Et.href,ce.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Et.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Et.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":zt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":ce.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Gt(Gt(e,ce.ajaxSettings),t):Gt(ce.ajaxSettings,e)},ajaxPrefilter:Ut(Bt),ajaxTransport:Ut(_t),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,v=ce.ajaxSetup({},t),y=v.context||v,m=v.context&&(y.nodeType||y.jquery)?ce(y):ce.event,x=ce.Deferred(),b=ce.Callbacks("once memory"),w=v.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n){n={};while(t=Wt.exec(p))n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(v.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),v.url=((e||v.url||Et.href)+"").replace($t,Et.protocol+"//"),v.type=t.method||t.type||v.method||v.type,v.dataTypes=(v.dataType||"*").toLowerCase().match(D)||[""],null==v.crossDomain){r=C.createElement("a");try{r.href=v.url,r.href=r.href,v.crossDomain=Xt.protocol+"//"+Xt.host!=r.protocol+"//"+r.host}catch(e){v.crossDomain=!0}}if(v.data&&v.processData&&"string"!=typeof v.data&&(v.data=ce.param(v.data,v.traditional)),Vt(Bt,v,t,T),h)return T;for(i in(g=ce.event&&v.global)&&0==ce.active++&&ce.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Ft.test(v.type),f=v.url.replace(Rt,""),v.hasContent?v.data&&v.processData&&0===(v.contentType||"").indexOf("application/x-www-form-urlencoded")&&(v.data=v.data.replace(Mt,"+")):(o=v.url.slice(f.length),v.data&&(v.processData||"string"==typeof v.data)&&(f+=(At.test(f)?"&":"?")+v.data,delete v.data),!1===v.cache&&(f=f.replace(It,"$1"),o=(At.test(f)?"&":"?")+"_="+jt.guid+++o),v.url=f+o),v.ifModified&&(ce.lastModified[f]&&T.setRequestHeader("If-Modified-Since",ce.lastModified[f]),ce.etag[f]&&T.setRequestHeader("If-None-Match",ce.etag[f])),(v.data&&v.hasContent&&!1!==v.contentType||t.contentType)&&T.setRequestHeader("Content-Type",v.contentType),T.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+zt+"; q=0.01":""):v.accepts["*"]),v.headers)T.setRequestHeader(i,v.headers[i]);if(v.beforeSend&&(!1===v.beforeSend.call(y,T,v)||h))return T.abort();if(u="abort",b.add(v.complete),T.done(v.success),T.fail(v.error),c=Vt(_t,v,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,v]),h)return T;v.async&&0<v.timeout&&(d=ie.setTimeout(function(){T.abort("timeout")},v.timeout));try{h=!1,c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&ie.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(v,T,n)),!i&&-1<ce.inArray("script",v.dataTypes)&&ce.inArray("json",v.dataTypes)<0&&(v.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(v,s,T,i),i?(v.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(ce.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(ce.etag[f]=u)),204===e||"HEAD"===v.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(y,[o,l,T]):x.rejectWith(y,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,v,i?o:a]),b.fireWith(y,[T,l]),g&&(m.trigger("ajaxComplete",[T,v]),--ce.active||ce.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return ce.get(e,t,n,"json")},getScript:function(e,t){return ce.get(e,void 0,t,"script")}}),ce.each(["get","post"],function(e,i){ce[i]=function(e,t,n,r){return v(t)&&(r=r||n,n=t,t=void 0),ce.ajax(ce.extend({url:e,type:i,dataType:r,data:t,success:n},ce.isPlainObject(e)&&e))}}),ce.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),ce._evalUrl=function(e,t,n){return ce.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){ce.globalEval(e,t,n)}})},ce.fn.extend({wrapAll:function(e){var t;return this[0]&&(v(e)&&(e=e.call(this[0])),t=ce(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return v(n)?this.each(function(e){ce(this).wrapInner(n.call(this,e))}):this.each(function(){var e=ce(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=v(t);return this.each(function(e){ce(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){ce(this).replaceWith(this.childNodes)}),this}}),ce.expr.pseudos.hidden=function(e){return!ce.expr.pseudos.visible(e)},ce.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},ce.ajaxSettings.xhr=function(){try{return new ie.XMLHttpRequest}catch(e){}};var Yt={0:200,1223:204},Qt=ce.ajaxSettings.xhr();le.cors=!!Qt&&"withCredentials"in Qt,le.ajax=Qt=!!Qt,ce.ajaxTransport(function(i){var o,a;if(le.cors||Qt&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(Yt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&ie.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),ce.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),ce.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return ce.globalEval(e),e}}}),ce.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),ce.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=ce("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),C.head.appendChild(r[0])},abort:function(){i&&i()}}});var Jt,Kt=[],Zt=/(=)\?(?=&|$)|\?\?/;ce.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Kt.pop()||ce.expando+"_"+jt.guid++;return this[e]=!0,e}}),ce.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Zt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Zt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=v(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Zt,"$1"+r):!1!==e.jsonp&&(e.url+=(At.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||ce.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=ie[r],ie[r]=function(){o=arguments},n.always(function(){void 0===i?ce(ie).removeProp(r):ie[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,Kt.push(r)),o&&v(i)&&i(o[0]),o=i=void 0}),"script"}),le.createHTMLDocument=((Jt=C.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Jt.childNodes.length),ce.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(le.createHTMLDocument?((r=(t=C.implementation.createHTMLDocument("")).createElement("base")).href=C.location.href,t.head.appendChild(r)):t=C),o=!n&&[],(i=w.exec(e))?[t.createElement(i[1])]:(i=Ae([e],t,o),o&&o.length&&ce(o).remove(),ce.merge([],i.childNodes)));var r,i,o},ce.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=Tt(e.slice(s)),e=e.slice(0,s)),v(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&ce.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?ce("<div>").append(ce.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},ce.expr.pseudos.animated=function(t){return ce.grep(ce.timers,function(e){return t===e.elem}).length},ce.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=ce.css(e,"position"),c=ce(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=ce.css(e,"top"),u=ce.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),v(t)&&(t=t.call(e,n,ce.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},ce.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){ce.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===ce.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===ce.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=ce(e).offset()).top+=ce.css(e,"borderTopWidth",!0),i.left+=ce.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-ce.css(r,"marginTop",!0),left:t.left-i.left-ce.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===ce.css(e,"position"))e=e.offsetParent;return e||J})}}),ce.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;ce.fn[t]=function(e){return M(this,function(e,t,n){var r;if(y(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),ce.each(["top","left"],function(e,n){ce.cssHooks[n]=Ye(le.pixelPosition,function(e,t){if(t)return t=Ge(e,n),_e.test(t)?ce(e).position()[n]+"px":t})}),ce.each({Height:"height",Width:"width"},function(a,s){ce.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){ce.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return M(this,function(e,t,n){var r;return y(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?ce.css(e,t,i):ce.style(e,t,n,i)},s,n?e:void 0,n)}})}),ce.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ce.fn[t]=function(e){return this.on(t,e)}}),ce.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),ce.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){ce.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var en=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;ce.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),v(e))return r=ae.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(ae.call(arguments)))}).guid=e.guid=e.guid||ce.guid++,i},ce.holdReady=function(e){e?ce.readyWait++:ce.ready(!0)},ce.isArray=Array.isArray,ce.parseJSON=JSON.parse,ce.nodeName=fe,ce.isFunction=v,ce.isWindow=y,ce.camelCase=F,ce.type=x,ce.now=Date.now,ce.isNumeric=function(e){var t=ce.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},ce.trim=function(e){return null==e?"":(e+"").replace(en,"$1")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return ce});var tn=ie.jQuery,nn=ie.$;return ce.noConflict=function(e){return ie.$===ce&&(ie.$=nn),e&&ie.jQuery===ce&&(ie.jQuery=tn),ce},"undefined"==typeof e&&(ie.jQuery=ie.$=ce),ce});
"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function ownKeys(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var n,r,a,o,i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return r=!(n=!0),{s:function(){i=i.call(e)},n:function(){var e=i.next();return n=e.done,e},e:function(e){r=!0,a=e},f:function(){try{n||null==i.return||i.return()}finally{if(r)throw a}}};if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return i&&(e=i),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var n;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}define("engine",["jquery","utils","state","section","passages"],function(N,j,P,R,I){var t,V=j.impossible,M=j.passageSelector,D=j.transitionOut,F=j.options;function L(e,t,n){var r,a,o;if(n?(n=n.get("name"),(a=I.getTree(n)).children.length&&(r={type:"include",tag:t,name:n,children:a.children,text:a.text})):r=I.getTree(t),r){for(;(o=e[e.length-1])&&("root"===o.type||"include"===o.type)&&o.children.some(function(e){return e.type.startsWith("unclosed")});)e[e.length-1]=Object.create(o),e=e[e.length-1].children=o.children.slice();e.push(r)}}function n(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=n.loadedGame,a=I.get(e),o=j.storyElement,i=o.parent(),s=n.stretch,n=n.transition,n=void 0===n?{}:n,c=n.depart,c=void 0===c?"instant":c,l=n.arrive,l=void 0===l?"dissolve":l,u=n.departOrigin,p=n.arriveOrigin,n=n.time,d=(i.findAndFilter("tw-enchantment").each(function(e,t){var n=(t=N(t)).data("enchantedProperties");n&&o.css(n.reduce(function(e,t){return e[t]="",e},{})),t[0]===i[0]&&(i=o.unwrap().parent())}),I.hasValid(e)||V("Engine.showPassage","There's no passage with the name \""+e+'"!'),o.children(M).not(".transition-out, .transition-out *")),a=(a.get("tags")||[]).join(" "),f=(t=N("<tw-passage><tw-sidebar>"),f=t.children("tw-sidebar"),h=N('<tw-icon tabindex=0 alt="Undo" title="Undo">&#8630;</tw-icon>'),g=N('<tw-icon tabindex=0 alt="Redo" title="Redo">&#8631;</tw-icon>'),P.pastLength<=0&&h.css("visibility","hidden"),P.futureLength<=0&&g.css("visibility","hidden"),f.append(h,g),t),h=("function"==typeof u&&(u=u.call(d)),"function"==typeof p&&(p=p.call(f)),!s&&c),m=h&&d.css("width"),g=(j.detachStoryElement(),f.appendTo(o).attr({tags:a}),h&&(D(d,c,n,0,0,0,u),d.css({position:"absolute",width:function(){return"0px"!==m?m:"100%"}})),o.attr({tags:a}),R.create(f)),y=(r&&(g.loadedGame=!0),[]);if(P.pastLength<=0&&1===P.turns){var b,v=_createForOfIteratorHelper(I.getTagged("startup"));try{for(v.s();!(b=v.n()).done;)L(y,"startup",b.value)}catch(e){v.e(e)}finally{v.f()}if(F.debug){var w,k=_createForOfIteratorHelper(I.getTagged("debug-startup"));try{for(k.s();!(w=k.n()).done;)L(y,"debug-startup",w.value)}catch(e){k.e(e)}finally{k.f()}}}var S,T=_createForOfIteratorHelper(I.getTagged("header"));try{for(T.s();!(S=T.n()).done;)L(y,"header",S.value)}catch(e){T.e(e)}finally{T.f()}if(F.debug){var _,x=_createForOfIteratorHelper(I.getTagged("debug-header"));try{for(x.s();!(_=x.n()).done;)L(y,"debug-header",_.value)}catch(e){x.e(e)}finally{x.f()}}L(y,e);var O,A=_createForOfIteratorHelper(I.getTagged("footer"));try{for(A.s();!(O=A.n()).done;)L(y,"footer",O.value)}catch(e){A.e(e)}finally{A.f()}if(F.debug){var C,E=_createForOfIteratorHelper(I.getTagged("debug-footer"));try{for(E.s();!(C=E.n()).done;)L(y,"debug-footer",C.value)}catch(e){E.e(e)}finally{E.f()}}g.renderInto(y,f,{transition:l,transitionTime:n,transitionOrigin:p}),g.loadedGame=!1,j.reattachStoryElement(),scroll(0,s?f.offset().top-.05*N(window).height():o[0].getBoundingClientRect().top+document.body.scrollTop)}return Object.freeze({goBack:function(e){P.rewind()&&n(P.passage,e)},goForward:function(e){P.fastForward()&&n(P.passage,e)},goToPassage:function(e,t){P.play(e),n(e,t)},redirect:function(e,t){P.redirect(e),n(e,t)},toggleFullscreen:function(){var e=document.documentElement;document.fullscreenElement?document.exitFullscreen():document.msFullscreenElement?document.msExitFullscreen():(e.msRequestFullscreen||e.requestFullscreen).call(e)},showPassage:n,enableDebugMode:function(){t&&t()},registerDebugMode:function(e){t=t||e}})}),define("harlowe",["jquery","debugmode/mode","renderer","state","section","engine","passages","utils","utils/renderutils","internaltypes/varscope","internaltypes/twineerror","macros","macrolib/values","macrolib/commands","macrolib/datastructures","macrolib/stylechangers","macrolib/enchantments","macrolib/metadata","macrolib/patterns","macrolib/links","macrolib/custommacros","utils/jqueryplugins","repl"],function($,DebugMode,Renderer,State,Section,Engine,Passages,Utils,_ref,VarScope){var dialog=_ref.dialog;function __HarloweEval(text){eval(text+"")}function printJSError(e){var t,n="".concat(e.name,": ").concat(e.message);return e.stack&&(t=(e=e.stack.split("\n")).findIndex(function(e){return e.includes("__HarloweEval")}),n+="\n".concat(e.slice(0,t).join("\n").replace(/\([^)]+\)/g,""))),"<div style='font-family:monospace;overflow-y:scroll;max-height:30vh'>```"+n+"```</div>"}!function(o){window.onerror=function(e,t,n,r,a){window.onerror=o,Utils.storyElement.parent().append(dialog({message:"Sorry to interrupt, but this page's code has got itself in a mess.\n\n".concat(printJSError(a),"\n(This is probably due to a bug in the Harlowe game engine.)")}).addClass("harlowe-crash")),"function"==typeof o&&o.apply(void 0,arguments)}}(window.onerror),Utils.onStartup(function(){var n,e,t,r,a=$("tw-storydata");0!==a.length&&(Utils.options.ifid=a.attr("ifid"),(a.attr("tags")||"").split(/\s/).forEach(function(e){"uncompressed-pure-values"!==e&&"uncompressed-saves"!==e||(Utils.options.uncompressedPureValues=!0),"uncompressed-structures"!==e&&"uncompressed-saves"!==e||(Utils.options.uncompressedStructures=!0)}),(a.attr("options")||"").split(/\s/).forEach(function(e){e&&(Utils.options[e]=!0),"debug"===e&&DebugMode()}),a=(a=a.attr("startnode"))||[].reduce.call($("tw-passagedata"),function(e,t){t=t.getAttribute("pid");return t<e?t:e},1/0),a=$("tw-passagedata[pid='"+a+"']").attr("name"),$(document.documentElement).on("keydown",function(e){13===e.which&&"0"===e.target.getAttribute("tabindex")&&$(e.target).trigger("click")}),n=!1,$("[role=script]").each(function(t){try{__HarloweEval($(this).html())}catch(e){n||(n=!0,dialog({parent:Utils.storyElement.parent(),message:"There is a problem with this story's "+Utils.nth(t+1)+" script:\n\n"+printJSError(e)}))}}),$("[role=stylesheet]").each(function(e,t){$(document.head).append("<style data-title=\"Story stylesheet '".concat(e+1,"'\">").concat($(t).html()))}),(e=Section.create()).stack=[{tempVariables:Object.create(VarScope)}],(r=Passages.loadMetadata(e)).length&&(t=dialog({parent:Utils.storyElement.parent(),message:"These errors occurred when running the `(metadata:)` macro calls in this story's passages:<p></p>"}),r.forEach(function(e){return t.find("p").append(e.render())})),(r=!Utils.options.debug&&State.hasSessionStorage&&sessionStorage.getItem("Saved Session"))&&!0===State.deserialise(e,r)?Engine.showPassage(State.passage):Engine.goToPassage(a))})}),define("macros",["utils/naturalsort","utils","utils/operationutils","datatypes/changercommand","datatypes/custommacro","datatypes/lambda","datatypes/codehook","internaltypes/changedescriptor","internaltypes/twineerror"],function(g,e,t,o,r,y,b,p,v){var w=e.insensitiveName,k=e.nth,S=e.andList,T=t.objectName,_=t.typeName,d=t.toSource,x=Array.isArray,i={};function O(e){return e===s.TypeSignature.Any||(x(e.innerType)?e.innerType.some(O):!!e.innerType&&O(e.innerType))}function a(e,t,n,r){var a,o,i,s,c,l,u,p,d=t.fn,f=t.typeSignature,h=t.returnType,m=(r=function(e){for(var t,n,r,a=[],o=0;o<e.length;o+=1)o in e&&(!0===(null==(t=e[o])?void 0:t.spreader)?(n=t.value,(r=v.containsError(n))?a.push(r):x(n)||"string"==typeof n?a.push.apply(a,_toConsumableArray(n)):n instanceof Set?a.push.apply(a,_toConsumableArray(Array.from(n).sort(g("en")))):a.push(v.create("operation","I can't spread out "+T(n)+", because it is not a string, dataset, or array."))):a.push(t));return a}(r),"string"!=typeof e&&(a=e,e=""),a?"":"("+(x(e)&&1<e.length?e[0]:e)+":)");for(e=a?a.TwineScript_KnownName?"the custom macro, ".concat(a.TwineScript_KnownName):"an unnamed custom macro":"the ".concat(m," macro"),o=0<f.length?1===f.length&&O(f[0])?1===r.length?"That value can't be given to macros as-is.":"Give only a single value to this macro.":e+" must only be given "+S(f.map(_))+(1<f.length?", in that order":"."):e+" must not be given any data."+(a?"":" Just write "+m),s=0,c=Math.max(r.length,f.length);s<c;s+=1){if(p=f[s],l=r[s],v.containsError(l))return l;if(s>=f.length&&!i)return v.create("datatype",r.length-f.length+" too many values were given to "+e+".",o);if(!(p=p||i).innerType||"rest"!==p.pattern&&"zero or more"!==p.pattern||(i=p.innerType,"rest"===p.pattern&&(p=p.innerType)),!function e(t,n){if(null===n)return void 0===t;var r=_typeof(t);if("function"!=typeof n&&n.pattern){if("optional"===n.pattern||"zero or more"===n.pattern)return void 0===t||e(t,n.innerType);if("either"===n.pattern){for(var a=0;a<n.innerType.length;a+=1)if(e(t,n.innerType[a]))return!0;return!1}if("lambda"===n.pattern&&e(t,n.innerType))return n.clauses.includes("where")===("where"in t||"each"in t)&&n.clauses.includes("making")==="making"in t&&n.clauses.includes("via")==="via"in t&&n.clauses.includes("with")==="with"in t;if("insensitive set"===n.pattern)return n.innerType.includes(w(t));if("range"===n.pattern)return n.range(t);if("wrapped"===n.pattern)return e(t,n.innerType)}return(void 0===n||void 0!==t)&&("anything"===n.TwineScript_TypeName&&void 0!==t&&!t.TwineScript_Unstorable||"everything"===n.TwineScript_TypeName&&void 0!==t||(n===String?"string"===r:n===Boolean?"boolean"===r:n===parseInt?"number"===r&&!Number.isNaN(t)&&!(t+"").includes("."):n===Number?"number"===r&&!Number.isNaN(t):n===Array?x(t):n===Map||n===Set?t instanceof n:Object.isPrototypeOf.call(n,t)))}(l,p))return void 0===l?(u=f.filter(function(e){return!("optional"===e.pattern||"zero or more"===e.pattern)}).length,v.create("datatype","".concat(e," was given ").concat(r.length?S(r.map(T)):"nothing",", but needs ").concat(u-s," more value").concat(1<u-s?"s":"","."),o)):null!=(u=l)&&u.TwineScript_Unstorable&&O(p)?v.create("datatype",e+"'s "+k(s+1)+" value, "+T(l)+", is not valid data for this macro.",o):b.isPrototypeOf(l)&&"Changer"===h?v.create("syntax","Please put this hook outside the parentheses of "+e+", not inside it.","Hooks should appear after a macro"+(a?".":": "+m+"[Some text]")):l&&y.isPrototypeOf(l)&&"lambda"===p.pattern?v.create("datatype",e+"'s "+k(s+1)+" value (a lambda) should have "+S(["where","when","making","via","with"].filter(function(e){return p.clauses.includes(e)}).map(function(e){return"a '"+e+"' clause"}))+", not "+S(["where","when","making","via","with"].filter(function(e){return e in l}).map(function(e){return"a '"+e+"' clause"}))+"."):"insensitive set"===p.pattern?v.create("datatype",T(l)+" is not a valid name string for "+e+".","Only the following names are recognised (capitalisation and hyphens ignored): "+S(p.innerType)+"."):v.create("datatype","".concat(e,"'s ").concat(k(s+1)," value is ").concat(T(l),", but should be ").concat(_(p),"."),p.message||o)}return d.apply(null,[n].concat(r))}function f(e,t,n,r){var a={fn:n,typeSignature:r=[].concat(r||[]),returnType:t};Object.freeze(a),[].concat(e).forEach(function(e){return Object.defineProperty(i,w(e),{value:a})})}var s={has:function(e){return e=w(e),hasOwnProperty.call(i,e)},get:function(e){return e=w(e),hasOwnProperty.call(i,e)&&i[e]},add:function e(t,n,r,a){return f(t,n,r,a),e},addChanger:function e(t,n,r,a){return f(t,"Changer",n,a),o.register(x(t)?t[0]:t,r),e},addCommand:function e(t,n,r,a){var s,c,l,u,o=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],i=[].concat(t)[0];return f(t,"Command",(s=i,c=n,l=r,u=o,function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,o,i=c.apply(void 0,n);return i||(a=p.create(),o=_objectSpread({TwineScript_TypeID:"command",TwineScript_ObjectName:"a (".concat(s,":) command"),TwineScript_TypeName:"a (".concat(s,":) command"),TwineScript_Print:function(){return"`[A (".concat(s,":) command]`")},TwineScript_ToSource:function(){return"(".concat(s,":").concat(n.map(d),")")},TwineScript_is:function(e){return d(this)===d(e)}},u?{TwineScript_Attach:function(e,t){return a.section=e,t.run(a),o},TwineScript_Run:function(e){e=l.apply(void 0,[a,e].concat(n));return a=p.create(),e}}:{TwineScript_Run:function(e){return l.apply(void 0,[e].concat(n))}}))}),a),e},TypeSignature:{optional:function(e){return{pattern:"optional",innerType:e}},zeroOrMore:function(e){return{pattern:"zero or more",innerType:e}},either:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"either",innerType:t}},rest:function(e){return{pattern:"rest",innerType:e}},insensitiveSet:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"insensitive set",innerType:t}},numberRange:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1/0;return{pattern:"range",min:t,max:n,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&t<=e&&e<=n}}},nonNegativeInteger:{pattern:"range",integer:!0,min:0,max:1/0,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&0<=e&&!(e+"").includes(".")}},positiveInteger:{pattern:"range",integer:!0,min:1,max:1/0,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&1<=e&&!(e+"").includes(".")}},wrapped:function(e,t){return{pattern:"wrapped",innerType:e,message:t}},Any:{TwineScript_TypeName:"anything"},Everything:{TwineScript_TypeName:"everything"}},run:function(e,t,n){return s.has(e)?a(e,s.get(e),t,n):v.create("macrocall","I can't run the macro '"+e+"' because it doesn't exist.","Did you mean to run a macro? If you have a word written like (this:), it is regarded as a macro name.")},runCustom:function(e,t,n){return r.isPrototypeOf(e)?a(e,e,t,n):v.containsError(e)?e:v.create("macrocall","I can't call ".concat(T(e)," because it isn't a custom macro."))}};return Object.assign(s.TypeSignature,{positiveNumber:s.TypeSignature.numberRange(Math.pow(2,-52),1/0),nonNegativeNumber:s.TypeSignature.numberRange(0,1/0),percent:s.TypeSignature.numberRange(0,1)}),Object.freeze(s)}),define("passages",["jquery","utils/naturalsort","utils","markup","internaltypes/twineerror"],function(t,s,e,c,l){var u=e.insensitiveName,p=e.unescape,n=e.onStartup,o=e.impossible,d=Object.assign,f=RegExp(c.Patterns.macroFront+c.Patterns.macroName,"ig");function r(e){var t,r,a,o,n=e.attr("name"),i=p(e.html()),s=(t=n,o=["metadata","storylet","exclusivity","urgency"],((s=i).match(f)||[]).some(function(t){return o.some(function(e){return u(t.slice(1,-1))===e})})?(r=!1,a={},c.lex(s,t).children.forEach(function e(t){if("macro"===t.type){var n=u(t.name);if(o.some(function(e){return n===e})){if(l.isPrototypeOf(a[n]))return;if(r)return void(a[n]=l.create("syntax","The (".concat(t.name,":) macro can't appear after non-metadata macros.")));if(a[n])return void(a[n]=l.create("syntax","There is more than one (".concat(t.name,":) macro.")));a[n]=t}else r=!0;t.children.forEach(function e(t){var n=u(t.name);"macro"===t.type&&o.some(function(e){return n===e})?a[n]=l.create("syntax","The (".concat(t.name,":) macro can't be inside another macro.")):t.children.forEach(e)})}else t.children.forEach(e)}),a):{});return d(new Map([["source",i],["tags",(e.attr("tags")||"").split(/\s/)||[]],["name",n]]),{TwineScript_TypeName:"a passage datamap",TwineScript_ObjectName:"a passage datamap",metadata:s,tree:null})}var a=Object.create(null),i=[],h=null,m=d(new Map,{TwineScript_ObjectName:"the Passages datamap",getTagged:function(n){var e,r;return a[n]||(e=s("en",function(e){return e.get("name")}),r=[],this.forEach(function(e){var t=e instanceof Map&&e.get("tags");Array.isArray(t)&&t.includes(n)&&r.push(e)}),r.sort(e),a[n]=r)},clearTagCache:function(){a=Object.create(null)},clear:function(){Map.prototype.clear.call(this),this.clearTagCache(),this.clearTreeCache(),this.clearStoryletCache()},delete:function(){var e;(e=Map.prototype.delete).call.apply(e,[this].concat(Array.prototype.slice.call(arguments))),this.clearTagCache(),this.clearTreeCache(),this.clearStoryletCache()},getTree:function(e){if(!this.has(e))return o("Passages.getTree","No passage name?"),[];var t=this.get(e),n=t.get("tags");if(n.includes("header")||n.includes("footer")||n.includes("debug-header")||n.includes("debug-footer"))return t.tree||(t.tree=c.lex(t.get("source"),e)),t.tree;for(var r,a=0;a<i.length;a+=1)if(i[a]&&i[a].place===e)return r=i.splice(a,1)[0],i.unshift(r),r;n=c.lex(t.get("source"),e);return i.unshift(n),16<i.length&&i.pop(),n},clearTreeCache:function(){i=[]},getStorylets:function(r,e){var a,o,i,e=e?e.filter(r,_toConsumableArray(m.values())):_toConsumableArray(m.values());return l.containsError(e)?e:(a=[],o=-1/0,e.reduce(function(e,t){if(e)return e;e=t.get("storylet");if(e){var n=r.speculate(e,t.get("name"),"a (storylet:) macro");if(l.containsError(n))return n.message="There's an error in the storylet passage \""+t.get("name")+'":\n'+n.message,n.source=e.TwineScript_ToSource(),n;n&&(e=t.get("exclusivity"),o=Math.max(o,"number"==typeof e?e:0),a.push(t))}},void 0)||(i=s("en"),a.filter(function(e){e=e.get("exclusivity");return("number"==typeof e?e:0)===o}).sort(function(e,t){var n=e.get("urgency"),r=t.get("urgency");return(n="number"==typeof n?n:0)!==(r="number"==typeof r?r:0)?r-n:i(e.get("name"),t.get("name"))})))},allStorylets:function(){return h=h||_toConsumableArray(m.values()).filter(function(e){return e.get("storylet")})},clearStoryletCache:function(){h=null},loadMetadata:function(i){var s=[];return m.forEach(function(o){o.metadata&&Object.keys(o.metadata).forEach(function(e){var t,n,r;function a(e,t){o.has(e)?s.push(l.create("syntax","This passage's datamap already has a '"+JSON.stringify(e)+"' data name.")):o.set(e,t)}l.containsError(o.metadata[e])?s.push(o.metadata[e]):(t=o.metadata[e],n=i.speculate(t,o.get("name"),"a ("+e+":) macro"),r='In "'+o.get("name")+'":\n',l.containsError(n)?(n.message=r+n.message,n.source=t.text,s.push(n)):n instanceof Map?n.forEach(function(e,t){return a(t,e)}):a(e,n))}),o.metadata=void 0}),s},hasValid:function(e){e=this.get(e);return e&&e instanceof Map&&e.has("source")},create:r});return n(function(){t("tw-storydata > tw-passagedata").get().forEach(function(e){e=t(e),m.set(e.attr("name"),new r(e))})}),m}),define("renderer",["jquery","utils","markup","internaltypes/twineerror"],function(a,e,S,T){var _=e.escape,x=e.insensitiveName,O=e.options;function A(e,t,n){n=2<arguments.length&&void 0!==n?n:"";return"<"+t+(n?" "+n:"")+">"+e+"</"+t+">"}var C="text-align: center; max-width:50%; ";function E(m,g){function y(e,t,n){e=E(e.children,g);return e&&A(e,t,n)}var b="",v=[];if(m)for(var e,w=(m=Array.isArray(m)?m:[m]).length,k=0;k<w;k+=1)if(e=function(e){var n=m[e];switch(n.type){case"include":b+=y(n,"tw-"+n.type,'type="'.concat(n.tag,'" name="').concat(n.name,'"'));break;case"error":b+=T.create("syntax",n.message,n.explanation).render(_(n.text))[0].outerHTML;break;case"numbered":case"bulleted":for(var t="numbered"===n.type?"ol":"ul",r=(b+="<"+t+">",1);e<w&&m[e];){if("br"===m[e].type){if(b+="</li>",!m[e+1]||m[e+1].type!==n.type)break}else m[e].type===n.type?(b=(b+=("<"+t+">").repeat(Math.max(0,m[e].depth-r)))+("</"+t+">").repeat(Math.max(0,r-m[e].depth))+"<li>",r=m[e].depth):b+=E([m[e]],g);e+=1}b+=("</"+t+">").repeat(r+1);break;case"align":for(;n&&"align"===n.type;){var a=n.align,o=e+=1;if("left"===a){--e;break}for(;e<w&&m[e]&&"align"!==m[e].type;)e+=1;var o=E(m.slice(o,e),g),i="";switch(a){case"center":i+=C+"margin-left: auto; margin-right: auto;";break;case"justify":case"right":i+="text-align: "+a+";";break;default:+a&&(i+=C+"margin-left: "+a+"%;")}b+="<tw-align "+(i?'style="'+i+'"':"")+">"+o+"</tw-align>\n",n=m[e]}break;case"column":for(var s,c=[];n&&"column"===n.type;){var l=n.column,u=e+=1;if("none"===l){--e;break}for(;e<w&&m[e]&&"column"!==m[e].type;)e+=1;c.push({text:n.text,type:l,body:E(m.slice(u,e),g),width:n.width,marginLeft:n.marginLeft,marginRight:n.marginRight}),n=m[e]}c.length&&(s=c.reduce(function(e,t){return e+t.width},0),b+="<tw-columns>"+c.map(function(e){return"<tw-column type=".concat(e.type," ",' style="width:').concat(e.width/s*100,"%; margin-left: ").concat(e.marginLeft,"em; margin-right: ").concat(e.marginRight,'em;">').concat(e.body,"</tw-column>\n")}).join("")+"</tw-columns>");break;case"heading":for(b+="<h"+n.depth+">";++e<w&&m[e];){if("br"===m[e].type){b+="</h"+n.depth+">";break}b+=E([m[e]],g)}break;case"br":if(!v.length||/td|th/.test(v[0])){b+="<br>";for(var p=m[e+1];p&&("br"===p.type||"tag"===p.type&&/^<br\b/i.test(p.text));)b+="<tw-consecutive-br"+("tag"===p.type?" data-raw":"")+"></tw-consecutive-br>",p=m[(e+=1)+1]}break;case"hr":b+="<hr>";break;case"escapedLine":case"comment":break;case"inlineUrl":b+='<a class="link" href="'+_(n.text)+'">'+n.text+"</a>";break;case"scriptStyleTag":case"tag":var d=n.text.toLowerCase();/^<\/?(?:table|thead|tbody|tr|tfoot|td|th|svg)\b/.test(d)&&!n.text.endsWith("/>")&&v[n.text.startsWith("</")?"shift":"unshift"](d),b+=n.text.startsWith("</")?n.text:n.text.replace(/(\/)?>$/,function(e,t){return" data-raw".concat(t?"></".concat(n.text.match(/[\w-]+/)):"",">")});break;case"sub":case"sup":case"strong":case"em":b+=y(n,n.type);break;case"strike":b+=y(n,"s");break;case"bold":b+=y(n,"b");break;case"italic":b+=y(n,"i");break;case"twineLink":d=_slicedToArray(S.lex("(link-goto:"+JSON.stringify(n.innerText)+","+JSON.stringify(n.passage)+")").children,1)[0];b+='<tw-expression type="macro" name="link-goto"'+(O.debug?' title="'+_(n.text)+'"':"")+' code="'+g.code.length+'"></tw-expression>',g.code.push(d);break;case"hook":b+="<tw-hook "+(n.hidden?"hidden ":"")+(n.name?'name="'+x(n.name)+'"':"")+(O.debug&&n.name?' title="Hook: ?'+n.name+'"':"")+' source="'+g.source.length+'"></tw-hook>',g.source.push(n.children);break;case"unclosedHook":return b+="<tw-hook "+(n.hidden?"hidden ":"")+(n.name?'name="'+x(n.name)+'"':"")+'source="'+g.source.length+'"></tw-hook>',g.source.push(m.slice(e+1,w)),{v:b};case"verbatim":b+=A(_(n.innerText).replace(/\n/g,"<br>"),"tw-verbatim");break;case"collapsed":b+=y(n,"tw-collapsed");break;case"unclosedCollapsed":return{v:b+="<tw-collapsed>"+E(m.slice(e+1,w),g)+"</tw-collapsed>"};case"variable":case"tempVariable":case"macro":var f=[],h=[];if("macro"===n.type&&!function e(t){"string"!==t.type&&"hook"!==t.type&&t.children.every(e);var n=x(t.name);if("macro"!==t.type||"prompt"!==n&&"confirm"!==n){if("hook"===t.type&&!t.everyLeaf(function(e){return"error"!==e.type||(h.push(e),!1)}))return!1}else f.push(t);return!0}(n),h.length)return{v:T.create("syntax","This code hook's markup contained "+h.length+" error"+(h.length?"s":"")+":<br>\u2014"+h.map(function(e){return e.message}).join("<br>\u2014")).render(_(n.text))[0].outerHTML};d=f.map(function(e){return e.blockerTree=g.blockers.length,g.blockers.push(e),e.blockerTree});b+='<tw-expression type="'+n.type+'" name="'+_(n.name||n.text)+'"'+(O.debug?' title="'+_(n.text)+'"':"")+(d.length?' blockers="'+d+'"':"")+' code="'+g.code.length+'"></tw-expression>',g.code.push(n);break;default:b+=n.children&&n.children.length?E(n.children,g):n.text}k=e}(k))return e.v;return b}return Object.freeze({exec:function(e){var r={code:[],blockers:[],source:[]},e=E(e="string"==typeof e?S.lex(e).children:e,r),e=a(a.parseHTML(e,document,!0));return e.findAndFilter("script:not([src])").each(function(e,t){var n=t.getAttribute("type");n&&"text/javascript"!==n.toLowerCase()||t.setAttribute("type","application/x-harlowe")}),r.blockers=r.blockers.map(function(e){e.blockedValue=!0;e=Object.create(e);return e.blockedValue=!1,e}),e.findAndFilter("tw-expression[code]:not([data-raw]), tw-expression[blockers]:not([data-raw]), tw-hook[source]:not([data-raw])").each(function(e,t){var n;(t=a(t)).attr("blockers")&&(n=t.popAttr("blockers").split(",").map(function(e){return r.blockers[e]}),t.data("blockers",n)),t.attr("source")&&t.data("source",r.source[t.popAttr("source")]),t.attr("code")&&t.data("code",r.code[t.popAttr("code")])}),e}})}),define("repl",["utils","markup","section"],function(e,t,n){e.onStartup(function(){return setTimeout(function(){e.options.debug&&(window.REPL=function(e){e=n.create().eval(t.lex("(print:"+e+")"));return e.TwineScript_Run?e.TwineScript_Run().source:e},window.LEX=function(e){e=t.lex(e);return 1===e.length?e[0]:e})})})}),define("section",["jquery","utils","twinescript/runner","twinescript/operations","state","utils/operationutils","utils/renderutils","utils/scripttag","datatypes/changercommand","datatypes/colour","datatypes/lambda","datatypes/codehook","internaltypes/changedescriptor","internaltypes/varscope","internaltypes/twineerror","internaltypes/twinenotifier"],function(p,f,a,u,r,e,t,i,d,h,o,m,g,y,b,v){var w=e.printBuiltinValue,k=e.objectName,S=e.typeID,T=e.isObject,s=t.collapse,_=Object.assign,x=Object.create,O=Object.keys;function A(e,t,n){if(t&&"object"===_typeof(t)&&d.isPrototypeOf(t)){var r=n.popData("source")||(null==(r=n[0].cachedData)?void 0:r.source),a=(null!=(a=n[0])&&a.cachedData&&(n[0].cachedData.source=void 0),n.data("originalSource",r),g.create({target:n,source:r,section:this,append:"append"})),o=t.run(a);if(b.containsError(o)&&e.replaceWith(o.render(e.attr("title"))),!this.renderInto(r,null,a))return o=f.insensitiveName(e.attr("name")),["if","elseif","unless","else","testfalse"].includes(o)&&(e.addClass("false"),"elseif"!==o)&&(this.stackTop.lastHookShown=!1),n.data("live")&&function(t,n,r){function a(e){p&&(d-=(e-p)*(f.options.debug&&void 0!==f.options.speedMultiplier?f.options.speedMultiplier:1)),p=e,0<d?requestAnimationFrame(a):(d=s,o())}var o,i=this,e=r.data("live"),s=e.delay,c=e.event,l=((n=_objectSpread(_objectSpread({},n),{},{append:"replace",transitionDeferred:!1,enabled:!0})).data=_objectSpread(_objectSpread({},n.data),{},{live:void 0}),r.data("originalSource")||""),u=this.stackTop.tempVariables,p=null,d=s;o=this.whenUnblocked.bind(this,function(){var e;i.inDOM()&&(e=null==c?void 0:c.filter(i,[!0],u),b.containsError(e)?e.render(i,t.attr("title")).replaceAll(t):c&&!e[0]?requestAnimationFrame(a):(i.renderInto(l,r,n,u),e||r.find("tw-expression[name='stop']").length||i.inDOM()&&requestAnimationFrame(a)))}),requestAnimationFrame(a)}.call(this,e,a,n),!0}else{if(!1===t)return o=n.popData("source")||(null==(r=n[0].cachedData)?void 0:r.source),null!=(a=n[0])&&a.cachedData&&(n[0].cachedData.source=void 0),o&&(n.cachedData&&(n.cachedData.source=void 0),n.data("originalSource",o),n.data("hidden",!0)),e.addClass("false"),!(this.stackTop.lastHookShown=!1);if(!0!==t)return!1}return this.stackTop.lastHookShown=!0}function C(e){var t,n,e=(e instanceof p?e[0]:e).nextSibling;return e&&(e instanceof Text&&!e.textContent.trim()||["br","tw-consecutive-br"].includes((e.tagName||"").toLowerCase()))?(t=(n=C(e)).whitespace,n=n.nextElem,{whitespace:p(e).add(t),nextElem:n}):{whitespace:p(),nextElem:p(e)}}function E(e){if(null!=e&&e.length)return p("<tw-open-button replay label='\ud83d\udd0d'>").data("evalReplay",e)}function c(e,t){var n=this.eval(t);e.append(E(this.evalReplay)),e.append(function(e,t){if(/a \((go-to|undo|redirect|restart):\) command/.exec(null==t?void 0:t.TwineScript_TypeName))return p("<tw-open-button goto label='GO'>").data("goto",{section:e,command:t})}(this,n)),this.stackTop.evaluateOnly&&n&&(d.isPrototypeOf(n)||"function"==typeof n.TwineScript_Run)&&(n=b.create("syntax","I can't work out what ".concat(this.stackTop.evaluateOnly," should evaluate to, because it contains a ").concat(d.isPrototypeOf(n)?"changer.":"command."),"Please rewrite this without putting changers or commands here."));var r=p();for(i=e;d.isPrototypeOf(n);){var a=C(i),o=a.whitespace;if((i=a.nextElem)[0]&&i[0].nodeType===Node.TEXT_NODE&&"+"===i[0].textContent.trim()){var i,a=i,s=C(a),c=s.whitespace;if((i=s.nextElem).is("tw-expression")){var s=i.popData("code")||(null==(s=i[0])||null==(s=s.cachedData)?void 0:s.code),l=(null!=(l=i[0])&&l.cachedData&&(i[0].cachedData.code=void 0),this.eval(s));if(b.containsError(l)){n=l;break}s=u["+"](n,l);p(o).add(a).add(c).remove(),n=b.containsError(s)?b.create("operation","I can't combine "+k(n)+" with "+k(l)+".","function"==typeof l.TwineScript_Run?"If you want to attach this changer to ".concat(k(l),", remove the + between them."):"Changers can only be added to other changers."):s;continue}}if(i.is("tw-expression")){c=i.popData("code")||(null==(a=i[0])||null==(a=a.cachedData)?void 0:a.code),s=(null!=(l=i[0])&&l.cachedData&&(i[0].cachedData.code=void 0),this.eval(c));if(i.append(E(this.evalReplay)),b.containsError(s)){n=s;break}if(s&&"object"===_typeof(s)&&"function"==typeof s.TwineScript_Attach){n=s.TwineScript_Attach(this,n);break}return d.isPrototypeOf(s)?void e.replaceWith(b.create("operation","Changers like (".concat(n.macroName,":) need to be combined using + between them."),"Place the + between the changer macros, or the variables holding them. The + is absent only between a changer and its attached hook or command.").render(e.attr("title"))):void e.replaceWith(b.create("operation","".concat(k(s)," can't have changers like (").concat(n.macroName,":) attached."),"Changers placed just before hooks, links and commands will attempt to attach, but in this case it didn't work.").render(e.attr("title")))}if(i.is("tw-hook")){o.remove(),r=i;break}n.macroName||f.impossible("Section.runExpression","changer has no macroName");a=e.attr("title")||"("+n.macroName+": ...)";return void e.replaceWith(b.create("syntax","The (".concat(n.macroName,":) changer should be stored in a variable or attached to a hook."),"Macros like this should appear before a hook: ".concat(a,"[Some text]")).render(e.attr("title")))}e.attr("return",S(n)),r=r.length?r:C(e).nextElem.filter("tw-hook"),(t=b.containsError(n))?e.replaceWith(t.render(e.attr("title")).append(E(this.evalReplay))):v.isPrototypeOf(n)?e.append(n.render()):n&&"function"==typeof n.TwineScript_Run?(n=n.TwineScript_Run(this),b.containsError(n)?e.replaceWith(n.render(e.attr("title"))):g.isPrototypeOf(n)?null!=(t=n.data)&&t.live?e.replaceWith(b.create("unimplemented","I currently can't attach (live:) or (event:) macros to commands - only hooks.").render(e.attr("title"))):(n.section=this,n.target=i,this.renderInto("",i,n)):T(n)&&n.blocked?(this.stackTop.blocked=n.blocked,e.data("code",{type:"macro",blockedValue:!0,text:e.attr("title")||"",start:0,end:(e.attr("title")||"").length})):n&&f.impossible("Section.runExpression","TwineScript_Run() returned a non-ChangeDescriptor ".concat(_typeof(n),': "').concat(n,'"'))):r.length&&A.call(this,e,n,r)||("string"==typeof n||"number"==typeof n||n instanceof Map||n instanceof Set||Array.isArray(n)||h.isPrototypeOf(n)||m.isPrototypeOf(n)||n&&"function"==typeof n.TwineScript_Print&&!d.isPrototypeOf(n)?(n=w(n),b.containsError(n)?e.replaceWith(n.render(e.attr("title"))):"string"==typeof n||Array.isArray(n)?this.renderInto(n,e):f.impossible("printBuiltinValue() produced a non-string non-array ".concat(_typeof(n)))):d.isPrototypeOf(n)||"boolean"==typeof n||f.impossible("Section.runExpression","The expression evaluated to an unknown value: ".concat(n)))}var l={add:[],remove:[]};return Object.preventExtensions({create:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:f.storyElement,n=_(x(this),{timestamp:Date.now(),dom:e,stack:[],enchantments:[],unblockCallbacks:[],freeVariables:null,evalReplay:null,loadedGame:!1,Identifiers:{TwineScript_Identifiers:!0,it:0,get time(){var e;return null!=(e=n.stackTop)&&e.evaluateOnly?b.create("operation","'time' can't be used in ".concat(n.stackTop.evaluateOnly,".")):(Date.now()-n.timestamp)*(f.options.debug&&void 0!==f.options.speedMultiplier?f.options.speedMultiplier:1)},get turns(){return r.turns},get turn(){return r.turns},get visits(){var t=n.stackTop.speculativePassage;return r.history().filter(function(e){return e===(t||r.passage)}).length+(!t||t===r.passage)},get visit(){return n.Identifiers.visits},get exits(){var e;return null!=(e=n.stackTop)&&e.evaluateOnly?b.create("operation","'exit' and 'exits' can't be used in ".concat(n.stackTop.evaluateOnly,".")):n.dom.find("tw-enchantment, tw-link").filter(function(e,t){return(t=p(t)).data("enchantmentEvent")||t.parent().data("linkPassageName")||t.parent().data("clickEvent")}).length},get exit(){return n.Identifiers.exits},get pos(){return n.stackTop&&!n.stackTop.evaluateOnly&&n.stackTop.lambdaPos?+n.stackTop.lambdaPos||1:b.create("operation","'pos' can only be used in lambdas that aren't 'when' lambdas.")}}});return n},eval:function(t){var e,n;f.options.debug&&f.options.evalReplay&&(n=Array.isArray(t)?t.reduce(function(e,t){return e+t.text},""):t.text||"",this.evalReplay=[{code:n,fromCode:n,basis:(Array.isArray(t)?t[0]:t).start,start:0,end:n.length,diff:0}]);try{e=a(this,t)}catch(e){return null!=(n=window.console)&&n.error(e),this.evalReplay=null,b.create("","An internal error occurred while trying to run ".concat([].concat(t).map(function(e){return e.text}).join(""),"."),'The error was "'.concat(e.message,'".\nIf this is the latest version of Harlowe, please consider reporting a bug (see the documentation).'))}return this.evalReplay&&2===this.evalReplay.length&&this.evalReplay.shift(),e},get stackTop(){return this.stack[0]},inDOM:function(){return 0<f.storyElement.find(this.dom).length},evaluateTwineMarkup:function(e,t){var n=p("<p>");return this.stack.unshift({desc:g.create({target:n,source:e,section:this,append:"append"}),tempVariables:this.stackTop.tempVariables,evaluateOnly:t,finalIter:!0}),this.execute(),0<(e=n.find("tw-error")).length?e:n},speculate:function(e,t,n){this.stack.unshift({evaluateOnly:n,finalIter:!0,tempVariables:_(x(y),{TwineScript_VariableStore:{type:"temp",name:n}}),speculativePassage:t});var r,n=this.evalReplay;return this.evalReplay=null,o.isPrototypeOf(e)?r=e.apply(this,{fail:!1,pass:!0}):e&&(r=a(this,e)),this.stack.shift(),this.evalReplay=n,r},renderInto:function(e,a,t){var o=this,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,i=g.create({target:a,source:e,section:this,append:"append"});if(t)if(d.isPrototypeOf(t)){var e=t.run(i);if(b.containsError(e))return e.render(a.attr("title")).replaceAll(a),!1}else _(i,t);if((a=i.target,50<=this.stack.length)&&50<=this.stack.reduce(function(e,t){return e+!!t.finalIter},0))return b.create("infinite","Printing this expression may have trapped me in an infinite loop.").render(a.attr("title")).replaceAll(a),!1;var s=function(e,t,n){var r=a instanceof p&&a.is("tw-hook")&&0<a.parents("tw-collapsed,[collapsing=true]").length;o.stack.unshift({desc:e,finalIter:n,tempVariables:t,collapses:r,evaluateOnly:o.stackTop&&o.stackTop.evaluateOnly})},r=r||x(this.stack.length?this.stackTop.tempVariables:y),t=(hasOwnProperty.call(r,"TwineScript_VariableStore")||(t=null==(e=a)?void 0:e.tag(),r.TwineScript_VariableStore={type:"temp",name:"tw-hook"===t?a.attr("name")?"?"+a.attr("name"):"an unnamed hook":"tw-expression"===t?"a "+a.attr("type")+" expression":"tw-passage"===t?"this passage":"an unknown scope"}),null==(e=this.stackTop)?void 0:e.blocked);if(O(i.loopVars).length){var c=_objectSpread({},i.loopVars),l=Math.min.apply(Math,_toConsumableArray(O(c).map(function(e){return c[e].length})));if(v.create(l+" loop"+(1!==l?"s":"")).render().prependTo(a),l){for(var n=l-1;0<=n;--n)!function(n){s(i,O(c).reduce(function(e,t){return e[t]=c[t][n],e},x(r),n===l-1))}(n);for(var u=l-1;0<=u&&!this.stackTop.blocked;--u)this.execute()}}else s(i,r,!0),this.execute();return(0===this.stack.length||!t&&null!=(e=this.stackTop)&&e.blocked)&&this.updateEnchantments(),i.enabled},execute:function(){var a=this,e=this.stackTop,t=e.desc,n=e.dom,r=e.collapses,o=e.evaluateOnly;t&&!n&&(n=t.render(),this.stackTop.dom=n,this.stackTop.desc=void 0),n.findAndFilter('tw-hook,tw-expression,script[type="application/x-harlowe"]').each(function(e,t){var n=p(t).data();t.cachedData={blockers:n.blockers,code:n.code,source:n.source}}).each(function(e,t){if(a.stackTop.blocked)return!1;var n=t.cachedData;switch(n&&(t.cachedData=void 0),(t=p(t)).tag()){case"tw-hook":var r=t.popData("source")||(null==n?void 0:n.source);(r&&t.data("originalSource",r),t.data("tempVariables",a.stackTop.tempVariables),t.popAttr("hidden"))?t.data("hidden",!0):r&&a.renderInto(r,t);break;case"tw-expression":var r=t.data("blockers")||(null==n?void 0:n.blockers);if(r){if(o)return void t.removeData("blockers").removeData("code").replaceWith(b.create("syntax","I can't use a macro like (prompt:) or (confirm:) in ".concat(o,"."),"Please rewrite this without putting such macros here.").render(t.attr("title"),t));if(r.length)return a.stackTop.blocked=!0,r=a.eval(r.shift()),b.containsError(r)&&(a.stackTop.blocked=!1,t.removeData("blockers").replaceWith(r.render(t.attr("title"),t))),!1;t.removeData("blockers")}r=t.popData("code")||(null==n?void 0:n.code);r&&c.call(a,t,r);break;case"script":if(f.reattachStoryElement(),t.text())try{i(t.text(),a.stackTop.tempVariables)}catch(e){b.isPrototypeOf(e)?t.replaceWith(e.render(t.text(),t)):(null!=(r=window.console)&&r.error(e),t.replaceWith(b.create("","A Javascript error occurred while running this <script> element.",'The error was "'.concat(e,'". Check the browser console for more details.')).render(t.text(),t)))}}}),this.stackTop.blocked||(n.length&&r&&s(n),n.findAndFilter("tw-collapsed,[collapsing=true]").each(function(){s(p(this))}),setTimeout(function(){return n.find("input, textarea").first().focus()},100),this.stack.shift())},updateEnchantments:function(){this.enchantments.forEach(function(e){e.disenchant(),e.enchantScope()})},on:function(e,t){return l[e].push(t),this},addEnchantment:function(t){var n=this;this.enchantments.push(t),l.add.forEach(function(e){return e(n,t)})},removeEnchantment:function(t){var n=this,e=this.enchantments.indexOf(t);this.enchantments.splice(e,1),t.disenchant(),l.remove.forEach(function(e){return e(n,t)})},unblock:function(e){for(this.stack.length||f.impossible("Section.unblock","stack is empty"),this.stackTop.blocked=!1,void 0!==e&&(this.stackTop.blockedValues=(this.stackTop.blockedValues||[]).concat(e));this.stack.length&&!this.stackTop.blocked;)this.execute();if(!this.stack.length)for(;0<this.unblockCallbacks.length;){var t;if(this.unblockCallbacks.shift()(),null!=(t=this.stackTop)&&t.blocked)return}},whenUnblocked:function(e,t){this.stack.length&&this.stackTop.blocked?this.unblockCallbacks=this.unblockCallbacks.concat(e):(t||e)()},blockedValue:function(){var e=this.stackTop;return e?e.blockedValues&&e.blockedValues.length?e.blockedValues.shift():(f.impossible("Section.blockedValue","blockedValues is missing or empty"),0):(f.impossible("Section.blockedValue","stack is empty"),0)}})}),define("state",["jquery","utils","passages","datatypes/customcommand","utils/operationutils","markup"],function(n,y,b,v,e,t){var i,w,C=e.toSource,E=e.is,k=t.lex,o=Object.assign,h=Object.create,e=Object.defineProperty,N=Array.isArray,s=Math.imul,t=(e(Map.prototype,"toJSON",{value:void 0}),e(Set.prototype,"toJSON",{value:void 0}),["localStorage","sessionStorage"].map(function(e){try{return!!window[e]&&(window[e].setItem("test","1"),window[e].removeItem("test"),!0)}catch(e){return!1}}));function S(e,t){var n=0<arguments.length&&void 0!==e?e:String.fromCodePoint(Date.now()%1114112),e=1<arguments.length&&void 0!==t?t:0;i.seedIter=e,i.seed=n;for(var r,a=0,o=2166136261;a<n.length;a+=1)r=s(n.charCodeAt(a),3432918353),o^=s(r<<15|r>>>17,461845907),o=s(o=o<<13|o>>>19,5)+3864292196|0;return o^=n.length,o=s(o^=o>>>16,2246822507),o=s(o^=o>>>13,3266489909),o=((o^=o>>>16)>>>0)+1831565813*e,function(){i.seedIter+=1;var e=o+=1831565813,e=s(e^e>>>15,1|e);return(((e^=e+s(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296}}function r(e,t){for(var n,r=t.variables,a=h(null),o=e.length-1;0<=o;--o){for(var i,s,c=e[o],l=0,u=["mockVisits","mockTurns","seed","seedIter"];l<u.length;l++){var p=u[l];hasOwnProperty.call(c,p)&&!hasOwnProperty.call(t,p)&&(t[p]=c[p])}for(i in c.forgetVisits&&(t.forgetVisits=Math.max(t.forgetVisits||0,c.forgetVisits)),void 0!==c.turns&&(t.turns=(t.turns||0)+c.turns),t.pastVisits||(t.pastVisits=[]),o!==e.length-1&&(void 0!==e[o+1].visits&&Array.isArray(t.pastVisits[0])?t.pastVisits[0]:t.pastVisits).unshift(c.passage),void 0!==c.pastVisits&&t.pastVisits.unshift(c.pastVisits),void 0!==c.visits&&t.pastVisits.unshift(c.visits),c.variables)if("TwineScript_TypeDefs"===i)for(var d in r[i]||(r[i]=h(null)),c.variables[i])r[i][d]||(r[i][d]=c.variables[i][d]);else i.startsWith("TwineScript_")||i in r||(null===c.variables[i]&&(a[i]=!0),a[i])||(r[i]=c.variables[i],!(s=c.valueRefs[i]))||"via"in s||t.valueRefs[i]||(t.valueRefs[i]=s)}for(n in t.valueRefs){var f=t.valueRefs[n];f&&"via"in f&&delete t.valueRefs[n]}}var a,c={passage:"",variables:h(null),visits:void 0,turns:void 0,seed:void 0,seedIter:void 0,mockVisits:void 0,mockTurns:void 0,forgetVisits:void 0,create:function(e){var t=h(c);return t.passage=e||"",t.variables=h(null),t.valueRefs=h(null),t}},l={forward:[],back:[],load:[],beforeForward:[],beforeBack:[],beforeLoad:[],forgetUndos:[]},u=[],p=-1,d=c.create(),f="";function m(){i.history=i.pastVisits.slice(i.forgetVisits).reduce(function(e,t){return e.concat(t)},[]),i.mockVisits&&(i.history=i.mockVisits.concat(i.history))}function g(){var e=c.create();e.pastVisits=[],o(e.variables,{TwineScript_ObjectName:"this story's variables",TwineScript_TypeDefs:h(null),TwineScript_VariableStore:{type:"global",name:"this story's variables"},TwineScript_Delete:function(e){delete this[e],d.variables[e]=null,delete d.valueRefs[e]},TwineScript_Set:function(e,t,n){if(this[e]=t,d.variables[e]=t,n)d.valueRefs[e]=n;else if((N(t)||t instanceof Map||t instanceof Set||"string"==typeof t)&&!y.options.uncompressedStructures)for(var r=p;0<=r;--r){var a=u[r].variables[e];if(void 0!==a){a=function e(t,n,r){var a="it"===r?"its":r+"'s",o="";if(N(n)&&N(t)&&n.length){for(var i=n.length===t.length,o="(a:",s=0;s<n.length;s+=1){var c,l,u,p=n[s];E(p,t[s])?(c=C(p),l="".concat(a," ").concat(s+1,"th"),o+=(c.length<l.length?c:l)+","):(i=!1,-1<(c=t.indexOf(p))?(l=C(p),u="".concat(a," ").concat(c+1,"th"),o+=(l.length<u.length?l:u)+","):o+=e(t[s],p,"".concat(a," ").concat(s+1,"th"))+",")}o=i?r:o.slice(0,-1)+")"}else if(n instanceof Map&&t instanceof Map&&n.size){var d,f=n.size===t.size,h=(o="(dm:",_createForOfIteratorHelper(n.entries()));try{for(h.s();!(d=h.n()).done;){var m,g,y=_slicedToArray(d.value,2),b=y[0],v=y[1];o+="".concat(C(b),","),E(v,t.get(b))?(m=C(v),g="".concat(a," (").concat(C(b),")"),o+=(m.length<g.length?m:g)+","):(f=!1,o+=e(t.get(b),v,"".concat(a," (").concat(C(b),")"))+",")}}catch(e){h.e(e)}finally{h.f()}o=f?r:o.slice(0,-1)+")"}else if(n instanceof Set&&t instanceof Set&&n.size){var w,k=new Set,S=new Set,T=_createForOfIteratorHelper(t);try{for(T.s();!(w=T.n()).done;){var _=w.value;n.has(_)||k.add(_)}}catch(e){T.e(e)}finally{T.f()}var x,O=_createForOfIteratorHelper(n);try{for(O.s();!(x=O.n()).done;){var A=x.value;t.has(A)||S.add(A)}}catch(e){O.e(e)}finally{O.f()}k.size||S.size||(o=r),o=k.size+S.size>n.size?C(n):r+(S.size?"+"+C(S):"")+(k.size?"-"+C(k):"")}else"string"==typeof n&&"string"==typeof t&&n&&(n.startsWith(t)?o=r+"+"+C(n.slice(t.length)):n.endsWith(t)&&(o=C(n.slice(0,n.length-t.length))+"+"+r));return o?"it"===r?{via:o}:o:"it"===r?void 0:C(n)}(a,t,"it");a&&("it"===a.via?delete d.variables[e]:d.valueRefs[e]=a);break}}},TwineScript_GetProperty:function(e){return this[e]},TwineScript_DefineType:function(e,t){this.TwineScript_TypeDefs[e]=t,hasOwnProperty.call(d.variables,"TwineScript_TypeDefs")||(d.variables.TwineScript_TypeDefs=h(null)),d.variables.TwineScript_TypeDefs[e]=t}}),r(u.slice(0,p+1),e),i=e,m(),w=S(e.seed,e.seedIter)}function T(e){d=c.create(e);e=a.serialise(!0),f=e.past,e=e.pastAndPresent;if(a.hasSessionStorage&&"string"==typeof e)try{sessionStorage.setItem("Saved Session",e)}catch(e){}}function _(e,t,n,r){for(var a in r)if(hasOwnProperty.call(r,a)&&!a.startsWith("TwineScript_"))if("object"===_typeof(r[a]))if(hasOwnProperty.call(r[a],"at")){n.valueRefs[a]=r[a];var o=r[a],i=o.at,s=o.from,c=o.to,l=o.hash,u=o.seed,p=o.seedIter,o=o.blockedValues;if(!b.has(i))throw Error('The data refers to a passage named `"'.concat(n.passage,"\"`, but it isn't in this story."));var d=b.get(i).get("source"),f=d.slice(s,c);if(void 0!==l)for(var h=0,m=c-s;y.hash(f).toString(16)!==l;){if(h+m>=d.length)throw Error("The value (or type) of the variable `$".concat(a,"` couldn't be found in the passage `\"").concat(i,'"`.'));(h+=1)===s&&(h+=1),f=d.slice(h,h+m)}c=k(f,"","macro");void 0!==u&&void 0!==p&&(w=S(u,p)),void 0!==o&&(e.stackTop.blockedValues=o,c.forEach(function e(t){var n;"string"!==t.type&&"hook"!==t.type&&t.children.every(e),"macro"!==t.type||"prompt"!==(n=y.insensitiveName(t.name))&&"confirm"!==n||(t.blockedValue=!0)})),r[a]=e.eval(c)}else if(hasOwnProperty.call(r[a],"via")){for(var g=t.length-1;0<=g;--g)if(hasOwnProperty.call(t[g].variables,a)){e.Identifiers.it=t[g].variables[a];break}r[a]=e.eval(k(r[a].via,"","macro")),e.Identifiers.it=0}else hasOwnProperty.call(r[a],"changer")&&(r[a].changer=e.eval(k(r[a].changer,"","macro")),r[a].hook=e.eval(k(r[a].hook,"","macro")),_(e,t,n,r[a].variables),r[a]=v.create(r[a]));else r[a]=e.eval(k(r[a],"","macro"));else"TwineScript_MockVisits"===a&&(n.mockVisits=r[a])}return g(),d.seed=i.seed,d.seedIter=0,(a={get passage(){return d.passage},get variables(){return i.variables},get pastLength(){return p},get turns(){return p+1+(i.turns||0)+(i.mockTurns||0)},get futureLength(){return u.length-1-p},get mockVisits(){return i.mockVisits||[]},set mockVisits(e){i.mockVisits=e,d.mockVisits=e,m()},get mockTurns(){return i.mockTurns||0},set mockTurns(e){i.mockTurns=e,d.mockTurns=e},history:function(){return i.history},forgetUndos:function(e){e<0&&(e=u.length+e);var t,e=u.splice(0,Math.min(u.length-1,e));e.length&&(p=u.length-1,t=u[0],r(e,t),t.pastVisits.push(e[e.length-1].passage),t.turns=(t.turns||0)+e.length,i.turns=(i.turns||0)+e.length,t.forgetVisits&&(t.pastVisits=t.pastVisits.slice(t.forgetVisits-t.turns),t.forgetVisits-=t.turns),f="",0===p&&n("tw-link[undo], tw-icon[alt='Undo']",y.storyElement).each(function(e,t){(n(t).closest("tw-expression, tw-hook").data("forgetUndosEvent")||Object)(t)}),l.forgetUndos.forEach(function(e){return e()}))},forgetVisits:function(e){(e=e<0?u.length+e:e)>p+i.turns&&(e=p+i.turns),d.forgetVisits=i.forgetVisits=Math.max(i.forgetVisits||0,e),m()},passageNameVisited:function(e){var t=0;if(!b.get(e))return 0;for(var n=0;n<i.history.length;n++)t+=+(e===i.history[n]);return t},get timeline(){return u},play:function(t){var e;d||y.impossible("State.play","present is undefined!"),l.beforeForward.forEach(function(e){return e()}),d.passage&&((null!=(e=d.visits)&&e.length&&Array.isArray(i.pastVisits[i.pastVisits.length-1])?i.pastVisits[i.pastVisits.length-1]:i.pastVisits).push(d.passage),i.history.push(d.passage)),d.passage=t,u=u.slice(0,p+1).concat(d),p+=1,T(t),l.forward.forEach(function(e){return e(t)})},redirect:function(e){var t;d||y.impossible("State.redirect","present is undefined!"),d.passage&&(null!=(t=d.visits)&&t.length&&Array.isArray(i.pastVisits[i.pastVisits.length-1])?i.pastVisits[i.pastVisits.length-1].push(d.passage):i.pastVisits.push([d.passage]),i.history.push(d.passage)),d.visits=(d.visits||[]).concat(e),d.passage=e},rewind:function(e){for(var t=void 0!==e?e:1,n=!1;0<t&&0<p;t--)n=!0,--p;return n&&(l.beforeBack.forEach(function(e){return e()}),f="",T(u[p].passage),g(),l.back.forEach(function(e){return e()})),n},fastForward:function(e){var t=1,n=!1;for("number"==typeof e&&(t=e);0<t&&0<u.length;t--)n=!0,p+=1;return n&&(l.beforeForward.forEach(function(e){return e()}),T(u[p].passage),g(),l.forward.forEach(function(e){return e(u[p].passage,"fastForward")})),n},on:function(e,t){if(e in l)return"function"!=typeof t||l[e].includes(t)||l[e].push(t),a;y.impossible("State.on","invalid event name")},reset:function(){l.beforeLoad.forEach(function(e){return e()}),u=[],p=-1,g(),(d=c.create()).seed=i.seed,d.seedIter=0,f="",w=S(),l.load.forEach(function(e){return e(u)})},hasStorage:t[0],hasSessionStorage:t[1],setSeed:function(e){w=S(e),d.seed=i.seed,d.seedIter=0},get seed(){return i.seed},get seedIter(){return i.seedIter},random:function(){var e=w();return d.seedIter=i.seedIter,e},shuffled:function(){for(var a=this,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce(function(e,t,n){var r=a.random()*(n+1)|0;return r===n?e.push(t):(e.push(e[r]),e[r]=t),e},[]);return d.seedIter=i.seedIter,r}}).serialise=function(e){function o(e,t){if("TwineScript_TypeDefs"===t){var n,r={};for(n in e[t])r[n]=C(e[t][n]);return r}var a;return null===e[t]?null:e[t]&&hasOwnProperty.call(e[t],"TwineScript_CustomCommand")?(a=e[t].TwineScript_CustomCommand(),{changer:C(a.changer),toSource:a.toSource,hook:C(a.hook),variables:Object.keys(a.variables).reduce(function(e,t){return e[t]=o(a.variables,t),e},{})}):C(e[t])}function t(e,t){if(c.isPrototypeOf(t)&&void 0===t.visits&&void 0===t.turns&&void 0===t.mockVisits&&void 0===t.forgetVisits&&void 0===t.pastVisits&&void 0===t.mockTurns&&void 0===t.seed&&void 0===t.seedIter&&Object.keys(t.variables).every(function(e){return e.startsWith("TwineScript_")}))return t.passage;if(!c.isPrototypeOf(this)||"valueRefs"!==e){if(c.isPrototypeOf(this)&&"variables"===e){var n,r={};for(n in this.variables)this.valueRefs[n]?r[n]=this.valueRefs[n]:r[n]=o(this.variables,n);return r}return t}}var e=u.slice(f?e?p-1:p:0,p+1),n=e.slice(0,-1),r=f;try{return{past:r=n.length?(r?r.slice(0,-1)+",":"[")+JSON.stringify(n,t).slice(1):r,pastAndPresent:r.slice(0,-1)+(r?",":"[")+JSON.stringify(e.slice(-1),t).slice(1)}}catch(e){return{past:!1,pastAndPresent:!1}}},a.deserialise=function(e,t){var n;try{n=JSON.parse(t)}catch(e){return Error("The save data is unintelligible.")}if(!N(n))return Error("The save data isn't a sequence of past turns.");for(var r=0;r<n.length;r+=1){var a=n[r];if("string"==typeof a)a={passage:a,variables:{}};else if("object"!==_typeof(a)||!hasOwnProperty.call(a,"variables")){n.splice(r--,1);continue}if(a.valueRefs=h(null),a.variables=o(h(null),a.variables),!b.hasValid(a.passage))return Error('The data refers to a passage named `"'.concat(a.passage,"\"`, but it isn't in this story."));if(hasOwnProperty.call(a.variables,"TwineScript_TypeDefs"))try{_(e,n.slice(0,r),a,a.variables.TwineScript_TypeDefs)}catch(e){return Error("The variable types on turn ".concat(r+1," couldn't be reconstructed.").concat(e.message?" (".concat(e.message,")"):""))}try{_(e,n.slice(0,r),a,a.variables)}catch(e){return Error("The variables on turn ".concat(r+1," couldn't be reconstructed.").concat(e.message?" (".concat(e.message,")"):""))}n[r]=o(h(c),a)}return p=(u=n).length-1,l.load.forEach(function(e){return e(u)}),f="",g(),T(u[p].passage),!0},Object.seal(c),Object.freeze(a)}),define("utils",["jquery","markup","utils/polyfills"],function(d){var r=String.fromCharCode,n="audio,blockquote,canvas,div,h1,h2,h3,h4,h5,hr,ol,p,pre,table,ul,video,tw-align,tw-story,tw-passage,tw-sidebar,tw-columns,tw-column,tw-meter".split(","),a="a,b,i,em,strong,sup,sub,abbr,acronym,s,strike,del,big,small,script,img,button,input,tw-link,tw-broken-link,tw-verbatim,tw-collapsed,tw-error,tw-colour,tw-icon".split(","),f=["audio"],e=_slicedToArray([function(e){return r(e)!==r(e).toLowerCase()},function(e){return r(e)!==r(e).toUpperCase()},function(e){return r(e).toLowerCase()!==r(e).toUpperCase()}].map(function(e){return"["+Array.from(Array(57343)).map(function(e,t){return t}).filter(e).map(function(e,t,n){return e===n[t-1]+1&&e===n[t+1]-1?"-":r(e)}).join("").replace(/-+/g,"-")+"]"}),3),t=e[0],o=e[1],e=e[2];function s(e){return"instant"===e?0:800}var i,c,l=[],u={},p=0,h={},m=0,g={};function y(n,r,e,a,o){var i=null,s=0,c=r+e;function l(e){var t;1&n[0].compareDocumentPosition(document)&&(c=0),i&&(c-=t=e-i),i=e,0<a&&0<p+m&&n.data("expediteAnim")(a),c<=r&&(s+=t||0,"paused"===n.css("animation-play-state"))&&n.css({visibility:"","animation-play-state":"running"}),c<=0?(n.removeData("expediteAnim"),o()):requestAnimationFrame(l)}n.data("expediteAnim",function(e){var t;c-=e=void 0===e?s:e,"running"===n.css("animation-play-state")&&n.css("animation-delay",(("ms"===(t=(t=n.css("animation-delay")).toLowerCase()).slice(-2)?+t.slice(0,-2)||0:"s"===t.slice(-1)&&1e3*+t.slice(0,-1)||0)||0)-e+"ms")}),c?requestAnimationFrame(l):l()}d(document.documentElement).on("keydown keyup mousedown mouseup",function(e){var t=e.key,n=e.button,e=e.type.includes("down"),r=t?u:h,n=t&&v.insensitiveName(t)||n;r[n]&&!e?t?p=Math.max(p-1,0):m=Math.max(m-1,0):!r[n]&&e&&(t?p+=1:m+=1),r[n]=e}).on("mousemove",function(e){var t=e.pageX,e=e.pageY;g.x=t,g.y=e});var b=/-|_/g,v={hash:function(e){for(var t=9,n=e.length;0<n;)--n,t=Math.imul(t^e.charCodeAt(n),Math.pow(9,9));return(t^t>>>9)>>>0},permutations:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r,a,o=t.length,i=[[].concat(t)],s=Array(o).fill(0),c=1;c<o;)s[c]<c?(r=c%2&&s[c],a=t[c],t[c]=t[r],t[r]=a,++s[c],c=1,i.push([].concat(t))):(s[c]=0,++c);return i},nth:function(e){var t=+e+"";return e+("1"!==t[t.length-1]||1!==t.length&&"1"===t[t.length-2]?"2"!==t[t.length-1]||1!==t.length&&"1"===t[t.length-2]?"3"!==t[t.length-1]||1!==t.length&&"1"===t[t.length-2]?"th":"rd":"nd":"st")},plural:function(e,t,n){return e+" "+(1!==Math.abs(e)?n||t+"s":t)},andList:function(e){return e.length<=1?e[0]:e.slice(0,-1).join(", ")+" and "+e[e.length-1]},realWhitespace:"[ \\n\\r\\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]",anyRealLetter:"[\\dA-Za-z\\u00c0-\\u00de\\u00df-\\u00ff\\u0150\\u0170\\u0151\\u0171\\uD800-\\uDFFF]",anyUppercase:t,anyLowercase:o,anyCasedLetter:e,anyNewline:"(?:\\n|\\r|\\r\\n)",unescape:function(e){return e.replace(/&(?:amp|lt|gt|quot|nbsp|zwnj|#39|#96);/g,function(e){return{"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#39;":"'","&nbsp;":String.fromCharCode(160),"&zwnj;":String.fromCharCode(8204)}[e]})},escape:function(e){return e.replace(/[&><"']/g,function(e){return{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"}[e]})},insensitiveName:function(e){return(e+"").toLowerCase().replace(b,"")},allKeysDown:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every(function(e){return u[e]})},someKeysDown:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(function(e){return u[e]})},buttonsDown:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every(function(e){return h[e]})},anyInputDown:function(){return 0<p+m},mouseCoords:g,parentColours:function(e){for(var t,n={colour:null,backgroundColour:null},r=/^\w+a\(.+?,\s*0\s*\)$|^transparent$/;e.length&&e[0]!==document;e=e.parent())if(n.backgroundColour||(t=e.css("background-color")).match(r)||(n.backgroundColour=t),n.colour||(t=e.css("color")).match(r)||(n.colour=t),n.colour&&n.backgroundColour)return n;return{colour:"#fff",backgroundColour:"#000"}},childrenProbablyInline:function(e){var t=[];return[].every.call(e.findAndFilter("*"),function(e){if(!(e.hidden||/none|inline/.test(e.style.display)||/display: (none|inline)/.test(e.getAttribute("style")))){if(n.includes(e.tagName.toLowerCase())||/display: (?!none|inline|inherit|unset)/.test(e.getAttribute("style")))return!1;a.includes(e.tagName.toLowerCase())||t.push(e)}return!0})&&t.every(function(e){return/inline|none/.test(window.getComputedStyle(e).display)})},transitionOut:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,i=6<arguments.length&&void 0!==arguments[6]?arguments[6]:void 0;0!==e.length&&(n=n||s(t),!(1<e.length)&&v.childrenProbablyInline(e)&&["tw-hook","tw-passage","tw-sidebar","tw-expression"].includes(e.tag())||(e=e.wrapAll("<tw-transition-container>").parent()),i&&e.css("transform-origin",i),e.attr("data-t8n",t).addClass("transition-out").css({"animation-duration":"".concat(n,"ms"),"animation-delay":"".concat(-o,"ms"),"animation-play-state":"paused"}),requestAnimationFrame(function(){v.childrenProbablyInline(e)?e.css("display","inline"):e.parent().is("tw-backdrop,tw-story")||e[0].setAttribute("style",e[0].getAttribute("style")+"display:block !important;width:100%")}),y(e,n,r-o,a,function(){e.remove()}))},transitionIn:function(u,e,t){var p,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:void 0;0!==u.length&&(t=t||s(e),(p=1<u.length||!v.childrenProbablyInline(u)||!["tw-hook","tw-passage","tw-sidebar","tw-expression"].includes(u.tag()))&&(u=u.wrapAll("<tw-transition-container>").parent()),o&&u.css("transform-origin",o),u.attr("data-t8n",e).addClass("transition-in").css(_objectSpread({"animation-duration":"".concat(t,"ms"),"animation-delay":"".concat(-a,"ms")},n-a?{visibility:"hidden","animation-play-state":"paused"}:{})),requestAnimationFrame(function(){v.childrenProbablyInline(u)?u.css("display","inline"):u.parent().is("tw-backdrop,tw-story")||u[0].setAttribute("style",u[0].getAttribute("style")+"display:block !important;width:100%")}),y(u,t,n-a,r,function(){var e=0===u.filter(f.join(",")).length;if(p&&e){u.find("tw-transition-container, .transition-in, .transition-out").each(function(e,t){((t=d(t)).data("expediteAnim")||Object)()});for(var t=[],n=u.find("*"),r=0;r<n.length;r+=1){var a=n[r];0===a.scrollTop&&0===a.scrollLeft||t.push([a,a.scrollLeft,a.scrollTop])}e=u.find(document.activeElement);u.contents().unwrap();for(var o=0,i=t;o<i.length;o++){var s=_slicedToArray(i[o],3),c=s[0],l=s[1],s=s[2];c.scrollLeft=l,c.scrollTop=s}e.length&&e[0].focus()}else u.removeClass("transition-in").removeAttr("data-t8n")}))},debounce:function(e){function t(){300<Date.now()-l||s<=u?(u=n=0,p=!i,o?(e(c),c=[]):e.apply(void 0,_toConsumableArray(c)),p=!1):n=requestAnimationFrame(t)}var n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=r.batch,o=void 0!==a&&a,a=r.recur,i=void 0!==a&&a,a=r.maxWait,s=void 0===a?1/0:a,c=[],l=0,u=0,p=!1;return function(){var e;p||(e=Date.now(),u+=e-l,l=e,o?c.push(arguments):c=arguments,n&&cancelAnimationFrame(n),n=requestAnimationFrame(t))}},impossible:function(e,t){window.console&&console.error(e+"(): "+t)},onStartup:function(e){l?l.push(e):e()},get storyElement(){return i},detachStoryElement:function(){document.documentElement.contains(i[0])&&(c=i.parent(),i.detach())},reattachStoryElement:function(){document.documentElement.contains(i[0])||(c||d(document.body)).append(i.parents().length?i.parents().last():i)},options:{speedMultiplier:1}};return d(function(){i=d("tw-story"),l.forEach(function(e){return e()}),l=null}),Object.freeze(v)}),define("datatypes/assignmentrequest",["utils/operationutils","datatypes/typedvar","datatypes/datatype","internaltypes/varref","internaltypes/twineerror"],function(e,y,b,v,w){var k=e.objectName,S=e.matches,t=e.toSource;return Object.freeze({assignmentRequest:!0,TwineScript_TypeName:"a VariableToValue (a 'to' or 'into' expression)",TwineScript_ObjectName:"a VariableToValue (a 'to' or 'into' expression)",TwineScript_ToSource:function(){return"into"===this.operator?"".concat(t(this.src)," ").concat(this.operator," ").concat(t(this.dest)):"".concat(t(this.dest)," ").concat(this.operator," ").concat(t(this.src))},TwineScript_Unstorable:!0,set:function(){var e,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=[],r=function e(t,n,r){var a=!(2<arguments.length&&void 0!==r)||r,o=[],i=n&&v.isPrototypeOf(n)?n.get():n;if(w.containsError(i))return i;if(Array.isArray(i)&&Array.isArray(t)){for(var s=0,c=0;s<t.length&&c<i.length;){var l=t[s],u=i[c];if(y.isPrototypeOf(l)&&l.datatype.rest||b.isPrototypeOf(l)&&l.rest){for(var p=c;c<i.length&&S(l,u);)u=i[c+=1];y.isPrototypeOf(l)?l.datatype=[l.datatype]:b.isPrototypeOf(l)&&(l=b.create("array")),o=o.concat(e(l,v.isPrototypeOf(n)?v.create(n,{first:p+1,last:c+1}):i.slice(p,c)))}else o=o.concat(e(l,v.isPrototypeOf(n)?v.create(n,c+1):u)),c+=1;s+=1}return s<t.length?a&&w.create("operation","I can't unpack this array because it needs ".concat(t.length-s," more value").concat(0<t.length-s?"s":"",".")):o}if(t instanceof Map&&i instanceof Map){var d,f=_createForOfIteratorHelper(t.entries());try{for(f.s();!(d=f.n()).done;){var h=_slicedToArray(d.value,2),m=h[0],g=h[1];if(!i.has(m))return a&&w.create("operation","I can't unpack this datamap because it needs a '"+m+"' data name.");o=o.concat(e(g,v.isPrototypeOf(n)?v.create(n,m):i.get(m)))}}catch(e){f.e(e)}finally{f.f()}return o}if(y.isPrototypeOf(t)){if("function"==typeof t.datatype.destructure)return[{dest:t,value:i,src:n}].concat(t.datatype.destructure(i));if(!S(i,t.datatype))return a&&w.create("operation","I can't put ".concat(k(i)," into ").concat(t.varRef.TwineScript_ToSource()," because it doesn't match ").concat(t.varRef.TwineScript_ToSource(),"'s datatype, ").concat(k(t.datatype),"."));o=o.concat(e(t.datatype,i))}return v.isPrototypeOf(t)||y.isPrototypeOf(t)?o.concat({dest:t,value:i,src:n}):"function"==typeof t.destructure?o.concat(t.destructure(i)):S(i,t)?o:a&&w.create("operation","I tried to unpack, but "+k(t)+" in the pattern didn't match "+k(i)+".")}(this.dest,this.src);if(e=w.containsError(r))return e;if(!r.length)return w.create("operation","I can't store a new value inside "+k(this.dest)+" that isn't in a variable.","You need a variable, or a data structure containing variables at certain positions, to store the value.");var a,o=_createForOfIteratorHelper(r.reverse());try{for(o.s();!(a=o.n()).done;){var i=a.value,s=i.dest,c=i.value,l=i.src;if(y.isPrototypeOf(s)){if(e=w.containsError(s.defineType()))return e;s=s.varRef}if(e=s.set(c,this.srcRef),w.isPrototypeOf(e))return e;t&&l&&l.delete(),n.shift(k(s)+" is now "+k(c))}}catch(e){o.e(e)}finally{o.f()}return n.join("; ")},create:function(e,t,n,r){return w.containsError(e)?e:w.containsError(t)?t:Object.assign(Object.create(this),{dest:e,src:t,operator:n,srcRef:r})}})}),define("datatypes/changercommand",["utils","utils/operationutils","internaltypes/changedescriptor","internaltypes/twineerror"],function(e,t,n,r){var i=e.plural,a=e.impossible,o=t.is,s=t.toSource,c={},l={TwineScript_TypeID:"changer",TwineScript_TypeName:"a changer",TwineScript_Print:function(){return"`[A ("+this.macroName+":) changer]`"},TwineScript_ToSource:function(){return"("+this.macroName+":"+("else"===this.name?"":this.params.map(s))+")"+(this.next?"+"+this.next.TwineScript_ToSource():"")},get TwineScript_ObjectName(){1===this.params.length&&36<(e=s(this.params[0])).length&&(e=void 0);for(var e,t="a (".concat(this.macroName,":").concat(e||"",") changer"),n=this.next,r=(n&&(t+=" combined with "),0);n&&t.length<48;){var a="(".concat(n.macroName,":)");t+=(0<r&&!n.next?" and ":"")+a+(n.next?", ":""),n=n.next,r+=1}for(var o=0;n&&o<99;)n=n.next,o+=1;return 0<o&&(t+="".concat(0<r?" and ":"").concat(i(o,"other changer"))),t},summary:function(){var e=n.create();return this.run(e),e.summary()},create:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,r=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];return Array.isArray(t)||a("ChangerCommand.create","params was not an array but "+t),Object.assign(Object.create(this),{macroName:e,params:t,next:n,canEnchant:r})},"TwineScript_+":function(e){for(var t=this.TwineScript_Clone(),n=t;n.next;)n=n.next;return n.next=e,t.canEnchant=this.canEnchant&&e.canEnchant,t},TwineScript_is:function(e){if(l.isPrototypeOf(e))return this.macroName===e.macroName&&o(this.params,e.params)&&o(this.next,e.next)},TwineScript_Clone:function(){for(var e=l.create(this.macroName,this.params,this.next),t=e;t.next;)t=t.next=t.next.TwineScript_Clone();return e.canEnchant=this.canEnchant,e},run:function(e,t){var n="output"===this.macroName?[t||this]:this.params,n=c[this.macroName].apply(c,[e].concat(_toConsumableArray(n)));if(r.containsError(n))return n;this.next&&this.next.run(e,t||this)},register:function(e,t){c[e]=t}};return Object.freeze(l)}),define("datatypes/codehook",[],function(){var t=Object.freeze({TwineScript_TypeName:"a code hook",TwineScript_ObjectName:"a code hook",TwineScript_ToSource:function(){return this.source},TwineScript_Print:function(){return this.code},TwineScript_toString:function(){return this.source},TwineScript_is:function(e){return t.isPrototypeOf(e)&&this.source===e.source},TwineScript_Clone:function(){return t.create(this.code,this.source)},create:function(e,t){return Object.assign(Object.create(this),{code:e,source:t})}});return t}),define("datatypes/colour",["jquery"],function(c){var l=Math.max,u=Math.min,a=Math.sin,o=Math.cos,i=Math.pow,p=Math.round,d=Math.floor,s=Math.atan2,f=Math.cbrt,h=Math.sqrt,m=Math.PI,g=Object.assign,y=Object.create,b=/^([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,t=/^([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,v=y(null);function w(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(0<r.length)return w.apply(void 0,[w(e,t)].concat(r));if(!t)return e;for(var o=[],i=0;i<e.length;i++){o[i]=[];for(var s=0;s<t[0].length;s++){for(var c=0,l=0;l<e[0].length;l++)c+=e[i][l]*t[l][s];o[i][s]=c}}return o}function n(e){var t,n=e.r,r=e.g,a=e.b,e=e.a,o=l(n/=255,r/=255,a/=255),i=u(n,r,a),s=(o+i)/2,c=o-i;if(o===i)return{h:0,s:0,l:s};switch(o){case n:t=(r-a)/c+(r<a?6:0);break;case r:t=(a-n)/c+2;break;case a:t=(n-r)/c+4}return{h:t=p(60*t),s:.5<s?c/(2-o-i):c/(o+i),l:s,a:e}}var k=[.9642956764295677,1,.8251046025104602],S=24389/27,T=216/24389,_=function(e){return e.map(function(e){return[e]})},x=function(e){return e.map(function(e){return e[0]})};function O(e){var t=e.l,n=e.c,r=e.h,e=e.a,n=[t*=100,n*o(r*m/180),n*a(r*m/180)],r=[];r[1]=(n[0]+16)/116,r[0]=n[1]/500+r[1],r[2]=r[1]-n[2]/200;n=[i(r[0],3)>T?i(r[0],3):(116*r[0]-16)/S,S*T<t?i((16+t)/116,3):t/S,i(r[2],3)>T?i(r[2],3):(116*r[2]-16)/S].map(function(e,t){return e*k[t]}),t=_slicedToArray(x(w([[3.2409699419045226,-1.537383177570094,-.4986107602930034],[-.9692436362808796,1.8759675015077202,.04155505740717559],[.05563007969699366,-.20397695888897652,1.0569715142428786]],w([[.9554734527042182,-.023098536874261423,.0632593086610217],[-.028369706963208136,1.0099954580058226,.021041398966943008],[.012314001688319899,-.020507696433477912,1.3303659366080753]],_(n)))).map(function(e){return u(255,l(0,255*(.0031308<(e=e)?1.055*i(e,1/2.4)-.055:12.92*e)))}),3);return{r:t[0],g:t[1],b:t[2],a:e}}function e(e){function t(e){return 1e-5<=n[e]&&n[e]<=255-1e-5}var n=O(e);if(Object.keys(n).every(t))return n;var r=(e=_objectSpread({},e)).c,a=0;for(e.c/=2;1e-5<r-a;)n=O(e),Object.keys(n).every(t)?a=e.c:r=e.c,e.c=(r+a)/2;return O(e)}var A=Object.freeze({TwineScript_TypeID:"colour",TwineScript_TypeName:"a colour",TwineScript_ObjectName:"a colour",TwineScript_DebugName:function(){return"a colour "+this.TwineScript_Print()},"TwineScript_+":function(e){var t=this.toRGBA(),e=e.toRGBA();return A.create({r:u(p(.6*(t.r+e.r)),255),g:u(p(.6*(t.g+e.g)),255),b:u(p(.6*(t.b+e.b)),255),a:(t.a+e.a)/2})},TwineScript_Print:function(){var e=this.toRGBA();return"<tw-colour style='background-color:rgba("+[e.r,e.g,e.b,e.a]+");'></tw-colour>"},TwineScript_is:function(e){var t;return!!A.isPrototypeOf(e)&&(e.lcha&&this.lcha?e.lcha.l===this.lcha.l&&e.lcha.c===this.lcha.c&&e.lcha.h===this.lcha.h&&e.a===this.a:(t=this.toRGBA(),(e=e.toRGBA()).r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a))},TwineScript_Clone:function(){return A.create(this)},toRGBAString:function(){var e=this.toRGBA(),t=e.r,n=e.g,r=e.b,e=e.a;return"rgba(".concat(t,", ").concat(n,", ").concat(r,", ").concat(e,")")},toHSLA:function(){return n(this.toRGBA())},toRGBA:function(){return this.lch?e(_objectSpread({a:this.a},this.lch)):this},toLCHA:function(){return this.lch?_objectSpread({a:this.a},this.lch):(t=(e=this).r,n=e.g,r=e.b,e=e.a,n=[116*(t=x(w([[1.0479298208405488,.022946793341019088,-.05019222954313557],[.029627815688159344,.990434484573249,-.01707382502938514],[-.009243058152591178,.015055144896577895,.7518742899580008]],w([[.41239079926595934,.357584339383878,.1804807884018343],[.21263900587151027,.715168678767756,.07219231536073371],[.01933081871559182,.11919477979462598,.9505321522496607]],_([t/255,n/255,r/255].map(function(e){return e<.04045?e/12.92:i((e+.055)/1.055,2.4)}))))).map(function(e,t){return e/k[t]}).map(function(e){return T<e?f(e):(S*e+16)/116}))[1]-16,500*(t[0]-t[1]),200*(t[1]-t[2])],r=180*s(n[2],n[1])/m,{l:n[0]/100,c:h(i(n[1],2)+i(n[2],2)),h:0<=r?r:360+r,a:e});var e,t,n,r},LCHRotate:function(e){e<0&&(e=360+e);var t=this.toLCHA();return t.h=(t.h+e)%360,A.create(t)},TwineScript_GetProperty:function(e){var t;return"lch"===e?(t=this.toLCHA(),new Map([["l",t.l],["c",t.c],["h",t.h]])):(t=this.toRGBA(),"h"===e||"s"===e||"l"===e?n(t)[e]:"r"===e||"g"===e||"b"===e||"a"===e?t[e]:void 0)},TwineScript_Properties:["h","s","l","r","g","b","a","lch"],TwineScript_ToSource:function(){if(0===this.a)return"transparent";var e=!this.lch&&n(this);if(1===e.l&&!e.h&&!e.s)return"white";if(0===e.l&&!e.h&&!e.s)return"black";if(.5<=e.l&&e.l<.5334&&0===e.s)return"gray";if(.5===e.l&&.8<=e.s&&e.s<.804){var t={0:"red",30:"orange",60:"yellow",90:"lime",120:"green",180:"cyan",210:"blue",240:"navy",270:"purple",300:"magenta"}[e.h];if(t)return t}return"(".concat(this.lch?"lch":"hsl",":").concat(this.lch?[this.lch.l,this.lch.c,this.lch.h]:[e.h,e.s,e.l]).concat(1!==this.a?","+this.a:"",")")},create:function(e){var t,n,r,a,o,i;return"string"==typeof e?this.create((A.isHexString(e)?function(e){return"string"!=typeof e?e:(e=(e=e.replace("#","")).replace(b,"$1$1$2$2$3$3"),{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16)})}:function(e){var t;return e in v?v[e]:(t="transparent"===(t=c("<p>").css("background-color",e).css("background-color"))?{r:0,g:0,b:0,a:0}:t.startsWith("rgb")?t.match(/\d+/g).reduce(function(e,t,n){return e["rgb"[n]]=+t,e},{}):{r:192,g:192,b:192},v[e]=t)})(e)):!("h"in e&&"s"in e&&"l"in e)||"r"in e||"g"in e||"b"in e?("a"in e&&"number"==typeof e.a||(e.a=1),"h"in e&&"c"in e&&!("s"in e)&&"l"in e?g(y(this),{a:e.a,lch:{l:e.l,c:e.c,h:e.h}}):g(y(this),e)):this.create((a=(t=e).h,o=e.s,i=e.l,t=e.a,0===o?{r:e=d(255*i),g:e,b:e}:(r=2*i-(n=i<.5?i*(1+o):i+o-i*o),{r:d(255*s((a/=360)+1/3)),g:d(255*s(a)),b:d(255*s(a-1/3)),a:t})));function s(e){return e<0&&(e+=1),1<e&&--e,e<1/6?r+6*(n-r)*e:e<.5?n:e<2/3?r+(n-r)*(2/3-e)*6:r}},isHexString:function(e){return"string"==typeof e&&"#"===e[0]&&(e.slice(1).match(b)||e.slice(1).match(t))},isCSS3Function:function(e){return"string"==typeof e&&/^(?:rgb|hsl)a?\(\s*\d+(?:\.\d+)?\s*,\s*\d+(?:\.\d+)?%?\s*,\s*\d+(?:\.\d+)?%?(?:,\s*\d+(?:\.\d+)?\s*)?\)$/.test(e)}});return A}),define("datatypes/customcommand",["internaltypes/changedescriptor","internaltypes/twineerror"],function(l,u){var p=Object.assign,d=Object.create;return Object.seal({TwineScript_TypeID:"command",TwineScript_ObjectName:"a custom command",TwineScript_TypeName:"a custom command",TwineScript_Print:function(){return"`[a custom command]`"},create:function(e){var t,n=e.toSource,r=e.changer,a=e.hook,o=e.variables,i={};for(t in o)i[t]=[o[t]];var s,c=l.create({source:a,loopVars:i},r);return u.containsError(c)?c:s=p(d(this),{TwineScript_Attach:function(e,t){c.section=e;e=t.run(c);return u.containsError(e)?e:s},TwineScript_Run:function(e){c.section=e;e=c;return c=l.create({source:a,loopVars:i},r),e},TwineScript_ToSource:function(){return n},TwineScript_CustomCommand:function(){return e}})}})}),define("datatypes/custommacro",["jquery","utils","renderer","utils/operationutils","datatypes/customcommand","internaltypes/varref","internaltypes/varscope","internaltypes/twineerror","internaltypes/twinenotifier"],function(w,e,k,t,S,T,_,x,O){function n(v){return function(e){v.called+=1;for(var t=v.varNames,n=v.params,r=v.body,a=E(N(_),{TwineScript_VariableStore:{type:"temp",name:v.TwineScript_ObjectName+" call #"+v.called},TwineScript_TypeDefs:N(null)}),o=[],i=0,s=!1,c=arguments.length,l=new Array(1<c?c-1:0),u=1;u<c;u++)l[u-1]=arguments[u];for(var p=0;p<l.length;p+=1){var d=l[p],f=t[i],h=(a.TwineScript_TypeDefs[f]=n[i].datatype.rest?n[i].datatype.create("array"):n[i].datatype,T.create(a,f));if(x.containsError(h))return h;if(n[i].datatype.rest){var s=!0,m=(a[f]||[]).concat([d]);if(p<l.length-1){a[f]=m;continue}h.set(m)}else h.set(d),i+=1;o.push(O.create(A(h)+" is now "+A(a[f])))}if(!s&&null!=(g=n[i])&&g.datatype.rest){var g=T.create(a,t[i]);if(x.containsError(g))return g;g.set([]),a.TwineScript_TypeDefs[name]=n[i].datatype.create("array")}var y,g=w("<p>").append(k.exec(r.code)),b=e.stack.length,r=(e.stack.unshift({tempVariables:a,dom:g,output:function(e){y=e}}),e.evalReplay);for(e.evalReplay=null,e.execute();e.stack.length>b;)e.stack.shift();e.evalReplay=r;r=g.find("tw-error");return r.length?(g.prepend(o.map(function(e){return e.render()}),"<br>"),x.create("propagated","".concat(r.length," error").concat(1<r.length?"s":""," occurred when running ").concat(v.TwineScript_ObjectName,"."),void 0,g)):void 0===y?x.create("custommacro","".concat(v.TwineScript_ObjectName," didn't output any data or hooks using (output:) or (output-data:).")):"object"===_typeof(y)&&"changer"in y?S.create(E(y,{toSource:"(".concat(v.TwineScript_KnownName||"unnamed",":").concat(l.map(C),")")})):y}}var r=e.andList,A=t.objectName,a=t.typeName,o=t.matches,C=t.toSource,E=Object.assign,N=Object.create,i=Object.seal({TwineScript_TypeID:"macro",TwineScript_TypeName:"a custom macro",TwineScript_GetProperty:function(e){if("params"===e)return _toConsumableArray(this.params)},TwineScript_Properties:["params"],TwineScript_Print:function(){return"`["+this.TwineScript_ObjectName+"]`"},TwineScript_Clone:function(){var e=E(N(i),this);return e.fn=n(e),e},TwineScript_ToSource:function(){return"(macro:"+this.params.map(function(e){return e.TwineScript_ToSource()}).concat("")+this.body.TwineScript_ToSource()+")"},createFromFn:function(e,t,n,r){return E(N(i),{params:[],fn:e,typeSignature:r,TwineScript_ObjectName:t,TwineScript_ToSource:n,TwineScript_KnownName:""})},create:function(e,t){t=E(N(i),{params:e,called:0,varNames:e.map(function(e){return e.varRef.propertyChain[0]}),typeSignature:e.map(function(t){var e=t.datatype.toTypeSignatureObject?t.datatype.toTypeSignatureObject({rest:t.rest}):{pattern:"range",range:function(e){return o(t.datatype,e)},name:a(t.datatype)};return t.rest?{pattern:"zero or more",innerType:e}:e}),body:t,TwineScript_KnownName:"",TwineScript_ObjectName:"a custom macro (with ".concat(e.length?r(e.map(C)):"no params",")")});return t.fn=n(t),t}});return i}),define("datatypes/datatype",["utils","utils/operationutils","datatypes/changercommand","datatypes/colour","datatypes/gradient","datatypes/lambda","datatypes/custommacro","datatypes/codehook","internaltypes/twineerror"],function(e,t,n,r,a,o,i,s,c){var l=e.realWhitespace,u=e.anyRealLetter,p=e.anyCasedLetter,d=e.anyNewline,f=t.objectName,e=Object.seal,h=Object.keys,m=Math.floor,g=Math.abs,y={TwineScript_TypeID:"datatype",TwineScript_TypeName:"a datatype",TwineScript_Print:function(){return"`["+this.TwineScript_ObjectName+"]`"},get TwineScript_ObjectName(){return"the "+(this.rest?"...":"")+this.name+" datatype"},TwineScript_is:function(e){return y.isPrototypeOf(e)&&e.name===this.name},TwineScript_Clone:function(){return this.rest?this:Object.create(this)},TwineScript_ToSource:function(){return(this.rest?"...":"")+this.name},TwineScript_IsTypeOf:function(e){var t=this.name,n=this.rest;return!!v[t]&&v[t](e,n)},toTypeSignatureObject:function(){var e=this.name,e={pattern:"range",range:v[e],name:"a "+("dm"===e?"datamap":"ds"===e?"dataset":"num"===e?e+"ber":"str"===e?e+"ing":"color"===e?"colour":"bool"===e?e+"ean":"alnum"===e?"alphanumeric character":"int"===e?e+"eger":"even"===e||"odd"===e?e+" number":e.endsWith("case")||"whitespace"===e?e+" character":"empty"===e?e+" value":e)};return this.rest?{pattern:"zero or more",innerType:e}:e},create:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=(e="datamap"===e?"dm":"dataset"===e?"ds":"number"===e?"num":"string"===e?"str":"color"===e?"colour":"boolean"===e?"bool":"alphanumeric"===e?"alnum":"integer"===e?"int":"newline"===e?"linebreak":e,Object.create(this));return n.name=e,n.rest=t,n},from:function(t){var e=h(b).find(function(e){return b[e](t)});return e?y.create(e):c.create("datatype",f(t)+" doesn't correspond to a datatype value.")}},b={array:Array.isArray,dm:function(e){return e instanceof Map},ds:function(e){return e instanceof Set},datatype:function(e){return y.isPrototypeOf(e)},changer:function(e){return n.isPrototypeOf(e)},colour:function(e){return r.isPrototypeOf(e)},gradient:function(e){return a.isPrototypeOf(e)},lambda:function(e){return o.isPrototypeOf(e)},macro:function(e){return i.isPrototypeOf(e)},codehook:function(e){return s.isPrototypeOf(e)},command:function(e){return e&&"command"===e.TwineScript_TypeID},str:function(e){return"string"==typeof e},num:function(e){return"number"==typeof e},bool:function(e){return"boolean"==typeof e}},v=_objectSpread(_objectSpread({},b),{},{even:function(e){return!isNaN(e)&&m(g(e))%2==0},odd:function(e){return!isNaN(e)&&m(g(e))%2==1},empty:function(e){return e instanceof Map||e instanceof Set?!e.size:!(!Array.isArray(e)&&"string"!=typeof e||e.length)},int:function(e){return"number"==typeof e&&e===(0|e)},uppercase:function(e){return"string"==typeof e&&1===_toConsumableArray(e).length&&_toConsumableArray(e).every(function(e){return e!==e.toLowerCase()})},lowercase:function(e){return"string"==typeof e&&1===_toConsumableArray(e).length&&_toConsumableArray(e).every(function(e){return e!==e.toUpperCase()})},whitespace:function(e){return"string"==typeof e&&!!e.match("^"+l+"$")},digit:function(e){return"string"==typeof e&&!!e.match("^\\d$")},alnum:function(e){return"string"==typeof e&&!!e.match("^"+u+"$")},anycase:function(e){return"string"==typeof e&&!!e.match("^"+p+"$")},linebreak:function(e){return"string"==typeof e&&!!e.match("^"+d+"$")},any:function(){return!0},const:function(){return!0}});return e(y)}),define("datatypes/gradient",["utils/operationutils"],function(e){var t=e.toSource,n=Object.freeze({TwineScript_TypeID:"gradient",TwineScript_TypeName:"a gradient",TwineScript_ObjectName:"a gradient",TwineScript_DebugName:function(){return"a gradient "+this.TwineScript_Print()},TwineScript_GetProperty:function(e){var t=this;return"angle"===e?this.angle:"stops"===e?this.stops.map(function(e){return new Map([[t.repeating?"pixels":"percent",e.stop],["colour",e.colour.TwineScript_Clone()]])}):void 0},TwineScript_Properties:["angle","stops"],TwineScript_ToSource:function(){return"(gradient:"+this.angle+","+this.stops.map(function(e){return t(e.stop)+","+t(e.colour)})+")"},TwineScript_is:function(e){var r=this;return e.angle===this.angle&&e.stops.length===this.stops.length&&e.stops.every(function(e,t){var n=e.colour,e=e.stop;return r.stops[t].stop===e&&r.stops[t].colour.TwineScript_is(n)})},TwineScript_Clone:function(){return n.create(this.angle,_toConsumableArray(this.stops))},TwineScript_Print:function(){return"<tw-colour style='background:"+this.toLinearGradientString()+"'></tw-colour>"},create:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return Object.assign(Object.create(this),{angle:e,stops:t.sort(function(e,t){return e.stop-t.stop}),repeating:n})},multiply:function(t){return n.create(this.angle,this.stops.map(function(e){return{colour:e.colour,stop:e.stop*t}}))},toLinearGradientString:function(){var r=this;return(this.repeating?"repeating-":"")+"linear-gradient(".concat(this.angle,"deg, ").concat(this.stops.reduce(function(e,t){var n=t.colour,t=t.stop;return e+n.toRGBAString()+" "+t*(r.repeating?1:100)+(r.repeating?"px,":"%,")},"").slice(0,-1),")")}});return n}),define("datatypes/hookset",["jquery","utils","utils/renderutils","utils/operationutils"],function(g,s,e,t){var y=e.textNodeToChars,b=e.realWhitespace,c=e.findTextInNodes,r=t.toSource;function l(e){function t(n,e){if(Array.isArray(e))return e.reduce(function(e,t){return e.add(n.get(t))},g());if(e&&"object"===_typeof(e)&&"first"in e&&"last"in e){for(var t=e.first,r=e.last,a=n.length,o=(t<0&&(t+=a),r<0&&(r+=a),[n.get(t)]);t!==r;)t+=Math.sign(r-t),o.push(n.get(t));return g(o)}if("string"==typeof e){if("chars"===e){var i,s=[],c=_createForOfIteratorHelper(n.textNodes(m));try{for(c.s();!(i=c.n()).done;){var l,u=i.value,p=_createForOfIteratorHelper(y(u));try{for(p.s();!(l=p.n()).done;){var d=l.value;d.textContent.match(b)||s.push(d)}}catch(e){p.e(e)}finally{p.f()}}}catch(e){c.e(e)}finally{c.f()}return g(s)}if("links"===e)return n.findAndFilter("tw-link, .enchantment-link");if("visited"===e)return n.findAndFilter("tw-link.visited");var f,h;if("lines"===e)return f=n.findAndFilter("br:not(tw-sidebar *),tw-consecutive-br:not(tw-sidebar *)").get(),h=[[]],n.contents().each(function e(t,n){var r=(n.tagName||"").toLowerCase();if("tw-sidebar"!==r)if("tw-passage"===r||"tw-transition-container"===r)g(n).contents().each(e);else{if(f.length){if(n===f[0])return f.shift(),void h.push([]);if(16&n.compareDocumentPosition(f[0]))return h.push([]),g(n).contents().each(e),void h.push([])}h[h.length-1].push(n)}}),g(h.map(function(e){return!!e.length&&g(e).wrapAll("<tw-pseudo-hook>").parent()[0]}).filter(Boolean))}return g(n.get(e))}var n,r,a=e.dom,m=":not(tw-error, tw-error *)",o=g();this.next&&(o=o.add(l.call(this.next,e)));if(this.selector){if("string"===this.selector.type)i=this.selector.data,n=c((n=a).textNodes(),i),r=g(),n.forEach(function(e){r=r.add(g(e).wrapAll("<tw-pseudo-hook>").parent())}),i=r;else{if("base"===this.selector.type)return o.add(t(l.call(this.selector.data,e),this.property));n=this.selector.data,e='tw-hook[name="'+(n=s.insensitiveName(n).replace(/"/g,"&quot;"))+'"],tw-enchantment[name="'+n+'"]';var e=e+={page:", tw-story",passage:", tw-passage",sidebar:", tw-sidebar",link:", tw-link, .enchantment-link"}[n]||"",i=a.findAndFilter(e).add(a.parentsUntil(s.storyElement.parent())).filter(e)}o=this.property?o.add(t(i,this.property)):o.add(i)}return o=o.get().reduce(function(e,t){return t=g(t),e.add(t.is("tw-enchantment")&&t.contents().length<=1?t.contents():t)},g())}function a(e){var t,n;return e?(t=e.selector,n=e.property,e=e.next,[JSON.stringify(["base"===t.type?a(t.data):s.insensitiveName(t.data),n])].concat(_toConsumableArray(a(e))).sort()):[]}var o=Object.freeze({forEach:function(e,n){var t=l.call(this,e).each(function(e,t){return n(g(t),e)});return e.dom.findAndFilter("tw-pseudo-hook").contents().unwrap(),t},hooks:function(e){return l.call(this,e)},get TwineScript_ObjectName(){return"the hook name ".concat(this.TwineScript_ToSource())},TwineScript_TypeID:"hookName",TwineScript_TypeName:"a hook name (like ?this)",TwineScript_Unstorable:!0,TwineScript_ToSource:function(){var e="",t=this.selector,n=t.type,t=t.data;return"name"===n?t.match(RegExp("^"+s.anyRealLetter+"+$"))?e+="?"+t:e+="(hooks-named:"+JSON.stringify(t)+")":"string"===n?e+=JSON.stringify(t):"base"===n&&(e+=t.TwineScript_ToSource()+"'s "+r(this.property,"property")),this.next&&(e+=" + "+this.next.TwineScript_ToSource()),e},"TwineScript_+":function(e){for(var t=this.TwineScript_Clone(),n=t;n.next;)n=n.next;return n.next=e,t},TwineScript_is:function(e){return a(this)+""==a(e)+""},TwineScript_GetProperty:function(e){return o.create({type:"base",data:this},e,void 0)},TwineScript_Properties:["chars","links","lines","visited"],TwineScript_Clone:function(){return o.create(this.selector,this.property,this.next)},create:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0;return Object.assign(Object.create(this||o),{selector:Object.freeze(e),property:t,next:n})},from:function(e){return o.isPrototypeOf(e)||"string"==typeof e||s.impossible("HookSet.from() was given a non-HookSet non-string."),o.isPrototypeOf(e)?e:o.create({type:"string",data:e})}});return o}),define("datatypes/lambda",["utils/operationutils","internaltypes/varscope","internaltypes/varref","internaltypes/twineerror"],function(e,h,s,m){var g=e.objectName;var c=Object.freeze({TwineScript_TypeID:"lambda",TwineScript_TypeName:"a lambda",get TwineScript_ObjectName(){return'a "'+("making"in this?"making ... ":"")+("each"in this?"each ... ":"")+("where"in this?"where ... ":"")+("when"in this?"when ... ":"")+("via"in this?"via ... ":"")+'" lambda'},TwineScript_Print:function(){return"`[A lambda]`"},TwineScript_is:function(e){return e===this},TwineScript_ToSource:function(){return this.source},TypeSignature:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"lambda",innerType:c,clauses:t,typeName:'a "'+t.concat("").join(" ...")+'" lambda'}},TwineScript_Clone:function(){return Object.assign(Object.create(c),this)},create:function(e,t,n,r){var a,o="temp variable, or typed temp variable";function i(e){e=e&&e.varRef?e.varRef:e;return void 0===e||e&&s.isPrototypeOf(e)&&h.isPrototypeOf(e.object)&&1===e.propertyChain.length}if(m.containsError(n))return n;if("making"===t&&!i(n))return m.create("syntax","I need a "+o+", to the right of '"+t+"', not "+g(n)+".");if(m.containsError(e))return e;if(c.isPrototypeOf(e)){if("when"===t||"when"in e)return m.create("syntax","A 'when' lambda cannot have any other clauses, such as '"+t+"'.");if(t in e)return m.create("syntax","This lambda has two '"+t+"' clauses.");a=e}else{if("when"===t&&void 0!==e)return m.create("syntax","A 'when' lambda shouldn't begin with a temp variable (just use 'when' followed by the condition).");if(!i(e))return m.create("syntax","This lambda needs to start with a single "+o+", not "+g(e)+".");(a=Object.create(this)).loop=e||""}return a.source=r.trim(),a[t]=n,a.making&&a.making.getName()===(a.loop&&a.loop.getName())?m.create("syntax","This lambda has two variables named '"+a.loop.getName()+"'.","Lambdas should have all-unique parameter names."):a},apply:function(e,t){var n=t.loop,r=t.pos,a=t.making,o=t.ignoreVia;function i(e,t){if(e){var n,r;if("datatype"in e&&"varRef"in e)return n=e.varRef.create(s,e.varRef.propertyChain),m.containsError(n)?n:(r=n.defineType(e.datatype),m.containsError(r)||(r=n.set(t),m.containsError(r))?r:void 0);s[e.getName()]=t}}var s=(s=t.tempVariables)||Object.create(e.stack.length?e.stackTop.tempVariables:h),t=i(this.loop,n)||i(this.making,a);if(m.containsError(t))return t;e.stack.unshift(Object.assign(Object.create(e.stackTop||null),{tempVariables:s,lambdaPos:this.when?void 0:r})),!n||this.making||this.when?e.Identifiers.it=m.create("operation","I can't use 'it', or an implied 'it', in "+this.TwineScript_ObjectName):e.Identifiers.it=n;var c,l,u,p,d,t=!o&&this.via,o="where"in this||"when"in this,f=e.evalReplay;return e.evalReplay=f?[]:null,o?(c=e.eval(this.where||this.when),l=e.evalReplay,e.evalReplay=l&&t?[]:null,!n||this.making||this.when||(e.Identifiers.it=n),u=c,p=!t||e.eval(t),d=null,u=m.containsError(u)||("boolean"!=typeof u?m.create("operation","This lambda's 'where' clause must evaluate to true or false, not "+g(u)+"."):u?p:d)):c=u=!t||e.eval(t),p=t?e.evalReplay:null,e.stack.shift(),(e.evalReplay=f)&&(o||t)&&(((d=f[f.length-1])||{}).lambda&&d.lambda.obj===this||((d={lambda:{obj:this,loops:[]},code:(f[f.length-1]||{}).code||""}).fromCode=d.code,f.push(d)),d.lambda.loops.push(_objectSpread(_objectSpread(_objectSpread({it:n,pos:r},void 0!==a&&{making:a}),t&&{viaReplay:p,viaResult:u}),o&&{whereReplay:l,whereResult:null!==c&&c}))),u},filter:function(r,e){var a,o=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return e.reduce(function(e,t,n){return a||(n=o.apply(r,{loop:t,pos:n+1,ignoreVia:!0,tempVariables:i}),a=m.containsError(n))||e.concat(n?[t]:[])},[])}});return c}),define("datatypes/typedvar",["utils/operationutils","internaltypes/varref","internaltypes/twineerror"],function(e,a,o){var i=e.typeName,t=e.matches,n=e.toSource,s=e.unstorableValue,e=Object.freeze,c=Object.assign,l=Object.create,u=e({TwineScript_TypeName:"a TypedVar (typed variable name)",get TwineScript_ObjectName(){var e=n(this.datatype);return"the ".concat(e.length<24?e+"-":"","typed variable name, ").concat(this.varRef.TwineScript_ToSource())},TwineScript_Print:function(){return"`[A typed variable name]`"},TwineScript_Unstorable:!0,TwineScript_Clone:function(){return c(l(u),{datatype:this.datatype.TwineScript_Clone(),varRef:this.varRef})},TwineScript_ToSource:function(){return n(this.datatype)+"-type "+this.varRef.TwineScript_ToSource()},TwineScript_GetProperty:function(e){return"name"===e?this.getName():this[e]},TwineScript_Properties:["datatype","name"],TwineScript_IsTypeOf:function(e){return t(this.datatype,e)},get:function(){var e;return(e=this.varRef).get.apply(e,arguments)},getName:function(){return this.varRef.getName()},defineType:function(){if("any"!==this.datatype.name)return this.varRef.defineType(this.datatype)},create:function(e,t){var n,r;return(n=o.containsError(t)||o.containsError(e)||t.error)||(a.isPrototypeOf(t)?(n=t.object,r=t.compiledPropertyChain,n&&n.TwineScript_VariableStore&&1===r.length&&n.TwineScript_TypeDefs?(r=s(e))&&!u.isPrototypeOf(r)?o.create("syntax","The -type syntax can't have "+i(r)+" to its left."):c(l(this),{datatype:e,varRef:t}):o.create("unimplemented","I can only restrict the datatypes of variables, not data names or anything else.")):o.create("syntax","The -type syntax must have a variable to its right."))}});return u}),define("datatypes/varbind",["jquery","utils","utils/operationutils","internaltypes/varref","internaltypes/twineerror"],function(o,e,t,n,r){var a=t.objectName;return n.on("set",function(r,a){r.TwineScript_VariableStore&&e.storyElement.find("[data-2bind]").each(function(e,t){var n=(t=o(t)).data("twoWayBindEvent");"function"==typeof n&&n(t,r,a)})}),Object.freeze({TwineScript_TypeName:"a VarBind (bound variable name)",get TwineScript_ObjectName(){return"a ".concat(this.bind," bind to ").concat(this.varRef.TwineScript_ToSource())},TwineScript_Print:function(){return"`[A bound variable name]`"},TwineScript_Unstorable:!0,TwineScript_ToSource:function(){return("two way"===this.bind?"2":"")+"bind "+this.varRef.TwineScript_ToSource()},set:function(e){var e=this.varRef.set(e);if(e=r.containsError(e))return e},create:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"one way";return r.containsError(e)?e:n.isPrototypeOf(e)?e.error||Object.assign(Object.create(this),{varRef:e,bind:t}):r.create("operation","I can only 'bind' a variable, not "+a(e)+".")}})}),define("debugmode/highlight",["jquery","utils","utils/typecolours","macros","lexer"],function(u,e,t,p,n){var d=e.insensitiveName,f=t.versionClass,h=n.lex;return function(e,t,n,r){if(9999<e.length)return[u("<span>").text(e)];for(var a=h(e,"",t||"macro"),o=[],i="",s=a,c=a.start;c<a.end;c+=1){var l=a.pathAt(c);l[0]!==s[0]&&(o.length&&(o[o.length-1].textContent=i),i="",s=l,o.push(u("<".concat(r&&n<=c&&c<r?"mark":"span",' class="').concat(function(e){for(var t={},n="",r=0;r<e.length;r+=1){var a=e[r],o=a.type,i=a.text,s=("verbatim"!==o&&"comment"!==o||(n=""),f+o);switch(t[s]=(t[s]||0)+1,1<t[s]&&(s+="-"+t[s]),o){case"text":i.trim()&&e.slice(r+1).reduce(function(e,t){return void 0===e?"macro"===t.type||"hook"!==t.type&&e:e},void 0)&&(s+=" ".concat(f,"error"));break;case"macroName":var c,l=e[r].text[0];"_"!==l&&"$"!==l?(c=d(e[r].text.slice(0,-1)),p.has(c)?s+="-"+p.get(c).returnType.toLowerCase():s+=" ".concat(f,"error")):s+=" ".concat(f,"customMacro ").concat(f+("_"===l?"tempV":"v"),"ariable")}n+=s+" "}return n}(s),'">'))[0])),i+=a.text[c-a.start]}return o.length&&(o[o.length-1].textContent=i),o}}),define("debugmode/mode",["jquery","utils","utils/naturalsort","state","engine","internaltypes/varref","internaltypes/twineerror","utils/operationutils","utils/renderutils","passages","section","debugmode/panel","debugmode/highlight","utils/typecolours"],function(I,V,M,D,F,L,H,e,t,z,q,W,B,n){var U=e.objectName,$=e.isObject,G=e.toSource,Y=e.typeID,J=t.dialog,X=n.CSS,K=function(e,t){var f=V.escape,i=V.nth,n=V.debounce,r=I(document.documentElement),a=M(),o={darkMode:!0,fadePanel:!0,evalReplay:!0,width:null,maxHeight:400};if(D.hasStorage)try{var s=localStorage.getItem("(Debug Options "+V.options.ifid+")");s&&(o=JSON.parse(s))}catch(e){}function c(){if(D.hasStorage)try{localStorage.setItem("(Debug Options "+V.options.ifid+")",JSON.stringify(o))}catch(e){}}W.defaultMaxHeight=o.maxHeight;function l(e){return n(function(){if(V.options.debug)return e.apply(this,arguments)},{maxWait:2e3})}var h=I('<tw-debugger class="'.concat([o.darkMode?"theme-dark":"",o.fadePanel?"fade-panel":""].join(" "),'" style="').concat(o.width?"width:"+o.width+"px":"","\">\n<div class='panel panel-errors' hidden><table></table></div>\n<div class='tabs'></div>\n<label style='user-select:none'>Turns: </label><select class='turns' disabled></select>\n<button class='show-invisibles'>\ud83d\udd0d Debug View</button>\n<button class='show-dom'><span style=\"vertical-align:text-top\">&lt;</span><span style=\"vertical-align:text-bottom\">&gt;</span> DOM View</button>\n<button class='close'>\u2716</button>\n<div class='resizer-h'>\n</tw-debugger>")),s=h.find(".tabs"),u=h.find(".show-dom"),p=h.find(".show-invisibles"),d=h.find(".close"),m=h.find(".turns");I(document.documentElement).on("click","tw-expression, tw-error, tw-eval-explanation",n(function(e){var r,a,o,i,l,u,p,d,t=I(e.target).data("evalReplay");function n(){var e,s,c=r[a],t=o.find("tw-eval-explanation").empty(),n=o.find("tw-eval-code");c.toCode||c.toDesc||c.error||c.lambda?(o.find("tw-eval-code").empty().append(B(c.code,"macro",0<a&&c.start,0<a&&c.end+c.diff)),t.append(c.lambda?"":"<code class='".concat(56<c.fromCode.length?"from-block":"from-inline","'></code>"),c.error?"<span> caused an error: </span>":c.lambda?"<span>The lambda <code class='to-lambda'></code> was run, producing these results.</span>":"<span> became".concat(c.ToDesc?"\u2026":""," </span>").concat(c.toDesc?"<span class='to-desc'>".concat(f(c.toDesc),".</span>"):"<code class='to-code'></code>")),c.error?t.append(c.error):c.lambda?(s=function(e,t){return I("<".concat(e,"><code></").concat(e,">")).find("code").append(B(t,"macro")).end()},t.find(".to-lambda").append(B(c.lambda.obj.source,"macro")).end().append((e=I("<table>")).append.apply(e,[I("<tr>").append(s("th","pos"),c.lambda.obj.loop?s("th","_"+c.lambda.obj.loop.getName()).append(" / ",I("<code>").append(B("it","macro"))):s("th","it"),c.lambda.obj.making&&s("th","_"+c.lambda.obj.making.getName()),c.lambda.obj.where&&s("th","where").append(" result"),c.lambda.obj.via&&s("th","via").append(" result"))].concat(_toConsumableArray(c.lambda.loops.map(function(e){var t=e.it,n=e.pos,r=e.making,a=e.whereResult,o=e.whereReplay,i=e.viaResult,e=e.viaReplay;return I("<tr>").append(s("td",G(n)),s("td",G(t)),void 0!==r&&s("td",G(r)),null!=a&&(H.containsError(a)?I("<td>").append(a.render(c.lambda.obj.source,!0)):s("td",G(a))).append(o&&I("<tw-open-button replay label='\ud83d\udd0d'>").data("evalReplay",o)),null!=i&&(H.containsError(i)?I("<td>").append(i.render(c.lambda.obj.source,!0)):s("td",G(i))).append(e&&I("<tw-open-button replay label='\ud83d\udd0d'>").data("evalReplay",e)))})))))):c.toDesc||t.find(".to-code").append(B(c.toCode,"macro")),t.next().html(c.itIdentifier?'(The <code class="cm-harlowe-3-identifier">it</code> identifier now refers to '.concat(f(c.itIdentifier),".)"):"").next().text(c.reason||"")):(n.html(B(c.code,"macro")),t.html("<center>First, there was <code></code>.</center>").next().empty().next().empty()),c.lambda||t.find("code").first().append(B(c.fromCode,"macro")),o.find("mark").each(function(e,t){t.scrollIntoView()}),i.css("visibility",a<=9?"hidden":"visible"),l.css("visibility",a<=0?"hidden":"visible"),p.css("visibility",a>=r.length-1?"hidden":"visible"),d.css("visibility",a>=r.length-10?"hidden":"visible"),u.html("( ".concat(a+1,"/").concat(r.length," )"))}t&&(r=t,t=J({buttons:[{name:"Understood",confirm:!(a=0),callback:function(){return!h.find("tw-backdrop").length&&h.removeClass("show-dialog")}}]}).addClass("eval-replay"),o=I("<tw-eval-replay>".concat(1===r.length?"":"<tw-eval-code></tw-eval-code>","<tw-eval-explanation></tw-eval-explanation><tw-eval-it></tw-eval-it><tw-eval-reason></tw-eval-reason>").concat(1===r.length?"":"<tw-dialog-links><tw-link style='visibility:hidden'>\u2190 10</tw-link><tw-link style='visibility:hidden'>\u2190 \u2190</tw-link><b></b><tw-link>\u2192 \u2192</tw-link><tw-link>10 \u2192</tw-link></tw-dialog-links>","</tw-eval-replay>")),t.find("tw-dialog").css({width:"75vw","max-width":"75vw"}).prepend(o),i=o.find("tw-link:first-of-type"),l=i.next(),u=l.next(),p=u.next(),d=p.next(),n(),i.on("click",function(){a=Math.max(0,a-10),n()}),l.on("click",function(){a=Math.max(0,a-1),n()}),p.on("click",function(){a=Math.min(r.length-1,a+1),n()}),d.on("click",function(){a=Math.min(r.length-1,a+10),n()}),h.find("tw-backdrop").length?h.find("tw-backdrop").before(t):h.addClass("show-dialog").append(t));var s,t=I(e.target).data("goto");t&&(s=V.options.ignoreGotos,V.options.ignoreGotos=!1,t.command.TwineScript_Run(t.section),V.options.ignoreGotos=s),e.stopPropagation()})),h.find(".resizer-h").mousedown(function(e){if(1!==e.which)return!0;e.stopPropagation();var t=e.pageX,n=h.width();r.on("mousemove.debugger-resizer-h",function(e){e=e.pageX;h.width("".concat(n+t-e|0,"px"))}).on("mouseup.debugger-resizer-h",function(){r.off(".debugger-resizer-h"),o.width=h.width(),c()})}),h.on("mousedown",".resizer-v",function(e){if(1!==e.which)return!0;e.stopPropagation();var t=e.pageY,n=I(e.target.parentNode).height();r.on("mousemove.debugger-resizer-v",function(e){e=e.pageY;h.find(".panel").css("maxHeight","".concat(n+t-(0|e),"px"))}).on("mouseup.debugger-resizer-v",function(){r.off(".debugger-resizer-v"),o.maxHeight=h.find(".panel").css("maxHeight"),c()})}),p.click(function(){r.toggleClass("debug-mode").removeClass("dom-debug-mode"),p.toggleClass("enabled"),u.removeClass("enabled")}),u.click(function(){r.toggleClass("dom-debug-mode").removeClass("debug-mode"),u.toggleClass("enabled"),p.removeClass("enabled")}),d.click(function(){r.removeClass("debug-mode dom-debug-mode"),h.detach(),Object.assign(V.options,{debug:!1,speedMultiplier:1,ignoreClickEvents:!1,ignoreGotos:!1})});function g(e){(e=e.parents(".variable-row, .enchantment-row, .source-row")).next(".panel-row-source").find("td").empty().append(B(e.data("value")||G(e.data("enchantment").changer),e.is("source-row")?"markup":"macro"))}function y(){return k=new Set}function b(){I(document.body).append(h),V.options.debug=!0,V.options.evalReplay=o.evalReplay,V.options.speedMultiplier=1,V.options.ignoreClickEvents=!1,V.options.ignoreGotos=!1,R()}var v,w=l(function(){var r=m.children().get(),e=D.timeline,a=0;e.forEach(function(e,t){var n=e.turns,e=e.passage,n=(a+=1+(void 0===n?0:n))+": "+e;r[t]?r[t].textContent=n:m.append("<option value='".concat(t,"'>").concat(n,"</option>"))}),e.length<r.length&&I(r.slice(e.length)).remove(),m[1<=e.length?"removeAttr":"attr"]("disabled"),m.val(D.pastLength)}),k=(m.change(function(e){e=e.target.value-D.pastLength;0!=e&&(D[e<0?"rewind":"fastForward"](Math.abs(e)),F.showPassage(D.passage))}),w(),D.on("forward",w).on("load",w).on("forgetUndos",function(){return w}).on("back",function(){D.pastLength<=1&&m.attr("disabled"),m.find("[selected]").removeAttr("selected"),m.val(D.pastLength)}),new Set),S=W.create({className:"variables",tabName:"Variable",rowWrite:function(e,t){var n,r=e.name,a=e.dataset,o=e.path,i=e.value,s=e.tempScope,e=e.type,c=i&&48<i.length&&!i.TwineScript_DebugName,l=$(i)&&i.TwineScript_DebugName?i.TwineScript_DebugName():f(U(i)),u="",a=(o.length&&(u=o.reduce(function(e,t){return e+t+"'s "},"")),a&&(r="???"),e?G(e):""),e="object"===_typeof(i)||c;return t?(t[0].firstChild.innerHTML=a||"",u&&I(t[0].firstChild).children(".variable-path").html((s?"_":"$")+f(u)),t[0].childNodes[1].lastChild.textContent=(u?"":s?"_":"$")+f(r+""),t[0].childNodes[2].textContent=s||"",t[0].childNodes[3].innerHTML=l,n=(c=I(t[0].lastChild.firstChild)).is(".open"),c[e?"show":"hide"](),c=t.next(".panel-row-source"),n&&c.find("td").empty().append(B(G(i))),t.data("value",G(i)),t.add(c)):I('<div class="variable-row">').attr("data-name",r).attr("data-path",o+"").attr("data-scope",s||"").css("padding-left",Math.min(5,o.length)+"em").append("<td class='variable-type'>".concat(a||"","</td>"),"<td class='variable-name cm-harlowe-3-"+(s?"tempV":"v")+"ariable'><span class='variable-path'>"+(u?(s?"_":"$")+f(u):"")+"</span> "+(u?"":s?"_":"$")+f(r+"")+"</td>","<td class='temporary-variable-scope'>".concat(s||"","</td>"),"<td class='variable-value cm-harlowe-3-macroName-"+Y(i)+"'>"+l+"</td><td class='panel-row-buttons'><tw-folddown tabindex=0 style='display:"+(e?"visible":"none")+"'>(source:) </tw-folddown></td>").data("value",G(i)).find("tw-folddown").data("folddown",g).end().add("<tr class='variable-row panel-row-source' style='display:none'><td colspan='5'></td></tr>")},rowCheck:function(e,t){var n=e.name,r=e.path,e=e.tempScope;return t[0]&&t[0].getAttribute("data-name")===n&&t[0].getAttribute("data-path")===r+""&&t[0].getAttribute("data-scope")===e},columnHead:function(){return'<tr class="panel-head"><th data-col="variable-type">Type</th><th data-col="variable-name">Name</th><th data-col="temporary-variable-scope">Scope</th><th data-col="variable-value">Value</th></tr>'},rowSort:function(e,t,n){if("variable-value"===e)return a(t.attr("class"),n.attr("class"))||a(t.parent().data("value"),n.parent().data("value"))}}),T=l(function(){var e,t,o=[],n=D.variables,r=o.length;for(e in n)e.startsWith("TwineScript")||(r+=1,function n(e){var r,t,a;500<o.length||(o.push(e),r=e.path.concat(e.name),t=e.value,a=e.tempScope,r.length<=4&&(Array.isArray(t)?t.forEach(function(e,t){return n({name:i(t+1),path:r,value:e,tempScope:a})}):t instanceof Map?_toConsumableArray(t).forEach(function(e){var t=(e=_slicedToArray(e,2))[0],e=e[1];return n({name:t,path:r,value:e,tempScope:a})}):t instanceof Set&&_toConsumableArray(t).forEach(function(e,t){return n({name:t,dataset:!0,path:r,value:e,tempScope:a})})))}({name:e,path:[],value:n[e],tempScope:"",type:null==(t=n.TwineScript_TypeDefs)?void 0:t[e]}));o.push.apply(o,_toConsumableArray(k)),r+=k.size,S.update(o,r),0===r!==S.panel[0].classList.contains("panel-variables-empty")&&S.panel.toggleClass("panel-variables-empty")}),_=(L.on("set",function(e,t,n){var r,a;e===D.variables||"temp"!==(null==(a=e.TwineScript_VariableStore)?void 0:a.type)||null!=(a=e.TwineScript_VariableStore)&&a.name.match(/#\d+$/)||(r=null==(a=e.TwineScript_VariableStore)?void 0:a.name,e=null==(a=e.TwineScript_TypeDefs)?void 0:a[t],(a=_toConsumableArray(k).find(function(e){return e.name===t&&e.tempScope===r}))?a.value=n:k.add({name:t,path:[],value:n,tempScope:r,type:e})),T(),v()}).on("delete",function(){T(),v()}),S.panel.append("<div class='panel-variables-bottom'>\n\t\t\t<button class='panel-variables-copy'>Copy $ variables as (set:) call</button>\n\t\t\t<input class='clipboard' type=\"text\" style='opacity:0;pointer-events:none;position:absolute;'></input>\n\t\t</div>").removeAttr("hidden"),S.tab.addClass("enabled"),S.panel.find(".clipboard")),x=(r.on("click",".panel-variables-copy",function(){var e,t=[];for(e in D.variables)e.startsWith("TwineScript")||t.push("$"+e+" to "+G(D.variables[e]));_.val("(set:"+t+")")[0].select(),document.execCommand("copy")}),W.create({className:"enchantments",tabName:"Enchantment",rowWrite:function(e,t){var n=e.scope,r=e.changer,a=e.lambda,o=e.name,i=e.localHook,a=r?f(U(r)):a?f(G(a)):"<em>enchanted with ("+o+":)</em>";return t||I('<div class="enchantment-row">').data("enchantment",e).append("<td><span class='enchantment-name'>"+G(n)+(i?"</span><span class='enchantment-local cm-harlowe-3-hookName'>"+("function"==typeof i.TwineScript_ToSource?i.TwineScript_ToSource():i.attr("name")?"?"+i.attr("name"):"an unnamed hook"):"")+"</span></td><td class='enchantment-value cm-harlowe-3-macroName-"+(r?"changer":"command")+" '>"+a+"</td>"+(r?"<td class='panel-row-buttons'><tw-folddown tabindex=0>(source:)</tw-folddown></td>":"")).find("tw-folddown").data("folddown",g).end().add(r?I("<tr class='panel-row-source' style='display:none'><td colspan='3'></td></tr>"):"")},rowCheck:function(e,t){return t.data("enchantment")===e},columnHead:function(){return'<tr class="panel-head"><th data-col="enchantment-name">Scope</th><th data-col="enchantment-value">Value</th></div>'}})),d=l(function(e){x.update(e.enchantments,e.enchantments.length)}),O=(q.on("add",d).on("remove",d),q.create()),A=W.create({className:"storylets",tabName:"Storylet",rowWrite:function(e,t){var n=e.name,r=e.active,a=e.storyletSource,o=e.exclusive,e=e.urgent;return t?(t.toggleClass("storylet-closed",!r),t[0].firstChild.textContent=r?"\u2713":""):(t=I('<tr class="storylet-row '.concat(r?"":"storylet-closed",'">')).attr("data-name",n).append("<td class='storylet-open'>"+(r?"\u2713":"")+"</td><td class='storylet-name'>"+n+"</td><td class='storylet-lambda'></td><td class='storylet-exclusive'>"+o+"</td><td class='storylet-urgent'>"+e+"</td>")).find(".storylet-lambda").append(B(a.replace(/^when\s+/i,""))),t},rowCheck:function(e,t){e=e.name;return t[0].getAttribute("data-name")===f(e+"")},columnHead:function(){return'<tr class="panel-head"><th data-col="storylet-open" data-order="desc">Open</th><th data-col="storylet-name">Name</th><th data-col="storylet-lambda">Condition</th><th data-col="storylet-exclusive" class=\'storylet-exclusive\'>Exclusivity</th><th data-col="storylet-urgent" class=\'storylet-urgent\'>Urgency</th></tr>'}}),C=(A.tab.hide(),v=l(function(){var r,a,o=z.getStorylets(O),i=H.containsError(o),e=z.allStorylets();A.update(e.map(function(t){var e="number"==typeof t.get("exclusivity")?t.get("exclusivity"):0,n="number"==typeof t.get("urgency")?t.get("urgency"):0;return r=r||e,a=a||e,{name:t.get("name"),storyletSource:t.get("storylet").TwineScript_ToSource(),active:!i&&o.some(function(e){return e.get("name")===t.get("name")}),exclusive:e,urgent:n}}),i?0:o.length),A.panel.toggleClass("storylet-error",i),A.panel.toggleClass("panel-exclusive",r),A.panel.toggleClass("panel-urgent",a),e.length&&A.tab.show()}),W.create({className:"source",tabName:"Source",tabNameCounter:!1,rowWrite:function(e,t){var n=e.name,e=e.tag;return t?t.add(t.next(".panel-row-source")):(t=z.get(n).get("source"),I('<div class="source-row" data-tag="'.concat(e,'">')).data("value",t).append('<td class="source-name">'.concat(n,'</td><td class="source-tags">').concat(e,"</td><td class='panel-row-buttons'><tw-folddown class='").concat(e?"":"open","' tabindex=0></tw-folddown></td>")).find("tw-folddown").data("folddown",g).end().add(I("<tr class='panel-row-source' style='".concat(e?"display:none":"","'><td colspan='3'></td></tr>")).find("td").append(!e&&B(t,"markup")).end()))},rowCheck:function(e,t){e=e.name;return t[0].firstChild.textContent===f(e+"")},tabUpdate:I.noop,columnHead:I.noop})),E=["debug-startup","startup","header","debug-header","footer","debug-footer"].reduce(function(e,t){return e.concat(z.getTagged(t).map(function(e){return{name:e.get("name"),tag:t}}))},[]),N=W.create({className:"errors",tabName:"Error",rowWrite:I.noop,rowCheck:I.noop,columnHead:I.noop,tabUpdate:function(e){return N.tab.css({background:e?"rgba(230,101,204,0.3)":""}).text("".concat(e," Error").concat(1!==e?"s":""))}}),d=n(function(e){var t;V.options.debug&&(N.panelRows.append(e.reduce(function(e,t){var t=_slicedToArray(t,2),n=t[0],t=t[1];return"propagated"===n.type?e:e+'<tr class="error-row"><td class="error-passage">'+D.passage+'</td><td class="error-message" title="'+f(t)+'">'+n.message+"</td></tr>"},"")),500<(t=(e=N.panelRows.children()).length)&&I(Array.prototype.slice.call(N.panelRows[0].childNodes,0,t-500)).remove(),N.tabUpdate(Math.min(500,e.length)))},{batch:!0}),j=(H.on(d),N.panel.append("<div class='panel-errors-bottom'>\n\t\t\t<button class='panel-errors-clean'>\ud83e\uddf9 Clear this panel</button>\n\t\t</div>"),r.on("click",".panel-errors-clean",function(){N.panelRows.empty(),N.tabUpdate(0)}),W.create({className:"tools",tabName:"Tools",tabNameCounter:!1,rowWrite:function(e,t){var n=e.id,r=e.type,a=e.label,o=e.dropdownItems,i=e.dropdownValue;return"checkbox"===r?t?t.find("input").prop("checked",!1):I('<span><input id="debug-'.concat(n,'" type="checkbox"></input><label for="debug-').concat(n,'">').concat(a,"</label></span>")):"dropdown"===r?t?t.find("input").prop("checked",!1):I("<span>".concat(a,'<select style="width:3em" data-default="').concat(i,'" id="debug-').concat(n,'"></span>')).find("select").append(o.map(function(e){return"<option value='".concat(e,"' ").concat(e===i?"selected":"",">").concat(e,"x</option>")})).end():void 0},rowCheck:I.noop,columnHead:I.noop,tabUpdate:function(e){return j.tab.css({background:e?"hsla(210, 72%, 65%, .3)":""})}})),P=(r.on("click, change",'.panel-tools [type="checkbox"], .panel-tools select',function(e){var e=e.target,t=(e=I(e)).attr("id"),n=e.is(":checked")||e.is("select")&&e.val()!==+e.attr("data-default");"debug-peekBehindDialogs"===t&&r.toggleClass("debug-dialogs",n),"debug-ignoreClickEvents"===t&&(V.options.ignoreClickEvents=n),"debug-ignoreGotos"===t&&(V.options.ignoreGotos=n),"debug-speedMultiplier"===t&&(V.options.speedMultiplier=+e.val()),j.tabUpdate(n)}),j.update([{id:"peekBehindDialogs",type:"checkbox",label:"See through and click through <code>(dialog:)</code> boxes"},{id:"ignoreClickEvents",type:"checkbox",label:"Stop links, <code>(click:)</code> and <code>(hover-style:)</code> from activating"},{id:"ignoreGotos",type:"checkbox",label:"Stop <code>(go-to:)</code>, <code>(undo:)</code>, <code>(redirect:)</code> and <code>(restart:)</code> from activating<br><small>(Click 'GO' buttons in Debug View to activate later)</small>"},{id:"speedMultiplier",label:"Speed of timed events (<code>time</code>, <code>(live:)</code>, <code>(after:)</code>): ",type:"dropdown",dropdownValue:1,dropdownItems:[.25,.5,.75,1,1.25,1.5,1.75,2,3,5,10]}]),W.create({className:"options",tabName:"\u2699\ufe0f",tabNameCounter:!1,rowWrite:function(e,t){var n=e.name,e=e.label,r={darkMode:o.darkMode,fadePanel:o.fadePanel,evalReplay:o.evalReplay}[n];return t?t.find("input").prop("checked",r):I('<span><input id="debug-'.concat(n,'" type="checkbox" ').concat(r?"checked":"",'></input><label for="debug-').concat(n,'">').concat(e,"</label></span>"))},rowCheck:I.noop,tabUpdate:I.noop,columnHead:I.noop})),R=(r.on("click",'.panel-options [type="checkbox"]',function(e){var e=e.target,t=(e=I(e)).attr("id"),e=e.is(":checked");"debug-darkMode"===t&&(o.darkMode=e,h.toggleClass("theme-dark",e)),"debug-fadePanel"===t&&(o.fadePanel=e,h.toggleClass("fade-panel",e)),"debug-evalReplay"===t&&(V.options.evalReplay=o.evalReplay=e),c()}),P.update([{name:"darkMode",label:"Debug panel is dark"},{name:"fadePanel",label:"Debug panel is transparent unless the cursor is over it"},{name:"evalReplay",label:"Record expression replays (viewable via \ud83d\udd0d buttons in Debug View; slower)"}]),h.prepend(S.panel,x.panel,N.panel,A.panel,C.panel,j.panel,P.panel),s.prepend(S.tab,x.tab,N.tab,A.tab,C.tab,j.tab,P.tab),D.on("beforeForward",y).on("beforeBack",y).on("beforeLoad",y),l(function(){T(),v(),x.panelRows.empty(),x.tabUpdate(0),D.passage&&z.get(D.passage)&&(C.update(E.concat({name:D.passage,tag:""})),C.panel.find('[data-tag=""], [data-tag=""] + .panel-row-source').insertBefore(C.panel.find('[data-tag="footer"]').first()))}));D.on("forward",R).on("back",R).on("load",R);K=b,I(document.head).append(I("<style>").html(X)),b(),e&&d(e,t)};return F.registerDebugMode(function(e,t){return!V.options.debug&&K(e,t)}),K}),define("debugmode/panel",["jquery","utils/naturalsort"],function(d,e){var i=e();return Object.seal({create:function(e){var n,t=e.className,r=e.rowWrite,a=e.rowCheck,o=e.rowSort,i=e.columnHead,s=e.tabName,c=e.tabNameCounter,l=void 0===c||c,c=e.tabUpdate,u=d("<div class='panel panel-".concat(t,"' style='").concat(this.defaultMaxHeight?"max-height:"+this.defaultMaxHeight+"px":"","' hidden><div class=\"resizer-v\"></div><table class='panel-rows'></table></div>")),p=d("<button class='tab tab-".concat(t,"'>").concat(l?"0 ".concat(s,"s"):s,"</button>"));return p.click(function(){p.toggleClass("enabled"),p.parent().siblings(".panel").attr("hidden",""),p.is(".enabled")&&(p.siblings(".tab:not(.tab-"+t+")").removeClass("enabled"),u.removeAttr("hidden"))}),u.on("click","th",function(e){var e=e.target,t="desc"===(e=d(e)).attr("data-order")?"asc":"desc";n.sort(e.attr("data-col"),t),u.find("th[data-order]").removeAttr("data-order"),e.attr("data-order",t)}),c=c||function(e){return p.text(l?"".concat(e," ").concat(s).concat(1!==e?"s":""):s)},n=Object.assign(Object.create(this),{tabName:s,tab:p,panel:u,panelRows:u.find(".panel-rows"),rowWrite:r,rowSort:o,rowCheck:a,columnHead:i,tabUpdate:c})},sort:function(r,a){var o=this;this.panelRows.children(":not(.panel-head, .panel-row-source)").get().sort(function(e,t){var n;return"desc"===a&&(e=(n=[t,e])[0],t=n[1]),e=e.querySelector("."+r),t=t.querySelector("."+r),o.rowSort&&o.rowSort(r,d(e),d(t))||i(e.textContent,t.textContent)}).forEach(function(e){var t=d(e).next(".panel-row-source").get();o.panelRows.append(e,t)})},update:function(e,t){var r=this.rowCheck,a=this.rowWrite,o=this.panelRows,n=this.columnHead,i=this.panel,s=[],c=o.children(),e=(e.forEach(function(t){var e=c.get().filter(function(e){return r(t,d(e))}),n=a(t,e.length&&d(e));e.length||o.append(n),s.push.apply(s,_toConsumableArray(n.get()))}),c.filter(function(e,t){return!s.includes(t)&&!t.className.includes("panel-head")}).remove(),this.tabUpdate(t),0<t&&!o.find(".panel-head").length?o.prepend(n()):0===t&&o.find(".panel-head").remove(),i.find("th[data-order]"));e.length&&this.sort(e.attr("data-col"),e.attr("data-order"))},defaultMaxHeight:300})}),define("internaltypes/changedescriptor",["jquery","utils","renderer","datatypes/hookset","internaltypes/twineerror"],function(b,e,t,v,n){function w(e){return("string"==typeof e?e:e.map(function(e){return e.text}).join("")).split(/\n/g).reduce(function(e,t,n,r){r=r.length;return e.concat(document.createTextNode(t),n!==r-1&&document.createElement(t.length?"br":"tw-consecutive-br"))},[])}var k=e.impossible,S=e.transitionIn,T=t.exec,r=Object.assign,p=Object.keys,a=Object.create,e=Object.seal,_=Array.isArray,x={source:"",appendSource:null,enabled:!0,enablers:null,verbatim:!1,target:null,append:"",newTargets:null,transition:"",transitionTime:null,transitionDeferred:!1,transitionDelay:0,transitionSkip:0,transitionOrigin:null,loopVars:null,styles:null,attr:null,data:null,innerEnchantments:null,section:null,timestamp:0,output:!1,summary:function(){var t=this;return["source","appendSource","enabled","verbatim","target","append","newTargets","transition","transitionTime","transitionDeferred","transitionDelay","transitionSkip","transitionOrigin","innerEnchantments","enablers","output"].filter(function(e){return hasOwnProperty.call(t,e)}).concat([this.attr.length&&"attr",this.styles.length&&"styles",p(this.loopVars).length&&"loopVars",p(this.data).length&&"data"].filter(Boolean))},create:function(e,t){e=r(a(this),{attr:this.attr?this.attr.slice():[],styles:this.styles?this.styles.slice():[],loopVars:this.loopVars||{},data:this.data||{}},e);if(t){t=t.run(e);if(n.containsError(t))return t}return e},update:function(){function e(t){var e,n,r;_(a.styles)&&0<a.styles.length&&(n=(e=_slicedToArray(a.styles.reduce(function(n,r){return p(r).forEach(function(e){var t=r[e];n[+("function"==typeof t)].push(_defineProperty({},e,t))}),n},[[],[]]),2))[0],r=e[1],n.forEach(function(e){return t.css(e)}),setTimeout(function(){r.forEach(function(e){return t.css(e)})})),a.attr&&a.attr.forEach(function(e){return t.attr(e)}),a.data&&t.data(a.data)}var a=this,t=this.section,n=this.newTargets,r=this.transition,o=this.transitionDeferred,i=this.append,s=this.target;"function"==typeof s&&(s=s());if(_(n)&&n.length&&(s=n.map(function(e){return e.target})),_(s))for(var c=0;c<s.length;c+=1)v.isPrototypeOf(s[c])?s[c].forEach(t,e):e(s[c]);else v.isPrototypeOf(s)?s.forEach(t,e):e(s);if(r&&!o&&!i){for(var l,u=s;(l=u.data("timestamp"))||(u=u.parent()),!l&&u.length;);S(s,r,this.transitionTime,this.transitionDelay,this.transitionSkip,l?Date.now()-l:0,this.transitionOrigin)}},render:function(){var e,r=this,t=this.source,n=this.transition,a=this.transitionTime,o=this.transitionDeferred,i=this.enabled,s=this.enablers,c=this.data,l=this.section,u=this.newTargets,p=this.innerEnchantments,d=this.appendSource,f=this.output,h=this.target,m=this.target,g=this.append;if("function"==typeof h&&(h=h()),!g)return k("ChangeDescriptor.render","This doesn't have an 'append' method chosen."),b();if(f)return b();if(null!=s&&s.length)return s=(f=s[0]).descriptor,f=f.changer,s=s.render(),f&&(e=x.create({section:l,target:s}),f.run(e),e.update()),s;if(!i||void 0!==h.attr("hidden"))return x.create({target:h,attr:this.attr.filter(function(e){return!("style"in e)}),data:_objectSpread(_objectSpread({},c),{},{originalSource:t,hidden:!0})}).update(),b();if(!(h=_(u)&&u.length?u:h))return k("ChangeDescriptor.render","ChangeDescriptor has source but not a target!"),b();var y=b();if([].concat(h).filter(function(e){return!e.jquery}).map(function(e){var t,n,r=g;return e.target&&e.append&&(r=(t=e).append,n=t.before,e=e.target),{elements:e.hooks(l,m).filter(function(){return!(n&&1&this.compareDocumentPosition(document)&&2&this.compareDocumentPosition(m[0]))}),append:r}},[]).forEach(function(e){var t=e.elements,n=e.append;t.each(function(e,t){t=b(t),y=y.add(r.create({target:t,append:n,newTargets:null}).render()),t.filter("tw-pseudo-hook").contents().unwrap()})}),!(y.length||_(h)||v.isPrototypeOf(h))){f=g;if(!(f in h)){if("replace"!==f)return k("ChangeDescriptor.render","The target doesn't have a '"+f+"' method."),b();f=h[0]instanceof Text?"replaceWith":(h.empty(),"append")}h[0]instanceof Text&&"prepend"===(f="append"===f?"after":f)&&(f="before"),y=b(t&&(this.verbatim?w:T)(t)),_(d)&&d.forEach(function(e){var t=e.source,e=e.append,t=b((r.verbatim?w:T)(t));y="append"===e?y.add(t):"prepend"===e?t.add(y):t}),h[f](y.length?y:void 0),h.data("timestamp",Date.now()),this.update(),n&&!o&&S("replace"===g?h:y,n,a,this.transitionDelay,this.transitionSkip,this.expedite,this.transitionOrigin),p&&p.map(function(e){return e(h)}).forEach(function(e){return l.addEnchantment(e)})}return y}};return e(x)}),define("internaltypes/enchantment",["jquery","utils","internaltypes/changedescriptor","datatypes/changercommand","utils/operationutils","internaltypes/twineerror","utils/renderutils"],function(g,y,b,v,e,w,t){var k=e.objectName,S=e.toSource,T=t.collapse;return Object.freeze({create:function(e){return Object.assign(Object.create(this),{enchantments:g()},e)},enchantScope:function(){var i=this,s=this.attr,c=this.data,l=this.functions,u=this.section,p=this.scope,d=this.localHook,f=this.lambda,h=[],m=0;p.forEach(u,function(e,t){if(d){d=d.jquery?d:d.hooks(u);var n=e.find(d);if(n.length)e=n;else if(!d.has(e[0]).length)return}var r,a,o;(!e.is(":empty")||e.data("source")&&e.data("source").length)&&(m+=1,f?(o=f.apply(u,{loop:p.TwineScript_GetProperty(t),pos:m}),w.containsError(o)?(e.replaceWith(o.render()),f=o=null):v.isPrototypeOf(o)?o.canEnchant||(e.replaceWith(w.create("macrocall",'The lambda "'.concat(S(f),"\" can't be or include a revision, enchantment, or interaction changer like (replace:), (click:), or (link:).")).render()),f=o=null):(e.replaceWith(w.create("macrocall",'The lambda "'.concat(S(f),'" must return a changer, not ').concat(k(o),".")).render()),f=o=null)):o=i.changer,n=!s&&!c&&(!o||o.summary().every(function(e){return e.startsWith("transition")})),r=n?e:e.wrap("<tw-enchantment>").parent(),s&&r.attr(s),c&&r.data(c),l&&l.forEach(function(e){return e(r)}),o&&(t=b.create({section:u,target:r}),o.run(t),t.update(),e.is(y.storyElement)?(a=Object.keys(Object.assign.apply(Object,[{}].concat(_toConsumableArray(t.styles)))),e.css(a.reduce(function(e,t){return"background-color"===t||"background-image"===t?(e["background-color"]="transparent",e["background-image"]="none",a.push("background-".concat("background-color"===t?"image":"color"))):e[t]="inherit",e},{})),r.data({enchantedProperties:a})):e.is("tw-passage")&&t.styles.some(function(e){return"margin-left"in e||"margin"in e||"margin-right"in e})&&(o="padding-right",y.storyElement.css(t="padding-left","0px").css(o,"0px"),r.data({enchantedProperties:[t,o]}))),e.is(y.storyElement)&&r.css({"min-width":"100%","min-height":"100%"}),"true"===r.attr("collapsing")&&(r.find("[collapsing=false]").each(function(){g(this).removeAttr("collapsing")}),T(r)),n||h.push(r))}),this.enchantments=g(h)},disenchant:function(){this.enchantments.each(function(e,t){(t=g(t)).contents().unwrap();t=t.data("enchantedProperties");t&&y.storyElement.css(t.reduce(function(e,t){return e[t]="",e},{}))})}})}),define("internaltypes/twineerror",["jquery","utils"],function(i,s){var a=s.impossible,c=s.escape,l=(i(document.documentElement).on("click","tw-folddown",function(e){var t=e.target,e=((t=i(t)).toggleClass("open"),t.popData("folddown"));for("function"==typeof e&&e(t);t&&!t.next().length;)t=t.parent();null!=(e=t)&&e.next().toggle()}),{syntax:"The markup seems to contain a mistake.",saving:"I tried to save or load the game, but I couldn't do it.",operation:"I tried to perform an operation on some data, but the data's type was incorrect.",macrocall:"I tried to use a macro, but its call wasn't written correctly.",datatype:"I tried to use a macro, but was given the wrong type of data to it.",custommacro:"I tried to use a custom macro, but its code hook had a mistake in it.",infinite:"I almost ended up doing the same thing over and over, forever.",property:"I tried to access a value in a string/array/datamap, but I couldn't find it.",unimplemented:"I currently don't have this particular feature. I'm sorry.",propagated:"Click the 'Open' button to see the code hook as it was executed.",user:"This is a custom error created by (error:). It usually means you used a custom macro incorrectly.",assertion:"This command exists to provide a helpful error if a certain important condition wasn't true.",debugonly:"This macro is not meant to be used outside of debugging your story."}),u=[],n={TwineError:!0,create:function(e,t,n,r){return t&&"string"==typeof t||a("TwineError.create","has a bad message string"),n||e in l||a("TwineError.create","no error explanation given"),"user"!==e&&(t=t[0].toUpperCase()+t.slice(1)),Object.assign(Object.create(this),{type:e,message:t,explanation:n,source:void 0,innerDOM:r,appendTitleText:!1})},containsError:function(){for(var e=0;e<arguments.length;e+=1){var t=arguments[e];if(n.isPrototypeOf(t))return t;if(Array.isArray(t)){t=n.containsError.apply(n,t);if(t)return t}}return!1},createWarning:function(e,t){return Object.assign(this.create(e,t),{warning:!0})},render:function(t){var n=this,e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=(t="string"==typeof t?t:this.source||"",i("<tw-error class='"+(this.warning?"warning":"error")+"' title='"+c(t)+"'>"+c(this.message+(this.appendTitleText?" "+t:""))+"</tw-error>")),a=i("<tw-error-explanation>").text(this.explanation||l[this.type]).hide(),o=i("<tw-folddown tabindex=0>");return this.innerDOM&&i("<tw-open-button label='Open'>").on("click",function(){var e=i("<tw-backdrop><tw-dialog></tw-backdrop>");e.find("tw-dialog").prepend(n.innerDOM,i("<tw-link tabindex=0>OK</tw-link>").on("click",function(){n.innerDOM.detach(),e.remove()}).wrap("<tw-dialog-links>").parent()),s.storyElement.prepend(e)}).appendTo(r),r.append(o).append(a),r.data("TwineError",this),e||u.forEach(function(e){return e(n,t)}),r},on:function(e){return"function"!=typeof e||u.includes(e)||u.push(e),n}};return Object.preventExtensions(n)}),define("internaltypes/twinenotifier",["jquery","utils"],function(e,t){var n=t.impossible,r={create:function(e){return e||n("TwineNotifier.create","called with only 1 string."),Object.assign(Object.create(r),{message:e})},render:function(){return e("<tw-notifier>").attr("message",this.message)}};return Object.preventExtensions(r)}),define("internaltypes/varref",["state","internaltypes/twineerror","utils","utils/operationutils","datatypes/hookset"],function(u,p,e,t,i){var c,n=e.impossible,s=e.andList,r=e.nth,o=t.is,d=t.isObject,f=t.toSource,h=t.isSequential,m=t.objectName,l=t.typeName,g=t.clone,y=t.isValidDatamapName,b=t.subset,v=t.collectionType,w=t.unstorableValue,a=t.matches,k=Array.isArray,S={set:[],delete:[]},T="You can only access position strings/numbers ('4th', 'last', '2ndlast', (2), etc.), slices ('1stTo2ndlast', '3rdTo5th'), ",_="You can't access the '0th' or '0thlast' position of ";function x(e,t){if(p.containsError(t))return n;if(e instanceof Map&&(n=p.containsError(y(e,t))))return n;if(h(e))if("number"==typeof t){if(0===t)return p.create("property","You can't access elements at position 0 of ".concat(m(e),"."),"Only positive and negative position values exist.");0<t&&--t}else if("string"==typeof t&&(r=/^(\d+)(?:st|[nr]d|th)last$/i.exec(t))){if("0"===r[1])return p.create("property",_+m(e)+".");t=-r[1]}else if("string"==typeof t&&(r=/^(\d+)(?:st|[nr]d|th)$/i.exec(t))){if("0"===r[1])return p.create("property",_+m(e)+".");t=r[1]-1}else if("string"==typeof t&&(r=/^(?:(\d+)(?:st|[nr]d|th)(last)?|last)to(?:(\d+)(?:st|[nr]d|th)(last)?|last)$/i.exec(t))){var n=_slicedToArray(r,5),r=n[1],r=void 0===r?0:r,a=n[2],o=n[3],o=void 0===o?0:o;t={last:n[4]?-o:o-1,first:a?-r:r-1}}else if("last"===t)t=-1;else if("random"===t){if(!e.length)return p.create("property","I can't get a random value from ".concat(m(e),", because it's empty."));t=u.random()*Array.from(e).length|0}else{if(i.isPrototypeOf(e)&&!i.TwineScript_Properties.includes(t))return p.create("property","".concat(T+s(i.TwineScript_Properties.map(function(e){return"'"+e+"'"}))," of ").concat(m(e),", not ").concat(("string"==typeof t?f:m)(t),"."));if(!["length","some","any","all","start","end","random"].includes(t)&&!i.isPrototypeOf(e))return p.create("property","".concat(T,"'length', 'some', 'any', 'all', 'start', 'end', and 'random' of ").concat(m(e),", not ").concat(("string"==typeof t?f:m)(t),"."))}else if(e instanceof Set){if(!["length","some","any","all"].includes(t))return p.create("property","".concat(T,"'length', 'some', 'any', and 'all' of ").concat(m(e),"."),"You can't access specific individual data values from datasets.");"length"===t&&(t="size")}else{if(k(e.TwineScript_Properties)&&!e.TwineScript_Properties.includes(t))return p.create("property","You can only get the ".concat(s(e.TwineScript_Properties.map(function(e){return"'"+e+"'"}))," of ").concat(m(e),", not ").concat(("string"==typeof t?f:m)(t),"."));if("number"==typeof e||"boolean"==typeof e)return p.create("property","You can't get any data values, let alone ".concat(m(t),", from ").concat(m(e)))}return t}function O(e,t){return+t<0&&Math.abs(t)<=e.length?e.length+ +t:t}var A=/[^\uD801-\uDFFF]/,C=new Map;function E(e,t){var n,r,a;return void 0===e?e:e instanceof Map?e.get(t):"some"!==t&&"any"!==t&&"all"!==t&&"start"!==t&&"end"!==t||e.TwineScript_VariableStore?("string"==typeof e&&(C.has(e)?e=C.get(e):A.test(e)?(a=_toConsumableArray(e),C.set(e,a),e=a):C.set(e,e)),h(e)&&Number.isFinite(t)&&(t=O(e,t)),e.TwineScript_GetProperty?e.TwineScript_GetProperty(t):"function"!=typeof(a=e[t])?a:void 0):(n=e,r=t,a='"'.concat(r," value").concat("any"===r?"":"s",'" of '),{determiner:r,determined:n,array:_toConsumableArray(n),string:"string"==typeof n&&n,TwineScript_ObjectName:a+m(n),TwineScript_ToSource:function(){return"".concat(r," of ").concat(f(n))},TwineScript_TypeName:a+"a data structure",TwineScript_Unstorable:!0,TwineScript_Print:function(){return"`["+this.TwineScript_TypeName+"]`"}})}function N(e){var t;return e.computed?(t=e.value,"string"==typeof(t=c.isPrototypeOf(t)?t.get():t)?"('"+t+"')":"("+t+")"):"number"==typeof e?r(e):"'"+e+"'"}function j(t,e,n){if(t.TwineScript_VariableStore){if(t.TwineScript_TypeDefs&&e in t.TwineScript_TypeDefs){var r=t.TwineScript_TypeDefs[e];if("const"===r.name){if(void 0!==t[e])return p.create("operation","I can't alter ".concat(t===u.variables?"$":"_").concat(e," because it's been restricted to a constant value."),"This variable can't be changed for the rest of the story.")}else if(!a(r,n))return p.create("operation","I can't set ".concat(t===u.variables?"$":"_").concat(e," to ").concat(l(n)," because it's been restricted to ").concat(f(r),"-type data."),"You can restrict a variable or data name by giving a typed variable to (set:) or (put:).")}return!0}return k(e)?e.map(function(e){return j(t,e)}):t instanceof Map?"string"==typeof e||p.create("operation","".concat(m(t)," can only have string data names, not ").concat(m(e),".")):h(t)?["length","random","some","any","all","start","end"].includes(e)?p.create("operation","I can't forcibly alter the '"+e+"' of "+m(t)+".","start"===e||"end"===e?"Alter the values at actual positions, like 1st or 2ndlast, rather than just the '"+e+"'.":void 0):+e==(0|e)||p.create("property",m(t)+" can only have position keys ('3rd', '1st', (5), etc.), not "+N(e)+"."):t.TwineScript_Identifiers&&e in t?p.create("keyword","I can't alter the value of the '"+e+"' identifier.","You can only alter data in variables, not fixed identifiers."):p.create("operation","I can't modify "+m(t),t instanceof Set?"You should use an (array:) if you need to modify the data inside this dataset.":i.isPrototypeOf(t)?"You should alter hooks indirectly using macros like (replace:) or (enchant:).":void 0)}function P(t,e,n,r){var a=e;t instanceof Map?t.set(e,n):(h(t)&&(e=O(t,e)),t.TwineScript_Set?t.TwineScript_Set(e,n,r):t[e]=n),S.set.forEach(function(e){return e(t,a,n)})}function R(t,e){var n=e;h(t)&&(e=O(t,e)),k(t)&&/^(?:[1-9]\d*|0)$/.exec(e)?t.splice(e,1):t instanceof Map||t instanceof Set?t.delete(e):t.TwineScript_Delete?t.TwineScript_Delete(e):delete t[e],S.delete.forEach(function(e){return e(t,n)})}function I(t,e){var n,r,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e,o=3<arguments.length&&void 0!==arguments[3]&&arguments[3];return e&&"object"===_typeof(e)&&"last"in e&&"first"in e?i.isPrototypeOf(t)?t.TwineScript_GetProperty(e):(n=e.first,r=e.last,b(t,n+(0<=n),r+(0<=r))):k(e)?i.isPrototypeOf(t)?t.TwineScript_GetProperty(e):e.map(function(e){return I(t,e,e)})["string"==typeof t?"join":"valueOf"](""):void 0!==(n=E(t,e))||o?n:t===u.variables?0:"temp"===(null==(r=t.TwineScript_VariableStore)?void 0:r.type)?p.create("property","There isn't a temp variable named _".concat(a," in this place."),"Temp variables only exist inside the same passage, hook, or lambda in which they're created."):k(t)&&"number"==typeof e?p.create("property","This array of ".concat(t.length," elements doesn't have a ").concat(N(a+("number"==typeof a?1:""))," element."),t.length?"It contains: ".concat(s(t.map(m)),"."):"The array is empty."):(o=Array.from("function"==typeof t.keys&&t.keys()),p.create("property","I can't find a ".concat(N(a)," data name in ").concat(m(t)),t instanceof Map&&o.length?"Its names include: ".concat(s(o),"."):void 0))}function V(e,t){var r=this,e=this.compiledPropertyChain.reduce(function(e,t){var n=0===e.length?r.object:I.apply(void 0,_toConsumableArray(e[e.length-1]));return e.push([n,t])&&e},[]).reduceRight(e,t);return p.containsError(e)?e:void 0}return c=Object.freeze({get:function(){for(var e=this.object,t=0;t<this.compiledPropertyChain.length-1;t+=1)if(e=I(e,this.compiledPropertyChain[t]),p.containsError(e))return e;return I(e,this.compiledPropertyChain.slice(-1)[0],this.propertyChain.slice(-1)[0])},has:function(){for(var e=this.object,t=0;t<this.compiledPropertyChain.length-1;t+=1)if(void 0===(e=I(e,this.compiledPropertyChain[t],void 0,!0))||p.containsError(e))return!1;return void 0!==I(e,this.compiledPropertyChain.slice(-1)[0],void 0,!0)},set:function(e,c){var l=this;return!this.object||this.object.TwineScript_VariableStore||this.object.TwineScript_Identifiers?V.call(this,function(n,e,t){var e=_slicedToArray(e,2),r=e[0],a=e[1];if(e=p.containsError(n,r,a)||p.containsError(j(r,a,n)))return e;if(e=w(n))return p.create("operation","".concat(m(n)," can't be stored").concat(!n.TwineScript_Unstorable&&v(n)?" because it holds ".concat(m(e)):"","."));if(0<t)r=g(r);else if("temp"===(null==(e=r.TwineScript_VariableStore)?void 0:e.type)&&r!==u.variables){for(var o=r;"temp"===(null==(i=o.TwineScript_VariableStore)?void 0:i.type)&&!hasOwnProperty.call(o,a);)var i,o=Object.getPrototypeOf(o);"temp"===(null==(t=o.TwineScript_VariableStore)?void 0:t.type)&&(r=o)}if("string"==typeof r){if("string"!=typeof n)return p.create("datatype","I can't put this non-string value, ".concat(m(n),", in a string."));if(n.length!==(k(a)?a.length:1))return p.create("datatype","".concat(m(n),"is not the right length to fit into this string location."));var r=_toConsumableArray(r),s=_toConsumableArray(n);[].concat(a).forEach(function(e){0+e<0&&(e=r.length+(0+e)),r=[].concat(_toConsumableArray(r.slice(0,e)),[s.shift()],_toConsumableArray(r.slice(e+1)))}),r=r.join("")}else d(r)&&(void 0!==n.TwineScript_KnownName&&((n=""!==n.TwineScript_KnownName?g(n):n).TwineScript_KnownName=f(l)),k(a)&&h(n)?("string"==typeof n&&(n=_toConsumableArray(n)),a.map(function(e,t){return[e,n[t]]}).forEach(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1];return P(r,t,e,c)})):P(r,a,n,c));return r},e):p.create("macrocall","I can't (set:) ".concat(m(this),", if the ").concat((m(this.object).match(/ (.+$)/)||["","value"])[1]," isn't stored in a variable."),"Modifying data structures that aren't in variables won't change the game state at all.")},delete:function(){return V.call(this,function(e,t,n){var r,t=_slicedToArray(t,2),a=t[0],t=t[1];return(r=p.containsError(e,a,t)||p.containsError(j(a,t)))||(0<n&&(a=g(a)),null===e?((r="string"==typeof a)&&(a=_toConsumableArray(a)),k(t)?(h(a)&&(t=_toConsumableArray(new Set(t))).sort(function(e,t){return O(a,t)-O(a,e)}),t.forEach(function(e){return R(a,e)})):R(a,t),r&&(a=a.join(""))):P(a,t,e,!1),a)},null)},defineType:function(e){var t=this.object,n=this.compiledPropertyChain[0],r=(hasOwnProperty.call(t,"TwineScript_TypeDefs")||(t.TwineScript_TypeDefs=Object.create(t.TwineScript_TypeDefs||null)),t.TwineScript_TypeDefs),a=r[n];if(a&&!o(a,e))return p.create("operation","I can't redefine the type of "+m(this)+" to "+(e.TwineScript_ObjectName||l(e))+", as it is already "+(a.TwineScript_ObjectName||l(a))+".");t.TwineScript_DefineType?t.TwineScript_DefineType(n,e):r[n]=e,"const"===e.name&&(t[n]=void 0)},matches:function(e,t){return this.object===e&&this.compiledPropertyChain[0]===t},getName:function(){return this.compiledPropertyChain[0]},create:function(e,t){var n;if(n=p.containsError(e))return n;Array.isArray(t)||(t=[].concat(t)),c.isPrototypeOf(e)&&(t=e.propertyChain.concat(t),e=e.object);var r=function(e,t){for(var n,r=[],a=0;a<t.length;a+=1){var o=t[a];if(o.computed&&(o=o.value),c.isPrototypeOf(o)&&(o=o.get()),k(o)){for(var i=[],s=0;s<o.length;s+=1)i[s]=x(e,o[s]);o=i}else o=x(e,o);if(n=p.containsError(o))return n;a<t.length-1&&(e=I(e,o)),r.push(o)}return r}(e,t);return(n=p.containsError(r))||Object.assign(Object.create(c),{object:e,propertyChain:t,compiledPropertyChain:r})},TwineScript_ToSource:function(){function r(e,t){return!t&&n.object.TwineScript_VariableStore?e:N(e)}var e,n=this;return(this.object===u.variables?"$":"temp"===(null==(e=this.object.TwineScript_VariableStore)?void 0:e.type)?"_":f(this.object)+"'s ")+(1===this.propertyChain.length?r(this.propertyChain[0]):this.propertyChain.reduce(function(e,t,n){return e+"'s "+r(t,n)}))},get TwineScript_ObjectName(){var e;return this.object.TwineScript_VariableStore?"the ".concat("temp"===(null==(e=this.object.TwineScript_VariableStore)?void 0:e.type)?"temp ":"","variable ").concat(this.TwineScript_ToSource()):m(this.object)+"'s "+(1===this.propertyChain.length?N(this.propertyChain[0]):this.propertyChain.reduce(function(e,t,n){return e+"'s "+N(t)}))},on:function(e,t){if(e in S)return"function"!=typeof t||S[e].includes(t)||S[e].push(t),c;n("VarRef.on","invalid event name")}})}),define("internaltypes/varscope",[],function(){return Object.seal({TwineScript_ObjectName:"the temporary variables",TwineScript_VariableStore:{type:"temp",name:"an unknown scope"},TwineScript_TypeDefs:Object.create(null)})}),define("macrolib/commands",["jquery","macros","utils","state","passages","engine","internaltypes/twineerror","internaltypes/twinenotifier","datatypes/assignmentrequest","datatypes/hookset","datatypes/codehook","datatypes/colour","datatypes/gradient","internaltypes/varref","datatypes/typedvar","datatypes/varbind","utils/operationutils","utils/renderutils"],function(u,n,b,c,l,a,y,M,e,o,t,p,d,i,s,v,r,f){var h=r.printBuiltinValue,m=r.objectName,g=r.clone,w=r.toSource,k=f.dialog,S=f.geomParse,D=f.geomStringRegExp,r=n.TypeSignature,f=r.Any,F=r.Everything,T=r.rest,_=r.either,x=r.optional,O=r.zeroOrMore,L=r.percent,H=r.nonNegativeInteger,A=r.positiveInteger,r=r.positiveNumber,C=Object.assign,E=Math.floor,N=Math.ceil,j=Math.abs,z=Math.max,q=Math.min,P=u.noop;function R(e){return"(".concat(e," ").concat(b.options.ifid,") ")}["set","put","unpack"].forEach(function(r){return n.add(r,"Instant",function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t+=1){var n=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];if("into"===n.operator&&"set"===r)return y.create("macrocall","Please say 'to' when using the (set:) macro.");if("to"===n.operator&&"set"!==r)return y.create("macrocall","Please say 'into' when using the (put:) or (unpack:) macro.");if((i.isPrototypeOf(n.dest)||s.isPrototypeOf(n.dest))===("unpack"===r))return y.create("macrocall","unpack"===r?"Please use the (unpack:) macro with arrays, datamaps or (p:) patterns containing variables to the right of 'into'.":"Please use the (".concat(r,":) macro with just single variables and typed variables to the ").concat("set"===r?"left of 'to'.":"right of 'into'."),"You may wish to change this to the (".concat("unpack"!==r?"unpack":"to"===n.operator?"set":"put",":) macro."));n=n.set();if(y.containsError(n))return n}return{TwineScript_TypeID:"instant",TwineScript_TypeName:"a (".concat(r,":) operation"),TwineScript_ObjectName:"a (".concat(r,":) operation"),TwineScript_Unstorable:!0,TwineScript_Print:function(){return b.options.debug,""}}},[T(e)])}),n.add("move","Instant",function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t+=1){var n=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];if("into"!==n.operator)return y.create("macrocall","Please say 'into' when using the (move:) macro.");n=n.set(!0);if(y.containsError(n))return n}return{TwineScript_TypeID:"instant",TwineScript_TypeName:"a (move:) operation",TwineScript_ObjectName:"a (move:) operation",TwineScript_Unstorable:!0,TwineScript_Print:function(){return b.options.debug,""}}},[T(e)]),n.addCommand("display",function(e){if(!l.hasValid(e))return y.create("macrocall","I can't (display:) the passage '".concat(e,"' because it doesn't exist."))},function(e,t,n){return e.source=l.getTree(n),e},[String])("print",P,function(e,t,n){return C(e,{source:h(n)})},[f])(["verbatim-print","v6m-print"],P,function(e,t,n){return C(e,{verbatim:!0,source:h(n)})},[f])(["verbatim-source","v6m-source"],function(e){if("command"===(null==e?void 0:e.TwineScript_TypeID)&&!e.TwineScript_ToSource)return y.create("datatype","I can't construct the source code of a command created by a custom macro.")},function(e,t,n){return C(e,{verbatim:!0,source:h(w(n))})},[f])("go-to",function(e){if(!l.hasValid(e))return y.create("macrocall","I can't (go-to:) to the passage '".concat(e,"' because it doesn't exist."),"Check that you didn't mistype the passage name, or rename the passage to something else.")},function(e,t,n){if(!b.options.ignoreGotos)return requestAnimationFrame(function(){return a.goToPassage(n,{transition:e.data.passageT8n})}),{blocked:!0}},[String])("redirect",function(e){if(!l.hasValid(e))return y.create("macrocall","I can't (redirect:) to the passage '".concat(e,"' because it doesn't exist."),"Check that you didn't mistype the passage name, or rename the passage to something else.")},function(e,t,n){if(!b.options.ignoreGotos)return requestAnimationFrame(function(){return a.redirect(n,{transition:e.data.passageT8n})}),{blocked:!0}},[String])("undo",P,function(e,t,n){return c.pastLength<1?C(e,{source:n}):b.options.ignoreGotos?void 0:(requestAnimationFrame(function(){return a.goBack({transition:e.data.passageT8n})}),{blocked:!0})},[x(String)])("debug",P,a.enableDebugMode,[],!1),b.onStartup(function(){return b.storyElement.on("click.icon","tw-icon",function(e){var t=u(this),n=t.data("clickEvent"),r=t.attr("alt");n&&n(t),"Undo"===r&&(e.stopPropagation(),a.goBack()),"Redo"===r&&(e.stopPropagation(),a.goForward()),"Fullscreen"===r&&(e.stopPropagation(),a.toggleFullscreen()),"Restart"===r&&(c.hasSessionStorage&&sessionStorage.removeItem("Saved Session"),window.location.reload())})}),[["Undo","&#8630;",function(){return 0<c.pastLength}],["Redo","&#8631;",function(){return 0<c.futureLength}],["Fullscreen","&#9974;",function(){return document.fullscreenEnabled||document.msFullscreenEnabled}],["Restart","&#10226;",Object]].forEach(function(e){var e=_slicedToArray(e,3),o=e[0],i=e[1],s=e[2];n.addCommand("icon-".concat(o.toLowerCase()),function(e,t){if("string"==typeof e&&"string"==typeof t)return e=_toConsumableArray(e).length,t=_toConsumableArray(t).length,1<e&&1<t?y.create("datatype","One of the two strings given to (icon-".concat(o.toLowerCase(),":) should be 1 character long, for its icon.")):1===e&&1===t?y.create("datatype","One of the two strings given to (icon-".concat(o.toLowerCase(),":) should be 2 or more characters long, for its label.")):void 0},function(t,e,n,r){var a;return("string"==typeof r&&1===_toConsumableArray(r).length||"string"==typeof n&&1<_toConsumableArray(n).length)&&(n=(a=[r,n])[0],r=a[1]),"Undo"===o&&(t.data.forgetUndosEvent=function(e){t.section.whenUnblocked(function(){return u(e).css("visibility","hidden")})}),C(t,{source:'<tw-icon tabindex=0 alt="'.concat(o,'" ').concat(r?'data-label="'.concat(r.replace('"',"&quot;"),'"'):"",' title="').concat(o,'" ').concat(s()?"":'style="visibility:hidden"',">").concat(n||i,"</tw-icon>")})},[x(String),x(String)])}),n.addCommand("icon-counter",function(e,t,n){var r=" label string given to (icon-counter:) can't be empty or only whitespace.";return t&&t.trim()?"string"!=typeof n||n.trim()?void 0:y.create("datatype","The 2nd "+r):y.create("datatype","The 1st "+r)},function(r,e,a,o,i){r.attr.push({"data-2bind":!0}),r.data.twoWayBindEvent=function(e,t,n){a.varRef.matches(t,n)&&"number"==typeof(t=a.varRef.get())&&r.target.children("tw-icon").text((0<t?E:N)(t)).attr("data-label",1!==j(t)&&void 0!==i?i:o)};var t=a.varRef.get();return"number"!=typeof t?y.create("datatype","(icon-counter:) can only be bound to a variable holding a number, not ".concat(m(t),".")):C(r,{source:'<tw-icon data-label="'.concat(b.escape(1!==j(t)&&void 0!==i?i:o),'">').concat((0<t?E:N)(t),"</tw-icon>")})},[v,String,x(String)]),n.addCommand("meter",function(e,t,n,r){return"two way"===e.bind?y.create("datatype","(meter:) shouldn't be given two-way bound variables.",'Change the "2bind" keyword to just "bind".'):"string"!=typeof r||r.trim()?-1===n.search(D)||!n.includes("=")&&1<n.length?y.create("datatype",'The (meter:) macro requires a sizing line("==X==", "==X", "=XXXX=" etc.) be provided, not '+JSON.stringify(n)+"."):void 0:y.create("datatype","The label string given to (meter:) can't be empty or only whitespace.")},function(r,e,a,n,t,o,i){o&&"string"!=typeof o&&(i=o,o=void 0),i=i||p.create({h:0,s:0,l:.5,a:.5}),p.isPrototypeOf(i)&&(i=d.create(90,[{colour:i,stop:0},{colour:i,stop:1}]));function s(e){var t=z(0,q(1,e/n)),e=i.repeating?i:i.multiply(n/e);return"height:100%;background-repeat:no-repeat;background-image:".concat((l?C(e,e.repeating?{}:{angle:270}).toLinearGradientString()+", ":"")+C(e,e.repeating?{}:{angle:l||0===c?90:270}).toLinearGradientString(),";background-size:").concat(l?Array(2).fill(50*t+"%"):100*t+"%",";background-position-x:").concat(l?-100/(2-t)+100+"%,"+100/(2-t)+"%":0===c?"left":"right",";text-align:").concat(l?"center":0===c?"left":"right")}var t=S(t),c=t.marginLeft,t=t.size,l=0<c&&Math.ceil(c+t)<100,u=(r.styles.push({"margin-left":c+"%",width:t+"%",height:"1.5em",display:"block"}),r.attr.push({"data-2bind":!0}),o&&e.stackTop.tempVariables),t=(r.data.twoWayBindEvent=function(e,t,n){a.varRef.matches(t,n)&&"number"==typeof(t=a.varRef.get())&&((n=r.target.children("tw-meter")).attr("style",s(t)),o)&&r.section.renderInto("",null,{source:o,target:n,append:"replace",transitionDeferred:!1},u)},a.varRef.get());return"number"!=typeof t?y.create("datatype","(meter:) can only be bound to a variable holding a number, not ".concat(m(t),".")):C(r,{source:'<tw-meter style="'.concat(s(t),'">').concat(o||"","</tw-meter>")})},[v,r,String,x(_(String,p,d)),x(_(p,d))]),[["cycling-link"],["seq-link","sequence-link"]].forEach(function(t,u){return n.addCommand(t,function(){var e;return""===(arguments.length<=0?void 0:arguments[0])?y.create("datatype","The first string in a ("+t[0]+":) can't be empty."):arguments.length<=(v.isPrototypeOf(arguments.length<=0?void 0:arguments[0])?2:1)?y.create("datatype","I need two or more strings to "+(u?"sequence":"cycle")+" through, not just '"+((e=arguments.length-1)<0||arguments.length<=e?void 0:arguments[e])+"'."):void 0},function(a,e){for(var o,t=arguments.length,i=new Array(2<t?t-2:0),n=2;n<t;n++)i[n-2]=arguments[n];v.isPrototypeOf(i[0])&&(o=i.shift());var s=0,c=("two way"===(null==(l=o)?void 0:l.bind)&&(a.attr.push({"data-2bind":!0}),-1<(l=i.indexOf(o.varRef.get())))&&(s=l),e.stackTop.tempVariables);function r(e,t){var n=s>=i.length-1&&u,r=""===i[s]?"":n?i[s]:"<tw-link>".concat(i[s],"</tw-link>");if(n&&(a.data.clickEvent=void 0),o&&!t){n=o.set(i[s]);if(y.containsError(n))return void e.replaceWith(n.render(i[s]))}t=_objectSpread(_objectSpread({},a),{},{source:r,transitionDeferred:!1});a.section.renderInto("",null,t,c)}i[s]&&(a.data.clickEvent=function(e){s=(s+1)%i.length,r(e,!1)},a.data.twoWayBindEvent=function(e,t,n){o.varRef.matches(t,n)&&(t=o.varRef.get(),-1<(n=i.indexOf(t)))&&n!==s&&(s=n,r(e,!0))});var l="<tw-link>".concat(i[s],"</tw-link>");if(o){e=o.set(i[s]);if(y.containsError(e))return e}return C(a,{source:l,append:"replace",transitionDeferred:!0})},[_(v,String),T(String)])}),b.onStartup(function(){return b.storyElement.on("change.dropdown-macro","select",function(){var e=u(this),t=e.closest("tw-expression, tw-hook").data("dropdownEvent");t&&t(e)})}),n.addCommand("dropdown",function(e){var t;return""===(arguments.length<=1?void 0:arguments[1])||""===((t=(arguments.length<=1?0:arguments.length-1)-1+1)<1||arguments.length<=t?void 0:arguments[t])?y.create("datatype","The first or last strings in a (dropdown:) can't be empty.","Because empty strings create separators within (dropdown:)s, having them at the start or end doesn't make sense."):(arguments.length<=1?0:arguments.length-1)<=1?y.create("datatype","I need two or more strings to create a (dropdown:) menu, not just "+(arguments.length<=1?0:arguments.length-1)+"."):void 0},function(e,t,r){for(var n=arguments.length,a=new Array(3<n?n-3:0),o=3;o<n;o++)a[o-3]=arguments[o];var i=0,s=("two way"===r.bind&&(e.attr.push({"data-2bind":!0}),-1<(c=a.indexOf(r.varRef.get())))&&(i=c),Math.max.apply(Math,_toConsumableArray(a.map(function(e){return _toConsumableArray(e).length})))),c="<select>"+a.map(function(e,t){return"<option".concat(t===i?" selected":"").concat(""===e?" disabled":"",">").concat(b.escape(e||"\u2500".repeat(s)),"</option>")}).join("\n")+"</select>",l=(e.data.dropdownEvent=function(e){var t=e.val(),n=r.set(t);y.containsError(n)&&e.replaceWith(n.render(t))},e.data.twoWayBindEvent=function(e,t,n){r.varRef.matches(t,n)&&(t=r.varRef.get(),-1<(n=a.indexOf(t)))&&n!==i&&(e.find("select").val(t),i=n)},e.styles.push({"background-color":function(){return b.parentColours(u(this)).backgroundColour}}),r.set(a[i]));return y.containsError(l)?l:C(e,{source:c,append:"replace"})},[v,String,T(String)]),b.onStartup(function(){return b.storyElement.on("input.checkbox-macro","input[type=checkbox]",function(){var e=u(this),t=e.closest("tw-expression").data("checkboxEvent");t&&t(e)})});function I(e){return["I can't use a dialog macro in "+e+".","Please rewrite this without putting such macros here."]}var V=1;n.addCommand("checkbox",function(){},function(e,t,r,n){var a=!1,o="checkbox-"+ ++V,i=("two way"===r.bind&&(e.attr.push({"data-2bind":!0}),"boolean"==typeof(i=r.varRef.get())&&(a=i),e.data.twoWayBindEvent=function(e,t,n){r.varRef.matches(t,n)&&"boolean"==typeof(t=r.varRef.get())&&e.children("input[type=checkbox]").prop("checked",t)}),e.data.checkboxEvent=function(e){var t=e.is(":checked"),t=r.set(t);y.containsError(t)&&e.replaceWith(t.render(""))},r.set(a));return y.containsError(i)?i:C(e,{source:'<input id="'.concat(o,'" type="checkbox" ').concat(a?"checked":"",'><label for="').concat(o,'">').concat(n,"</label>"),append:"replace"})},[v,String]),b.onStartup(function(){return u(document).on("fullscreenchange",function(){u("input[type=checkbox][id^=fullscreen]",b.storyElement).each(function(e,t){(u(t).closest("tw-expression").data("fullscreenEvent")||Object)(t)})})}),n.addCommand("checkbox-fullscreen",function(){},function(e,t,n){var r="fullscreenCheckbox-"+ ++V;return e.data.fullscreenEvent=function(e){return u(e).prop("checked",!(!document.fullscreenElement&&!document.msFullscreenElement))},e.data.checkboxEvent=function(){return a.toggleFullscreen()},C(e,{source:'<input id="'.concat(r,'" type="checkbox" ').concat(document.fullscreenEnabled||document.msFullscreenEnabled?" ":"disabled ").concat(document.fullscreenElement||document.msFullscreenElement?"checked":"",'><label for="').concat(r,'">').concat(n,"</label>"),append:"replace"})},[String]),b.onStartup(function(){return b.storyElement.on("input.input-box-macro","textarea, input[type=text]",function(){var e=u(this),t=e.closest("tw-expression").data("inputBoxEvent");t&&t(e)})}),["input","force-input","input-box","force-input-box"].forEach(function(g){return n.addCommand(g,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=g.endsWith("box"),a=v.isPrototypeOf(t[0]),o="string"==typeof t[+a],r=r&&"number"==typeof t[o+a],i=o?t[+a]:t[a+r],s=0<S(i).size,o=s?t[a+r+o]:i;return g.startsWith("force")&&"string"!=typeof o?y.create("datatype","The (".concat(g,":) macro requires a string of text to forcibly input.")):t.length>a+r+s+("string"==typeof o)?y.create("datatype","An incorrect combination of values was given to this (".concat(g,":) macro.")):void 0},function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var o=g.startsWith("force"),i=g.endsWith("box"),s=v.isPrototypeOf(r[0]),c="string"==typeof r[+s],l=i&&"number"==typeof r[c+s],u=s&&r[0],p=l?r[1+s]:3,d=c?S(r[+s]):{},f=d.marginLeft,d=d.size,h=(d?r[s+l+c]:c&&r[+s])||"",l=o?"":h,c=!1;if("two way"===u.bind){e.attr.push({"data-2bind":!0});s=u.varRef.get();if("string"==typeof s){l=o?h.slice(0,s.length):s,s=u.set(l),c=!0;if(y.containsError(s))return s}e.data.twoWayBindEvent=function(e,t,n){u.varRef.matches(t,n)&&"string"==typeof(t=u.varRef.get())&&e.find(i?"textarea":"input").val(o?h.slice(0,t.length):t)}}if(u&&!c){s=u.set(o?"":h);if(y.containsError(s))return s}!o&&u&&(e.data.inputBoxEvent=function(e){var t=e.val(),t=u.set(t);y.containsError(t)&&e.replaceWith(t.render(""))});var m,c="<".concat(i?"textarea":"input type=text",' style="width:100%" ').concat(i?"rows=".concat(p,">"):'value="').concat(b.escape(l)).concat(i?"</textarea>":'">');return o&&(m=Array.from(h),e.data.inputBoxEvent=function(e){var t=e.val().length,t=m.slice(0,t).join("");return e.val(t),u&&(t=u.set(t),y.containsError(t))&&e.replaceWith(t.render("")),!0}),e.styles.push({display:"block","margin-left":d?f+"%":void 0,width:d?d+"%":"100%","border-style":function(){return this.style.borderStyle||"solid"}}),C(e,{source:c,append:"replace"})},g.endsWith("box")?[_(v,String),x(_(A,String)),x(_(A,String)),x(String)]:[x(_(v,String)),x(String),x(String)])}),["show","rerun"].forEach(function(s){return n.addCommand(s,function(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(function e(t){var n=t.selector,t=t.next;return"name"===n.type&&"page"===n.data?(r=y.create("macrocall","You can't (hide:) the ?page. Sorry."),!0):!!("base"===n.type&&e(n.data)||t&&e(t))||void 0}),r},function(o,i){for(var e=arguments.length,t=new Array(2<e?e-2:0),n=2;n<e;n++)t[n-2]=arguments[n];return t.forEach(function(e){return e.forEach(i,function(e){var t,n,r,a=e.data("hidden");void 0!==a!=("rerun"===s)&&(e.removeData("hidden"),a instanceof u?e.empty().append(a):(a=e.data("tempVariables"),n=(t="tw-passage"===e.tag())?l.getTree(c.passage):e.data("originalSource")||"",t&&(r=e.find("tw-sidebar").detach()),i.renderInto("",null,_objectSpread(_objectSpread({},o),{},{append:"replace",source:n,target:e}),a&&Object.create(a)),r&&e.prepend(r)))})}),o},[T(o)])});n.addCommand("hide",function(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(function e(t){var n=t.selector,t=t.next;return"name"===n.type&&"page"===n.data?(r=y.create("macrocall","You can't (hide:) the ?page. Sorry."),!0):!!("base"===n.type&&e(n.data)||t&&e(t))||void 0}),r},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,o=n;a<o.length;a++)o[a].forEach(e,function(e){e.data("hidden")||e.data("hidden",e.contents().detach())})},[T(o)],!1)("scroll",P,function(m,e,g){var y="number"==typeof g&&g;requestAnimationFrame(function(){e.forEach(m,function(e){if(!1!==y){var t,n,r=e[0];null!=(t=(n=r=r===b.storyElement[0]&&r.scrollHeight===r.clientHeight?getComputedStyle(document.body).overflow.includes(" scroll")?document.body:document.documentElement:r).scrollTo)&&t.call(n,0,(r.scrollHeight-r.clientHeight)*y)}else{var a,o=_createForOfIteratorHelper(g.hooks(m).get());try{for(o.s();!(a=o.n()).done;){var i=a.value;if(e.find(i)){for(var s=[],c=e[0];(c=c.parentNode)&&c!==document.body;)s.push([c,c.scrollLeft,c.scrollTop]);i.scrollIntoView();for(var l=0,u=s;l<u.length;l++){var p=_slicedToArray(u[l],3),d=p[0],f=p[1],h=p[2];d.scrollLeft=f,d.scrollTop=h}break}}}catch(e){o.e(e)}finally{o.f()}}})})},[o,_(L,o)],!1)("stop",P,P,[],!1)("load-game",P,function(e,t){var n,r;return e.loadedGame?y.create("infinite","I can't use (load-game:) immediately after loading a game."):(n=localStorage.getItem(R("Saved Game")+t))?(n=c.deserialise(e,n))instanceof Error?{blocked:r=k({message:"Sorry to interrupt... The story tried to load saved data, but there was a problem.\n"+n.message+"\n\nThat data might have been saved from a different version of this story. Should I delete it?\n(Type 'delete' and choose Yes to delete it.)\n\nEither way, the story will now continue without loading the data.",defaultValue:"",buttons:[{name:"Yes",confirm:!0,callback:function(){"delete"===r.find("input").last().val()&&localStorage.removeItem(R("Saved Game")+t),e.unblock("")}},{name:"No",cancel:!0,callback:function(){return e.unblock()}}]})}:void requestAnimationFrame(a.showPassage.bind(a,c.passage,{loadedGame:!0})):y.create("saving","I can't find a save slot named '"+t+"'!")},[String],!1)("forget-undos",P,function(e,t){c.futureLength||c.forgetUndos(t)},[parseInt],!1)("forget-visits",P,function(e,t){c.forgetVisits(t)},[parseInt],!1)("mock-visits",function(){if(!b.options.debug)return y.create("debugonly","(mock-visits:) cannot be used outside of debug mode.");for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.find(function(e){return!l.hasValid(e)});return r?y.create("datatype","I can't mock-visit '"+r+"' because no passage with that name exists."):void 0},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];c.mockVisits=g(n)},[T(String)],!1)("mock-turns",function(){if(!b.options.debug)return y.create("debugonly","(mock-turns:) cannot be used outside of debug mode.")},function(e,t){c.mockTurns=t},[H],!1)("seed",P,function(e,t){c.setSeed(t)},[String],!1)(["dialog","alert"],function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(v.isPrototypeOf(e)){if("two way"===e.bind)return y.create("datatype","(dialog:) shouldn't be given two-way bound variables.",'Change the "2bind" keyword to just "bind".');if(void 0===t)return y.create("datatype","(dialog:) needs a message string or codehook to display.")}else void 0!==t&&r.unshift(t);e=r.findIndex(function(e){return""===e});if(-1<e)return y.create("datatype","(dialog:)'s ".concat(b.nth(e+1)," link text shouldn't be an empty string."))},function(e,n,r,t){for(var a=arguments.length,o=new Array(4<a?a-4:0),i=4;i<a;i++)o[i-4]=arguments[i];return v.isPrototypeOf(r)||(void 0!==t&&o.unshift(t),t=r,r=void 0),o.length||(o=["OK"]),{blocked:k({section:n,message:t,cd:e,buttons:o.map(function(t){return{name:t,callback:function(){var e;n.unblock((null==(e=r)?void 0:e.set(t))||"")}}})})}},[_(v,String,t),x(_(t,String)),O(String)])("open-url",P,function(e,t){window.open(t,"")},[String],!1)(["restart","reload"],P,function(){if(!b.options.ignoreGotos){if(c.turns<=1)return y.create("infinite","I mustn't (restart:) the story in the starting passage.");c.hasSessionStorage&&sessionStorage.removeItem("Saved Session"),window.location.reload()}},[],!1)("goto-url",P,function(e,t){window.location.assign(t)},[String],!1)("ignore",P,P,[O(F)])("assert-exists",function(e){if(""===e)return y.create("datatype","(assert-exists:) mustn't be given an empty string.")},function(e,t,n){var r=0;return("string"==typeof n?o.create({type:"string",data:n}):n).forEach(t,function(){++r}),r?e:y.create("assertion","I didn't see any ".concat("string"==typeof n?"text occurrences of":"hooks matching"," ").concat(w(n)," in this passage."))},[_(o,String)]),n.add("assert","Instant",function(e,t){return t?{TwineScript_TypeID:"instant",TwineScript_TypeName:"an (assert:) operation",TwineScript_ObjectName:"an (assert:) operation",TwineScript_Unstorable:!0,TwineScript_Print:function(){return""}}:C(y.create("assertion","An assertion failed: "),{appendTitleText:!0})},[Boolean])("save-game","Boolean",function(e,t,n){if(n=n||"",!c.hasStorage)return!1;var r=c.serialise(!1).pastAndPresent;if(y.containsError(r))return r;if(!1===r)return!1;try{return localStorage.setItem(R("Saved Game")+t,r),localStorage.setItem(R("Saved Game Filename")+t,n),!0}catch(e){return!1}},[String,x(String)])("prompt","String",function(e,t,n,r,a){var o,i;return null!=(o=e.stackTop)&&o.evaluateOnly?y.create.apply(y,["macrocall"].concat(_toConsumableArray(I(e.stackTop.evaluateOnly)))):""===a?y.create("datatype","The text for (prompt:)'s confirm link can't be blank."):(i=k({section:e,message:t,defaultValue:n,buttons:[{name:a||"OK",confirm:!0,callback:function(){return e.unblock(i.find("input").last().val())}}].concat(""===r?[]:{name:r||"Cancel",cancel:!0,callback:function(){return e.unblock(n)}})}),e.stackTop.blocked=i,0)},[_(String,t),String,x(String),x(String)])("confirm","Boolean",function(e,t,n,r){var a;return null!=(a=e.stackTop)&&a.evaluateOnly?y.create.apply(y,["macrocall"].concat(_toConsumableArray(I(e.stackTop.evaluateOnly)))):""===r?y.create("datatype","The text for (confirm:)'s confirm link can't be blank."):(a=k({section:e,message:t,defaultValue:!1,buttons:[{name:r||"OK",confirm:!0,callback:function(){return e.unblock(!0)}}].concat(""===n?[]:{name:n||"Cancel",cancel:!0,callback:function(){return e.unblock(!1)}})}),e.stackTop.blocked=a,0)},[_(String,t),x(String),x(String)])("page-url","String",function(){return window.location.href},[])}),define("macrolib/custommacros",["utils","macros","state","utils/operationutils","datatypes/changercommand","datatypes/custommacro","datatypes/codehook","datatypes/typedvar","internaltypes/twineerror"],function(c,l,u,e,t,p,n,d,f){function s(e,t,n){if(!t.some(function(e){if("function"==typeof e.output)return e.output(n),!0}))return f.create("macrocall","("+e+":) should only be used inside a code hook passed to (macro:).")}var h=e.objectName,m=e.toSource,e=l.add,r=l.addChanger,a=l.addCommand,o=l.TypeSignature,i=o.rest,g=o.either,y=o.Any,b=o.Everything,o=o.zeroOrMore;e("macro","CustomMacro",function(e){for(var t,n=[],r=arguments.length,a=new Array(1<r?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];for(t=0;t<a.length;t+=1){var i=t===a.length-1;if(d.isPrototypeOf(a[t])===i)return f.create("datatype","The "+(i?"":c.nth(a.length-t+1)+"-")+"last value given to (macro:) should be a "+(i?"code hook":"datatyped variable")+", not "+h(a[t]));if(!i){i="A custom macro";if(a[t].varRef.object===u.variables)return f.create("datatype",i+"'s typed variables must be temp variables (with a '_'), not global variables (with a '$').","Write them with a _ symbol at the start instead of a $ symbol.");if(1<a[t].varRef.propertyChain.length)return f.create("datatype",i+"'s typed variables can't be properties inside a data structure.");if(a[t].datatype.rest&&t!==a.length-2)return f.create("datatype",i+" can only have one spread variable, and it must be its last variable.");var s=a[t].varRef.propertyChain[0];if(n.includes(s))return f.create("datatype",i+"'s typed variables can't both be named '"+s+"'.");n.push(s)}}return p.create(a.slice(0,-1),a[a.length-1])},[i(g(d,n))]);a(["output-data","out-data"],function(){},function(e,t){e=e.stack;return s("output-data",e,t)||{blocked:!0}},[y],!1),r(["output","out"],function(){return Object.assign(t.create("output",[]))},function(e,t){if(e.section){var n,r=e.section,a=r.stack,o=r.stackTop,i={};for(n in o.tempVariables)n.startsWith("TwineScript_")||(i[n]=o.tempVariables[n]);s("output",a,{changer:t,variables:i,hook:Array.isArray(e.source)?"["+e.source.map(function(e){return e.text}).join("")+"]":e.source}),e.output=!0,o.blocked=!0}},[]),a("error",function(e){if(!e)return f.create("datatype","This (error:) macro was given an empty string.")},function(e,t){e=e.stack;return s("error",e,f.create("user",t))||{blocked:!0}},[String],!1),e("partial","CustomMacro",function(e,a){for(var t=arguments.length,o=new Array(2<t?t-2:0),n=2;n<t;n++)o[n-2]=arguments[n];var r="string"!=typeof a&&a,i=!r&&a;if(!r){if(!l.has(i))return f.create("macrocall",'The macro name given to (partial:), "'.concat(a,"\", isn't the name of a built-in macro."));if("Metadata"===l.get(i).returnType)return f.create("macrocall","(partial:) can't be used with metadata macros such as (".concat(a,":)"))}var s="(partial:".concat(m(a),",").concat(o.map(function(e){return m(e)}),")"),c=p.createFromFn(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=l["string"==typeof a?"run":"runCustom"](a,e,o.concat(n));return f.containsError(e)&&(e.message="An error occurred while running the (partial:)-created macro, ".concat(c.TwineScript_ObjectName,":\n")+e.message),e},"a (partial:) custom macro of ".concat(i||r.TwineScript_KnownName?"(".concat(i||r.TwineScript_KnownName,":").concat(o.map(function(e){return m(e)}),")"):"another unnamed custom macro"),function(){return s},(i?l.get(i):r).typeSignature.filter(function(e,t){return t>=o.length||"rest"===e.pattern||"zero or more"===e.pattern}));return c},[g(String,p),o(b)])}),define("macrolib/datastructures",["utils","utils/naturalsort","macros","utils/operationutils","state","engine","passages","datatypes/lambda","datatypes/typedvar","internaltypes/twineerror"],function(e,i,t,n,s,r,a,c,o,l){var u=e.permutations,p=e.options,d=n.objectName,f=n.subset,h=n.collectionType,m=n.isValidDatamapName,g=n.is,y=n.unique,b=n.clone,v=n.range,e=t.TypeSignature,n=e.optional,w=e.rest,k=e.either,S=e.zeroOrMore,T=e.Any,e=e.nonNegativeInteger,_=i("en");t.add(["a","array"],"Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n},S(k(o,T)))("range","Array",function(e,t,n){return v(t,n)},[parseInt,parseInt])("subarray","Array",function(e,t,n,r){return f(t,n,r)},[Array,parseInt,parseInt])("reversed","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reverse().map(b)},S(T))("shuffled","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return s.shuffled.apply(s,n).map(b)},[S(T)])("sorted","Array",function(e){for(var t,n=arguments.length,r=new Array(1<n?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];if(!c.isPrototypeOf(r[0]))return(t=r.filter(function(e){return"string"!=typeof e&&"number"!=typeof e}))&&t.length?1===t.length&&Array.isArray(t[0])?l.create("macrocall","Please give multiple numbers or strings to (sorted:), not a single array.","You can use the spread ... syntax to spread out the array's values into (sorted:)."):l.create("datatype","If (sorted:) isn't given a 'via' lambda, it must be given only numbers and strings, not ".concat(d(t[0]),".")):r.sort(_);var o=r.shift();if("making"in o||"where"in o||"when"in o||!("via"in o))return l.create("datatype","The optional lambda given to (sorted:) must be a 'via' lambda, not ".concat(d(o),"."));for(var i=0;i<r.length;i+=1){var s=o.apply(e,{loop:r[i],pos:i+1});if(l.containsError(s))return s;if("string"!=typeof s&&"number"!=typeof s)return l.create("datatype",'The "via" lambda given to (sorted:) couldn\'t convert '.concat(d(r[i])," into a string or number."));r[i]=[r[i],s]}return r.sort(function(e,t){return _(e[1],t[1])}).map(function(e){return e[0]})},[S(T)])("rotated","Array",function(e,t){if(0===t)return l.create("macrocall","I can't rotate these values by 0 positions.");for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=-1*(t=Math.abs(t)%r.length*Math.sign(t));return r.slice(t).concat(r.slice(0,t)).map(b)},[parseInt,S(T)])("rotated-to","Array",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)?t:t.length?(e=r.indexOf(t[0]),r.slice(e).concat(r.slice(0,e)).map(b)):l.create("macrocall","None of these "+r.length+" values matched the lambda, so I can't rotate them.")},[c.TypeSignature("where"),w(T)])("repeated","Array",function(e,t){for(var n=[],r=arguments.length,a=new Array(2<r?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];if(!a.length)return n;for(;0<t--;)n.push.apply(n,a);return n.map(b)},[e,w(T)])("interlaced","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=Math.min.apply(Math,_toConsumableArray(n.map(function(e){return e.length}))),o=[],i=0;i<a;i+=1)for(var s=0;s<n.length;s+=1)o.push(b(n[s][i]));return o},[Array,w(Array)])("permutations","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.length?u.apply(void 0,n):[]},[S(T)])("unique","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.filter(y)},[S(T)])("altered","Array",function(n,r){for(var e=arguments.length,t=new Array(2<e?e-2:0),a=2;a<e;a++)t[a-2]=arguments[a];return t.map(function(e,t){t=r.apply(n,{loop:e,pos:t+1});return null===t?e:t})},[k(c.TypeSignature("via"),c.TypeSignature("where","via")),S(T)])("find","Array",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return t.filter(e,r)},[c.TypeSignature("where"),S(T)])(["all-pass","pass"],"Boolean",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)||t.length===r.length},[c.TypeSignature("where"),S(T)])("some-pass","Boolean",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)||0<t.length},[c.TypeSignature("where"),S(T)])("none-pass","Boolean",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)||0===t.length},[c.TypeSignature("where"),S(T)])("folded","Any",function(r,a){for(var e=arguments.length,t=new Array(2<e?e-2:0),n=2;n<e;n++)t[n-2]=arguments[n];return"where"in a&&(t=[t[0]].concat(_toConsumableArray(a.filter(r,t.slice(1))))),l.containsError(t)||t.reduce(function(e,t,n){return a.apply(r,{making:e,loop:t,pos:n+1})})},[k(c.TypeSignature("where","via","making"),c.TypeSignature("via","making")),w(T)])(["dm-names","datamap-names","datanames"],"Array",function(e,t){return Array.from(t.keys()).sort(i("en"))},[Map])(["dm-values","datamap-values","datavalues"],"Array",function(e,t){return Array.from(t.entries()).sort(i("en",function(e){return String(e[0])})).map(function(e){return b(e[1])})},[Map])(["dm-entries","datamap-entries","dataentries"],"Array",function(e,t){return Array.from(t.entries()).sort(function(e,t){return[e[0],t[0]].sort(i("en"))[0]===e[0]?-1:1}).map(function(e){return new Map([["name",e[0]],["value",b(e[1])]])})},[Map])(["dm-altered","datamap-altered"],"Datamap",function(a,o,e){return Array.from(e.entries()).sort(function(e,t){return[e[0],t[0]].sort(i("en"))[0]===e[0]?-1:1}).reduce(function(e,t,n){if(!l.containsError(e)){var r=new Map([["name",t[0]],["value",b(t[1])]]),r=o.apply(a,{loop:r,pos:n+1});if(l.containsError(r))return r;e.set(t[0],null===r?t[1]:r)}return e},new Map)},[k(c.TypeSignature("via"),c.TypeSignature("where","via")),Map])("history","Array",function(e,t){var n=s.history();return t?(t=t.filter(e,n.map(function(e){return a.get(e)})),l.containsError(t)?t:t.map(function(e){return e.get("name")})):n},[n(c.TypeSignature("where"))])("visited","Boolean",function(e,t){var n;return"string"==typeof t?a.has(t)?0<s.passageNameVisited(t)||s.passage===t:l.create("macrocall","There's no passage named '"+t+"' in this story."):(n=s.history(),n=t.filter(e,n.concat(s.passage).map(function(e){return a.get(e)})),l.containsError(n)?n:0<n.length)},[k(String,c.TypeSignature("where"))])("passage","Datamap",function(e,t){return b(a.get(t||s.passage))||l.create("macrocall","There's no passage named '"+t+"' in this story.")},[n(String)])("passages","Array",function(e,t){var n=i("en"),r=_toConsumableArray(a.values()).map(function(e){return b(e)}),t=t?t.filter(e,r):r,e=l.containsError(t);return e||t.sort(function(e,t){return n(e.get("name"),t.get("name"))})},[n(c.TypeSignature("where"))])("open-storylets","Array",function(e,t){return e.stackTop.evaluateOnly?l.create("macrocall","(open-storylets:) can't be used in "+e.stackTop.evaluateOnly+"."):(e=a.getStorylets(e,t),l.containsError(e)||e.map(b))},[n(c.TypeSignature("where"))])("savedgames","Datamap",function(){function e(e){return"("+e+" "+p.ifid+") "}var t,n,r=0,a=new Map;do{if(!s.hasStorage)break;t=localStorage.key(r),r+=1;var o=e("Saved Game")}while(null!=(n=t)&&n.startsWith(o)&&(t=t.slice(o.length),a.set(t,localStorage.getItem(e("Saved Game Filename")+t))),t);return a},[])(["datamap","dm"],"Datamap",function(e){for(var r,a=new Map,t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var i=n.reduce(function(e,t){var n;if(!l.containsError(e))if(void 0===r)r=t;else{if(n=l.containsError(m(a,r)))return n;if(a.has(r))return l.create("macrocall","You used the same data name ("+d(r)+") twice in the same (datamap:) call.");a.set(r,b(t)),r=void 0}return e},!0);return l.containsError(i)?i:void 0!==r?l.create("macrocall","This datamap has a data name without a value."):a},S(k(o,T)))(["dataset","ds"],"Dataset",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new Set(n.filter(y).map(b))},S(T))("count","Number",function t(n,r){for(var e,a=arguments.length,o=new Array(2<a?a-2:0),i=2;i<a;i++)o[i-2]=arguments[i];if(1<o.length)return e=o.map(function(e){return t(n,r,e)}),l.containsError(e)||e.reduce(function(e,t){return e+t},0);var s=o[0];switch(h(r)){case"dataset":case"datamap":return l.create("macrocall","(count:) shouldn't be given a datamap or dataset.","You should use the 'contains' operator instead. For instance, write: $variable contains 'value'.");case"string":return"string"!=typeof s?l.create("macrocall",d(r)+" can't contain  "+d(s)+" because it isn't also a string."):s?r.split(s).length-1:0;case"array":return r.reduce(function(e,t){return e+g(t,s)},0);default:return l.create("macrocall",d(r)+" can't contain values, let alone "+d(s)+".")}},[T,w(T)])}),define("macrolib/enchantments",["jquery","utils","utils/operationutils","engine","state","passages","macros","datatypes/hookset","datatypes/codehook","datatypes/changercommand","datatypes/lambda","internaltypes/changedescriptor","internaltypes/enchantment","internaltypes/twineerror"],function(c,r,e,l,s,n,u,p,a,d,t,i,f,h){var m=e.is,e=u.TypeSignature,g=e.either,y=e.rest,o=e.optional,b=Object.assign;function v(e,t){if(d.isPrototypeOf(t)&&!t.canEnchant)return h.create("datatype","The changer given to (".concat(e,":) can't include a revision, enchantment, or interaction changer like (replace:), (click:), or (link:)."))}["enchant","change"].forEach(function(o){u.addCommand(o,function(e,t){t=v(o,t);if(t)return t},function(t,n,e){n=p.from(n);var r,a=[];return d.isPrototypeOf(e)&&(r=i.create({section:t}),e.run(r),0<(r.innerEnchantments||[]).length)&&(r=r.innerEnchantments.map(function(e){return e(n)}),a.push.apply(a,_toConsumableArray(r))),a.push(f.create(_defineProperty(_defineProperty({scope:n},d.isPrototypeOf(e)?"changer":"lambda",e),"section",t))),a.forEach(function(e){"enchant"===o?(t.addEnchantment(e),t.updateEnchantments()):e.enchantScope()}),""},[g(p,String),g(d,t.TypeSignature("via"))],!1)}),u.addChanger("enchant-in",function(e,t,n){var r=v("enchant-in",n);return r||d.create("enchant-in",[t,n])},function(t,n,r){return t.innerEnchantments=(t.innerEnchantments||[]).concat(function(e){return f.create(_defineProperty(_defineProperty({scope:p.from(n),localHook:e},d.isPrototypeOf(r)?"changer":"lambda",r),"section",t.section))}),t},[g(p,String),g(d,t.TypeSignature("via"))]),[["link-style",p.create({type:"name",data:"link"})],["line-style",p.create({type:"base",data:p.create({type:"name",data:"page"})},"lines",void 0)],["char-style",p.create({type:"base",data:p.create({type:"name",data:"page"})},"chars",void 0)]].forEach(function(e){var e=_slicedToArray(e,2),r=e[0],a=e[1];u.addChanger(r,function(e,t){var n=v(r,t);return n||d.create(r,[t])},function(t,n){return t.innerEnchantments=(t.innerEnchantments||[]).concat(function(e){return f.create(_defineProperty(_defineProperty({scope:a,localHook:e},d.isPrototypeOf(n)?"changer":"lambda",n),"section",t.section))}),t},[g(d,t.TypeSignature("via"))])});e=["replace","append","prepend"];function w(i,s){return r.onStartup(function(){var e=i.classList.replace(/ /g,"."),t=i.blockClassList?i.blockClassList.replace(/ /g,"."):"",n="."+e+(t?",."+t:"");r.storyElement.on(i.event.map(function(e){return e+".enchantment"}).join(" "),n,function(){var e,t=c(this);r.options.debug&&r.options.ignoreClickEvents&&!t.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *")||t.is("tw-open-button")||(e=(t=c(Array.from(t.parents(n).add(this)).sort(function(e,t){return 8&e.compareDocumentPosition(t)?1:-1})[0])).data("enchantmentEvent"))&&e(t)})}),[function(e,t,n){if(!t)return h.create("datatype","A string given to this ("+s+":) macro was empty.");if(n){var r=v(s,n);if(r)return r}return d.create(s,[p.from(t)].concat(n?[n]:[]))},function(t,e,n){t.enabled=!1,t.transitionDeferred=!0,i.rerender&&(t.newTargets=(t.newTargets||[]).concat({target:e,append:i.rerender}));var r,a=null!=(r=t.section)&&r.stackTop?t.section.stackTop.tempVariables:Object.create(null),o=f.create(_defineProperty({functions:[function(e){e.attr("class",e.children().is("tw-story, tw-sidebar, tw-passage")||["block","flex"].includes(e.children().css("display"))?i.blockClassList:i.classList),e.attr({tabIndex:"0"})}],data:{enchantmentEvent:function(){var e;null!=(e=t.section.stackTop)&&e.blocked||(i.once&&t.section.removeEnchantment(o),i.goto?l.goToPassage(i.goto,{transition:i.transition}):i.undo?l.goBack({transition:i.transition}):t.section.renderInto(t.source,null,_objectSpread(_objectSpread({},t),{},{append:i.once?"append":"replace",enabled:!0,transitionDeferred:!1}),a))}},scope:e,section:t.section,name:s},d.isPrototypeOf(n)?"changer":"lambda",n));return t.section&&(t.section.addEnchantment(o),o.enchantScope()),t},[g(p,String),o(g(d,t.TypeSignature("via")))]]}e.forEach(function(o){u.addChanger(o,function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.every(Boolean)?d.create(o,n.map(p.from),null,!1):h.create("datatype","A string given to this (".concat(o,":) macro was empty."))},function(e){var t;0<c(e.target).parents().filter("tw-collapsed,[collapsing=true]").length||e.attr.some(function(e){return e.collapsing})||(e.attr=[].concat(_toConsumableArray(e.attr),[{collapsing:!1}])),e.newTargets=e.newTargets||[];for(var n=arguments.length,r=new Array(1<n?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=e.newTargets).push.apply(t,_toConsumableArray(r.filter(function(n){return!e.newTargets.some(function(e){var t=e.target,e=e.append;return m(n,t)&&o===e})}).map(function(e){return{target:e,append:o,before:!0}}))),e},y(g(p,String)))(o+"-with",function(e,t){return d.create(o+"-with",[t],null,!1)},function(e,t){return a.isPrototypeOf(t)&&(t=t.code),e.appendSource=(e.appendSource||[]).concat({source:t,append:o}),e},g(a,String))});var k="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints,S=[{name:"click",enchantDesc:{event:["click"],once:!0,rerender:"",classList:"link enchantment-link",blockClassList:"enchantment-clickblock"}},{name:"mouseover",enchantDesc:{event:["mouseenter",k?"click":""].filter(Boolean),once:!0,rerender:"",classList:"link enchantment-mouseover",blockClassList:"enchantment-mouseoverblock"}},{name:"mouseout",enchantDesc:{event:["mouseleave",k?"click":""].filter(Boolean),once:!0,rerender:"",classList:"link enchantment-mouseout",blockClassList:"enchantment-mouseoutblock"}},{name:"doubleclick",enchantDesc:{event:["dblclick"],once:!0,rerender:"",classList:"link enchantment-dblclick",blockClassList:"enchantment-dblclickblock"}}];S.forEach(function(e){"doubleclick"!==e.name&&(u.addChanger.apply(u,[e.name].concat(_toConsumableArray(w(e.enchantDesc,e.name)))),"click"===e.name)&&u.addChanger.apply(u,[e.name+"-rerun"].concat(_toConsumableArray(w(_objectSpread(_objectSpread({},e.enchantDesc),{},{once:!1}),e.name+"-rerun"))))}),r.onStartup(function(){S.forEach(function(e){var n=e.enchantDesc;n.blockClassList&&r.storyElement.on(n.event.map(function(e){return e+".enchantment"}).join(" "),function(){var e,t=c(this);r.options.debug&&r.options.ignoreClickEvents&&!t.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *")||t.is("tw-open-button")||(e=(t=c(Array.from(t.parents("."+n.blockClassList.replace(/ /g,"."))).sort(function(e,t){return 8&e.compareDocumentPosition(t)?1:-1})[0])).data("enchantmentEvent"))&&e(t)})})}),e.forEach(function(n){S.forEach(function(e){var t;"doubleclick"!==e&&(t=_objectSpread(_objectSpread({},e.enchantDesc),{},{rerender:n}),e=e.name+"-"+n,u.addChanger.apply(u,[e].concat(_toConsumableArray(w(t,e)))))})}),S.forEach(function(i){"doubleclick"!==i&&["goto","undo"].forEach(function(a){var o=i.name+"-"+a;u.addCommand(o,function(e,t){return!e||!t&&"goto"===a?h.create("datatype","A string given to this ("+o+":) macro was empty."):"goto"!==a||n.hasValid(t)?void 0:h.create("macrocall","I can't ("+o+":) the passage '"+t+"' because it doesn't exist.")},function(e,t,n,r){return"undo"===a&&s.pastLength<1?h.create("macrocall","I can't (undo:) on the first turn."):((0,_slicedToArray(w(_objectSpread(_objectSpread({},i.enchantDesc),{},{transition:e.data.passageT8n},"undo"===a?{undo:!0}:{goto:r}),o),2)[1])({section:t},p.from(n)),b(e,{source:""}))},[g(p,String)].concat("undo"===a?[]:String))})})}),define("macrolib/links",["jquery","macros","utils","state","passages","engine","datatypes/changercommand","internaltypes/changedescriptor","datatypes/hookset","datatypes/lambda","internaltypes/twineerror"],function(i,e,c,l,u,p,a,d,t,f,h){var n=e.TypeSignature,r=n.optional,o=n.rest,n=n.either,m=["Links can't have empty strings for their displayed text.","In the link syntax, a link's displayed text is inside the [[ and ]], and on the non-pointy side of the -> or <- arrow if it's there."],g=Object.assign;function s(e,t,n){n=n||t;var r,a=u.hasValid(t)&&t===n,e=e.evaluateTwineMarkup(c.unescape(n),"a link's passage name");return a?t=(a=0<e.children().length?"`".repeat((n.match(/`+/)||[]).reduce(function(e,t){return Math.max(e,t.length+1)},1)):"")+"\0".repeat(!!a)+t+"\0".repeat(!!a)+a:(e.findAndFilter("tw-error").length&&(r=e.findAndFilter("tw-error").data("TwineError")),n=e.text()),{text:t,passage:n,error:r}}c.onStartup(function(){var e="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints;function t(e){var t=i(this),n=t.closest("tw-expression"),r=t.closest("tw-expression, tw-hook"),a=r.data("clickEvent"),r=r.data("section");if((!c.options.debug||!c.options.ignoreClickEvents||t.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *"))&&!t.is("tw-open-button")&&(null==r||!r.stackTop||!r.stackTop.blocked||r.stackTop.blocked instanceof i&&r.stackTop.blocked.find(t).length)){if(a)return 0<t.find("tw-error").length?void 0:(e.stopPropagation(),void a(t));var r=n.data("linkPassageName"),o=_objectSpread({},n.data("passageT8n")||{});n.find("tw-enchantment").each(function(e,t){Object.assign(o,i(t).data("passageT8n")||{})}),r?(e.stopPropagation(),p.goToPassage(r,{transition:o})):t.is("[undo]")?(e.stopPropagation(),p.goBack({transition:o})):t.is("[fullscreen]")&&(e.stopPropagation(),p.toggleFullscreen())}}c.storyElement.on("click.passage-link","tw-link"+(e?"":":not(.enchantment-mouseover):not(.enchantment-mouseout):not(.enchantment-dblclick)"),t).on("mouseover.passage-link","tw-link.enchantment-mouseover, tw-expression.enchantment-mouseover > tw-link",t).on("mouseout.passage-link","tw-link.enchantment-mouseout, tw-expression.enchantment-mouseout > tw-link",t).on("dblclick.passage-link","tw-link.enchantment-dblclick, tw-expression.enchantment-dblclick > tw-link",t),i(document).on("fullscreenchange",function(){i("tw-link[fullscreen]",c.storyElement).each(function(e,t){(i(t).closest("tw-expression, tw-hook").data("fullscreenEvent")||Object)(t)})})}),[["link","link-replace"],["link-reveal","link-append"],["link-repeat"],["link-rerun"]].forEach(function(s){return e.addChanger(s,function(e,t,n){return t?n&&!n.canEnchant?h.create("datatype","The changer given to (".concat(s[0],":) can't be (or include) a revision, enchantment, or interaction changer like (replace:), (click:), or (link:).")):a.create(s[0],[t].concat(n||[]),null,!0):h.create("datatype",m[0])},function(r,e,t){var n,a=s[0],o=null!=(n=r.section)&&n.stackTop?r.section.stackTop.tempVariables:Object.create(null),i=d.create({source:"<tw-link tabindex=0>"+e+"</tw-link>",target:function(){return r.target},append:"replace",data:{section:r.section,clickEvent:function(e){r.enablers=r.enablers.filter(function(e){return e.descriptor!==i}),"link-reveal"===a&&e.contents().unwrap();var t,n=e.parentsUntil(":not(tw-enchantment)").parent();n.length||(n=e.parent()),"link-rerun"===a&&(t=e.parentsUntil(":not(tw-enchantment)"),e.detach(),t.remove()),"link"!==a&&"link-rerun"!==a||n.empty(),r.section.renderInto("",null,r,o),"link-rerun"===a&&n.prepend(e)}}});return r.enablers=(r.enablers||[]).concat({descriptor:i,changer:t}),r},[String,r(a)])}),e.addCommand("link-goto",function(e){if(!e)return h.create.apply(h,["datatype"].concat(m))},function(e,t,n,r){var a,o=s(t,n,r);return n=o.text,r=o.passage,(o=o.error)||(e.transition?h.create("datatype","Please attach ("+(o="transition")+"-depart:) or ("+o+"-arrive:) to a passage link, not ("+o+":)."):(a=(a=u.hasValid(r)?a:'<tw-broken-link passage-name="'+c.escape(r)+'">'+n+"</tw-broken-link>")||"<tw-link tabindex=0 "+(0<l.passageNameVisited(r)?'class="visited" ':"")+">"+n+"</tw-link>",e.data.linkPassageName=r,e.data.section=t,g(e,{source:a,transitionDeferred:!0})))},[String,r(String)])("link-storylet",function(){var e=(e=1===arguments.length||"string"!=typeof(arguments.length<=0?void 0:arguments[0])?0:1)<0||arguments.length<=e?void 0:arguments[e];if(!e||"string"==typeof e)return h.create("datatype","(link-storylet:) should be given one index number or one 'where' lambda, after the optional link text string.")},function(e,t){var n=(n=2+("string"==typeof(arguments.length<=2?void 0:arguments[2])?1:0))<2||arguments.length<=n?void 0:arguments[n],r="string"==typeof(arguments.length<=2?void 0:arguments[2])&&(arguments.length<=2?void 0:arguments[2]),a=((a=(arguments.length<=2?0:arguments.length-2)-1+2)<2||arguments.length<=a?void 0:arguments[a])!==n&&((a=(arguments.length<=2?0:arguments.length-2)-1+2)<2||arguments.length<=a?void 0:arguments[a]);if(e.transition)return h.create("datatype","Please attach (".concat(o="transition","-depart:) or (").concat(o,"-arrive:) to (link-storylet:), not (").concat(o,":)."));var o=f.isPrototypeOf(n),i=u.getStorylets(t,o&&n),s=h.containsError(i);if(s)return s;var c,s=i[o?0:n<0?i.length+n:n-1];if(s)s=s.get("name"),r=r||s,c=c||"<tw-link tabindex=0 "+(0<l.passageNameVisited(s)?'class="visited" ':"")+">"+r+"</tw-link>",e.data.linkPassageName=s,e.data.section=t;else{if(!a)return e;c=a}return g(e,{source:c,transitionDeferred:!0})},[n(parseInt,String,f.TypeSignature("where")),r(n(parseInt,String,f.TypeSignature("where"))),r(String)])("link-undo",function(e){if(!e)return h.create("datatype",m[0])},function(t,e,n){var r,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"";return l.pastLength<1?g(t,{source:a}):(r=(t.data.section=e).stackTop.tempVariables,t.data.forgetUndosEvent=function(){return t.data.section.whenUnblocked(function(){var e=_objectSpread(_objectSpread({},t),{},{append:"replace",source:a,transitionDeferred:!1});t.section.renderInto("",null,e,r)})},g(t,{source:"<tw-link tabindex=0 undo>"+n+"</tw-link>",transitionDeferred:!0}))},[String,r(String)])("link-show",function(e){if(!e)return h.create("datatype",m[0])},function(r,a,e){for(var t=arguments.length,n=new Array(3<t?t-3:0),o=3;o<t;o++)n[o-3]=arguments[o];return r.data.section=a,r.data.clickEvent=function(e){e.contents().unwrap(),n.forEach(function(e){return e.forEach(a,function(e){var t=e.data("originalSource")||"",n=e.data("hidden");n&&(e.removeData("hidden"),n instanceof i?e.empty().append(n):(n=e.data("tempVariables"),a.renderInto("",null,_objectSpread(_objectSpread({},r),{},{source:t,target:e,transitionDeferred:!1}),n&&Object.create(n))))})})},g(r,{source:"<tw-link tabindex=0>"+e+"</tw-link>",transitionDeferred:!0})},[String,o(t)])("link-fullscreen",function(e,t){if(!e||!t)return h.create("datatype",m[0])},function(t,e,n,r){function a(){return document.fullscreenEnabled||document.msFullscreenEnabled?"<tw-link tabindex=0 fullscreen>"+(document.fullscreenElement||document.msFullscreenElement?r:n)+"</tw-link>":r?"<tw-broken-link>"+r+"</tw-broken-link>":""}var o=e.stackTop.tempVariables;return t.data.section=e,t.data.fullscreenEvent=function(){(document.fullscreenEnabled||document.msFullscreenEnabled)&&t.data.section.whenUnblocked(function(){var e=_objectSpread(_objectSpread({},t),{},{append:"replace",source:a(),transitionDeferred:!1});t.section.renderInto("",null,e,o)})},g(t,{source:a(),transitionDeferred:!0})},[String,String,r(String)]),e.addChanger(["link-reveal-goto"],function(e,t,n,r){if(!t)return h.create.apply(h,["datatype"].concat(m));if(a.isPrototypeOf(n)){if(a.isPrototypeOf(r))return h.create("datatype","You mustn't give two changers to (link-reveal-goto:)");r=n,n=void 0}return r&&!r.canEnchant?h.create("datatype","The changer given to (link-reveal-goto:) can't include a revision, enchantment, or interaction changer like (replace:), (click:), or (link:)."):(t=(e=s(e,t,n)).text,n=e.passage,e.error||a.create("link-reveal-goto",[t,n,r].filter(function(e){return void 0!==e}),null,!1))},function(t,e,n,r){var a,o,i,s;if(u.hasValid(n))return o=l.passageNameVisited(n),i=null!=(a=t.section)&&a.stackTop?t.section.stackTop.tempVariables:Object.create(null),s=d.create({source:"<tw-link tabindex=0 "+(0<o?'class="visited" ':"")+">"+e+"</tw-link>",target:t.target,append:"replace",data:{section:t.section,append:"replace",clickEvent:function(e){t.enablers=t.enablers.filter(function(e){return e.descriptor!==s}),e.contents().unwrap(),t.section.renderInto("",null,t,i),t.section.whenUnblocked(function(){return p.goToPassage(n,{transition:t.data.passageT8n})})}}}),t.enablers=(t.enablers||[]).concat({descriptor:s,changer:r}),t;t.source='<tw-broken-link passage-name="'+c.escape(n)+'">'+e+"</tw-broken-link>"},[String,r(n(a,String)),r(a)])}),define("macrolib/metadata",["macros","utils/operationutils","datatypes/lambda","internaltypes/twineerror"],function(t,e,n,s){function c(e){return{TwineScript_TypeName:"a ("+e+":) macro",TwineScript_ObjectName:"a ("+e+":) macro",TwineScript_Unstorable:!0,TwineScript_Print:function(){return""}}}var l=e.clone,u=e.objectName,p=e.isValidDatamapName,e=t.TypeSignature,r=e.zeroOrMore,e=e.Any;[["storylet",n.TypeSignature("when")],["urgency",Number],["exclusivity",Number]].forEach(function(e){var e=_slicedToArray(e,2),n=e[0],e=e[1];t.add(n,"Metadata",function(e,t){return e.stackTop.speculativePassage?t:c(n)},e)}),t.add("metadata","Metadata",function(e){for(var r,a=new Map,t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var i=n.reduce(function(e,t){var n;if(!s.containsError(e))if(void 0===r)r=t;else{if(n=s.containsError(p(a,r)))return n;if(a.has(r))return s.create("macrocall","You used the same data name ("+u(r)+") twice in the same (metadata:) call.");a.set(r,l(t)),r=void 0}return e},!0);return s.containsError(i)?i:void 0!==r?s.create("macrocall","This (metadata:) macro has a data name without a value."):e.stackTop.speculativePassage?a:c("metadata")},r(e))}),define("macrolib/patterns",["macros","utils","utils/operationutils","datatypes/lambda","datatypes/datatype","datatypes/typedvar","internaltypes/twineerror","internaltypes/varscope"],function(e,t,n,y,b,h,v,w){function k(e){var r,t,a=e.name,n=e.fullArgs,o=e.args,i=e.makeRegExpString,s=void 0===i?function(e){return e.join("")}:i,c=void 0!==(i=e.insensitive)&&i,l=void 0===(i=e.canContainTypedVars)||i,u=void 0===(i=e.canBeUsedAlone)||i,p=void 0===(i=e.canContainTypedGlobals)||i,d=o||n,f=E(null),e=d.map(function e(t){if(h.isPrototypeOf(t)){var n=t.varRef;if(!l)return v.create("operation","Optional string patterns, like (".concat(a,":)").concat("p-many"===a?" with a minimum of 0 matches":"",", can't have typed variables inside them."));if(!p&&!w.isPrototypeOf(n.object))return v.create("operation","Only typed temp variables can be used in patterns given to (".concat(a,":)"));n=n.getName();if(n in f)return v.create("operation","There's already a typed temp variable named _".concat(n," inside this (").concat(a,":) call."));f[n]=!0;n=e(t.datatype);return v.containsError(n)?n:"("+n+")"}if(b.isPrototypeOf(t)){if(!(l&&p||"function"!=typeof t.typedVars)){n=t.typedVars();if(!l&&n.length)return v.create("operation","(".concat(a,":) can't have typed variables inside its pattern."));if(!p&&n.some(function(e){return!w.isPrototypeOf(e.varRef.object)}))return v.create("operation","Only typed temp variables can be used in patterns given to (".concat(a,":)"))}var r;return t.regExp?(t.rest?"(?:":"")+(c?t.insensitive():t).regExp+(t.rest?")*":""):(n=t.name,r=t.rest?"*":"","alnum"===n?m+r:"whitespace"===n?_+r:"uppercase"===n?(c?T:g)+r:"lowercase"===n?(c?T:S)+r:"anycase"===n?T+r:"digit"===n?"\\d"+r:"linebreak"===n?"(?:\\r|\\n|\\r\\n)"+r:"str"===n?".*?":["even","odd","int","num"].includes(n)?v.create("datatype","Please use string datatypes like 'digit' in (".concat(a,":) instead of number datatypes.")):v.create("datatype","The (".concat(a,":) macro must only be given string-related datatypes, not ").concat(O(t),".")))}return"string"==typeof t?(t=t.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),c?t.replace(RegExp("(".concat(g,"|").concat(S,")"),"g"),function(e){return"["+e.toUpperCase()+e.toLowerCase()+"]"}):t):(x("createPattern","mapper() was given a non-string non-datatype "+t),"")});return(i=v.containsError(e))||(r=s(e),t=C(E(b),{name:a,regExp:r,insensitive:function(){return c?t:k({name:a,fullArgs:n,args:d.map(function(e){return b.isPrototypeOf(e)&&"function"==typeof e.insensitive?e.insensitive():e}),makeRegExpString:s,insensitive:!0,canContainTypedVars:l,canBeUsedAlone:u})},typedVars:function(){return d.reduce(function(e,t){return h.isPrototypeOf(t)&&(e=e.concat(c?h.create(k({name:"p-ins",fullArgs:[t.datatype],insensitive:!0}),t.varRef):t),t=t.datatype),e=b.isPrototypeOf(t)&&"function"==typeof t.typedVars?e.concat(t.typedVars()):e},[])},destructure:function(e){var n,t;return"string"!=typeof e?[v.create("operation","I can't put ".concat(O(e)," into ").concat(this.TwineScript_ToSource()," because it isn't a string."))]:(n=this.typedVars()).length?(t=(RegExp("^"+(this.rest?"(?:":"")+r+(this.rest?")*":"")+"$").exec(e)||[]).slice(1)).length?t.map(function(e,t){t=n[t];if(t)return t.datatype.rest&&!t.datatype.regExp&&((t=t.TwineScript_Clone()).datatype=k({name:"p",fullArgs:[t.datatype]})),{dest:t,value:e||"",src:void 0}}).filter(Boolean):[v.create("operation","I can't put ".concat(O(e)," because it doesn't match the pattern ").concat(this.TwineScript_ToSource(),"."))]:[]},TwineScript_IsTypeOf:function(e){return u?"string"==typeof e&&!!e.match("^"+(this.rest?"(?:":"")+r+(this.rest?")*":"")+"$"):v.create("operation","A (".concat(a,":) datatype must only be used with a (p:) macro."))},TwineScript_toTypeSignatureObject:function(){var t=this;return{pattern:"range",name:a,range:function(e){return t.TwineScript_IsTypeOf(e)}}},TwineScript_ToSource:function(){return(this.rest?"...":"")+"("+a+":"+n.map(A)+")"}}),Object.defineProperty(t,"TwineScript_ObjectName",{get:function(){return"a (".concat(a,":) datatype")}}),t)}var m=t.anyRealLetter,g=t.anyUppercase,S=t.anyLowercase,T=t.anyCasedLetter,_=t.realWhitespace,x=t.impossible,O=n.objectName,A=n.toSource,t=e.TypeSignature,n=t.rest,r=t.either,a=t.optional,t=t.nonNegativeInteger,C=Object.assign,E=Object.create,o=n(r(String,b,h));e.add(["p","pattern"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p",fullArgs:n})},o)(["p-either","pattern-either"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-either",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?:"+e.join("|")+")"}})},o)(["p-opt","pattern-opt","p-optional","pattern-optional"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-opt",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?:"+e.join("")+")?"}})},o)(["p-not","pattern-not"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.find(function(e){return"string"==typeof e?1!==_toConsumableArray(e).length:e.rest||e.regExp||["str","empty"].includes(e.name)})?v.create("datatype","(p-not:) should only be given single characters, or datatypes that match single characters"):k({name:"p-not",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"[^"+e.map(function(e){return e.startsWith("[")&&e.endsWith("]")?e.slice(1,-1):e}).join("")+"]"}})},o)(["p-not-before","pattern-not-before"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-not-before",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?!"+e.join("")+")"}})},o)(["p-before","pattern-before"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-before",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?="+e.join("")+")"}})},o)(["p-start","pattern-start"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-start",fullArgs:n,makeRegExpString:function(e){return"^(?:"+e.join("")+")"}})},o)(["p-end","pattern-end"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-end",fullArgs:n,makeRegExpString:function(e){return"(?:"+e.join("")+")$"}})},o)(["p-many","pattern-many"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,o,i,s=n.slice();return"number"==typeof n[0]&&(a=n.shift(),o="number"==typeof n[0]?n.shift():1/0),!(void 0!==o&&o<a)&&n.length?(i=n.find(function(e){return"string"!=typeof e&&!b.isPrototypeOf(e)&&!h.isPrototypeOf(e)}))?v.create("datatype","This (p-many:) macro can only be given a min and max number followed by datatypes or strings, but was also given "+O(i)+"."):k({name:"p-many",args:n,fullArgs:s,canContainTypedVars:0<a,makeRegExpString:function(e){return"(?:"+e.join("")+")"+(void 0!==a?"{"+a+(o===1/0?",":o!==a?","+o:"")+"}":"+")}}):v.create("datatype","The (p-many:) macro needs to be given string patterns, not just min and max numbers.")},[n(r(t,String,b,h))])(["p-ins","pattern-ins","p-insensitive","pattern-insensitive"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-ins",fullArgs:n,insensitive:!0})},o)(["split","splitted"],"Array",function(e,t,n){if(t=k({name:"split",fullArgs:[t],canContainTypedVars:!1}),v.containsError(t))return t;if(!n)return[""];if(!t.regExp)return _toConsumableArray(n);for(var r,a=RegExp(t.regExp),o=[];n&&(r=a.exec(n));){if(r.index+r[0].length===0)return o;o.push(n.slice(0,r.index)),n=n.slice(r.index+r[0].length)}return o.concat(n||[])},[r(String,b),String])("trimmed","String",function(e,t,n){return void 0===n||b.isPrototypeOf(t)&&"whitespace"===t.name?t.trim():(t=k({name:"trimmed",fullArgs:[t],canContainTypedVars:!1}),v.containsError(t)?t:t.regExp?n.replace(RegExp("^("+t.regExp+")*|("+t.regExp+")*$","g"),""):n)},[r(String,b),a(String)])(["str-find","string-find"],"String",function(e,t,n){if(t=k({name:"str-find",fullArgs:[t],canContainTypedGlobals:!1}),v.containsError(t))return t;for(var r,a=t.typedVars(),o=RegExp(t.regExp,"g"),i=[],s=o.lastIndex;(r=o.exec(n))&&s!==o.lastIndex;)if(s=o.lastIndex,a.length){for(var c=new Map,l=0;l<a.length;l+=1){if("match"===a[l].varRef.getName())return v.create("macrocall","There was a typed temp variable named _match in the pattern given to (str-find:)","The variable _match is reserved, and can't be used inside (str-find:)'s pattern.");c.set(a[l].varRef.getName(),r[l+1]),c.set("match",r[0])}i.push(c)}else i.push(r[0]);return i},[b,String])(["str-replaced","string-replaced","replaced"],"String",function(e,t,n,r,a){if("number"!=typeof t){if(void 0!==a)return v.create("macrocall","1 too many values were given to (str-replaced:).","If this is given 5 values, the first value must be a number of replacements.");a=r,r=n,n=t,t=1/0}else if(void 0===a)return v.create("macrocall","The (str-replaced:) macro needs 1 more value.","The final string seems to be missing.");if(b.isPrototypeOf(r))return v.create("datatype","The replacement value for (str-replaced:) must be a string or lambda, not ".concat(O(r)));if(y.isPrototypeOf(a)||y.isPrototypeOf(n))return v.create("datatype","The ".concat(y.isPrototypeOf(a)?"final string":"search pattern"," given to (str-replaced:) can't be a lambda."),"Only the replacement value (after the search pattern) can be a 'via' lambda.");if(n=k({name:"str-replaced",fullArgs:[n],canContainTypedGlobals:!1}),v.containsError(n))return n;if(!n.regExp)return a;for(var o,i=RegExp(n.regExp,"g"),s=y.isPrototypeOf(r)?n.typedVars():[],c=1,l=0,u="",p=i.lastIndex;a&&(o=i.exec(a))&&0<t&&p!==i.lastIndex;){for(var p=i.lastIndex,d=Object.create(e.stack.length?e.stackTop.tempVariables:w),f=0;f<s.length;f+=1){var h=s[f],m=h.varRef.create(d,h.varRef.propertyChain);if(v.containsError(m))return m;h=m.defineType(h.datatype);if(v.containsError(h))return h;m.set(o[f+1])}var g=y.isPrototypeOf(r)?r.apply(e,{loop:o[0],pos:c,tempVariables:d}):r;if(v.containsError(g))return g;if("string"!=typeof g)return v.create("datatype","(str-replaced:)'s lambda must produce a string, but it produced ".concat(O(g),' when given "').concat(o[0],'".'));u+=a.slice(l,o.index)+g,c+=1,--t,l=o.index+o[0].length}return u+=a.slice(l)},[r(t,String,b),r(b,String,y.TypeSignature("via")),r(String,y.TypeSignature("via")),a(String)])}),define("macrolib/stylechangers",["jquery","macros","utils","utils/renderutils","datatypes/colour","datatypes/hookset","datatypes/gradient","datatypes/changercommand","datatypes/lambda","internaltypes/changedescriptor","internaltypes/twineerror"],function(s,e,c,t,a,n,r,o,i,l,u){var p,d,f=t.geomParse,h=t.geomStringRegExp,m=Object.assign,t=e.TypeSignature,g=t.either,y=t.wrapped,b=t.optional,v=t.Any,w=t.Everything,k=t.zeroOrMore,S=t.rest,T=t.insensitiveSet,_=t.positiveNumber,x=t.positiveInteger,O=t.nonNegativeNumber,t=t.percent,y=[y(Boolean,'If you gave a number, you may instead want to check that the number is not 0. If you gave a string, you may instead want to check that the string is not "".')],A=(c.onStartup(function(){return c.storyElement.on("mouseenter.hover-macro","[hover=false]",function(){var e=s(this),t=e.data("hoverChanger");c.options.debug&&c.options.ignoreClickEvents&&!e.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *")||(e.data({mouseoutStyle:e.attr("style")||""}),l.create({target:e},t).update(),e.attr("hover",!0))}).on("mouseleave.hover-macro","[hover=true]",function(){var e=s(this),t=e.data("mouseoutStyle");e.attr("style",t).removeData("mouseoutStyle").attr("hover",!1)})}),u.on(function(){s("tw-expression, tw-hook",c.storyElement).each(function(e,t){((t=s(t)).data("errorEvent")||Object)(t)})}),T("instant","dissolve","fade","rumble","shudder","pulse","zoom","flicker","slideleft","slideright","slideup","slidedown","fadeleft","faderight","fadeup","fadedown","blur")),C=T("dotted","dashed","solid","double","groove","ridge","inset","outset","none");e.addChanger("if",function(e,t){return o.create("if",[t])},function(e,t){return e.enabled=e.enabled&&t},y)("unless",function(e,t){return o.create("unless",[t])},function(e,t){return e.enabled=e.enabled&&!t},y)("elseif",function(e,t){return"lastHookShown"in e.stack[0]?o.create("elseif",[!1===e.stack[0].lastHookShown&&!!t]):u.create("macrocall","There's no (if:) or something else before this to do (else-if:) with.")},function(e,t){return e.enabled=e.enabled&&t},y)("else",function(e){return"lastHookShown"in e.stack[0]?o.create("else",[!1===e.stack[0].lastHookShown]):u.create("macrocall","There's nothing before this to do (else:) with.")},function(e,t){return e.enabled=e.enabled&&t},null)("hidden",function(){return o.create("hidden")},function(e){return e.enabled=!1},null)(["verbatim","v6m"],function(){return o.create("verbatim")},function(e){return e.verbatim=!0},null)("live",function(e,t){return o.create("live",t?[t]:[])},function(e,t){e.enabled=!1,e.transitionDeferred=!0,e.data.live={delay:t}},b(Number))("event",function(e,t){return o.create("event",[t])},function(e,t){e.enabled=!1,e.transitionDeferred=!0,e.data.live={event:t}},i.TypeSignature("when"))("more",function(){return o.create("more")},function(e){e.enabled=!1,e.transitionDeferred=!0,e.data.live={event:{when:!0,filter:function(e){return 0!==e.Identifiers.exits?[]:[!0]}}}},null)("after",function(e,t,n){return o.create("after",[t].concat(void 0!==n?[n]:[]))},function(e,t,n){e.enabled=!1,e.transitionDeferred=!0,e.data.live={event:{when:!0,filter:function(e){return c.anyInputDown()&&n&&(t-=n),e.Identifiers.time>t?[!0]:[]}}}},[_,b(O)])("after-error",function(){return o.create("after-error",[])},function(n){n.enabled=!1,n.transitionDeferred=!0;var r=n.section.stackTop.tempVariables;n.data.errorEvent=function(e){e.removeData("errorEvent");var t=_objectSpread(_objectSpread({},n),{},{enabled:!0,transitionDeferred:!1});t.data&&(t.data.errorEvent=void 0),n.section.whenUnblocked(function(){return n.section.renderInto("",null,t,r)})}},[])("hook",function(e,t){var n;return t?(n=c.insensitiveName(t))?o.create("hook",[n]):u.create("datatype",'The string given to (hook:), "'.concat(t,'", contained only dashes and underscores.')):u.create("datatype","The string given to (hook:) was empty.")},function(e,t){return e.attr.push({name:t})},[String])(["for","loop"],function(e,t){if(!t.loop)return u.create("datatype","The lambda provided to (for:) must refer to a temp variable, not just 'it'.");for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return o.create("for",[t].concat(r))},function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var o,i=t.filter(e.section,r);if(o=u.containsError(i))return o;e.loopVars[t.loop.getName()]=i||[]},[i.TypeSignature("where"),k(v)])(["transition","t8n"],function(e,t){return o.create("transition",[c.insensitiveName(t)])},function(e,t){return"zoom"===(e.transition=t)&&(e.transitionOrigin=function(){var e=s(this).offset(),t=e.left,e=e.top;return c.mouseCoords.x-t+"px "+(c.mouseCoords.y-e)+"px"}),e},[A])(["transition-time","t8n-time"],function(e,t){return o.create("transition-time",[t])},function(e,t){return e.transitionTime=t,e.data.passageT8n=m(e.data.passageT8n||{},{time:t}),e},[_])(["transition-delay","t8n-delay"],function(e,t){return o.create("transition-delay",[t])},function(e,t){return e.transitionDelay=t,e},[O])(["transition-skip","t8n-skip"],function(e,t){return o.create("transition-skip",[t])},function(e,t){return e.transitionSkip=t,e},[_])(["transition-depart","t8n-depart"],function(e,t){return o.create("transition-depart",[c.insensitiveName(t)])},function(e,t){return e.data.passageT8n=m(e.data.passageT8n||{},{depart:t}),"zoom"===t&&(e.data.passageT8n.departOrigin=function(){var e=s(this).offset(),t=e.left,e=e.top;return c.mouseCoords.x-t+"px "+(c.mouseCoords.y-e)+"px"}),e},[A])(["transition-arrive","t8n-arrive"],function(e,t){return o.create("transition-arrive",[c.insensitiveName(t)])},function(e,t){return e.data.passageT8n=m(e.data.passageT8n||{},{arrive:t}),"zoom"===t&&(e.data.passageT8n.arriveOrigin=function(){var e=s(this),t=e.offset(),n=t.left,t=t.top,r=e.height();return{"transform-origin":100*(c.mouseCoords.x-n)/e.width()+"% "+100*(c.mouseCoords.y-t)/r+"%",height:r+"px"}}),e},[A])("button",function(e,t){return void 0===t||f(t).size?o.create("button",t?[t]:[]):u.create("datatype",'The string given to (button:) should be a sizing line ("==X==", "==X", "=XXXX=" etc.), not '.concat(JSON.stringify(t),"."))},function(e,t){var t=f(t),n=t.marginLeft,t=t.size;return e.attr.push({class:function(){return this.className+(this.classList.contains("enchantment-button")?"":" ".repeat(0<this.className.length)+"enchantment-button")}}),e.styles.push({"margin-left":t?n+"%":void 0,width:t?t+"%":"100%"}),e},[b(String)]).apply(void 0,_toConsumableArray((d={click:{className:"enchantment-link",blockClassName:"enchantment-clickblock"},doubleclick:{className:"enchantment-dblclick",blockClassName:"enchantment-dblclickblock"},mouseover:{className:"enchantment-mouseover",blockClassName:"enchantment-mouseoverblock"},mouseout:{className:"enchantment-mouseout",blockClassName:"enchantment-mouseoutblock"}},["action",function(e,t){return o.create("action",[c.insensitiveName(t)])},function(e,t){return e.attr.push({class:function(){var e=function e(t){return(t=s(t)).is("tw-story, tw-sidebar, tw-passage")||["block","flex"].includes(t.css("display"))||t.children().get().some(e)}(this);return Array.from(this.classList).filter(function(t){return!Object.keys(d).some(function(e){return d[e].className===t||d[e].blockClassName===t})}).concat(d[t][e?"blockClassName":"className"]).join(" ")}}),e},[T.apply(void 0,_toConsumableArray(Object.keys(d)))]])))(["border","b4r"],function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("border",n.map(c.insensitiveName))},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({display:function(){var e=s(this).css("display");return n.every(function(e){return"none"===e})||!e.includes("inline")?e:"inline-block"},"border-style":n.join(" "),"border-width":function(){return this.style.borderWidth||"2px"}}),e},[C].concat(_toConsumableArray(Array(3).fill(b(C)))))(["border-size","b4r-size"],function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("border-size",n)},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-width":n.map(function(e){return e+"px"}).join(" ")}),e},[O].concat(_toConsumableArray(Array(3).fill(b(O)))))("corner-radius",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("corner-radius",n)},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-radius":n.map(function(e){return e+"px"}).join(" "),padding:function(){return this.style.padding||n.map(function(e){return e+"px"}).join(" ")}}),e},[O].concat(_toConsumableArray(Array(3).fill(b(O)))))(["border-colour","b4r-colour","border-color","b4r-color"],function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("border-colour",n.map(function(e){return a.isPrototypeOf(e)?e.toRGBAString(e):e}))},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-color":n.join(" ")}),e},[g(String,a)].concat(_toConsumableArray(Array(3).fill(b(g(String,a))))))("opacity",function(e,t){return o.create("opacity",[t])},function(e,t){return e.styles.push({opacity:t})},[t])("font",function(e,t){return o.create("font",[t])},function(e,t){return e.styles.push({"font-family":t}),e},[String])("align",function(e,t){var n=t.indexOf("><");return/^(==+>|<=+|=+><=+|<==+>)$/.test(t)?((n=~n?_objectSpread({"text-align":"center","max-width":"50%"},25===(n=Math.round(n/(t.length-2)*50))?{"margin-left":"auto","margin-right":"auto"}:{"margin-left":n+"%"}):"<"===t[0]&&">"===t.slice(-1)?{"text-align":"justify","max-width":"50%"}:t.includes(">")?{"text-align":"right"}:{"text-align":"left"}).display="block",o.create("align",[n])):u.create("datatype",'The (align:) macro requires an alignment arrow ("==>", "<==", "==><=" etc.) be provided, not "'+t+'"')},function(e,t){e.styles.push(t)},[String])(["text-colour","text-color","color","colour"],function(e,t){return o.create("text-colour",[t])},function(e,t){return a.isPrototypeOf(t)&&(t=t.toRGBAString(t)),e.styles.push({color:t}),e},[g(String,a)])(["text-size","size"],function(e,t){return o.create("text-size",[t])},function(e,t){return e.styles.push({"font-size":24*t+"px","line-height":36*t+"px"}),e},[O])("text-indent",function(e,t){return o.create("text-indent",[t])},function(e,t){return e.styles.push({"text-indent":t+"px",display:"inline-block"}),e},[O])(["text-rotate-z","text-rotate"],function(e,t){return o.create("text-rotate-z",[t])},function(e,t){return e.styles.push({display:"inline-block",transform:function(){var e=s(this).css("transform")||"";return(e="none"===e?"":e)+" rotate("+t+"deg)"}}),e},[Number])("text-rotate-y",function(e,t){return o.create("text-rotate-y",[t])},function(e,t){return e.styles.push({display:"inline-block",transform:function(){var e=s(this).css("transform")||"";return(e="none"===e?"":e)+" perspective(50vw) rotateY("+t+"deg)"}}),e},[Number])("text-rotate-x",function(e,t){return o.create("text-rotate-x",[t])},function(e,t){return e.styles.push({display:"inline-block",transform:function(){var e=s(this).css("transform")||"";return(e="none"===e?"":e)+" perspective(50vw) rotateX("+t+"deg)"}}),e},[Number])(["background","bg"],function(e,t){return o.create("background",[t])},function(e,t){return a.isPrototypeOf(t)?t=t.toRGBAString():r.isPrototypeOf(t)&&(t=t.toLinearGradientString()),t=a.isHexString(t)||a.isCSS3Function(t)?{"background-color":t}:t.startsWith("linear-gradient(")||t.startsWith("repeating-linear-gradient(")?{"background-image":t}:{"background-size":"cover","background-image":"url(".concat(t,")"),"background-attachment":"fixed"},e.styles.push(t,{display:function(){var e=s(this);return!e.children().length||c.childrenProbablyInline(e)?s(this).css("display"):"block"}}),e},[g(String,a,r)]).apply(void 0,_toConsumableArray((y={color:function(){return"transparent"}},p=m(Object.create(null),{none:{},bold:{"font-weight":"bold"},italic:{"font-style":"italic"},underline:{"text-decoration":"underline"},doubleunderline:{"text-decoration":"underline","text-decoration-style":"double"},wavyunderline:{"text-decoration":"underline","text-decoration-style":"wavy"},strike:{"text-decoration":"line-through"},doublestrike:{"text-decoration":"line-through","text-decoration-style":"double"},wavystrike:{"text-decoration":"line-through","text-decoration-style":"wavy"},superscript:{"vertical-align":"super","font-size":".83em"},subscript:{"vertical-align":"sub","font-size":".83em"},blink:{animation:"fade-in-out 1s steps(1,end) infinite alternate"},shudder:{animation:"shudder linear 0.1s 0s infinite"},mark:{"background-color":"hsla(60, 100%, 50%, 0.6)"},condense:{"letter-spacing":"-0.08em"},expand:{"letter-spacing":"0.1em"},outline:[{"text-shadow":function(){var e=s(this).css("color");return"-1px -1px 0 "+e+", 1px -1px 0 "+e+",-1px  1px 0 "+e+", 1px  1px 0 "+e}},{color:function(){return c.parentColours(s(this)).backgroundColour}}],shadow:{"text-shadow":function(){return"0.08em 0.08em 0.08em "+s(this).css("color")}},emboss:{"text-shadow":function(){return"0.04em 0.04em 0em "+s(this).css("color")}},smear:[{"text-shadow":function(){var e=s(this).css("color");return"0em   0em 0.02em "+e+",-0.2em 0em  0.5em "+e+", 0.2em 0em  0.5em "+e}},y],blur:[{"text-shadow":function(){return"0em 0em 0.08em "+s(this).css("color")}},y],blurrier:[{"text-shadow":function(){return"0em 0em 0.2em "+s(this).css("color")},"user-select":"none"},y],mirror:{display:"inline-block",transform:"scaleX(-1)"},upsidedown:{display:"inline-block",transform:"scaleY(-1)"},tall:{display:"inline-block",transform:"scaleY(1.5) translateY(-0.25ex)"},flat:{display:"inline-block",transform:"scaleY(0.5) translateY(0.25ex)"},fadeinout:{animation:"fade-in-out 2s ease-in-out infinite alternate"},rumble:{animation:"rumble linear 0.1s 0s infinite"},sway:{animation:"sway linear 2.5s 0s infinite"},buoy:{animation:"buoy linear 2.5s 0s infinite"},fidget:{animation:function(){return"fidget step-end 60s "+60*-Math.random()+"s infinite"+(Math.random()<.5?" reverse":"")}}}),["text-style",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("text-style",n.map(c.insensitiveName))},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0;a<n.length;a+=1)"none"===n[a]?e.styles=[]:e.styles=e.styles.concat(p[n[a]]);return e},[S(T.apply(void 0,_toConsumableArray(Object.keys(p))))]])))("collapse",function(){return o.create("collapse")},function(e){return e.attr.push({collapsing:!0}),e},[])("hover-style",function(e,t){var n=l.create(),r=(t.run(n),n.summary());return r+""=="styles"||r.every(function(e){return"styles"===e||"attr"===e})&&n.attr.every(function(e){return Object.keys(e)+""=="style"})?o.create("hover-style",[t]):u.create("datatype","The changer given to (hover-style:) must only change the hook's style.")},function(e,t){return e.data.hoverChanger=t,e.attr.push({hover:function(e,t){return void 0!==t&&t}}),e},[o])("css",function(e,t){return t.trim().endsWith(";")||(t+=";"),o.create("css",[t])},function(e,t){return e.attr.push({style:function(){return(s(this).attr("style")||"")+t}}),e},[String])("test-true",function(){return o.create("test-true",[])},function(e){return e.enabled=!0},k(w))("test-false",function(){return o.create("test-false",[])},function(e){return e.enabled=!1},k(w)),e.addCommand("animate",s.noop,function(r,e,t,a,o){t.forEach(e,function(e){var t,n;"zoom"===name&&(n=(t=e.offset()).left,t=t.top,n=c.mouseCoords.x-n+"px "+(c.mouseCoords.y-t)+"px"),c.transitionIn(e,a,r.transitionTime||o,r.transitionDelay,r.transitionSkip,0,n)})},[S(n),T.apply(void 0,_toConsumableArray(A.innerType.filter(function(e){return"instant"!==e}))),b(_)]),["box","float-box"].forEach(function(i){return e.addChanger(i,function(e,t,n){var r=-1===t.search(h)||1<t.length&&!t.includes("="),a="float-box"===i&&(-1===n.search(h)||1<n.length&&!n.includes("="));return r||a?u.create("datatype","The ("+i+':) macro requires a sizing line("==X==", "==X", "=XXXX=" etc.) be provided, not "'+(r?t:n)+'".'):o.create(i,[t,n].filter(function(e){return void 0!==e}))},function(e,t,n){var r,t=f(t),a=t.marginLeft,t=t.size,o=("float-box"===i&&(r=(o=f(n)).marginLeft,n=o.size),"box"===i?"%":"vw"),t=_defineProperty(_defineProperty(_defineProperty({display:"block",width:t+o,"max-width":t+o},"box"===i?"margin-left":"left",a+o),"overflow-y","auto"),"padding",function(){var e=s(this).css("padding");return e&&"0px"!==e?e:"1em"});return void 0!==n&&(t.height="box"===i?1.5*n+2+"em":n+"vh"),"float-box"===i&&m(t,{position:"fixed",top:r+"vh","background-color":function(){return c.parentColours(s(this)).backgroundColour}}),e.styles.push(t),e},[String,"box"===i?b(x):String])})}),define("macrolib/values",["macros","state","utils","utils/operationutils","datatypes/colour","datatypes/gradient","datatypes/datatype","datatypes/hookset","datatypes/codehook","internaltypes/twineerror"],function(t,r,e,n,l,c,a,o,i,f){var s=e.realWhitespace,u=e.nth,p=e.anyRealLetter,d=e.plural,h=n.subset,m=n.objectName,g=n.clone,y=n.toSource,e=t.TypeSignature,n=e.rest,b=e.zeroOrMore,v=e.either,w=e.optional,k=e.insensitiveSet,S=e.numberRange,T=e.percent,_=e.nonNegativeInteger,x=e.positiveInteger,e=e.Any,O=Math.max,A=Math.min,C=Math.round,E=Math.floor,N=Math.ceil;function j(t){return function(){var e=t.apply(void 0,arguments);return"number"!=typeof e||isNaN(e)?f.create("macrocall","This mathematical expression doesn't compute!"):e}}t.add(["str","string","text"],"String",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.map(function(e){return i.isPrototypeOf(e)?e.source:e}).join("")},[b(t.TypeSignature.either(String,Number,Boolean,Array,i))])("source","String",function(e,t){return"command"!==(null==t?void 0:t.TwineScript_TypeID)||t.TwineScript_ToSource?y(t):f.create("datatype","I can't construct the source code of a command created by a custom macro.")},[e])("substring","String",function(e,t,n,r){return h(t,n,r)},[String,parseInt,parseInt])("lowercase","String",function(e,t){return t.toLowerCase()},[String])("uppercase","String",function(e,t){return t.toUpperCase()},[String])("lowerfirst","String",function(e,t){return t.replace(RegExp(p+"+"),function(e){return(e=Array.from(e))[0].toLowerCase()+e.slice(1).join("").toLowerCase()})},[String])("upperfirst","String",function(e,t){return t.replace(RegExp(p+"+"),function(e){return(e=Array.from(e))[0].toUpperCase()+e.slice(1).join("").toLowerCase()})},[String])("words","Array",function(e,t){return t.split(RegExp(s+"+")).filter(Boolean)},[String])(["str-repeated","string-repeated"],"String",function(e,t,n){return 0===n.length?f.create("macrocall","I can't repeat an empty string."):n.repeat(t)},[_,String])(["str-reversed","string-reversed"],"String",function(e,t){return _toConsumableArray(t).reverse().join("")},[String])("joined","String",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return r.join(t)},[n(String)])("plural","String",function(e,t,n,r){return n&&""!==r?d(t,n,r):f.create("macrocall","The (plural:) macro can't be given empty strings.")},[parseInt,String,w(String)])(["str-nth","string-nth"],"String",function(e,t){return u(t)},[parseInt])("digit-format","String",function(e,t,n){if(1e21<=Math.abs(n))return f.create("macrocall","The number given to (digit-format:) is too big.");for(var r=/([^#0])(?=[#0]*$)/g,a=(r.exec(t)||[])[1],o=(/^[#0]*([^#0])/g.exec(t)||[])[1],i=(t=_toConsumableArray(t)).length,s=(a&&(","!==a||o&&","!==o)&&(i=r.lastIndex-1),Math.abs(n).toFixed(16).replace(/(\.\d*?)0+$/,function(e,t){return t}).replace(/^0+/,"")),c=s.includes(".")?s.indexOf("."):s.length,l=0,u="",p=t.length-1;0<=p;--p){var d=t[p];"0"===d||"#"===d?u=(s[c-i+p+l]||("0"===d?"0":""))+u:p<t.length-1&&0<p&&(u=d+u,l+=p===i?0:1)}return(n<0?"-":"")+u},[String,Number])(["num","number"],"Number",function(e,t){return Number.isNaN(+t)?f.create("macrocall","I couldn't convert "+m(t)+" to a number."):+t},[String])("datatype","Datatype",function(e,t){return a.from(t)},[e])("datapattern","Any",function(e,t){return function n(e){var r;return Array.isArray(e)?r=e.map(n):e instanceof Map?(r=new Map,_toConsumableArray(e).forEach(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1];return r.set(t,n(e))})):r=a.from(e),(e=f.containsError(r))||r}(t)},[e])(["rgb","rgba"],"Colour",function(e){return l.create({r:arguments.length<=1?void 0:arguments[1],g:arguments.length<=2?void 0:arguments[2],b:arguments.length<=3?void 0:arguments[3],a:arguments.length<=4?void 0:arguments[4]})},[S(0,255),S(0,255),S(0,255),w(T)])(["hsl","hsla"],"Colour",function(e,t,n,r,a){return(t=C(t)%360)<0&&(t+=360),l.create({h:t,s:n,l:r,a:a})},[Number,T,T,w(T)])(["lch","lcha"],"Colour",function(e,t,n,r,a){return(r=C(r)%360)<0&&(r+=360),l.create({l:t,c:n,h:r,a:a})},[T,S(0,132),Number,w(T)])("complement","Colour",function(e,t){return t.LCHRotate(180)},[l])("mix","Colour",function(e,t,n,r,a){n=n.toLCHA(),a=a.toLCHA();var o=1,i=(t+r!==1&&(t+r<1&&(o=t+r),t=(i=[t/(t+r),r/(t+r)])[0],r=i[1]),n.c<2||n.l<.01||.99<n.l?n.h=a.h:(a.c<2||a.l<.01||.99<a.l)&&(a.h=n.h),n.l*=n.a,n.c*=n.a,a.l*=a.a,a.c*=a.a,180<a.h-n.h?n.h+=360:a.h-n.h<-180&&(a.h+=360),n.a*t+a.a*r),s=(n.l*t+a.l*r)/i,c=(n.c*t+a.c*r)/i,n=(n.h*t+a.h*r)/i;return l.create({l:s,c:c,h:n,a:i*o})},[T,l,T,l])("palette","Array",function(e,t,n){var r,a=n.toLCHA(),o=a.l,a={l:o<=.75?.75+o/3:.75-3*(1-o),c:80,h:a.h,a:1},i=l.create(a);return a.l+=o<=.75?-.1:.1,a.l<.5&&(a.l*=.5/a.l),r=l.create(a),a.l+=o<=.85?.15:-.15,o=l.create(a),"adjacent"===t?(r=(i=i.LCHRotate(-30)).LCHRotate(30),o=i.LCHRotate(60)):"triad"===t&&(o=i.LCHRotate(180),r=i.LCHRotate(140),i=i.LCHRotate(-140)),[n,i,r,o]},[k("mono","adjacent","triad"),l])("gradient","Gradient",function(e,t){(t=C(t)%360)<0&&(t+=360);for(var n,r,a,o=arguments.length,i=new Array(2<o?o-2:0),s=2;s<o;s++)i[s-2]=arguments[s];return i.length<4?f.create("datatype","(gradient:) must be given at least 2 colour-stop pairs of numbers and colours."):(r=[],a=i.reduce(function(e,t){if(!f.containsError(e))if(void 0===n)n=t;else{if("number"!=typeof n||!l.isPrototypeOf(t))return f.create("datatype","(gradient:) colour-stops should be pairs of numbers and colours, not colours and numbers.");r.push({stop:n,colour:g(t)}),n=void 0}return e},!0),f.containsError(a)?a:void 0!==n?f.create("macrocall","This gradient has a colour-stop percent without a colour."):c.create(t,r))},[Number,n(v(T,l))])("stripes","Gradient",function(e,t,n){(t=C(t)%360)<0&&(t+=360);for(var r=0,a=[],o=arguments.length,i=new Array(3<o?o-3:0),s=3;s<o;s++)i[s-3]=arguments[s];return i.forEach(function(e){a.push({stop:r,colour:g(e)}),r+=n,a.push({stop:r,colour:g(e)})}),c.create(t,a,!0)},[Number,x,l,n(l)])("hooks-named","HookName",function(e,t){return t?o.create({type:"name",data:t}):f.create("datatype","(hooks-named:) can't be given an empty string.")},[String])("cond","Any",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0;a<n.length;a+=2){var o=n[a];if(a===n.length-1||f.containsError(o))return o;if("boolean"!=typeof o)return f.create("datatype","(cond:)'s "+u(a+1)+" value is "+m(o)+", but should be a boolean.");if(o)return n[a+1]}return f.create("macrocall","An odd number of values must be given to (cond:), not "+n.length,"(cond:) must be given one or more pairs of booleans and values, as well as one final value.")},[Boolean,e,n(e)]);({weekday:[function(){return["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur"][(new Date).getDay()]+"day"},null],monthday:[function(){return(new Date).getDate()},null],currenttime:[function(){var e=new Date,t=e.getHours()<12;return(e.getHours()%12||12)+":"+((e.getMinutes()<10?"0":"")+e.getMinutes())+" "+(t?"A":"P")+"M"},null],currentdate:[function(){return(new Date).toDateString()},null],min:[A,n(Number)],max:[O,n(Number)],abs:[Math.abs,Number],sign:[Math.sign,Number],sin:[Math.sin,Number],cos:[Math.cos,Number],tan:[Math.tan,Number],floor:[E,Number],round:[C,Number],trunc:[function(e){return(0<e?E:N)(e)},Number],ceil:[N,Number],pow:[j(Math.pow),[Number,Number]],exp:[Math.exp,Number],sqrt:[j(Math.sqrt),Number],log:[j(Math.log),Number],log10:[j(Math.log10),Number],log2:[j(Math.log2),Number],random:[function(e,t){var n,t=t?(n=A(e,t),O(e,t)):(n=0,e);return t+=1,~~(r.random()*(t-n))+n},[parseInt,t.TypeSignature.optional(parseInt)]],"":function(){for(var e in this)e&&hasOwnProperty.call(this,e)&&t.add(e,"Number",function(a){return function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.apply(void 0,n)}}(this[e][0]),this[e][1])}})[""](),t.add("either","Any",function(e){var t=1+~~(r.random()*(arguments.length<=1?0:arguments.length-1));return t<1||arguments.length<=t?void 0:arguments[t]},n(e))("nth","Any",function(e,t){return t<=0?f.create("datatype","(nth:)'s first value should be a positive whole number, not "+t):(t=(t-1)%(arguments.length<=2?0:arguments.length-2)+2)<2||arguments.length<=t?void 0:arguments[t]},[parseInt,n(e)])}),!function(){var a,k={};function o(e){for(var t in e)this[t]=e[t]}function i(e,t){for(var n,r,a=e.innerText,o=null,i=0,s=i,c=a.length,l=null;i<c;){for(var u=a.slice(i),p=(o&&o.length?o[0]:e).innerMode,d=0,f=p.length;d<f;d+=1){var h=k[p[d]];if(!(h.constraint&&!h.constraint(l)||h.cannotFollowText&&("text"===(null==(w=l)?void 0:w.type)||s<i))&&(h.plainCompare?u.startsWith(h.pattern):h.pattern.test(u))){var m=h.fn(h.plainCompare?h.pattern:h.pattern.exec(u)),g=!1,y=0;if(m.matches){for(;o&&y<o.length;y+=1){var b=o[y],v=b.type,b=b.aka;if(v in m.matches){g=!0;break}b&&(v=b),-1<(null==(b=m.cannotCross)?void 0:b.indexOf(v))&&(y=o.length-1)}if((!o||y>=o.length)&&!m.isFront)continue}s<i&&e.addChild({type:"text",text:a.slice(s,i),innerMode:p});var s=i+=(l=e.addChild(m)).text.length,w=!1;g&&(t&&S(e,l,o[y]),o=o.slice(y+1),w=!0),!w&&l.isFront&&(o?o.unshift(l):o=[l]);break}}d===f&&(i+=1,null===l)&&(l={type:"text"})}for(s<i&&e.addChild({type:"text",text:a.slice(s,i),innerMode:(null!=(n=o)&&n.length?o[0]:e).innerMode});0<(null==(r=o)?void 0:r.length);)o.shift().demote();return e}function S(e,t,n){var r=e.children.indexOf(t),a=e.children.indexOf(n);t.children=e.children.splice(a+1,r-(a+1)),t.type=t.matches[n.type],t.innerText="";for(var o,i=0,s=t.children.length;i<s;i++)t.innerText+=t.children[i].text;for(o in t.start=n.start,t.text=n.text+t.innerText+t.text,n)hasOwnProperty.call(n,o)&&!hasOwnProperty.call(t,o)&&(t[o]=n[o]);t.isFront&&(t.isFront=!1),e.children.splice(a,1)}o.prototype={constructor:o,addChild:function(e){var t=this.lastChildEnd(),n=new o(e);return n.start=t,n.end=e.text&&t+e.text.length,n.place=this.place,n.children=[],n.innerText&&i(n),this.children.push(n),n},lastChildEnd:function(){var e=this.children&&this.children[this.children.length-1]||null;return e?e.end:this.start+Math.max(0,this.text.indexOf(this.innerText))},tokenAt:function(e){if(e<this.start||e>=this.end)return null;if(this.children.length)for(var t=0;t<this.children.length;t+=1)if(e>=this.children[t].start&&e<this.children[t].end){var n=this.children[t].tokenAt(e);if(n)return n}return this},pathAt:function(e){if(e<this.start||e>=this.end)return[];var t=[];if(this.children.length)for(var n=0;n<this.children.length;n+=1)if(e>=this.children[n].start&&e<this.children[n].end){var r=this.children[n].pathAt(e);if(r.length){t=t.concat(r);break}}return t.concat(this)},nearestTokenAt:function(n){return n<this.start||n>=this.end?null:this.children?this.children.reduce(function(e,t){return e||(n>=t.start&&n<t.end?t:null)},null):this},everyLeaf:function(n){return this.children&&0!==this.children.length?this.children.reduce(function(e,t){return e&&t.everyLeaf(n)},!0):!!n(this)},demote:function(){this.type="text"},error:function(e){this.type="error",this.message=e},toString:function(){var e=this.type+"("+this.start+"\u2192"+this.end+")";return this.children&&0<this.children.length&&(e+="["+this.children+"]"),e},copy:function(){var e=new o(this);return e.children=e.children.slice(),e},foldChildren:function(){for(var e=[],t=this.children.slice(),n=0;n<t.length;n+=1){var r=t[n],a=!1;if(r.matches)for(var o=0;o<e.length;o+=1)e[o].type in r.matches&&(S(this,r,e[o]),e=e.slice(o+1),a=!0);!a&&r.isFront&&e.unshift(r)}}},a={lex:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"start",r=3<arguments.length&&void 0!==arguments[3]&&arguments[3];return i(new o({type:"root",place:t,start:0,end:e.length,text:e,innerText:e,children:[],innerMode:a.modes[n]}),!r)},rules:k,modes:{}},"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=a:"function"==typeof define&&define.amd?define("lexer",[],function(){return a}):this&&null!=this&&this.loaded?(this.modules||(this.modules={}),this.modules.Lexer=a):this.Lexer=a}.call(eval("this")||("undefined"!=typeof global?global:window)),!function(){Object.assign=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var m,g=Object.keys,y=Object.assign;function t(e){function t(n){return n=n||"innerText",function(e){var e=e.reduceRight(function(e,t,n){return e||(n?t:"")},""),t={};return t[n]=e,t}}function n(e,t){var n={};return n[e]=t,function(){return{isFront:!0,matches:n,cannotCross:["verbatimOpener"]}}}var r=Object.bind(0,null);function a(a,e){return Object.keys(e).forEach(function(n){var r=e[n].fn;e[n].fn=function(e){var t=r(e);return t.text||(t.text="string"==typeof e?e:e[0]),t.type||(t.type=n),t.innerMode||(t.innerMode=a),t}}),e}function o(e){switch(e&&e.type){case null:case"br":case"hr":case"bulleted":case"numbered":case"heading":case"align":case"column":case"escapedLine":return!0}return!1}var i=[],s=[],c=[],l=a(i,{hr:{fn:r},bulleted:{fn:function(e){return{depth:e[1].length}}},numbered:{fn:function(e){return{depth:e[1].length/2}}},heading:{fn:function(e){return{depth:e[1].length}}},align:{fn:function(e){var t,e=e[1],n=e.indexOf("><");return~n?25===(t=Math.round(n/(e.length-2)*50))&&(t="center"):"<"===e[0]&&">"===e.slice(-1)?t="justify":-1<e.indexOf(">")?t="right":-1<e.indexOf("<")&&(t="left"),{align:t}}},column:{fn:function(e){var t,e=e[1],n=e.indexOf("|");return n&&n<e.length-1?t="center":"|"===e[0]&&"|"===e.slice(-1)?t="none":n===e.length-1?t="right":n||(t="left"),{column:t,width:/\|+/.exec(e)[0].length,marginLeft:/^=*/.exec(e)[0].length,marginRight:/=*$/.exec(e)[0].length}}}}),u=(g(l).forEach(function(e){l[e].constraint=o,l[e].cannotFollowText=!0}),a(i,{twine1Macro:{fn:function(){return{type:"error",message:"Harlowe macros use a different syntax to Twine 1, SugarCube, and Yarn macros."}}},emBack:{fn:function(){return{matches:{emFront:"em"},cannotCross:["verbatimOpener"]}}},strongBack:{fn:function(){return{matches:{strongFront:"strong"},cannotCross:["verbatimOpener"]}}},strongFront:{fn:function(){return{isFront:!0}}},emFront:{fn:function(){return{isFront:!0}}},boldOpener:{fn:n("boldOpener","bold")},italicOpener:{fn:n("italicOpener","italic")},strikeOpener:{fn:n("strikeOpener","strike")},supOpener:{fn:n("supOpener","sup")},commentFront:{fn:function(){return{isFront:!0}}},commentBack:{fn:function(){return{matches:{commentFront:"comment"}}}},scriptStyleTag:{fn:r},tag:{fn:r},url:{fn:r},hookPrependedFront:{fn:function(e){return{name:e[1],hidden:")"===e[2],isFront:!0,tagPosition:"prepended"}}},hookFront:{fn:function(){return{isFront:!0}}},hookBack:{fn:function(){return{matches:{hookPrependedFront:"hook",hookFront:"hook"},cannotCross:["verbatimOpener"]}}},hookAppendedBack:{fn:function(e){return{name:e[2],hidden:"("===e[1],tagPosition:"appended",matches:{hookFront:"hook"},cannotCross:["verbatimOpener"]}}},unclosedHook:{fn:r},unclosedHookPrepended:{fn:function(e){return{type:"unclosedHook",name:e[1],hidden:")"===e[2]}}},verbatimOpener:{fn:function(e){var e=e[0].length,t={};return{type:(t["verbatim"+e]="verbatim")+e,isFront:!0,matches:t,aka:"verbatimOpener"}}},unclosedCollapsed:{fn:r},collapsedFront:{fn:function(){return{isFront:!0}}},collapsedBack:{fn:function(){return{matches:{collapsedFront:"collapsed"},cannotCross:["verbatimOpener"]}}},escapedLine:{fn:r},legacyLink:{fn:function(e){return{type:"twineLink",innerText:e[1],passage:e[2],innerMode:i}}},br:{fn:r}})),p=y(a(s,{macroFront:{fn:function(e){return{isFront:!0,name:e[1]}}},groupingBack:{fn:function(){return{matches:{groupingFront:"grouping",macroFront:"macro"},cannotCross:["singleStringOpener","doubleStringOpener","hookFront"]}}},passageLink:{fn:function(e){var t=e[1]||"",n=e[2]||"",e=e[3]||"";return{type:"twineLink",innerText:n?e:t,passage:t?e:n,innerMode:i}}},simpleLink:{fn:function(e){return{type:"twineLink",innerText:e[1]||"",passage:e[1]||"",innerMode:i}}},variable:{constraint:function(e){return!e||"macroFront"!==e.type},fn:t("name")},tempVariable:{constraint:function(e){return!e||"macroFront"!==e.type},fn:t("name")}}),{hookFront:u.hookFront,hookBack:u.hookBack}),d=a(s,_objectSpread(_objectSpread({commentBack:{fn:function(){return{matches:{commentFront:"comment"}}}},macroName:{constraint:function(e){return e&&"macroFront"===e.type},fn:t("name")},groupingFront:{fn:function(){return{isFront:!0}}},property:{fn:t("name"),constraint:function(e){if(e)switch(e.type){case"variable":case"hookName":case"property":case"tempVariable":case"colour":case"itsProperty":case"belongingItProperty":case"macro":case"grouping":case"string":case"datatype":case"hook":case"boolean":case"number":return!0}}},possessiveOperator:{fn:r},itsProperty:{cannotFollowText:!0,fn:t("name")},itsOperator:{cannotFollowText:!0,fn:r},belongingItProperty:{cannotFollowText:!0,fn:t("name")},belongingItOperator:{cannotFollowText:!0,fn:r},belongingProperty:{cannotFollowText:!0,fn:t("name")},belongingOperator:{cannotFollowText:!0,fn:r},escapedStringChar:{fn:function(){return{type:"text"}}},singleStringOpener:{fn:function(){return{isFront:!0,matches:{singleStringOpener:"string"},innerMode:c}}},doubleStringOpener:{fn:function(){return{isFront:!0,matches:{doubleStringOpener:"string"},innerMode:c}}},hookName:{fn:t("name")},cssTime:{fn:function(e){return{value:+e[1]*("s"===e[2].toLowerCase()?1e3:1)}}},datatype:{cannotFollowText:!0,fn:function(e){return{name:e[0].toLowerCase()}}},colour:{cannotFollowText:!0,fn:function(e){var e=e[0].toLowerCase(),t={red:"e61919",orange:"e68019",yellow:"e5e619",lime:"80e619",green:"19e619",cyan:"19e5e6",aqua:"19e5e6",blue:"197fe6",navy:"1919e6",purple:"7f19e6",fuchsia:"e619e5",magenta:"e619e5",white:"fff",black:"000",gray:"888",grey:"888"},t=hasOwnProperty.call(t,e)?"#"+t[e]:e;return{colour:t}}},number:{fn:function(e){return{value:parseFloat(e[0])}}},inequality:{fn:function(e){return{operator:e[2],negate:-1<e[1].indexOf("not")}}},augmentedAssign:{fn:function(e){return{operator:e[0][0]}}},identifier:{fn:t("name"),cannotFollowText:!0},whitespace:{fn:r,cannotFollowText:!0},incorrectOperator:{fn:function(e){var t={"=>":">=","=<":"<=",gte:">=",lte:"<=",gt:">",lt:"<",eq:"is",isnot:"is not",neq:"is not",isa:"is a",are:"is",x:"*","or a":"or"}[e[0].toLowerCase().replace(/\s+/g," ")];return{type:"error",message:"Please say "+(t?"'"+t+"'":"something else")+" instead of '"+e[0]+"'.",explanation:"In the interests of readability, I want certain operators to be in a specific form."}},cannotFollowText:!0}},["boolean","is","to","into","where","when","via","making","each","and","or","not","isNot","contains","doesNotContain","isIn","isA","isNotA","isNotIn","matches","doesNotMatch","bind"].reduce(function(e,t){return e[t]={fn:r,cannotFollowText:!0},e},{})),["comma","spread","typeSignature","addition","subtraction","multiplication","division"].reduce(function(e,t){return e[t]={fn:r},e},{}))),f=a(c,{singleStringCloser:d.singleStringOpener,doubleStringCloser:d.doubleStringOpener,escapedStringChar:d.escapedStringChar}),h=(i.push.apply(i,_toConsumableArray(g(l)).concat(_toConsumableArray(g(p)),_toConsumableArray(g(u)))),s.push.apply(s,_toConsumableArray(g(p)).concat(_toConsumableArray(g(d)))),c.push.apply(c,_toConsumableArray(g(f))),_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},l),u),p),d),f)),u=(g(h).forEach(function(e){m.PlainCompare[e]?(h[e].pattern=m.PlainCompare[e],h[e].plainCompare=!0):h[e].pattern=RegExp("^(?:"+m[e]+")","i")}),y(e.rules,h),e.modes);return u.start=u.markup=i,u.macro=s,u.string=c,e}function n(e){return Object.freeze({lex:t(e).lex,Patterns:m})}"object"===("undefined"==typeof module?"undefined":_typeof(module))?(m=require("./patterns"),module.exports=n(require("./lexer"))):"function"==typeof define&&define.amd?define("markup",["lexer","patterns"],function(e,t){return m=t,n(e)}):this&&this.loaded&&this.modules?(m=this.modules.Patterns,this.modules.Markup=n(this.modules.Lexer)):(m=this.Patterns,this.Markup=n(this.Lexer))}.call(eval("this")||("undefined"!=typeof global?global:window)),!function(){var e;function n(t){return t&&"object"===_typeof(t)?(Object.keys(t).forEach(function(e){t[e]=n(t[e])}),t):(t+"").replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}function t(e){return function(){return"("+e+Array.apply(0,arguments).join("|")+")"}}var r=t("?:"),a=t("?!"),o=t("?="),i="[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*",s=i.replace("*","+"),c="\\b",l="[\\w\\-\\u00c0-\\u00de\\u00df-\\u00ff\\u0150\\u0170\\u0151\\u0171\\uD800-\\uDFFF]",u=l.replace("\\-",""),p=r("\\n","$"),d=i+"(\\*+)"+s,f=i+"((?:0\\.)+)"+s,h=i+"-{3,}"+i+p,m=i+"(==+>|<=+|=+><=+|<==+>)"+i+p,p=i+"(=+\\|+|\\|+=+|=+\\|+=+|\\|=+\\|)"+i+p,g={opener:"\\[\\[(?!\\[)",text:"("+function(){return"[^"+Array.apply(0,arguments).map(n).join("")+"]*"}("]")+")",rightSeparator:r("\\->","\\|"),leftSeparator:"<\\-",closer:"\\]\\]",legacySeparator:"\\|",legacyText:"("+r("[^\\|\\]]","\\]"+a("\\]"))+"+)"},y=u+"*"+u.replace("\\w","a-zA-Z")+u+"*",b="\\$("+y+")",v="_("+y+")",w="'s"+s+a("_")+"("+y+")",k="("+y+")"+s+"of"+c+a("it\\b"),S="'s"+s,T=r("it","time","turns?","visits?","exits?","pos")+c,_="its"+s+"("+y+")",x="("+y+")"+s+"of"+s+"it"+c,O="of"+s+"it"+c,A={opener:"\\(",name:"("+r("\\$","_")+"?"+l+"+):"+a("\\/"),closer:"\\)"},C=r("=<","=>","[gl]te?\\b","n?eq\\b","isnot\\b","are\\b","x\\b","isa\\b","or"+s+"a"+c),E="[a-zA-Z][\\w\\-]*",N="(?:\"[^\"]*\"|'[^']*'|[^'\">])*?",j="\\|("+l+"+)(>|\\))",P="(<|\\()("+l+"+)\\|",R="((?:\\b\\d+(?:\\.\\d+)?|\\.\\d+)(?:[eE][+\\-]?\\d+)?)"+a("m?s")+c;g.main=g.opener+r(g.text+g.rightSeparator,g.text.replace("*","*?")+g.leftSeparator)+g.text,e={upperLetter:"[A-Z\\u00c0-\\u00de\\u0150\\u0170]",lowerLetter:"[a-z0-9_\\-\\u00df-\\u00ff\\u0151\\u0171]",anyLetter:l,anyLetterStrict:u,whitespace:s.replace("[","[\\n\\r"),escapedLine:"\\\\\\n\\\\?|\\n\\\\",br:"\\n(?!\\\\)",tag:"<\\/?"+E+N+">",scriptStyleTag:"<("+r("script","style","textarea")+")"+N+">[^]*?<\\/\\1>",scriptStyleTagOpener:"<",url:"("+r("https?","mailto","javascript","ftp","data")+":\\/\\/[^\\s<]+[^<.,:;\"')\\]\\s])",bullet:"\\*",hr:h,heading:"[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*(#{1,6})[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*",align:m,column:p,bulleted:d,numbered:f,verbatimOpener:"`+",hookAppendedFront:"\\["+a("=+"),hookPrependedFront:j+"\\["+a("=+"),hookFront:"\\["+a("=+"),hookBack:"\\]"+a(P),hookAppendedBack:"\\]"+P,unclosedHook:"\\[=+",unclosedHookPrepended:j+"\\[=+",unclosedCollapsed:"\\{=+",passageLink:g.main+g.closer,legacyLink:g.opener+g.legacyText+g.legacySeparator+g.legacyText+g.closer,simpleLink:g.opener+g.legacyText+g.closer,macroFront:A.opener+o(A.name),macroName:A.name,groupingFront:"\\("+a(A.name),twine1Macro:"<<[^>\\s]+\\s*(?:\\\\.|'(?:[^'\\\\]*\\\\.)*[^'\\\\]*'|\"(?:[^\"\\\\]*\\\\.)*[^\"\\\\]*\"|[^'\"\\\\>]|>(?!>))*>>",validPropertyName:y,property:w,belongingProperty:k,possessiveOperator:S,belongingOperator:"of\\b",itsOperator:"its\\b",belongingItOperator:O,variable:b,tempVariable:v,hookName:"\\?("+l+"+)\\b",cssTime:"(\\d+\\.?\\d*|\\d*\\.?\\d+)(m?s)\\b",colour:r(r("Red","Orange","Yellow","Lime","Green","Cyan","Aqua","Blue","Navy","Purple","Fuchsia","Magenta","White","Gray","Grey","Black","Transparent"),"#[\\dA-Fa-f]{3}(?:[\\dA-Fa-f]{3})?"),datatype:r("alnum","alphanumeric","any(?:case)?","array","bool(?:ean)?","changer","codehook","colou?r","const","command","dm","data"+r("map","type","set"),"ds","digit","gradient","empty","even","int"+a("o")+"(?:eger)?","lambda","lowercase","macro","linebreak","newline","num(?:ber)?","odd","str(?:ing)?","uppercase","whitespace")+c,number:R,boolean:r("true","false")+c,identifier:T,itsProperty:_,belongingItProperty:x,escapedStringChar:"\\\\[^\\n]",singleStringOpener:"'",doubleStringOpener:'"',singleStringCloser:"'",doubleStringCloser:'"',is:"is"+a(s+"not"+c,s+"an?"+c,s+"in"+c,s+"<",s+">")+c,isNot:"is"+s+"not"+a(s+r("an?","in")+c)+c,isA:"is"+s+"an?"+c,isNotA:"is"+s+"not"+s+"an?"+c,matches:"matches\\b",doesNotMatch:"does"+s+"not"+s+"match"+c,and:"and\\b",or:"or\\b",not:"not\\b",inequality:"((?:is(?:"+s+"not)?"+i+")*)("+r("<(?!=)","<=",">(?!=)",">=")+")",isIn:"is"+s+"in"+c,contains:"contains\\b",doesNotContain:"does"+s+"not"+s+"contain"+c,isNotIn:"is"+s+"not"+s+"in"+c,addition:n("+")+a("="),subtraction:n("-")+a("=","type"),multiplication:n("*")+a("="),division:r("/","%")+a("="),spread:"\\.\\.\\."+a("\\."),to:r("to\\b","="),into:"into\\b",making:"making\\b",where:"where\\b",when:"when\\b",via:"via\\b",each:"each\\b",augmentedAssign:r("\\+","\\-","\\*","\\/","%")+"=",bind:"2?bind\\b",typeSignature:n("-type")+c,incorrectOperator:C,PlainCompare:{comma:",",commentFront:"\x3c!--",commentBack:"--\x3e",strikeOpener:"~~",italicOpener:"//",boldOpener:"''",supOpener:"^^",strongFront:"**",strongBack:"**",emFront:"*",emBack:"*",collapsedFront:"{",collapsedBack:"}",groupingBack:")"}},"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=e:"function"==typeof define&&define.amd?define("patterns",[],function(){return e}):this&&this.loaded?(this.modules||(this.modules={}),this.modules.Patterns=e):this.Patterns=e}.call(eval("this")||("undefined"!=typeof global?global:window)),define("twinescript/operations",["utils","utils/operationutils","datatypes/typedvar","datatypes/datatype","internaltypes/twineerror"],function(e,t,n,r,m){var a=e.plural,o=t.isObject,i=t.collectionType,s=t.is,c=t.isA,l=t.clone,u=t.unique,p=t.contains,e=t.matches,g=t.objectName,d=t.toSource;function f(r,a,o,i){return o=o||"do this to",function(e,t){var n;return 1===a.length&&(t=e),(n=m.containsError(e,t))||(_typeof(e)!==r||_typeof(t)!==r?m.create("operation","I can only ".concat(o," ").concat(r,"s, not ").concat(g(_typeof(e)!==r?e:t),"."),i):a(e,t))}}function h(a){return function(e,t){var n,r;return(n=m.containsError(e,t))||(_typeof(e)!==_typeof(t)||o(e)&&"TwineScript_TypeName"in e&&o(t)&&"TwineScript_TypeName"in t&&e.TwineScript_TypeName!==t.TwineScript_TypeName||i(e)!==i(t)?(n="".concat(g(e)," isn't the same type of data as ").concat(g(t)),_typeof(e)+_typeof(t)!=="stringnumber"&&_typeof(e)+_typeof(t)!=="numberstring"||(r="You might want to convert one side to a number using (num:), or to a string using (str:)."),m.create("operation",n[0].toUpperCase()+n.slice(1),r)):a(e,t))}}function y(d,f,e){var h=2<arguments.length&&void 0!==e&&e;return function r(a,o){var e;if(e=m.containsError(a,o))return e;var t=_slicedToArray(a.determiner?[a,o]:o.determiner?[o,a]:[],2),i=t[0],t=t[1];if(i){var n=i,s=n.determiner,n=n.determined;if("start"===s||"end"===s){if(f)return m.create("operation","I can't use '".concat(f,"' with the 'start' or 'end' of ").concat(g(n),"."));if(t.determiner){if("start"===t.determiner||"end"===t.determiner)return m.create("operation","I can't compare one value's 'start' or 'end' with another value's 'start' or 'end'.","Please change one of them to use an exact range, such as '1stto4th' or '2ndlasttolast'.");n=[t,i],i=n[0]}for(var c=i.string||i.array,l=0;l<c.length+1;l+=1){var u=l?"end"===s?c.slice(-l):c.slice(0,l):c.constructor(),u=i===a?r(u,o):r(a,u);if(e=m.containsError(u))return e;if(u!==h)return u}return h}var p="all"===s;return i.array.reduce(function(e,t){var n,t=i===a?r(t,o):r(a,t);return(n=m.containsError(e,t))||(p?e&&t:e||t)},p)}return d(a,o)}}function b(n,e){return y(function(e,t){e=n(e,t);return m.containsError(e)?e:!e},e,!0)}t="If one of these values is a number, you may want to write a check that it 'is not 0'. Also, if one is a string, you may want to write a check that it 'is not \"\" '.",t={and:f("boolean",h(function(e,t){return e&&t}),"use 'and' to join",t),or:f("boolean",h(function(e,t){return e||t}),"use 'or' to join",t),not:f("boolean",function(e){return!e},"use 'not' to invert",t),"+":h(function(e,t){var n;return Array.isArray(e)?[].concat(_toConsumableArray(e),_toConsumableArray(t)):e instanceof Map?(n=new Map(e),t.forEach(function(e,t){return n.set(t,e)}),n):e instanceof Set?new Set([].concat(_toConsumableArray(e),_toConsumableArray(t)).filter(u).map(l)):"function"==typeof e["TwineScript_+"]?e["TwineScript_+"](t):"string|number|boolean".includes(_typeof(e))?e+t:m.create("operation","I can't use + on ".concat(g(e),"."))}),"-":h(function(e,n){var r;return Array.isArray(e)?e.filter(function(t){return!n.some(function(e){return s(t,e)})}):e instanceof Set?(r=_toConsumableArray(n),new Set(_toConsumableArray(e).filter(function(t){return!r.some(function(e){return s(t,e)})}))):"string"==typeof e?e.split(n).join(""):"number"==typeof e?e-n:m.create("operation","I can't use - on ".concat(g(e),"."))}),"*":f("number",h(function(e,t){return e*t}),"multiply"),"/":f("number",h(function(e,t){return 0===t?m.create("operation","I can't divide ".concat(g(e)," by zero.")):e/t}),"divide"),"%":f("number",h(function(e,t){return 0===t?m.create("operation","I can't modulo ".concat(g(e)," by zero.")):e%t}),"modulus"),"<":y(f("number",h(function(e,t){return e<t}),"do < to"),"<"),">":y(f("number",h(function(e,t){return t<e}),"do > to"),">"),"<=":y(f("number",h(function(e,t){return e<=t}),"do <= to"),"<="),">=":y(f("number",h(function(e,t){return t<=e}),"do >= to"),">="),is:y(s),isNot:b(s),contains:y(p,"contains"),doesNotContain:b(p,"does not contain"),isIn:y(function(e,t){return p(t,e)},"is in"),isNotIn:b(function(e,t){return p(t,e)},"is not in"),isA:y(c,"is a"),isNotA:b(c,"is not a"),typifies:y(function(e,t){return c(t,e)}),untypifies:b(function(e,t){return c(t,e)}),matches:y(e),doesNotMatch:b(e),makeSpreader:function(e){var t;return m.containsError(e)?e:n.isPrototypeOf(e)||r.isPrototypeOf(e)?(t=l(e),(n.isPrototypeOf(e)?t.datatype:t).rest=!0,t):{value:e,spreader:!0,TwineScript_TypeName:"a spreaded '...' value",TwineScript_ObjectName:a("string"==typeof e||Array.isArray(e)?_toConsumableArray(e).length:1,"spreaded '...' value"),TwineScript_Unstorable:!0,TwineScript_ToSource:function(){return""+_toConsumableArray(e).map(d)}}}};return Object.freeze(t)}),define("twinescript/runner",["macros","state","utils","utils/operationutils","twinescript/operations","datatypes/colour","datatypes/hookset","datatypes/lambda","datatypes/datatype","datatypes/varbind","datatypes/codehook","datatypes/typedvar","datatypes/assignmentrequest","internaltypes/varref","internaltypes/twineerror"],function(Macros,State,Utils,_ref127,Operations,Colour,HookSet,Lambda,Datatype,VarBind,CodeHook,TypedVar,AssignmentRequest,VarRef,TwineError){var toSource=_ref127.toSource,typeName=_ref127.typeName,objectName=_ref127.objectName,insensitiveName=Utils.insensitiveName,impossible=Utils.impossible,hash=Utils.hash;function addFreeVariable(e,t){var n,r=e.freeVariables;"macro"===t.type?"current-time"===(n=insensitiveName(t.name))||"current-date"===n||"monthday"===n||"weekday"===n||"history"===n||"visited"===n||"passage"===n?e.freeVariables=!0:t.blockedValue&&!r.blockedValues?r.blockedValues=e.stackTop.blockedValues.concat():"random"!==n&&"either"!==n&&"shuffled"!==n||r.seed||(r.seed=State.seed,r.seedIter=State.seedIter):"identifier"===t.type?"time"!==(n=insensitiveName(t.text))&&"exits"!==n&&"it"!==n&&"visits"!==n&&"turns"!==n||(e.freeVariables=!0):"property"===t.type||"belongingProperty"===t.type?"random"!==insensitiveName(t.name)||r.seed||(r.seed=State.seed,r.seedIter=State.seedIter):"variable"!==t.type&&"tempVariable"!==t.type||(e.freeVariables=!0)}var precedenceTable=[["error","text"],["comma"],["to","into"],["where","when","via","making","each"],["typeSignature"],["augmentedAssign"],["and","or"],["is","isNot"],["contains","doesNotContain","isIn","isNotIn"],["isA","isNotA","matches","doesNotMatch"],["inequality"],["addition","subtraction"],["multiplication","division"],{rightAssociative:["spread","bind"]},{rightAssociative:["not","positive","negative"]},{rightAssociative:["belongingProperty","belongingItProperty","belongingOperator","belongingItOperator"]},["property","itsProperty","possessiveOperator","itsOperator"],["twineLink","macro","identifier","variable","tempVariable","hookName","number","cssTime","boolean","string","hook","colour","datatype","root"],["grouping"]];function precedentToken(e,t){var n,r,a,o=[];if(e.length)for("most"===t?(n=precedenceTable.length-1,r=a=-1):(n=0,r=precedenceTable.length,a=1);n!==r;n+=a){var i=precedenceTable[n],s=NaN;if(i.rightAssociative){for(var c=0;c<e.length;c+=1)if(i.rightAssociative.includes(e[c].type)){s=c;break}}else for(var l=e.length-1;0<=l;--l)if(i.includes(e[l].type)){s=l;break}if(!Number.isNaN(s)&&-1<s){o=[e[s],s];break}}return o}var comparisonOpTypes=["inequality","is","isNot","isIn","contains","doesNotContain","isNotIn","isA","typifies","isNotA","untypifies","matches","doesNotMatch"],inequalityNegator={">":"<=","<":">=",">=":"<","<=":">"};function compileComparisonOperator(e){return"inequality"===e.type?e.negate?inequalityNegator[e.operator]:e.operator:e.type}var comparisonReverser={">":"<","<":">",">=":"<=","<=":">=",contains:"isIn",doesNotContain:"isNotIn",isIn:"contains",isA:"typifies",typifies:"isA",isNotA:"untypifies",untypifies:"isNotA"};function reverseComparisonOperator(e){e=compileComparisonOperator(e);return comparisonReverser[e]||e}var tokenSides={error:"neither",identifier:"neither",variable:"neither",tempVariable:"neither",hookName:"neither",number:"neither",boolean:"neither",string:"neither",hook:"neither",colour:"neither",datatype:"neither",root:"neither",twineLink:"neither",macro:"neither",grouping:"neither",itsProperty:"neither",belongingItProperty:"neither",to:"both",into:"both",typeSignature:"both",augmentedAssign:"both",and:"both",or:"both",belongingOperator:"both",possessiveOperator:"both",multiplication:"both",division:"both",spread:"after",bind:"after",not:"after",belongingProperty:"after",each:"after",itsOperator:"after",positive:"after",negative:"after",belongingItOperator:"before",property:"before"};function missingSideError(e,t,n){return TwineError.create("syntax","I need usable code to be ".concat(e?"left ":"").concat(e&&t?"and ":"").concat(t?"right ":"","of ").concat(n.text,"."))}function wrongSideError(e,t,n){return TwineError.create("syntax","There can't be a ".concat(e&&t?e.map(function(e){return e.text}).join("")+" or "+t.map(function(e){return e.text}).join(""):(e||t).map(function(e){return e.text}).join("")," to the ").concat(e?"left ":"").concat(e&&t?"or ":"").concat(t?"right ":"","of ").concat(n.text,"."),"There could be a comma missing between them.")}function makeEvalReplayFrame(e,t){var n=t.val,r=t.fromCode,a=t.toCode,o=t.toDesc,i=t.reason,s=t.it,c=t.tokens,t=t.i;if(!(200<=e.length)){var l=c[t],u=c.slice(0,t),t=c.slice(t+1);if(1===c.length&&(u=t=!1,l=c[0]),!e[e.length-1].error){var p,d,c=TwineError.containsError(n),f=e[e.length-1].code,h=e[0].basis,m=(null!=(p=u)&&p.length&&null!=(p=t)&&p.length&&u[0].start>t[0].start&&(u=(p=[t,u])[0],t=p[1]),p=a||"".concat(null!=(p=u)&&p.length&&"whitespace"===u[u.length-1].type?" ":"").concat(c?" \ud83d\udc1e ":(n&&!n.TwineScript_ToSource&&n.TwineScript_Unstorable?objectName:toSource)(n)).concat(null==(p=t)||!p.length||"whitespace"!==t[0].type&&"addition"!==l.type&&"subtraction"!==l.type?"":" "),(u.length?u[0]:l).start-h),g=(t.length?t[t.length-1]:l).end-h,y=_createForOfIteratorHelper(e);try{for(y.s();!(d=y.n()).done;){var b=d.value;b.start<m?(m+=b.diff,g+=b.diff):b.start<g&&(g+=b.diff)}}catch(e){y.e(e)}finally{y.f()}!r&&(r=f.slice(m,g),a)&&a.trim()===r.trim()||(u=p.length-(g-m),e.push({code:f.slice(0,m)+p+f.slice(g),fromCode:r,toCode:!c&&a,toDesc:!c&&!a&&(o||objectName(n)),start:m,end:g,diff:u,reason:i,itIdentifier:void 0!==s&&objectName(s),error:c&&c.render(f.slice(m,g),!0)}))}}}function setIt(e,t){return(VarRef.isPrototypeOf(t)||TypedVar.isPrototypeOf(t))&&(e.Identifiers.it=t.get()),t}return function run(section,tokens){var isVarRef=2<arguments.length&&void 0!==arguments[2]&&arguments[2],isTypedVar=3<arguments.length&&void 0!==arguments[3]&&arguments[3],evalReplay=section.evalReplay,hasEvalReplay=null==evalReplay?void 0:evalReplay.length,evalReplayReason,evalReplaySkip=!1,evalReplayIt,ops=Operations,token,ret,i,before,after,_precedentToken,_precedentToken2,token,i,before,after;if(Array.isArray(tokens)||(tokens=[tokens]),!tokens.length||!tokens[0])return impossible("Runner.run","No tokens to run!"),0;1===tokens.length?token=tokens[0]:(_precedentToken=precedentToken(tokens,"least"),_precedentToken2=_slicedToArray(_precedentToken,2),token=_precedentToken2[0],i=_precedentToken2[1],before=tokens.slice(0,i),after=tokens.slice(i+1),before.length&&(1!==before.length||"whitespace"!==before[0].type)||(before=!1),after.length&&(1!==after.length||"whitespace"!==after[0].type)||(after=!1));var type=token.type;if(!type)return impossible("Runner.run","Token has no type!"),0;var sides=tokenSides[type]||"",VARREF=("both"!==sides||before&&after?"neither"===sides&&(before||after)?ret=wrongSideError(before,after,token):"before"===sides?before?after&&(ret=wrongSideError(null,after,token)):ret=missingSideError(!0,!1,token):"after"===sides&&(after?before&&(ret=wrongSideError(before,null,token)):ret=missingSideError(!1,!0,token)):ret=missingSideError(!before,!after,token),section.freeVariables&&"object"===_typeof(section.freeVariables)&&addFreeVariable(section,token),!0),TYPEDVAR=!0,_ret4,val,evalReplayReason,ret,source,_source4,_value4,msg;if(!ret){if("comma"===type)return impossible("Section.run","a comma token was run() somehow."),0;if("root"===type)ret=run(section,token.children);else if("identifier"===type)ret=isVarRef?VarRef.create(section.Identifiers,token.text.toLowerCase()):section.Identifiers[token.text.toLowerCase()];else if("variable"===type||"tempVariable"===type){ret=VarRef.create("tempVariable"===type?section.stackTop.tempVariables:State.variables,token.name),isTypedVar?(ret=TypedVar.create(Datatype.create("any"),ret),evalReplayReason=hasEvalReplay&&"Variables in 'to' or 'into' expressions with no -type to their left are considered to be 'any-type' variables that can store any storable value."):isVarRef||TwineError.containsError(ret)?evalReplaySkip=!0:(val=ret.get(),evalReplayReason=hasEvalReplay&&((null==(_ret4=ret)?void 0:_ret4.object)!==State.variables||hasOwnProperty.call(ret.object,ret.compiledPropertyChain[0])?"":"This variable didn't exist; for story-wide $ variables, a default value of 0 is used if they don't exist."),ret=val)}else if("hookName"===type)ret=HookSet.create({type:"name",data:token.name}),evalReplaySkip=!0;else if("number"===type||"cssTime"===type)ret=token.value,evalReplayReason=hasEvalReplay&&"cssTime"===type&&(token.text.endsWith("ms")?"The letters 'ms' at the end of numbers are ignored, so you can use them to indicate that a number represents milliseconds.":"The letter 's' at the end of numbers represents 'seconds'. Harlowe converts them to milliseconds (multiplies them by 1000)."),evalReplaySkip=!evalReplayReason;else if("boolean"===type)ret="true"===token.text.toLowerCase(),evalReplaySkip=!0;else if("string"===type){var t=token.text.replace(/(.?)\n/g,function(e,t){return("\\"===t?"\\\\":"\n"===t?"\\n":t)+"\\n"}).replace(/(\\*)\\0/g,function(e,t){return(t?"\\".repeat(2*t.length):"")+"0"});ret=eval(t),evalReplaySkip=!0}else if("hook"===type)ret=CodeHook.create(token.children,token.text),evalReplaySkip=!0;else if("colour"===type)ret=Colour.create(token.colour),evalReplaySkip=!0;else if("datatype"===type)ret=Datatype.create(token.name),evalReplaySkip=!0;else if("spread"===type)ret=ops.makeSpreader(run(section,after,!1,isTypedVar));else if("bind"===type)ret=VarBind.create(run(section,after,VARREF),token.text.startsWith("2")?"two way":""),evalReplaySkip=!0;else if("to"===type||"into"===type){var dest="to"===type?setIt(section,run(section,before,VARREF,TYPEDVAR)):run(section,after,VARREF,TYPEDVAR);if(TwineError.containsError(dest))ret=dest;else{(VarRef.isPrototypeOf(dest)&&dest.propertyChain.length<=1||TypedVar.isPrototypeOf(dest)&&dest.varRef.propertyChain.length<=1)&&(section.freeVariables=Object.create(null));var src="to"===type?run(section,after,VARREF):setIt(section,run(section,before,VARREF));if(TwineError.containsError(src))return src;var freeVariables=section.freeVariables,srcRef;section.freeVariables=null,token.place&&freeVariables&&"object"===_typeof(freeVariables)&&"boolean"!=typeof src&&"number"!=typeof src&&!Utils.options.uncompressedPureValues&&(srcRef=freeVariables,srcRef.at=token.place,srcRef.from=after[0].start,srcRef.to=after[after.length-1].end,srcRef.hash=hash(after.reduce(function(e,t){return e+t.text},"")).toString(16),JSON.stringify(srcRef).length>=toSource(src).length)&&(srcRef=void 0),ret=AssignmentRequest.create(dest,src,type,srcRef),evalReplaySkip=!0,evalReplayIt=section.Identifiers.it}}else if("typeSignature"===type){var datatype=run(section,before),free=section.freeVariables,variable=(section.freeVariables=null,run(section,after,VARREF));section.freeVariables=free,ret=TypedVar.create(datatype,variable),evalReplaySkip=!0}else if("where"===type||"when"===type||"via"===type){after?(source=tokens.map(function(e){return e.text}).join(""),ret=Lambda.create(before?run(section,before,VARREF):void 0,token.type,after,source),evalReplaySkip=!0):ret=missingSideError(!1,!0,token)}else if("making"===type||"each"===type){after?(_source4=[].concat(tokens).map(function(e){return e.text}).join(""),ret="each"===type?Lambda.create(run(section,after,VARREF),"each",null,_source4):Lambda.create(before?run(section,before,VARREF):void 0,token.type,run(section,after,VARREF),_source4),evalReplaySkip=!0):ret=missingSideError(!1,!0,token)}else if("augmentedAssign"===type)ret=ops.makeAssignmentRequest(run(section,before,VARREF),ops[token.operator](run(section,before),run(section,after)),token.operator),evalReplaySkip=!0;else if("and"===type||"or"===type){var isComparisonOp=function e(t){var n=_slicedToArray(precedentToken(t,"least"),2),r=n[0],n=n[1];if(r&&"whitespace"!==r.type)return comparisonOpTypes.includes(r.type)?r:r.type===type?e(t.slice(0,n))||e(t.slice(n+1)):void 0},leftIsComparison=isComparisonOp(before),rightIsComparison=isComparisonOp(after),ambiguityError=TwineError.create("operation",'This use of "is not" and "'.concat(type,'" is grammatically ambiguous.'),'Maybe try rewriting this as "__ is not __ '.concat(type,' __ is not __"')),operator,getElisionOperands=function e(t){var n,r=_slicedToArray(precedentToken(t,"least"),2),a=r[0],r=r[1];return a&&"whitespace"!==a.type?a.type===type?[].concat(_toConsumableArray(e(t.slice(0,r))),_toConsumableArray(e(t.slice(r+1)))):(a=run(section,t),hasEvalReplay&&"boolean"!=typeof a&&(n=operator.replace(/[A-Z]/g,function(e){return" "+e.toLowerCase()}),makeEvalReplayFrame(evalReplay,{toCode:" it ".concat(n," ").concat(toSource(a)," "),reason:"A missing 'it ".concat(n,"' was inferred to correct the '").concat(type,"' operation."),tokens:t,i:r}),makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(section.Identifiers.it)," ").concat(n," ").concat(toSource(a)," "),tokens:t,i:r})),[{val:a,tokens:t,i:r}]):[]},elidedComparisonOperator=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){var n=t.val,r=t.tokens,t=t.i;return"boolean"==typeof n?n:(e=Operations[token.type](e,Operations[operator](section.Identifiers.it,n)),hasEvalReplay&&makeEvalReplayFrame(evalReplay,{val:e,tokens:r,i:t}),e)},"and"===token.type)},leftSide,evalBefore,operator,rightSide,rightIndex,swappedSides,evalAfter;ret=leftIsComparison&&!rightIsComparison?(leftSide=leftIsComparison,operator=compileComparisonOperator(leftSide),"isNot"===leftSide.type||"isNotA"===leftSide.type||"untypifies"===leftSide.type?ambiguityError:(evalBefore=run(section,before),ops[type](evalBefore,elidedComparisonOperator.apply(void 0,_toConsumableArray(getElisionOperands(after)))))):!leftIsComparison&&rightIsComparison?(rightSide=rightIsComparison,rightIndex=tokens.indexOf(rightSide),operator=reverseComparisonOperator(rightSide),"isNot"===rightSide.type||"isNotA"===rightSide.type||"untypifies"===rightSide.type?ambiguityError:(swappedSides=[].concat(_toConsumableArray(tokens.slice(rightIndex+1)),[Object.assign(Object.create(rightSide),_defineProperty({},"inequality"===rightSide.type?"operator":"type",reverseComparisonOperator(rightSide)))],_toConsumableArray(tokens.slice(i+1,rightIndex))),evalAfter=run(section,swappedSides),ops[type](evalAfter,elidedComparisonOperator.apply(void 0,_toConsumableArray(getElisionOperands(before)))))):ops[type](run(section,before),run(section,after))}else if(comparisonOpTypes.includes(type)){after||missingSideError(!1,!0,token);var leftOp=before?run(section,before):section.Identifiers.it;ret=ops[compileComparisonOperator(token)](leftOp,run(section,after)),section.Identifiers.it=leftOp,evalReplayIt=leftOp,evalReplayReason=hasEvalReplay&&!before&&"A missing 'it' was inferred to complete the operation."}else if("addition"===type||"subtraction"===type){after||missingSideError(!1,!0,token);var convert=!before,_precedentToken7,_precedentToken8,previousPrecedentToken,_i10,_sides,pType,convert;before&&(_precedentToken7=precedentToken(before,"least"),_precedentToken8=_slicedToArray(_precedentToken7,2),previousPrecedentToken=_precedentToken8[0],_i10=_precedentToken8[1],_sides=tokenSides[previousPrecedentToken.type],pType=previousPrecedentToken.type,convert=("both"===_sides||"after"===_sides||"addition"===pType||"subtraction"===pType)&&(_i10===before.length-1||_i10===before.length-2&&"whitespace"===before[before.length-1].type)),convert?(token.type="addition"===type?"positive":"negative",ret=run(section,tokens),token.type=type,evalReplaySkip=!0):ret=ops[token.text](run(section,before),run(section,after))}else if("multiplication"===type||"division"===type)ret=ops[token.text](run(section,before),run(section,after));else if("positive"===type||"negative"===type)ret=ops["*"]("negative"===type?-1:1,run(section,after)),evalReplaySkip=!0;else if("not"===type)ret=ops.not(run(section,after));else if("belongingProperty"===type){var container=run(section,after,isVarRef),isRef=(ret=VarRef.create(container,token.name),isVarRef||TwineError.containsError(ret));ret=isRef?ret:ret.get(),isRef=isVarRef||TwineError.containsError(ret),hasEvalReplay&&!isRef?makeEvalReplayFrame(evalReplay,{toCode:" ".concat(token.name," of ").concat(toSource(VarRef.isPrototypeOf(container)?container.get():container)," "),tokens:tokens,i:i}):isRef||(evalReplayReason="The value to the right of 'of', ".concat(typeName(container),', had a "').concat(token.name,'" data name corresponding to that data value.'))}else if("belongingOperator"===type||"belongingItOperator"===type){var value=run(section,before);"random"===value&&section.freeVariables&&"object"===_typeof(section.freeVariables)&&!section.freeVariables.seed&&(section.freeVariables.seed=State.seed,section.freeVariables.seedIter=State.seedIter),ret=VarRef.create("belongingItOperator"===type?section.Identifiers.it:run(section,after,isVarRef),{computed:!0,value:value}),ret=isVarRef||TwineError.containsError(ret)?ret:ret.get(),"belongingItOperator"===type&&hasEvalReplay&&makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(value)," of ").concat(toSource(section.Identifiers.it)," "),tokens:tokens,i:i})}else if("property"===type){var _container=run(section,before,VARREF),_isRef=(ret=VarRef.create(_container,token.name),isVarRef||TwineError.containsError(ret));ret=_isRef?ret:ret.get(),_isRef=isVarRef||TwineError.containsError(ret),hasEvalReplay&&VarRef.isPrototypeOf(_container)&&!_isRef?makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(_container.get()),"'s ").concat(token.name," "),tokens:tokens,i:i}):_isRef||(evalReplayReason="The value to the left of 's, ".concat(typeName(_container),', had a "').concat(token.name,'" data name corresponding to that data value.'))}else if("itsProperty"===type||"belongingItProperty"===type)ret=VarRef.create(section.Identifiers.it,token.name),ret=isVarRef||TwineError.containsError(ret)?ret:ret.get(),hasEvalReplay&&makeEvalReplayFrame(evalReplay,{toCode:"itsProperty"===type?" ".concat(toSource(section.Identifiers.it),"'s ").concat(token.name," "):" ".concat(token.name," of ").concat(toSource(section.Identifiers.it)," "),tokens:tokens,i:i});else if("possessiveOperator"===type||"itsOperator"===type){!after||!before&&"itsOperator"!==token.type?ret=missingSideError(!before,!after,token):(_value4=run(section,after),"random"===_value4&&section.freeVariables&&"object"===_typeof(section.freeVariables)&&!section.freeVariables.seed&&(section.freeVariables.seed=State.seed,section.freeVariables.seedIter=State.seedIter),ret=VarRef.create("itsOperator"===token.type?section.Identifiers.it:run(section,before,isVarRef),{computed:!0,value:_value4}),ret=isVarRef||TwineError.containsError(ret)?ret:ret.get(),"itsOperator"===type&&hasEvalReplay&&makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(section.Identifiers.it),"'s ").concat(toSource(_value4)," "),tokens:tokens,i:i}))}else if("twineLink"===type)ret=Macros.run("link-goto",section,[token.innerText,token.passage]),evalReplayReason=hasEvalReplay&&"Passage links are the same as (link-goto:) macro calls.";else if("macro"===type)if(token.blockedValue&&!section.blocked){if(ret=section.blockedValue(),void 0===ret)return impossible("Runner.run","section.blockedValue() returned undefined"),0}else{var macroNameToken=token.children[0],variableCall="$"===macroNameToken.text[0]||"_"===macroNameToken.text[0],macroRef;if("macroName"!==macroNameToken.type&&!variableCall)return impossible("Runner.run","macro token had no macroName child token"),0;variableCall?(macroRef=VarRef.create("_"===macroNameToken.text[0]?section.stackTop.tempVariables:State.variables,macroNameToken.text.trim().slice(1,-1)),TwineError.containsError(macroRef)||(macroRef=macroRef.get())):macroRef=token.name,ret=Macros[variableCall?"runCustom":"run"](macroRef,section,token.children.slice(1).reduce(function(e,t){return"comma"===t.type?e.push([]):e[e.length-1].push(t),e},[[]]).filter(function(e){return e.length&&(1<e.length||"whitespace"!==e[0].type)}).map(function(e){return run(section,e,!1,isTypedVar)})),evalReplayReason=hasEvalReplay&&variableCall&&"I called ".concat(objectName(macroRef),".")}else if("grouping"===type)ret=run(section,token.children,isVarRef),evalReplaySkip=!0;else if("error"===type)ret=TwineError.create("syntax",token.message,token.explanation||"");else{if("text"!==type)return impossible("Section.run","unknown syntax token type: ".concat(type,"!!")),0;token.text.trim().match(/^\d+(?:th|nd|st|rd)(?:last)?(?:to\d+(?:nth|nd|st|rd)(?:last)?)?$/g)&&(msg='Position data names like "'.concat(token.text,'" need to be either left of "of" or right of "\'s".')),ret=TwineError.create("syntax",msg||'"'.concat(token.text,"\" isn't valid Harlowe syntax for the inside of a macro call."),"Maybe you misspelled something? Also, as of 3.3.0, Javascript syntax is not allowed inside macro calls.")}}return void 0===ret?(impossible("Section.run","token ".concat(type).concat(token.name?" (".concat(token.name,":)"):""," produced undefined")),0):ret===section?(impossible("Section.run","token ".concat(type).concat(token.name?" (".concat(token.name,":)"):""," produced the section")),0):(hasEvalReplay&&!evalReplaySkip&&makeEvalReplayFrame(evalReplay,{val:ret,reason:evalReplayReason,it:evalReplayIt,tokens:tokens,i:i}),ret)}}),define("utils/jqueryplugins",["jquery"],function(e){e.prototype.extend({popAttr:function(e){var t=this.attr(e);return this.removeAttr(e),t},popData:function(e){var t=this.data(e);return this.removeData(e),t},tag:function(){return this[0]&&this[0].tagName&&this[0].tagName.toLowerCase()},textNodes:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"*";return 1===this.length&&this[0]&&this[0].nodeType===Node.TEXT_NODE?[this[0]]:this.get().concat(this.contents().get(),this.find(e).contents().get()).filter(function(e,t,n){return(null==e?void 0:e.nodeType)===Node.TEXT_NODE&&n.indexOf(e)===t}).sort(function(e,t){return 2&e.compareDocumentPosition(t)?1:-1})},findAndFilter:function(e){var t=this.find(e),e=this.filter(e);return e.length?t.add(e):t}})}),define("utils/naturalsort",[],function(){return function(h){var m=1<arguments.length&&void 0!==arguments[1]?arguments[1]:String;return function(e,t){var n,r,a,o,i=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[/-]\d{1,4}[/-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,c=/^0x[0-9a-f]+$/i,l=/^0/,e=m(e).trim(),t=m(t).trim(),u=e.replace(i,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),p=t.replace(i,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),i=parseInt(e.match(c))||1!==u.length&&e.match(s)&&Date.parse(e),e=parseInt(t.match(c))||i&&t.match(s)&&Date.parse(t)||null;if(h&&window.Intl&&window.Intl.Collator&&(a=window.Intl.Collator(h)),e){if(i<e)return-1;if(e<i)return 1}for(var d=0,f=Math.max(u.length,p.length);d<f;d++){if(n=!(u[d]||"").match(l)&&parseFloat(u[d])||u[d]||0,r=!(p[d]||"").match(l)&&parseFloat(p[d])||p[d]||0,isNaN(n)!==isNaN(r))return isNaN(n)?1:-1;if(_typeof(n)!==_typeof(r))n+="",r+="";else if("string"==typeof n&&a&&0!==(o=a.compare(n,r)))return o;if(n<r)return-1;if(r<n)return 1}return 0}}}),define("utils/operationutils",["utils/naturalsort","utils","internaltypes/twineerror","patterns"],function(f,e,h,t){var m=e.impossible,g=e.nth,u=e.permutations,s=e.plural,y=t.validPropertyName,r="object",n="boolean",b="string",v="number",w="function";function a(e){return!!e&&(_typeof(e)===r||_typeof(e)===w)}var k=Array.isArray;function S(e){return e&&Object.getPrototypeOf(e)===Object.prototype}function i(e){return k(e)?"array":e instanceof Map?"datamap":e instanceof Set?"dataset":_typeof(e)===b?b:e&&_typeof(e)===r?r:""}function c(e){if(a(e)){if(_typeof(e.TwineScript_Clone)===w)return e.TwineScript_Clone();if(k(e))return _toConsumableArray(e);if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(_typeof(e)===w)return Object.assign(e.bind(),e);switch(Object.getPrototypeOf(e)){case Object.prototype:return _objectSpread({},e);case null:return Object.assign(Object.create(null),e)}m("OperationUtils.clone","The value "+e+" cannot be cloned!")}return e}function o(e,t,n,r){for(var a="",o=0;a.length<=t&&o<e.length;){var i=r(e[o]);if(!(i.length+a.length<=t)){a+=(0<o?" and ":"")+s(e.length-o,(0<o?"other ":"")+n);break}a+=(0<o&&o===e.length-1?" and ":"")+i+(o<e.length-1?", ":""),o+=1}return a}function l(e){var t;return a(e)&&"TwineScript_ObjectName"in e?e.TwineScript_ObjectName:k(e)?0===e.length?"an empty array":"an array (with "+o(e,48,"item",l)+")":e instanceof Map?0===e.size?"an empty datamap":"a datamap (with "+o(_toConsumableArray(e.keys()),48,"dataname",_)+")":e instanceof Set?0===e.size?"an empty dataset":"a dataset (with "+o(_toConsumableArray(e.values()),48,"item",l)+")":_typeof(e)===b?0===e.length?"an empty string":48<(t=_toConsumableArray(e)).length?"a ".concat(t.length,"-character string starting with ").concat(JSON.stringify(t.slice(0,48).join(""))):"the string ".concat(JSON.stringify(e)):_typeof(e)===n?"the boolean value '"+e+"'":_typeof(e)===v?"the number "+JSON.stringify(e):void 0===e?"an empty variable":"...whatever this is"}function T(e,t){return[e[0],t[0]].sort(f("en"))[0]===e[0]?-1:1}function _(e,t){var n=h.containsError(e);if(n&&m("toSource","received a TwineError: "+n.message),_typeof(e.TwineScript_ToSource)===w)return e.TwineScript_ToSource();if(S(e)&&"first"in e&&"last"in e)return(e.first<0?(-1!==e.first?g(-e.first):"")+"last":g(e.first+1))+"to"+(e.last<0?(-1!==e.last?g(-e.last):"")+"last":g(e.last+1));if(k(e)){var r,a="",o=_createForOfIteratorHelper(e);try{for(o.s();!(r=o.n()).done;)var i=r.value,a=(a+=a?",":"(a:")+("property"===t?i+(0<i):_(i))}catch(e){o.e(e)}finally{o.f()}return a+(a?")":"(a:)")}if(e instanceof Map){var s,c="",l=_createForOfIteratorHelper(Array.from(e.entries()).sort(T));try{for(l.s();!(s=l.n()).done;){var u=_slicedToArray(s.value,2),p=u[0],d=u[1];c+=(c?",":"(dm:")+_(p)+","+_(d)}}catch(e){l.e(e)}finally{l.f()}return c+(c?")":"(dm:)")}return e instanceof Set?"(ds:"+Array.from(e).sort(f("en")).map(_)+")":_typeof(e)===v&&"property"===t?e<0?-1===e?"last":g(-e)+"last":g(e+1):_typeof(e)===b&&"property"===t?RegExp(y).test(e)?e:"("+JSON.stringify(e)+")":JSON.stringify(e)}function p(t,n){return _typeof(t)!==r&&_typeof(n)!==r?t===n:k(t)&&k(n)?t.length===n.length&&t.every(function(e,t){return p(n[t],e)}):t instanceof Map&&n instanceof Map?p(Array.from(t.entries()).sort(),Array.from(n.entries()).sort()):t instanceof Set&&n instanceof Set?p(_toConsumableArray(t),_toConsumableArray(n)):t&&_typeof(t.TwineScript_is)===w?t.TwineScript_is(n):t&&_typeof(t)===r&&n&&_typeof(n)===r&&S(t)&&S(n)?p(Object.getOwnPropertyNames(t).map(function(e){return[e,t[e]]}),Object.getOwnPropertyNames(n).map(function(e){return[e,n[e]]})):Object.is(t,n)}return Object.freeze({isObject:a,isValidDatamapName:function(e,t){var n;return e instanceof Map||m("isValidDatamapName","called with non-Map"),h.containsError(t)?t:_typeof(t)!==b&&_typeof(t)!==v?h.create("property","Only strings and numbers can be used as data names for "+l(e)+", not "+l(t)+"."):(n=_typeof(t)===b?+t:""+t,!(!Number.isNaN(n)&&e.has(n))||h.create("property","You mustn't use both "+l(t)+" and "+l(n)+" as data names in the same datamap."))},collectionType:i,isSequential:function(e){return _typeof(e)===b||k(e)||_typeof(e.hooks)===w},unstorableValue:function e(t){return(null==t?void 0:t.TwineScript_Unstorable)&&t||k(t)&&t.find(e)||t instanceof Map&&_toConsumableArray(t.values()).find(e)||t instanceof Set&&_toConsumableArray(t).find(e)},isHarloweJSValue:function e(t){return _typeof(t)===b||_typeof(t)===n||_typeof(t)===v&&!Number.isNaN(t)&&Math.abs(t)!==1/0||Array.isArray(t)&&t.every(e)||t instanceof Set&&_toConsumableArray(t).every(e)||t instanceof Map&&_toConsumableArray(t.values()).every(e)&&_toConsumableArray(t.keys()).every(function(e){return _typeof(e)===b})},clone:c,objectName:l,typeName:function e(t){var n,r=S(t);return r&&t.innerType?t.typeName||("insensitive set"===t.pattern?"a case-insensitive string name":"either"===t.pattern?(k(t.innerType)||m("typeName",'"either" pattern had non-array inner type'),t.innerType.map(e).join(" or ")):"optional"===t.pattern?"(optional) "+e(t.innerType):e(t.innerType)):r&&"range"===t.pattern?t.name||(r=t.min,n=t.max,"a"+(0<r?" positive":"")+(t.integer?" whole":"")+" number"+(0===r?" between 0 and "+n:n<1/0?" up to "+n:"")):t===String||t===Number||t===Boolean?"a "+_typeof(t()):t===parseInt?"a whole number":t===Map?"a datamap":t===Set?"a dataset":t===Array?"an array":a(t)&&"TwineScript_TypeName"in t?t.TwineScript_TypeName:l(t)},typeID:function(e){var t=_typeof(e);return[n,b,v].includes(t)?t:k(e)?"array":e instanceof Map?"datamap":e instanceof Set?"dataset":e.TwineScript_TypeID||""},toSource:_,is:p,contains:function(e,t){if(e||""===e){if(_typeof(e)===b)return _typeof(t)!==b?h.create("operation",l(e)+" can only contain strings, not "+l(t)+"."):e.includes(t);if(k(e))return e.some(function(e){return p(e,t)});if(e instanceof Set||e instanceof Map)return Array.from(e.keys()).some(function(e){return p(e,t)})}return h.create("operation",l(e)+" cannot contain any values, let alone "+l(t))},isA:function(e,t){return _typeof(t.TwineScript_IsTypeOf)===w?t.TwineScript_IsTypeOf(e):h.create("operation",'"is a" should only be used to compare type names, not '+l(t)+".")},matches:function t(n,e){var r=!1;if(n&&_typeof(n.TwineScript_IsTypeOf)===w){var a=n.TwineScript_IsTypeOf(e);if(h.containsError(a))return a;r|=a}if(e&&_typeof(e.TwineScript_IsTypeOf)===w){if(a=e.TwineScript_IsTypeOf(n),h.containsError(a))return a;r|=a}if(r)return!0;if(k(n)&&k(e)){for(var o=0,i=0,s=!0;s&&o<n.length&&i<e.length;){var c=n[o],l=e[i];if(c.rest){for(;i<e.length&&t(c,l);)l=e[i+=1];o+=1}else if(l.rest){for(;o<n.length&&t(c,l);)c=n[o+=1];i+=1}else t(c,l)?(o+=1,i+=1):s=!1}return s&&o>=n.length&&i>=e.length}return n instanceof Map&&e instanceof Map?t(Array.from(n.entries()).sort(),Array.from(e.entries()).sort()):n instanceof Set&&e instanceof Set?(n=_toConsumableArray(n),u.apply(void 0,_toConsumableArray(e)).some(function(e){return t(n,e)})):p(n,e)},subset:function e(t,n,r){var a,o;return n&&r?((a=_typeof(t)===b)&&(t=Array.from(t)),n<0&&(n=Math.max(0,t.length+n+1)),(r=r<0?Math.max(0,t.length+r+1):r)<n?e(arguments[0],r,n):(o=t.slice(0<n?n-1:n,r).map(c),a?o.join(""):o)):h.create("macrocall","The sub"+i(t)+" index value must not be "+(n&&r)+".")},range:function e(t,n){if(n<t)return e(n,t);var r=[t];for(n-=t;0<n--;)r.push(++t);return r},printBuiltinValue:function r(e){return h.containsError(e)?e:e&&_typeof(e.TwineScript_Print)===w?e.TwineScript_Print():e instanceof Map?(e=Array.from(e.entries()),h.containsError(e)?e:e.reduce(function(e,t){var n=(t=_slicedToArray(t,2))[0],t=t[1];return e+"<tr><td>`"+r(n)+"`</td><td>`"+r(t)+"`</td></tr>"},"<table class=datamap>")+"</table>"):e instanceof Set?Array.from(e.values()).map(r)+"":k(e)?e.map(r)+"":e&&_typeof(e.jquery)===b?e:a(e)?h.create("unimplemented","I don't know how to print this value yet."):e+""},unique:function(t,e,n){return n.findIndex(function(e){return p(t,e)})===e}})}),define("utils/polyfills",[],function(){var o=Array.prototype;"function"!=typeof o.includes&&(o.includes=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!Number.isNaN(e)&&Number.isFinite(t)&&void 0!==e)return-1<o.indexOf.call(this,e,t);var n=Object(this),r=parseInt(n.length);if(!(r<=0))for(var a=0<=t?t:Math.max(0,r+t);a<r;){if(Object.is(e,n[a]))return!0;a+=1}return!1}),window.Symbol||(window.Symbol={iterator:"_es6-shim iterator_"})}),define("utils/renderutils",["jquery","utils","renderer"],function(l,u,p){var n=RegExp(u.realWhitespace+"+"),s=RegExp(u.realWhitespace+"+","g");function d(e,t,n){var r,a=e.textContent.length;if(!(a<=t))return r=[e=0===t?e:e.splitText(t)],n&&(n=n<=0?a-n:n)<a&&r.push(e.splitText(n-t)),r}var t,c=function(){var e;return void 0!==t?t:(e=l("<p>"),t=!!e[0].normalize&&(e.append(document.createTextNode("0-"),document.createTextNode("2"),document.createTextNode(""))[0].normalize(),1===e.contents().length))};var f="tw-collapsed,[collapsing=true]";var o=/^(=*)([^=]+)=*$/;return Object.freeze({dialog:function(){var e,t=(c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).section,n=void 0===(n=c.parent)?u.storyElement:n,r=c.cd,a=void 0===(a=c.message)?"":a,o=c.defaultValue,i=void 0===(c=c.buttons)?[{name:"OK",confirm:!0,callback:Object}]:c,s=("a code hook"===a.TwineScript_TypeName&&(a=a.code),l("<tw-backdrop><tw-dialog>"+(o||""===o?"<input type=text style='display:block;margin:0 auto'></input>\n":"")+"<tw-dialog-links>"+(i.length?i.reduce(function(e,t,n){t=t.name;return e+"<tw-link style='margin:0 "+(n===i.length-1?"0 0 0.5em":0===n?"0.5em 0 0":"0.5em")+"' tabindex=0>"+t+"</tw-link>"},""):"<tw-link tabindex=0>"+i[0].name+"</tw-link>")+"</tw-dialog-links></tw-dialog></tw-backdrop>")),c=s.find("tw-dialog");return n.append(s),t?(t.renderInto(a,c,_objectSpread(_objectSpread({},r),{},{append:"prepend"})),null!=(n=(null==r?void 0:r.transition)&&s.find("tw-dialog > tw-transition-container"))&&n.length&&n.appendTo(s).append(c.prepend(n.contents().detach()))):c.prepend(p.exec(a)),o&&((e=s.find("input").last()).val(o).on("keypress",function(e){13===e.which&&(s.remove(),i.filter(function(e){return e.confirm}).forEach(function(e){return e.callback()}))}),setTimeout(function(){return e.focus()},100)),i.reverse().forEach(function(e,t){l(s.find("tw-link").get(-t-1)).on("click",function(){u.options.debug&&u.options.ignoreClickEvents&&!l(s).is(".eval-replay, .harlowe-crash")||(s.remove(),e.callback())})}),s},realWhitespace:n,textNodeToChars:function(r){var e=_toConsumableArray(r.textContent);return 1===e.length?[r]:e.reduce(function(e,t){return t.match(n)&&e.length&&e[e.length-1].match(n)?e[e.length-1]+=t:e.push(t),e},[]).reduce(function(e,t){var n=r;return t.length<r.textContent.length&&(r=r.splitText(t.length)),e.concat(n)},[])},findTextInNodes:function e(t,n){var r=[],a="",o=[];if(!t.length||!n)return o;for(;0<t.length;){r.push(t[0]),a+=t[0].textContent,t.shift();var i=a.indexOf(n);if(-1<i){for(var s=a.length-(i+n.length);i>=r[0].textContent.length;)i-=r[0].textContent.length,r.shift();if(1===r.length){var c=d(r[0],i,i+n.length);o.push(c[0]),c[1]&&t.unshift(c[1]);break}o.push(d(r[0],i,r[0].length)[0]),o.push.apply(o,_toConsumableArray(r.slice(1,-1))),c=d(r[r.length-1],0,r[r.length-1].textContent.length-s),o.push(c[0]),c[1]&&t.unshift(c[1]),o=o.filter(Boolean);break}}return[o].concat(_toConsumableArray(e(t,n)))},collapse:function(e){function n(e){return 0===l(this||e).parentsUntil(f).filter("tw-verbatim, tw-expression, [collapsing=false]").length}var t=function e(t){var n=t[0],r=t.parent();return!r.length||t.findAndFilter("tw-story").length?null:(t=(t=r.textNodes().filter(function(e){return 4&(e=e.compareDocumentPosition(n))&&!(8&e)}))[t.length-1])||e(r)}(e),r=(l(t).parents(f).length||(t=null),function e(t){var n=t[0],r=t.parent();return!r.length||t.findAndFilter("tw-story").length?null:r.textNodes().filter(function(e){return 2&(e=e.compareDocumentPosition(n))&&!(8&e)})[0]||e(r)}(e)),a=(l(r).parents(f).length||(r=null),"br:not([data-raw]),tw-consecutive-br:not([data-raw])"),o=(e.find(a).filter(n).replaceWith(document.createTextNode(" ")),(e=l(e.get().map(function(e){return l(e).filter(n).is(a)?l(document.createTextNode(" ")).replaceAll(e)[0]:e}))).textNodes()),i=0;o.reduce(function(e,t){return n(t)?(t.textContent=t.textContent.replace(s," ")," "!==t.textContent[0]||e&&e.textContent&&!(-1<e.textContent.search(/\s$/))||(t.textContent=t.textContent.slice(1)),t):document.createTextNode("A")},t),_toConsumableArray(o).reverse().every(function(e){return!(!n(e)||(e.textContent.match(/^\s*$/)?(i+=e.textContent.length,e.textContent=""):(e.textContent=e.textContent.replace(/\s+$/,function(e){return i+=e.length,""}),1)))}),0<i&&r&&(o[o.length-1].textContent+=" "),e[0]&&c()&&e[0].normalize()},geomStringRegExp:o,geomParse:function(e){var t,n,r,a;return!e||(t=e.length,n=(a=_slicedToArray(o.exec(e)||[],3))[0],r=a[1],a=a[2],!n)||a===e&&1<a.length?{marginLeft:0,size:0}:{marginLeft:r.length/t*100,size:a.length/t*100}}})}),define("utils/scripttag",["state","utils/operationutils","internaltypes/varref","internaltypes/twineerror"],function(a,o,i,s){return function(e,r){Function("script","scope","with(scope){var scope=void 0,arguments=void 0;eval([script,script=void 0][0]);}")(e,Object.create(null,Object.keys(a.variables).map(function(e){return!e.startsWith("TwineScript_")&&"$"+e}).concat(Object.keys(r).map(function(e){return!e.startsWith("TwineScript_")&&"_"+e})).reduce(function(e,n){return n&&(e[n]={get:function(){var e=("$"===n[0]?a.variables:r)[n.slice(1)];if(o.isHarloweJSValue(e))return o.clone(e);throw s.create("","The contents of the variable ".concat(n,", ").concat(o.objectName(e),", couldn't be converted to a Javascript value."),"Only booleans, strings, numbers, datamaps, datasets and arrays can be converted to Javascript values.")},set:function(e){var t="$"===n[0]?a.variables:r;if(!o.isHarloweJSValue(e))throw s.create("","The Javascript value, ".concat(e,", couldn't be converted to a Harlowe value and assigned to the variable ").concat(n,"."),"Only booleans, strings, numbers (except NaN and Infinity), Maps, Sets and Arrays can be converted to Harlowe values.");e=o.clone(e);t=i.create(t,n.slice(1)).set(e);if(s.containsError(t))throw t}}),e},{})))}}),!function(){function e(t,n,r){return function(e){return"background-color: hsla(".concat(t,",").concat(n,"%,").concat(r,"%,").concat(e,");")}}var t={boolean:"color:hsla(0,0%,30%,1.0)",array:"color:hsla(0,100%,30%,1.0)",dataset:"color:hsla(30,100%,40%,1.0)",number:"color:hsla(30,100%,30%,1.0)",datamap:"color:hsla(60,100%,30%,1.0)",changer:"color:hsla(90,100%,30%,1.0)",lambda:"color:hsla(120,100%,40%,1.0)",hookName:"color:hsla(160,100%,30%,1.0)",string:"color:hsla(180,100%,30%,1.0)",identifier:"color:hsla(200,80%,40%,1.0)",variable:"color:hsla(200,100%,30%,1.0)",tempVariable:"color:hsla(200,70%,20%,1.0)",datatype:"color:hsla(220,100%,30%,1.0)",colour:"color:hsla(280,100%,30%,1.0)",macro:"color:hsla(320,80%,30%,1.0)",twineLink:"color:hsla(240,100%,20%,1.0)"},o=(t.gradient=t.colour,t.command=t.twineLink,t.instant=t.metadata=t.any=t.customMacro=t.macro,Math.min),n=e(40,100,50),r=e(220,100,50),i=/hsla\((\d+),\s*(\d+)%,\s*(\d+)%,\s*(\d+\.\d+)\)/g,s="cm-harlowe-3-",a=(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n={root:"box-sizing:border-box;",hook:n(.05),"hook-2":n(.1),"hook-3":n(.15),"hook-4":n(.2),"hook-5":n(.25),"hook-6":n(.3),"hook-7":n(.35),"hook-8":n(.4),"^=hook , ^=hook-":"font-weight:bold;",unclosedHook:n(.05)+"font-weight:bold;"},"error:not([class*='"+s+"string'])","background-color: hsla(17,100%,50%,0.5) !important;"),"^=macroName","font-style:italic;"),"macroName-boolean",t.boolean),"macroName-array",t.array),"macroName-dataset",t.dataset),"macroName-datatype",t.datatype),"macroName-number",t.number),"macroName-datamap",t.datamap),"macroName-changer",t.changer),"macroName-string",t.string),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,"macroName-colour, macroName-gradient",t.colour),"macroName-command, macroName-instant, macroName-metadata",t.command),"macroName-custommacro, macroName-macro, macroName-any",t.macro),"^=macro ","font-weight:bold;"+t.macro),"comma, spread",t.macro),"addition",t.any),"subtraction, multiplication, division",t.number),"is, and, or, not, isNot, contains, doesNotContain, isIn, isA, isNotA, isNotIn, matches, doesNotMatch",t.boolean),"bold, strong","font-weight:bold;"),"italic, em","font-style:italic;"),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,"sup","vertical-align: super;font-size:0.8em;"),"strike","text-decoration: line-through;"),"verbatim","background-color: hsla(0,0%,50%,0.1);font:var(--font-monospaced)"),"^=bold, ^=strong, ^=italic, ^=em, ^=sup, ^=verbatim, ^=strike","font-weight:100; color: hsla(0,0%,0%,0.5)"),"^=collapsed","font-weight:bold; color: hsla(201,100%,30%,1.0);"),"unclosedCollapsed",r(.025)+"font-weight:bold; color: hsla(201,100%,30%,1.0);"),"collapsed",r(.025)),"collapsed.hook",r(.05)),"collapsed.hook-2",r(.1)),"collapsed.hook-3",r(.15)),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,"collapsed.hook-4",r(.2)),"collapsed.hook-5",r(.25)),"collapsed.hook-6",r(.3)),"collapsed.hook-7",r(.35)),"collapsed.hook-8",r(.4)),"twineLink:not(.text)",t.twineLink),"tag, scriptStyleTag, comment","color: hsla(240,34%,25%,1.0);"),"boolean",t.boolean),"string",t.string),"number",t.number),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,"variable",t.variable),"tempVariable",t.tempVariable),"hookName",t.hookName),"datatype",t.datatype),"colour",t.colour),"cssTime",t.number),"passageString",t.variable+";text-decoration:underline 1px;"),"tagString",t.variable+";text-decoration:underline 1px dotted;"),"variableOccurrence, hookOccurrence","background: hsla(159,50%,75%,1.0) !important;"),"^=where, ^=via, ^=with, ^=making, ^=each, ^=when",t.lambda+"; font-style:italic;"),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,"heading","font-weight:bold;"),"hr","background-image: linear-gradient(0deg, transparent, transparent 45%, hsla(0,0%,75%,1.0) 45%, transparent 55%, transparent);"),"align","color: hsla(14,99%,37%,1.0); background-color: hsla(14,99%,87%,0.1);"),"column","color: hsla(204,99%,37%,1.0); background-color: hsla(204,99%,87%,0.1);"),"escapedLine","font-weight:bold; color: hsla(51,100%,30%,1.0);"),"identifier, property, belongingProperty, itsProperty, belongingItProperty, belongingItOperator, possessiveOperator, belongingOperator",t.identifier),"toString",function(){var a=this;return Object.keys(this).reduce(function(e,n){var r;return"toString"!==n&&(r=n.split(", ").map(function e(t){return-1<t.indexOf(".")?t.split(/\./g).map(e).join(""):0===t.indexOf("^=")?"[class^='"+s+t.slice(2)+"']":"."+s+t}),e+=r.join(", ")+"{"+a[n]+"}",a[n].match(i))&&[".theme-dark","[data-app-theme=dark]"].forEach(function(t){e+=r.map(function(e){return t+" "+e}).join(", ")+"{"+a[n].replace(i,function(e,t,n,r,a){return"hsla("+t+","+o(100,1.5*+n)+"%,"+(100-r)+"%,"+a+")"})+"}"}),e},"")})+"");"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports={Colours:t,CSS:a,versionClass:s}:"function"==typeof define&&define.amd&&define("utils/typecolours",[],function(){return{Colours:t,CSS:a,versionClass:s}})}.call(void 0);
;require("harlowe")}());
</script>

</body>
</html>
